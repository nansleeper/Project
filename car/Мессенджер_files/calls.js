/*! For license information please see calls.82f160e0e5e0398dcaf5.js.LICENSE.txt */
(()=>{var e,t,n,a={595318:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},750008:e=>{function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0},337057:(e,t,n)=>{"use strict";n.d(t,{VkIndexer:()=>a});var a=function(){function e(e,t,n){this.delimiter=new RegExp("[\\s\\-\\.,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\#\\+\\?\\\\]+","g"),this.trimmer=new RegExp("^[\\s\\-\\.,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\+\\?\\\\]+|[\\s\\-,\\\"\\'\\«\\(\\)\\[\\]\\{\\}\\\\]+$","g"),this.toTranslit={1072:"a",1073:"b",1074:"v",1075:"g",1076:"d",1077:"e",1078:"zh",1079:"z",1080:"i",1081:"y",1082:"k",1083:"l",1084:"m",1085:"n",1086:"o",1087:"p",1088:"r",1089:"s",1090:"t",1091:"u",1092:"f",1093:"h",1094:"ts",1095:"ch",1096:"sh",1097:"sh",1099:"y",1101:"e",1102:"yu",1103:"ya",1105:"e",1098:"",1100:""},this.toLocalCase={f:"a",",":"b","<":"b",d:"v",u:"g",l:"d",t:"e",";":"zh",":":"zh",p:"z",b:"i",q:"y",r:"k",k:"l",v:"m",y:"n",j:"o",g:"p",h:"r",c:"s",n:"t",e:"u",a:"f","[":"h","{":"kh",w:"ts",x:"ch",i:"sh",o:"sh",s:"y","'":"e",'"':"e",".":"yu",">":"yu",z:"ya","`":"e","~":"e",m:"","]":"","}":""},this.toLocalTranslit={1072:"f",1074:"d",1075:"u",1076:"l",1077:"t",1079:"p",1080:"b",1081:"q",1082:"r",1083:"k",1084:"v",1085:"y",1086:"j",1087:"g",1088:"h",1089:"c",1090:"n",1091:"e",1092:"a",1094:"w",1095:"x",1096:"i",1097:"o",1099:"s",1103:"z",1098:"m"},this.list=e||[],this.iterCur=0,this.iterEnd=e?e.length:0,this.index={},this.callback=n||function(){},this.prepareFunc=t||function(e){return e},setTimeout(this.indexIteration.bind(this),10)}return e.prototype.indexIteration=function(){for(var e=Math.min(this.iterEnd,this.iterCur+200),t=this.iterCur;t<e;t++){var n=this.list[t];try{n._order=t}catch(e){}this.add(n)}this.iterCur=t,t>=this.iterEnd?this.callback(this):setTimeout(this.indexIteration.bind(this),10)},e.prototype.strToPrefixes=function(e){for(var t,n={},a=(t=e,t.replace(/&#(\d\d+);/g,(function(e,t){return(t=!0===(n=t)?1:parseInt(n)||0)>=32?String.fromCharCode(t):e;var n})).replace(/&quot;/gi,'"').replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&")).toLowerCase().split(this.delimiter),r=a.length;r--;){var i=a[r],o="";if(i){for(var l=0;l<6;l++){var s=i.charCodeAt(l);if(s){var c=this.toTranslit[s],u=i.substr(l,1);o+=null!=c?c:u}}n[o]=1}}return n},e.prototype.strToSearchPrefixes=function(e){for(var t=[],n=e.toLowerCase().split(this.delimiter),a=n.length;a--;){var r={},i=n[a],o="",l="",s="",c=i.length>1;if(i){for(var u=0;u<6;u++){var d=i.charCodeAt(u);if(d){var p=this.toTranslit[d],_=i.substr(u,1);if(o+=null!=p?p:_,c){var m=this.toLocalCase[_],f=this.toLocalTranslit[d];l+=null!=m?m:_,s+=null!=f?f:_}}}r[o]=1,c&&(r[l]=2,r[s]=3),t.push(r)}}return t},e.prototype.toIndexTree=function(e,t){for(var n=this.index,a=0;a<6;a++){var r=e.substr(a,1)||-1;n=n[r]?n[r]:n[r]=5==a?[]:{}}n.push(t)},e.prototype.remove=function(e){var t=this.prepareFunc(e),n=this.strToPrefixes(t);for(var a in n)if(n.hasOwnProperty(a)){for(var r=this.index,i=0;i<6;i++){var o=a.substr(i,1)||-1;if(!r[o])break;r=r[o]}if(r.length)for(var i in r)if(this.equals(r[i],e)){r.splice(i,1);break}}},e.prototype.equals=function(e,t){for(var n in e)if(e.hasOwnProperty(n))switch(typeof e[n]){case"object":if(!this.equals(e[n],t[n]))return!1;break;case"function":if(void 0===e[n]||e[n].toString()!=t[n].toString())return!1;break;default:if(e[n]!=t[n])return!1}for(var n in t)if(void 0===t[n])return!1;return!0},e.prototype.intersect=function(e,t){var n=[];if(r(e[0])||r(t[0]))return e.filter((function(e){return-1!==t.indexOf(e)}));for(;e.length>0&&t.length>0;)if(e[0]._order<t[0]._order)e.shift();else if(e[0]._order>t[0]._order)t.shift();else{if(this.equals(e[0],t[0])){var a=e.shift();a&&n.push(a)}t.shift()}return n},e.prototype.add=function(e){var t=this.prepareFunc(e),n=this.strToPrefixes(t);for(var a in n)n.hasOwnProperty(a)&&this.toIndexTree(a,e)},e.prototype.search=function(e){var t=this.index,n=this.strToSearchPrefixes(e),a=[],r=!1;for(var i in n)if(n.hasOwnProperty(i)){if(r&&!a)break;var o=this.localSearch(n[i],0,t);o.sort((function(e,t){return e._order-t._order})),a=r?this.intersect(a,o):o,r=!0}for(var l=a[0],s=a.length+1,c=[],u=1;u<s;u++){var d=a[u];d!=l&&(c.push(l),l=d)}return c},e.prototype.localSearch=function(e,t,n){if(!n)return[];var a={};for(var r in e)e.hasOwnProperty(r)&&(a[o=r.substr(t,1)||-1]||(a[o]={}),a[o][r]=1);if(6==t++)return n;var i=[];for(var o in a)if("-1"===o)for(var l in n)n.hasOwnProperty(l)&&i.push.apply(i,this.localSearch(a[o],t,n[l]));else{var s=this.localSearch(a[o],t,n[o]);i.push.apply(i,s)}return i},e}();function r(e){return!isNaN(e)}},774351:(e,t,n)=>{"use strict";function a(e,t){return new Promise((function(n){setTimeout(n.bind(null,t),1e3*e)}))}n.d(t,{pause:()=>a})},788822:(e,t,n)=>{"use strict";n.d(t,{decodeHTMLEntities:()=>i,escape:()=>r});var a=[["&amp;","&"],["&lt;","<"],["&gt;",">"],["&quot;",'"']];function r(e){return a.reduce((function(e,t){var n=t[0],a=t[1];return e.replace(new RegExp(a,"ig"),n)}),e)}function i(e){return a.reduce((function(e,t){var n=t[0],a=t[1];return e.replace(new RegExp(n,"ig"),a)}),e).replace(/&#(\d+);/g,(function(e,t){return String.fromCodePoint(t)}))}},389953:(e,t,n)=>{"use strict";function a(e){return e>0&&e<2e9}function r(e){return e>2e9}n.d(t,{isChatPeer:()=>r,isUserPeer:()=>a})},465127:(e,t,n)=>{"use strict";n.d(t,{BlurFastWithMask:()=>G,EffectBackground:()=>F,EffectBlur:()=>W,ImageEdit:()=>v,Links:()=>y,Segmentation:()=>I,VideoEffects:()=>w,isSupported:()=>A});var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function i(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{s(a.next(e))}catch(e){i(e)}}function l(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}s((a=a.apply(e,t||[])).next())}))}function o(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}var l,s=function(e,t){void 0===t&&(t=[]);var n=t.join(","),a=new Blob(["("+e+")("+n+");"],{type:"application/javascript; charset=utf-8"});return window.URL.createObjectURL(a)};!function(e){e.IE="IE",e.Safari="Safari",e.Chrome="Chrome",e.Edge="Edge",e.Firefox="Firefox",e.Yandex="Yandex",e.Opera="Opera",e.Sferum="Sferum"}(l||(l={}));var c,u,d,p,_,m,f=(c=navigator.appVersion,u=navigator.appName,d=navigator.userAgent,p=[],function(){return p.length?p:p=function(){var e,t=!1,n=0,a=d.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(a[1]))return e=/\brv[ :]+(\d+)/g.exec(d),[l.IE,e&&e[1]||"Unknown",t,n];if("Safari"===a[1]){if(e=d.match(/\bEdge\/(\d+)/))return[l.Edge,e[1]||"Unknown",t,n];if(e=d.match(/\bCriOS\/(\d+)/))return[l.Chrome,e[1],!0,+e[1]];if(e=d.match(/\bFxiOS\/(\d+)/))return[l.Firefox,e[1],!1,n];if(e=d.match(/\bYaBrowser\/(\d+)/))return[l.Yandex,e[1],!1,n];if(e=d.match(/\bOPT\/(\d+)/))return[l.Opera,e[1],!1,n]}if(a[1]===l.Chrome){if(t=!0,n=Number(a[2]),e=d.match(/\bOPR\/(\d+)/))return[l.Opera,e[1]||"Unknown",t,n];if(e=d.match(/\bYaBrowser\/(\d+)/))return[l.Yandex,e[1]||"Unknown",t,n];if(e=d.match(/\bSferum\/((\d+)(?:\.\d+)*)/))return[l.Sferum,e[1]||"Unknown",t,n];if(e=d.match(/\bEdge?\/(\d+)/))return[l.Edge,e[1]||"Unknown",t,n];if(void 0!==window.opr&&/^(.+\.)?ok.ru$/.test(window.location.host))return[l.Opera,"Hidden",t,n]}return e=d.match(/version\/(\d+)/i),[a[2]?a[1]:u,e&&e[1]||a[2]||c,t,n]}()}),g=function(e){return i(void 0,void 0,void 0,(function(){return o(this,(function(t){return[2,new Promise((function(t,n){var a=document.createElement("img");a.crossOrigin="anonymous",a.onerror=function(e){n("Failed image loading: "+e)},a.onload=function(){return t(a)},a.src=e}))]}))}))},A=function(){try{var e=window,t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.captureStream&&e.CanvasCaptureMediaStreamTrack&&!0,n=f()[0]===l.Safari;return t&&!n}catch(e){return!1}},v=function(){function e(){this._backgroundCanvas=document.createElement("canvas")}return e.prototype.resize=function(e,t,n,a){var r,i,o=(void 0===a?{}:a).ctxOptions,l=(i={width:0,height:0},"number"==typeof(r=e).width&&"number"==typeof r.height&&(i.height=r.height,i.width=r.width),i),s=l.height,c=l.width,u=this._backgroundCanvas,d=u.getContext("2d",o);if(!d)throw new Error("ctx did not initialized");u.width=t,u.height=n;var p=Math.max(u.width/c,u.height/s),_=u.width/2-c/2*p,m=u.height/2-s/2*p;return d.drawImage(e,_,m,c*p,s*p),u},e}(),h=(function(e,t){e.exports=function(e){var t,n,a="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,r=void 0!==(e=e||{})?e:{};r.ready=new Promise((function(e,a){t=e,n=a}));var i,o={};for(i in r)r.hasOwnProperty(i)&&(o[i]=r[i]);var l="./this.program",s=function(e,t){throw t},c="";"undefined"!=typeof document&&document.currentScript&&(c=document.currentScript.src),void 0!==a&&a&&(c=a),c=0!==c.indexOf("blob:")?c.substr(0,c.lastIndexOf("/")+1):"";var u,d=r.print||console.log.bind(console),p=r.printErr||console.warn.bind(console);for(i in o)o.hasOwnProperty(i)&&(r[i]=o[i]);o=null,r.arguments,r.thisProgram&&(l=r.thisProgram),r.quit&&(s=r.quit),r.wasmBinary&&(u=r.wasmBinary);var _,m=r.noExitRuntime||!0;"object"!=typeof WebAssembly&&M("no native wasm support detected");var f,g,A,v,h,E=!1,C="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function S(e,t,n){for(var a=t+n,r=t;e[r]&&!(r>=a);)++r;if(r-t>16&&e.subarray&&C)return C.decode(e.subarray(t,r));for(var i="";t<r;){var o=e[t++];if(128&o){var l=63&e[t++];if(192!=(224&o)){var s=63&e[t++];if((o=224==(240&o)?(15&o)<<12|l<<6|s:(7&o)<<18|l<<12|s<<6|63&e[t++])<65536)i+=String.fromCharCode(o);else{var c=o-65536;i+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else i+=String.fromCharCode((31&o)<<6|l)}else i+=String.fromCharCode(o)}return i}function y(e){f=e,r.HEAP8=g=new Int8Array(e),r.HEAP16=new Int16Array(e),r.HEAP32=v=new Int32Array(e),r.HEAPU8=A=new Uint8Array(e),r.HEAPU16=new Uint16Array(e),r.HEAPU32=new Uint32Array(e),r.HEAPF32=new Float32Array(e),r.HEAPF64=new Float64Array(e)}r.INITIAL_MEMORY;var T,I,b,N=[],w=[],L=[],P=0,k=null;function M(e){r.onAbort&&r.onAbort(e),p(e+=""),E=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw n(t),t}function O(e){return e.startsWith("data:application/octet-stream;base64,")}function D(e){try{if(e==T&&u)return new Uint8Array(u);throw"both async and sync fetching of the wasm failed"}catch(e){M(e)}}function R(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?h.get(n)():h.get(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(r)}}function B(e){try{return _.grow(e-f.byteLength+65535>>>16),y(_.buffer),1}catch(e){}}r.preloadedImages={},r.preloadedAudios={},O(T="https://st.mycdn.me/static/callseffects/0-0-3/tflite-simd.wasm")||(I=T,T=r.locateFile?r.locateFile(I,c):c+I),b=function(){return performance.now()};var x={};function U(){if(!U.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:l||"./this.program"};for(var t in x)void 0===x[t]?delete e[t]:e[t]=x[t];var n=[];for(var t in e)n.push(t+"="+e[t]);U.strings=n}return U.strings}var H={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=H.buffers[e];0===t||10===t?((1===e?d:p)(S(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return H.varargs+=4,v[H.varargs-4>>2]},getStr:function(e){return function(e,t){return e?S(A,e,void 0):""}(e)},get64:function(e,t){return e}},G={a:function(){M()},m:function(e,t){var n;if(0===e)n=Date.now();else{if(1!==e&&4!==e)return 28,v[F()>>2]=28,-1;n=b()}return v[t>>2]=n/1e3|0,v[t+4>>2]=n%1e3*1e3*1e3|0,0},i:function(e,t){M("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")},c:function(e,t){M("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")},g:function(){return 2147483648},k:function(e,t,n){A.copyWithin(e,t,t+n)},l:function(e){var t,n=A.length,a=2147483648;if((e>>>=0)>a)return!1;for(var r=1;r<=4;r*=2){var i=n*(1+.2/r);if(i=Math.min(i,e+100663296),B(Math.min(a,((t=Math.max(e,i))%65536>0&&(t+=65536-t%65536),t))))return!0}return!1},d:function(e){for(var t=b();b()-t<e;);},e:function(e,t){var n=0;return U().forEach((function(a,r){var i=t+n;v[e+4*r>>2]=i,function(e,t,n){for(var a=0;a<e.length;++a)g[t++>>0]=e.charCodeAt(a);g[t>>0]=0}(a,i),n+=a.length+1})),0},f:function(e,t){var n=U();v[e>>2]=n.length;var a=0;return n.forEach((function(e){a+=e.length+1})),v[t>>2]=a,0},o:function(e){!function(e,t){var n;n=e,m||(r.onExit&&r.onExit(n),E=!0),s(n,new W(n))}(e)},h:function(e){return 0},j:function(e,t,n,a,r){},b:function(e,t,n,a){for(var r=0,i=0;i<n;i++){for(var o=v[t+8*i>>2],l=v[t+(8*i+4)>>2],s=0;s<l;s++)H.printChar(e,A[o+s]);r+=l}return v[a>>2]=r,0},n:function e(t,n){e.randomDevice||(e.randomDevice=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}return function(){M("randomDevice")}}());for(var a=0;a<n;a++)g[t+a>>0]=e.randomDevice();return 0}};!function(){var e={a:G};function t(e,t){var n,a=e.exports;r.asm=a,y((_=r.asm.p).buffer),h=r.asm.A,n=r.asm.q,w.unshift(n),function(e){if(P--,r.monitorRunDependencies&&r.monitorRunDependencies(P),0==P&&k){var t=k;k=null,t()}}()}function a(e){t(e.instance)}function i(t){return(u||"function"!=typeof fetch?Promise.resolve().then((function(){return D(T)})):fetch(T,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+T+"'";return e.arrayBuffer()})).catch((function(){return D(T)}))).then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){p("failed to asynchronously prepare wasm: "+e),M(e)}))}if(P++,r.monitorRunDependencies&&r.monitorRunDependencies(P),r.instantiateWasm)try{return r.instantiateWasm(e,t)}catch(e){return p("Module.instantiateWasm callback failed with error: "+e),!1}(u||"function"!=typeof WebAssembly.instantiateStreaming||O(T)||"function"!=typeof fetch?i(a):fetch(T,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(a,(function(e){return p("wasm streaming compile failed: "+e),p("falling back to ArrayBuffer instantiation"),i(a)}))}))).catch(n)}(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.q).apply(null,arguments)},r._setNumThreads=function(){return(r._setNumThreads=r.asm.r).apply(null,arguments)},r._getModelBufferMemoryOffset=function(){return(r._getModelBufferMemoryOffset=r.asm.s).apply(null,arguments)},r._getInputMemoryOffset=function(){return(r._getInputMemoryOffset=r.asm.t).apply(null,arguments)},r._getOutputMemoryOffset=function(){return(r._getOutputMemoryOffset=r.asm.u).apply(null,arguments)},r._getInputDim=function(){return(r._getInputDim=r.asm.v).apply(null,arguments)},r._getOutputDim=function(){return(r._getOutputDim=r.asm.w).apply(null,arguments)},r._loadModel=function(){return(r._loadModel=r.asm.x).apply(null,arguments)},r._updateRecurrentState=function(){return(r._updateRecurrentState=r.asm.y).apply(null,arguments)},r._runInference=function(){return(r._runInference=r.asm.z).apply(null,arguments)};var V,F=r.___errno_location=function(){return(F=r.___errno_location=r.asm.B).apply(null,arguments)};function W(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function z(e){function n(){V||(V=!0,r.calledRun=!0,E||(R(w),t(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),function(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)e=r.postRun.shift(),L.unshift(e);var e;R(L)}()))}P>0||(function(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)e=r.preRun.shift(),N.unshift(e);var e;R(N)}(),P>0||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1),n()}),1)):n()))}if(k=function e(){V||z(),V||(k=e)},r.run=z,r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return z(),e.ready}}(_={exports:{}}),_.exports),E="https://st.mycdn.me/static/callseffects",C=E+"/0-0-3",S=E+"/0-0-5",y={segmentation:{models:{"192x256":C+"/segmentation-model.tflite"},wasm:{tfliteSimd:C+"/tflite-simd.wasm"}},backgrounds:[{id:3012,preview:S+"/3012-preview.png",original:S+"/3012-original.jpg",description:"elephant in the white room",tags:["default"]},{id:3013,preview:S+"/3013-preview.png",original:S+"/3013-original.jpg",description:"old native stove in russian historic house",tags:["default"]},{id:3014,preview:S+"/3014-preview.png",original:S+"/3014-original.jpg",description:"flying baloons surrounded by mountains",tags:["default"]},{id:3015,preview:S+"/3015-preview.png",original:S+"/3015-original.jpg",description:"two pilots driving a plate",tags:["default"]},{id:3016,preview:S+"/3016-preview.png",original:S+"/3016-original.jpg",description:"sauna",tags:["default"]},{id:3017,preview:S+"/3017-preview.png",original:S+"/3017-original.jpg",description:"red chairs in movie theater",tags:["default"]},{id:3018,preview:S+"/3018-preview.png",original:S+"/3018-original.jpg",description:"sleeping person in train cart",tags:["default"]},{id:3019,preview:S+"/3019-preview.jpg",original:S+"/3019-original.jpg",description:"Little Big icons on pink background",tags:["star"]},{id:3020,preview:S+"/3020-preview.jpg",original:S+"/3020-original.jpg",description:"Violet wild mint (2 colors split background)",tags:["star"]},{id:3021,preview:S+"/3021-preview.jpg",original:S+"/3021-original.jpg",description:"Klava Koka left the chat and in love with MDK",tags:["star"]},{id:3022,preview:S+"/3022-preview.jpg",original:S+"/3022-original.jpg",description:"Some half-naked dude with rifle",tags:["star"]},{id:3023,preview:S+"/3023-preview.jpg",original:S+"/3023-original.jpg",description:'"Cirle" photo collage',tags:["star"]},{id:3024,preview:S+"/3024-preview.jpg",original:S+"/3024-original.jpg",description:"Gazgolder & red carpet on the wall",tags:["star"]},{id:3025,preview:S+"/3025-preview.jpg",original:S+"/3025-original.jpg",description:"Gazgolder & VK Clips collab pink-yellow-blue collage",tags:["star"]},{id:3026,preview:S+"/3026-preview.jpg",original:S+"/3026-original.jpg",description:"Crem Soda people collage",tags:["star"]}],icons:{starBackground:{id:"icon-star-background",description:"Icon for indicating that virtual background is from stars",url:S+"/icon-star-background.svg",type:"svg"}}},T=function(){function e(){}return e.workerFn=function(e){console.log("here goes the worker...");var t=null,n=!1,a={"192x256":[192,256]},r={processSizeKey:"192x256",inputMemoryOffset:0,outputMemoryOffset:0,maskArray:null,numThreads:2},i=function(){c.call(null,"log",Array.from(arguments))},o=function(){c.call(null,"warn",Array.from(arguments))};function l(l,c,u){return void 0===c&&(c={}),void 0===u&&(u=!1),n=u,i("[createModel]",l,c,{debugFlag:u}),e().then((function(e){return function(e,t){return i("[loadModel][modelPath]",e,t),fetch(t).then((function(e){return e.arrayBuffer()})).then((function(t){i("Model buffer size:",t.byteLength);var n=r.numThreads,a=e._getModelBufferMemoryOffset();return i("Model buffer memory offset:",a),i("Loading model buffer..."),e.HEAPU8.set(new Uint8Array(t),a),i("_loadModel result:",e._loadModel(t.byteLength,n)),{inputMemoryOffset:e._getInputMemoryOffset(0)/4,outputMemoryOffset:e._getOutputMemoryOffset(0)/4}}))}(e,l).then((function(n){return t=e,n}))})).then((function(e){var t=c.processSizeKey||r.processSizeKey,n=a[t],i=n[0],o=n[1],l=new Float32Array(i*o);s(Object.assign({maskArray:l},e,c))})).catch((function(e){t=null,o("simd error",e),self.postMessage({type:"error",error:e})}))}function s(e){Object.assign(r,e),i("settings updated",r)}function c(e,t){if(void 0===e&&(e="log"),"function"==typeof console[e]&&n){var a=["[segmentation-worker]"].concat(t);console[e].apply(null,a)}}self.onmessage=function(e){try{switch(e.data.type){case"create":l(e.data.modelPath,e.data.settings,e.data.debug).then((function(){self.postMessage({type:"ready"})}));break;case"frame":var n=function(e){var n=r.maskArray,i=r.inputMemoryOffset,l=r.outputMemoryOffset,s=a[r.processSizeKey],c=s[0],u=s[1];if(t){if(n){for(var d=0,p=0;d<c*u;d++,p+=4)t.HEAPF32[i+p]=e.data[p]/255,t.HEAPF32[i+p+1]=e.data[p+1]/255,t.HEAPF32[i+p+2]=e.data[p+2]/255,t.HEAPF32[i+p+3]=n[d];t._runInference(),t._updateRecurrentState(1,1);var _=new ImageData(u,c);for(d=0,p=0;d<c*u;d++,p+=4)n[d]=t.HEAPF32[l+d],_.data[p+3]=255*n[d];return _}o("no maskArray created")}else o("no tfliteSIMD instance!")}(e.data.imageData);n&&self.postMessage({type:"frame",segmentationMask:n,resizedImage:e.data.imageData},[n.data.buffer,e.data.imageData.data.buffer]);break;case"params":s(e.data.params);break;default:o("unhandled event",e.data)}}catch(e){o("onmessage error",e),self.postMessage({type:"error",error:e})}}},e}(),I=function(){function e(e){var t=this,n=e.onFrame,a=e.onReady,r=e.onError;this._settings={modelKey:"192x256",processSizeKey:"192x256"},this._processSize={"192x256":[192,256]},this._worker=null,this._worker=new Worker(s(T.workerFn,[h,JSON.stringify({})])),this._worker.onmessage=function(e){switch(e.data.type){case"ready":a(t);break;case"frame":n({image:t._canvasImageBackup,resizedImage:e.data.resizedImage,segmentationMask:e.data.segmentationMask});break;case"error":null==r||r(e.data);break;default:console.warn("unhandled event type",e.data)}},this._canvas=document.createElement("canvas"),this._canvasImageBackup=document.createElement("canvas");var i=this._canvas.getContext("2d"),o=this._canvasImageBackup.getContext("2d");if(!i||!o)throw new Error("can't get ctx for canvas");this._ctx=i,this._ctxImageBackup=o}return e.prototype.createModel=function(e){var t,n=this._settings,a=y.segmentation.models[n.modelKey];null===(t=this._worker)||void 0===t||t.postMessage({type:"create",modelPath:a,settings:n,debug:e})},e.prototype.setParams=function(e){var t=this._worker,n=this._settings;Object.assign(n,e),null==t||t.postMessage({type:"params",params:n})},e.prototype.requestSegmentation=function(e){var t=this,n=t._settings,a=t._canvas,r=t._ctx,i=t._worker,o=t._processSize[n.processSizeKey],l=o[0],s=o[1];this._saveImage(e),a.width=s,a.height=l,r.drawImage(e,0,0,s,l);var c=r.getImageData(0,0,s,l);null==i||i.postMessage({type:"frame",imageData:c},[c.data.buffer])},e.prototype._saveImage=function(e){var t=this._ctxImageBackup,n=this._canvasImageBackup,a=function(e){var t={height:0,width:0};return"number"==typeof e.height?t.height=e.height:t.height=e.height.baseVal.value,"number"==typeof e.width?t.width=e.width:t.width=e.width.baseVal.value,t}(e),r=a.height,i=a.width;n.height=r,n.width=i,t.clearRect(0,0,i,r),t.drawImage(e,0,0,i,r)},e.prototype.destroy=function(){this._worker&&(this._worker.terminate(),this._worker=null)},e}(),b=function(){function e(){}return e.updateSegmentationParams=function(t){Object.assign(e._params.segmentation,t)},e.getSegmentationParams=function(){return e._params.segmentation},e.setDebug=function(t){e._params.debug=t},e.getDebug=function(){return!!e._params.debug},e._params={segmentation:{processSizeKey:"192x256",modelKey:"192x256"}},e}(),N=function(){function e(){this._timeouts=new Map,this._throttles=new Map,this._worker=new Worker(s(e.workerFn))}return e.prototype.initWorker=function(e){var t=void 0===e?{}:e,n=t.onError,a=t.onTimeout,r=t.onThrottle,l=t.onReady;return i(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){return[2,new Promise((function(t,i){e._worker.addEventListener("message",(function(o){switch(o.data.type){case"timeout":e._callTimeout(o.data.id),null==a||a(o.data);break;case"throttle":e._callThrottle(o.data.id),null==r||r(o.data);break;case"error":null==n||n(o.data),i(o.data);break;case"ready":null==l||l(o.data),t()}})),e._worker.addEventListener("error",(function(e){null==n||n(e),i(e)})),e._worker.postMessage({type:"ready"})}))]}))}))},e.workerFn=function(){var e=new Map,t=new Map;self.onmessage=function(n){switch(n.data.type){case"timeout":!function(t,n){void 0===n&&(n=5);var a=setTimeout((function(){self.postMessage({type:"timeout",id:t}),e.delete(t)}),n);e.set(t,a)}(n.data.id,n.data.ms);break;case"throttle":!function(e,n){void 0===n&&(n=5);var a=t.get(e);a&&clearTimeout(a);var r=setTimeout((function(){self.postMessage({type:"throttle",id:e}),t.delete(e)}),n);t.set(e,r)}(n.data.id,n.data.ms);break;case"ready":self.postMessage({type:"ready"});break;default:self.postMessage({type:"error",data:n.data})}},self.postMessage({type:"ready"})},e.prototype.postTimeout=function(e,t,n){void 0===n&&(n=5),this._timeouts.set(e,t),this._worker.postMessage({type:"timeout",id:e,ms:n})},e.prototype.postThrottle=function(e,t,n){void 0===n&&(n=5),this._throttles.set(e,t),this._worker.postMessage({type:"throttle",id:e,ms:n})},e.prototype._callTimeout=function(e){var t=this._timeouts.get(e);t&&(this._timeouts.delete(e),t())},e.prototype._callThrottle=function(e){var t=this._throttles.get(e);t&&(this._throttles.delete(e),t())},e.prototype.destroy=function(){this._worker.terminate(),this._throttles.clear(),this._timeouts.clear()},e}();!function(e){e.NONE="none",e.BLUR="blur",e.BACKGROUND="background"}(m||(m={}));var w=function(){function e(e){var t=void 0===e?{}:e,n=t.segmentation,a=t.debug;this._effect=null,this._net=null,this._video=null,this._canvas=null,this._stream=null,this._track=null,this._sendNextFrame=null,this._timerWorker=null,n&&b.updateSegmentationParams(n),a&&b.setDebug(a)}return e.prototype._createDom=function(e){var t=function(e){var t,n,a=e.defaults,r=e.track,i=r.getSettings(),o=r.getConstraints(),l=a;return n=["width","height"],"object"==typeof(t=i)&&(Array.isArray(n)?n.every((function(e){return e in t})):n in t)||!function(e){return"object"==typeof e?Array.isArray(e)?!e.length:!Object.keys(e).length:"string"==typeof e?!e.length:!e}(o)?(i.height?l.height=i.height:"number"==typeof o.height?l.height=o.height:"object"==typeof o.height&&(l.height=o.height.exact||o.height.ideal||o.height.max||o.height.min||l.height),i.width?l.width=i.width:"number"==typeof o.width?l.width=o.width:"object"==typeof o.width&&(l.width=o.width.exact||o.width.ideal||o.width.max||o.width.min||l.width),l):l}({track:e,defaults:{height:360,width:640}}),n=t.width,a=t.height;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.style.pointerEvents="none",this._canvas.style.visibility="hidden",this._canvas.style.position="absolute",this._canvas.style.width="160px",this._canvas.style.height="90px",this._canvas.height=a,this._canvas.width=n,this._canvas.style.bottom="0",this._canvas.style.left="0",this._canvas.style.zIndex="5000",document.body.appendChild(this._canvas)),this._video||(this._video=document.createElement("video"),this._video.controls=!1,this._video.autoplay=!1,this._video.preload="auto",this._video.muted=!0,this._video.style.pointerEvents="none",this._video.style.visibility="hidden",this._video.style.position="absolute",this._video.style.width="160px",this._video.style.height="90px",this._video.height=a,this._video.width=n,this._video.style.bottom="0",this._video.style.right="0",this._video.style.zIndex="5000",document.body.appendChild(this._video))},e.prototype._removeDom=function(){try{this._canvas&&document.body.removeChild(this._canvas),this._video&&document.body.removeChild(this._video)}catch(e){}this._canvas=null,this._video=null},e.prototype._createStream=function(e){return i(this,void 0,void 0,(function(){var t=this;return o(this,(function(n){if(!this._canvas||!this._video)throw new Error("Video element or canvas not found");return this._stream=this._canvas.captureStream(0),[2,new Promise((function(n,a){var r=t._video;r.srcObject=new MediaStream([e]),r.onloadeddata=function(){var e;r.width=r.videoWidth,r.height=r.videoHeight,t._track=null===(e=t._stream)||void 0===e?void 0:e.getVideoTracks()[0],n()},r.onerror=function(){return a(new Error("Video element error"))};var i=r.play(),o=function(){return a(new Error("Autoplay is disabled"))};i?i.catch(o):o()}))]}))}))},e.prototype._createNet=function(){return i(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){return[2,new Promise((function(t,n){var a=b.getDebug()?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(console,e),n()}:void 0;new I({onFrame:function(t){e._drawFrame(t)},onReady:t,onError:a}).createModel(b.getDebug())}))]}))}))},e.prototype._removeStream=function(){this._stream&&(this._stream.getTracks().forEach((function(e){return e.stop()})),this._stream=null,this._track=null),this._video&&(this._video.pause(),this._video.srcObject&&this._video.srcObject.getTracks().forEach((function(e){return e.stop()})),this._video.srcObject=null)},e.prototype._drawFrame=function(e){var t,n=this;this._net&&this._video&&this._effect&&this._canvas&&this._video&&this._effect&&(this._effect.draw(e),this._track&&(this._track.requestFrame(),null===(t=this._timerWorker)||void 0===t||t.postTimeout(Date.now(),(function(){n._video&&n._sendNextFrame&&n._sendNextFrame(n._video)}))))},e.prototype._cleanup=function(e){var t=void 0===e?{}:e,n=t.removeWorkerNet,a=t.removeWorkerTimer;this._effect&&(this._effect.destroy(),this._effect=null),this._removeStream(),this._removeDom(),n&&this._net&&(this._net.destroy(),this._net=null),a&&this._timerWorker&&(this._timerWorker.destroy(),this._timerWorker=null)},e.prototype._setEffect=function(e,t){return i(this,void 0,void 0,(function(){var n,a=this;return o(this,(function(r){switch(r.label){case 0:return this._timerWorker?[3,2]:(this._timerWorker=new N,[4,this._timerWorker.initWorker()]);case 1:r.sent(),r.label=2;case 2:return this._net?[3,4]:(n=this,[4,this._createNet()]);case 3:n._net=r.sent(),r.label=4;case 4:return this._effect&&(this._effect=null),this._sendNextFrame=function(e){var t;null===(t=a._timerWorker)||void 0===t||t.postThrottle("img-segm",(function(){var t;null===(t=a._net)||void 0===t||t.requestSegmentation(e)}),1e3/60)},this._removeStream(),this._createDom(t),[4,this._createStream(t)];case 5:if(r.sent(),!this._canvas||!this._video)throw new Error("Video element or canvas not found");return this._effect=e,this._effect.video=this._video,this._effect.canvas=this._canvas,this._sendNextFrame(this._video),[2]}}))}))},e.prototype.setEffect=function(e,t){var n;return i(this,void 0,void 0,(function(){var a;return o(this,(function(r){switch(r.label){case 0:if(!e)return this._cleanup(),[2,t];e.effect!==(null===(n=this._effect)||void 0===n?void 0:n.effect)&&e.destroy(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._setEffect(e,t)];case 2:return r.sent(),[2,this._track||t];case 3:throw a=r.sent(),this._cleanup(),a;case 4:return[2]}}))}))},e.prototype.stopEffect=function(){this._cleanup()},Object.defineProperty(e.prototype,"effect",{get:function(){return this._effect?this._effect.effect:m.NONE},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this._cleanup({removeWorkerNet:!0,removeWorkerTimer:!0})},e}(),L=function(e){var t=e.gl,n=e.fs,a=e.vs,r=t.createShader(t.VERTEX_SHADER);if(!r)throw new Error("vertex shader didn't initialized");t.shaderSource(r,a),t.compileShader(r);var i=t.createShader(t.FRAGMENT_SHADER);if(!i)throw new Error("fragment shader didn't initialized");t.shaderSource(i,n),t.compileShader(i);var o=t.createProgram();if(!o)throw new Error("shader program didn't initialized");if(t.attachShader(o,r),t.attachShader(o,i),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw t.getProgramInfoLog(o);return t.deleteShader(r),t.deleteShader(i),{program:o}},P=function(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),t},k=function(e,t,n){var a=P(e);if(!a)throw new Error("texture was not created");e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null);var r=e.createFramebuffer();if(!r)throw new Error("framebuffer was not created");return e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),{framebuffer:r,texture:a}},M=function(e,t,n,a){e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,a,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindTexture(e.TEXTURE_2D,null)},O=function(e,t){e.bindFramebuffer(e.FRAMEBUFFER,t),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.bindFramebuffer(e.FRAMEBUFFER,null)},D=function(e,t){return{aTextureCoord:e.getAttribLocation(t,"aTextureCoord"),aVertexCoord:e.getAttribLocation(t,"aVertexCoord")}},R="attribute vec3 aVertexCoord;\nattribute vec2 aTextureCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n  gl_Position = vec4(aVertexCoord, 1.0);\n  vTextureCoord = aTextureCoord;\n}",B=function(){function e(e){var t=this;this.gl=e,this.program=L({fs:"precision highp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uAlphaTexture;\nuniform float uLowerBound;\nuniform float uUpperBound;\n\nvoid main(void) {\n  vec4 color = texture2D(uAlphaTexture, vTextureCoord);\n  if (color.a < uLowerBound) {\n    color.a = 0.0;\n  } else {\n    if (color.a < uUpperBound) {\n      color.a = (color.a - uLowerBound) / (uUpperBound - uLowerBound);\n    } else {\n      color.a = 1.0;\n    }\n  }\n  gl_FragColor = color;\n}",gl:e,vs:R}).program,this.uniforms={uAlphaTexture:function(e){var n=t.gl.getUniformLocation(t.program,"uAlphaTexture");t.gl.uniform1i(n,e)},uLowerBound:function(e){var n=t.gl.getUniformLocation(t.program,"uLowerBound");t.gl.uniform1f(n,e)},uUpperBound:function(e){var n=t.gl.getUniformLocation(t.program,"uUpperBound");t.gl.uniform1f(n,e)}},this.attributes=D(this.gl,this.program)}return e.prototype.bind=function(){this.gl.useProgram(this.program)},e.prototype.destroy=function(){this.gl.deleteProgram(this.program)},e}(),x=function(){function e(e){var t=this;this.gl=e,this.program=L({fs:"precision highp float;\n\nuniform sampler2D uCameraFrameTexture;\nuniform sampler2D uBackgroundTexture;\nuniform sampler2D uAlphaTexture;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n  vec4 cameraFrameColor = texture2D(uCameraFrameTexture, vTextureCoord);\n  vec4 backgroundColor = texture2D(uBackgroundTexture, vTextureCoord);\n  vec4 alphaMask = texture2D(uAlphaTexture, vTextureCoord);\n  gl_FragColor = mix(backgroundColor, cameraFrameColor, alphaMask.a);\n}",gl:e,vs:R}).program,this.uniforms={uAlphaTexture:function(e){var n=t.gl.getUniformLocation(t.program,"uAlphaTexture");t.gl.uniform1i(n,e)},uCameraFrameTexture:function(e){var n=t.gl.getUniformLocation(t.program,"uCameraFrameTexture");t.gl.uniform1i(n,e)},uBackgroundTexture:function(e){var n=t.gl.getUniformLocation(t.program,"uBackgroundTexture");t.gl.uniform1i(n,e)}},this.attributes=D(this.gl,this.program)}return e.prototype.bind=function(){this.gl.useProgram(this.program)},e.prototype.destroy=function(){this.gl.deleteProgram(this.program)},e}(),U=function(){function e(e){var t=this;this.gl=e,this.program=L({fs:"// https://github.com/Jam3/glsl-fast-gaussian-blur\n\nprecision highp float;\n\nuniform sampler2D texture;\nuniform vec3 iResolution;\nuniform bool flip;\nuniform vec2 direction;\n\nvec4 blur5(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3333333333333333) * direction;\n  color += texture2D(image, uv) * 0.29411764705882354;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.35294117647058826;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.35294117647058826;\n  return color;\n}\n\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.411764705882353) * direction;\n  vec2 off2 = vec2(3.2941176470588234) * direction;\n  vec2 off3 = vec2(5.176470588235294) * direction;\n  color += texture2D(image, uv) * 0.1964825501511404;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.2969069646728344;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.2969069646728344;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.09447039785044732;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.09447039785044732;\n  color += texture2D(image, uv + (off3 / resolution)) * 0.010381362401148057;\n  color += texture2D(image, uv - (off3 / resolution)) * 0.010381362401148057;\n  return color;\n}\n\nvoid main() {\n  vec2 uv = vec2(gl_FragCoord.xy / iResolution.xy);\n  if (flip) {\n    uv.y = 1.0 - uv.y;\n  }\n\n  gl_FragColor = blur13(texture, uv, iResolution.xy, direction);\n}",gl:e,vs:"attribute vec3 position;\n\nvoid main() { gl_Position = vec4(position, 1.0); }"}).program,this.uniforms={texture:function(e){var n=t.gl.getUniformLocation(t.program,"texture");t.gl.uniform1i(n,e)},iResolution:function(e,n,a){var r=t.gl.getUniformLocation(t.program,"iResolution");t.gl.uniform3f(r,e,n,a)},flip:function(e){var n=t.gl.getUniformLocation(t.program,"flip");t.gl.uniform1f(n,e)},direction:function(e,n){var a=t.gl.getUniformLocation(t.program,"direction");t.gl.uniform2f(a,e,n)}},this.attributes={position:this.gl.getAttribLocation(this.program,"position")}}return e.prototype.bind=function(){this.gl.useProgram(this.program)},e.prototype.destroy=function(){this.gl.deleteProgram(this.program)},e}(),H=function(){function e(e){var t=this;this.gl=e,this.program=L({fs:"precision highp float;\n\nuniform sampler2D uTextureOriginal;\nuniform sampler2D uTextureMask;\nuniform vec3 iResolution;\nuniform bool flip;\nuniform vec2 direction;\n\nvec4 blur13(sampler2D image, sampler2D maskTexture, vec2 uv, vec2 resolution,\n            vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.411764705882353) * direction;\n  vec2 off2 = vec2(3.2941176470588234) * direction;\n  vec2 off3 = vec2(5.176470588235294) * direction;\n  float sumCof = 0.0;\n\n  vec4 c = texture2D(image, uv);\n  vec4 m = texture2D(maskTexture, uv);\n  color += c * 0.1964825501511404 * (1.0 - m.a);\n  sumCof += 0.1964825501511404 * (1.0 - m.a);\n\n  c = texture2D(image, uv + (off1 / resolution));\n  m = texture2D(maskTexture, uv + (off1 / resolution));\n  color += c * 0.2969069646728344 * (1.0 - m.a);\n  sumCof += 0.2969069646728344 * (1.0 - m.a);\n\n  c = texture2D(image, uv - (off1 / resolution));\n  m = texture2D(maskTexture, uv - (off1 / resolution));\n  color += c * 0.2969069646728344 * (1.0 - m.a);\n  sumCof += 0.2969069646728344 * (1.0 - m.a);\n\n  c = texture2D(image, uv + (off2 / resolution));\n  m = texture2D(maskTexture, uv + (off2 / resolution));\n  color += c * 0.09447039785044732 * (1.0 - m.a);\n  sumCof += 0.09447039785044732 * (1.0 - m.a);\n\n  c = texture2D(image, uv - (off2 / resolution));\n  m = texture2D(maskTexture, uv - (off2 / resolution));\n  color += c * 0.09447039785044732 * (1.0 - m.a);\n  sumCof += 0.09447039785044732 * (1.0 - m.a);\n\n  c = texture2D(image, uv + (off3 / resolution));\n  m = texture2D(maskTexture, uv + (off3 / resolution));\n  color += c * 0.010381362401148057 * (1.0 - m.a);\n  sumCof += 0.010381362401148057 * (1.0 - m.a);\n\n  c = texture2D(image, uv - (off3 / resolution));\n  m = texture2D(maskTexture, uv - (off3 / resolution));\n  color += c * 0.010381362401148057 * (1.0 - m.a);\n  sumCof += 0.010381362401148057 * (1.0 - m.a);\n\n  return sumCof > 0.0 ? color / sumCof : vec4(0.0, 0.0, 0.0, 0.0);\n}\n\nvoid main() {\n  vec2 uv = vec2(gl_FragCoord.xy / iResolution.xy);\n\n  if (flip) {\n    uv.y = 1.0 - uv.y;\n  }\n\n  gl_FragColor =\n      blur13(uTextureOriginal, uTextureMask, uv, iResolution.xy, direction);\n}",gl:e,vs:"attribute vec3 position;\n\nvoid main() { gl_Position = vec4(position, 1.0); }"}).program,this.uniforms={uTextureOriginal:function(e){var n=t.gl.getUniformLocation(t.program,"uTextureOriginal");t.gl.uniform1i(n,e)},uTextureMask:function(e){var n=t.gl.getUniformLocation(t.program,"uTextureMask");t.gl.uniform1i(n,e)},iResolution:function(e,n,a){var r=t.gl.getUniformLocation(t.program,"iResolution");t.gl.uniform3f(r,e,n,a)},flip:function(e){var n=t.gl.getUniformLocation(t.program,"flip");t.gl.uniform1f(n,e)},direction:function(e,n){var a=t.gl.getUniformLocation(t.program,"direction");t.gl.uniform2f(a,e,n)}},this.attributes={position:this.gl.getAttribLocation(this.program,"position")}}return e.prototype.bind=function(){this.gl.useProgram(this.program)},e.prototype.destroy=function(){this.gl.deleteProgram(this.program)},e}(),G=function(){function e(e){this.textures={background:null,image:null,resizedImage:null,segmentationMask:null},this.parameters={blurStrength:.8,fixSegmentation:!0,fixSegmentationBlurStrength:.25,fixSegmentationIterations:8,alphaCutterLowerBound:.4,alphaCutterUpperBound:.6},this.$canvas=e;var t=this.$canvas.getContext("webgl");if(!t)throw new Error("getting ctx failed");this.gl=t;var n=this.gl;this.onresize=this.onresize.bind(this),this.onresize(),this.pBlurFastWithMask=new H(this.gl),this.pBackgroundComposer=new x(this.gl),this.pBlurFast=new U(this.gl),this.pAlphaCutter=new B(this.gl),this.vertices=[1,1,0,1,1,1,-1,0,1,0,-1,-1,0,0,0,-1,1,0,0,1],this.indices=[0,1,3,1,2,3];var a=n.createBuffer(),r=n.createBuffer();if(!a||!r)throw new Error("create buffer error");this.positionBuffer=a,this.indexBuffer=r,n.bindBuffer(n.ARRAY_BUFFER,this.positionBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(this.vertices),n.STATIC_DRAW),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),n.STATIC_DRAW),this.fbs={blur:this.createTextureLayers(),segmentationFix:this.createTextureLayers()},this.textures={background:P(n),image:P(n),resizedImage:P(n),segmentationMask:P(n)},window.addEventListener("resize",this.onresize)}return e.prototype.onresize=function(){var e=this,t=e.$canvas,n=e.gl,a=e.fbs,r=t.width||t.clientWidth,i=t.height||t.clientHeight;t.width=r,t.height=i,n.viewport(0,0,r,i),a&&function(e,t){for(var n=t.height,a=t.width,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];r.forEach((function(t){t.forEach((function(t){O(e,t.framebuffer),M(e,t.texture,a,n)}))}))}(n,{width:r,height:i},a.blur,a.segmentationFix)},e.prototype.loadTextures=function(e){var t=e.image,n=e.resizedImage,a=e.segmentationMask,r=e.background,i=this.gl,o=this.textures;return i.bindTexture(i.TEXTURE_2D,o.image),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),r||(i.bindTexture(i.TEXTURE_2D,o.resizedImage),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n)),i.bindTexture(i.TEXTURE_2D,o.segmentationMask),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,a),r&&(i.bindTexture(i.TEXTURE_2D,o.background),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r)),i.bindTexture(i.TEXTURE_2D,null),o},e.prototype.close=function(){var e=this,t=e.gl,n=e.positionBuffer,a=e.indexBuffer,r=e.pBackgroundComposer,i=e.pBlurFast,o=e.pBlurFastWithMask,l=e.pAlphaCutter,s=e.fbs,c=e.textures;window.removeEventListener("resize",this.onresize),t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(n),t.deleteBuffer(a),t.useProgram(null),r.destroy(),i.destroy(),o.destroy(),l.destroy(),function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];t.forEach((function(t){t.forEach((function(t){e.deleteFramebuffer(t.framebuffer),e.deleteTexture(t.texture)}))}))}(t,s.blur,s.segmentationFix),function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];t.forEach((function(t){return e.deleteTexture(t)}))}(t,c.background,c.image,c.resizedImage,c.segmentationMask)},e.prototype.drawGeometry=function(){var e=this,t=e.gl,n=e.indexBuffer,a=e.indices;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.drawElements(t.TRIANGLES,a.length,t.UNSIGNED_SHORT,0)},e.prototype.createTextureLayers=function(){var e=this.gl,t=this.$canvas,n=t.width,a=t.height;return[k(e,n,a),k(e,n,a)]},e.prototype.setGeometry=function(e,t){var n=this.gl,a=this.positionBuffer;n.bindBuffer(n.ARRAY_BUFFER,a),n.enableVertexAttribArray(e),n.vertexAttribPointer(e,3,n.FLOAT,!1,5*Float32Array.BYTES_PER_ELEMENT,0),void 0!==t&&(n.enableVertexAttribArray(t),n.vertexAttribPointer(t,2,n.FLOAT,!1,5*Float32Array.BYTES_PER_ELEMENT,3*Float32Array.BYTES_PER_ELEMENT))},e.prototype.setParameters=function(e){Object.assign(this.parameters,e)},e.prototype.draw=function(e){var t,n,a=this,r=a.gl,i=a.$canvas,o=a.parameters,l=a.pBlurFastWithMask,s=a.pBackgroundComposer,c=a.pBlurFast,u=a.pAlphaCutter,d=a.fbs,p=o.fixSegmentation,_=o.fixSegmentationBlurStrength,m=o.blurStrength,f=o.fixSegmentationIterations,g=o.alphaCutterLowerBound,A=o.alphaCutterUpperBound,v=i.width,h=i.height;r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.viewport(0,0,v,h),r.disable(r.BLEND),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);var E=this.loadTextures(e),C=null,S=e.background?E.background:null;if(p){c.bind(),this.setGeometry(c.attributes.position),c.uniforms.iResolution(v,h,0),c.uniforms.flip(0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,E.segmentationMask),c.uniforms.texture(0);for(var y=0,T=0;T<f;++T){var I=(f-T-1)*_,b=T%2==0?[I,0]:[0,I];(t=c.uniforms).direction.apply(t,b),r.bindFramebuffer(r.FRAMEBUFFER,d.segmentationFix[y%2].framebuffer),this.drawGeometry(),r.bindTexture(r.TEXTURE_2D,d.segmentationFix[y%2].texture),++y}u.bind(),this.setGeometry(u.attributes.aVertexCoord,u.attributes.aTextureCoord),u.uniforms.uLowerBound(g),u.uniforms.uUpperBound(A),u.uniforms.uAlphaTexture(0),r.bindFramebuffer(r.FRAMEBUFFER,d.segmentationFix[y%2].framebuffer),this.drawGeometry(),C=d.segmentationFix[y%2].texture}if(!S){l.bind(),this.setGeometry(l.attributes.position),l.uniforms.iResolution(v,h,0),l.uniforms.flip(0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,C||E.segmentationMask),l.uniforms.uTextureMask(0),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,E.resizedImage),l.uniforms.uTextureOriginal(1);var N=0;for(T=0;T<8;++T)I=(8-T-1)*m,b=T%2==0?[I,0]:[0,I],(n=l.uniforms).direction.apply(n,b),r.bindFramebuffer(r.FRAMEBUFFER,d.blur[N%2].framebuffer),this.drawGeometry(),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,d.blur[N%2].texture),++N;S=d.blur[(N-1)%2].texture}s.bind(),this.setGeometry(s.attributes.aVertexCoord,s.attributes.aTextureCoord),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,C||E.segmentationMask),s.uniforms.uAlphaTexture(0),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,S),s.uniforms.uBackgroundTexture(1),r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,E.image),s.uniforms.uCameraFrameTexture(2),r.bindFramebuffer(r.FRAMEBUFFER,null),this.drawGeometry()},e}(),V=function(){function e(e){this._effect=e}return Object.defineProperty(e.prototype,"video",{set:function(e){this._video=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvas",{set:function(e){this._canvas=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"effect",{get:function(){return this._effect},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){},e}(),F=function(e){function t(){var t=e.call(this,m.BACKGROUND)||this;return t._imageEdit=new v,t._WebGlBlend=null,t}return r(t,e),t.prototype.setBackgroundImage=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(a){switch(a.label){case 0:return t=this,e?[4,g(e)]:[3,2];case 1:return n=a.sent(),[3,3];case 2:n=void 0,a.label=3;case 3:return t._nextBackgroundImage=n,[2]}}))}))},t.prototype._updateBackground=function(){try{if(this._nextBackgroundImage){var e=this._canvas,t=this._imageEdit,n=e.width,a=e.height;this._backgroundImage=t.resize(this._nextBackgroundImage,n,a),delete this._nextBackgroundImage}}catch(e){console.warn(e)}},t.prototype.draw=function(e){try{if(this._WebGlBlend||(this._WebGlBlend=new G(this._canvas)),this._nextBackgroundImage&&this._updateBackground(),this._WebGlBlend){var t=Object.assign({background:this._backgroundImage},e);this._WebGlBlend.draw(t)}}catch(e){console.warn(e)}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this._WebGlBlend&&(this._WebGlBlend.close(),this._WebGlBlend=null)},t}(V),W=function(e){function t(){var t=e.call(this,m.BLUR)||this;return t._WebGLEffects=null,t._savedOptions=null,t}return r(t,e),t.prototype.draw=function(e){try{this._WebGLEffects||(this._WebGLEffects=new G(this._canvas),this._savedOptions&&this._WebGLEffects.setParameters(this._savedOptions)),this._WebGLEffects.draw(e)}catch(e){console.warn(e)}},t.prototype.setEffects=function(e){this._savedOptions=e,this._WebGLEffects&&this._WebGLEffects.setParameters(e)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this._WebGLEffects&&(this._WebGLEffects.close(),this._WebGLEffects=null)},t}(V)},890638:(e,t,n)=>{"use strict";t.default=void 0;var a=s(n(667294)),r=s(n(887854)),i=n(408091),o=n(279353),l=n(269659);function s(e){return e&&e.__esModule?e:{default:e}}var c="0 0 24 24",u="more_horizontal_24",d=!1;function p(){d||((0,o.addSpriteSymbol)(new r.default({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="more_horizontal_24"><g fill="none" fill-rule="evenodd"><path d="M24 0H0v24h24z" /><path d="M18 10c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm-6 4c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-6 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z" fill="currentColor" /></g></symbol>'})),d=!0)}var _=function(e){return(0,o.useIsomorphicLayoutEffect)((function(){p()}),[]),a.default.createElement(l.SvgIcon,(0,i.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};_.mountIcon=p;var m=_;t.default=m},725074:(e,t,n)=>{"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.IconSettingsProvider=t.IconSettingsContext=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var l=r?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(n,o,l):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(667294));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=(0,r.createContext)({});t.IconSettingsContext=l;t.IconSettingsProvider=function(e){var t=e.children,n=o(e,["children"]),a=(0,r.useMemo)((function(){return n}),[n.classPrefix,n.globalClasses]);return r.default.createElement(l.Provider,{value:a},t)}},269659:(e,t,n)=>{"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.SvgIcon=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var l=r?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(n,i,l):n[i]=e[i]}n.default=e,t&&t.set(e,n);return n}(n(667294)),i=n(725074);function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p={display:"block"};var _=function(e){var t=e.width,n=e.height,a=e.viewBox,o=e.id,s=e.className,u=e.style,_=e.fill,m=e.getRootRef,f=e.Component,g=d(e,["width","height","viewBox","id","className","style","fill","getRootRef","Component"]),A=Math.max(t,n),v=(0,r.useContext)(i.IconSettingsContext),h=function(e,t){for(var n=t.classPrefix,a=t.globalClasses,r="",i=0;i<e.length;i++)n&&(r+=" "+(n+e[i])),n&&!a||(r+=" "+e[i]);return r}(["Icon","Icon--".concat(A),"Icon--w-".concat(t),"Icon--h-".concat(n),"Icon--".concat(o)],v);return r.default.createElement(f,l({role:"presentation"},g,{ref:m,className:"".concat(h," ").concat(s),style:c(c({},u),{},{width:t,height:n})}),r.default.createElement("svg",{viewBox:a,width:t,height:n,style:p},r.default.createElement("use",{xlinkHref:"#".concat(o),style:{fill:"currentColor",color:_}})))};t.SvgIcon=_,_.defaultProps={Component:"div",className:"",style:{}}},263986:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 12 12",u="arrow_down_left_12",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="arrow_down_left_12"><path d="M3 10a1 1 0 01-1-1V4a1 1 0 012 0v2.586l4.293-4.293a1 1 0 011.414 1.414L5.415 8.001 8 8a1 1 0 010 2z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?12:+e.width,height:isNaN(e.height)?12:+e.height}))};_.mountIcon=p;const m=_},800055:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 12 12",u="arrow_up_right_12",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="arrow_up_right_12"><path d="M9 2a1 1 0 011 1v5a1 1 0 01-2 0V5.414L3.707 9.707a1 1 0 01-1.414-1.414l4.292-4.294L4 4a1 1 0 010-2z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?12:+e.width,height:isNaN(e.height)?12:+e.height}))};_.mountIcon=p;const m=_},711798:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 12 12",u="cancel_12",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="cancel_12"><path d="M3.525 2.464a.75.75 0 00-1.06 1.061L4.938 6 2.464 8.475a.75.75 0 101.061 1.06L6 7.062l2.475 2.475a.75.75 0 001.06-1.061L7.062 6l2.475-2.475a.75.75 0 10-1.061-1.06L6 4.938z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?12:+e.width,height:isNaN(e.height)?12:+e.height}))};_.mountIcon=p;const m=_},700881:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 12 12",u="cancel_outline_12",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="cancel_outline_12"><path clip-rule="evenodd" d="M9.03 2.97a.75.75 0 010 1.06L7.06 6l1.97 1.97a.75.75 0 01-1.06 1.06L6 7.06 4.03 9.03a.75.75 0 01-1.06-1.06L4.94 6 2.97 4.03a.75.75 0 011.06-1.06L6 4.94l1.97-1.97a.75.75 0 011.06 0z" fill="currentColor" fill-rule="evenodd" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?12:+e.width,height:isNaN(e.height)?12:+e.height}))};_.mountIcon=p;const m=_},297627:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 16 16",u="connection_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="connection_16"><g fill="currentColor"><path d="M12 3a1 1 0 00-1 1v8a1 1 0 102 0V4a1 1 0 00-1-1zM7 6a1 1 0 012 0v6a1 1 0 11-2 0zM3 8a1 1 0 012 0v4a1 1 0 11-2 0z" /></g></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};_.mountIcon=p;const m=_},722254:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 16 16",u="microphone_slash_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="microphone_slash_16"><path d="M5.498 7.06v.44a2.501 2.501 0 002.909 2.467l1.2 1.198a4.005 4.005 0 01-5.521-2.822.75.75 0 00-1.47.314A5.508 5.508 0 007.25 12.95v1.301a.75.75 0 001.502 0v-1.3a5.473 5.473 0 001.972-.669l1.25 1.25a.751.751 0 001.062-1.061L3.88 3.32a.75.75 0 10-1.06 1.06l2.678 2.68zm6.356 1.529c-.089.314-.03.66.2.89.37.37.993.284 1.16-.211a5.44 5.44 0 00.17-.61.75.75 0 10-1.469-.315 3.943 3.943 0 01-.061.246zM6.303 2.662c-.332.307-.254.818.066 1.138l3.428 3.424a.4.4 0 00.683-.279l.022-2.445a2.501 2.501 0 00-4.199-1.838z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};_.mountIcon=p;const m=_},607350:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 16 16",u="pin_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="pin_16"><path d="M10.235 2.106l3.657 3.663c.225.226.064.633-.263.633h-.523a.895.895 0 00-.633.263L10.758 8.38a.896.896 0 00-.262.633v2.996c0 .554-.7.858-1.1.456l-2.301-2.3-3.57 3.57a.893.893 0 11-1.264-1.263L5.83 8.898l-2.29-2.29c-.391-.392-.109-1.102.456-1.102H6.99a.895.895 0 00.633-.262L9.338 3.53a.896.896 0 00.263-.634V2.37c0-.32.403-.495.634-.263z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};_.mountIcon=p;const m=_},86339:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 16 16",u="pin_dot_16",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="pin_dot_16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.25 4a1.25 1.25 0 100-2.5 1.25 1.25 0 000 2.5zm7.642 1.77l-3.657-3.664c-.231-.232-.634-.057-.634.263v.526a.896.896 0 01-.263.634L7.623 5.244a.895.895 0 01-.633.262H3.995c-.565 0-.847.71-.455 1.102l2.29 2.29-3.569 3.574a.894.894 0 001.263 1.264l3.57-3.572 2.301 2.301c.402.402 1.101.098 1.101-.456V9.013a.9.9 0 01.262-.633l1.715-1.715a.895.895 0 01.633-.263h.523c.327 0 .488-.407.263-.633z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?16:+e.width,height:isNaN(e.height)?16:+e.height}))};_.mountIcon=p;const m=_},239446:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 20 20",u="delete_outline_20",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" id="delete_outline_20"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.697 6.502a.75.75 0 00-.695.801l.5 7a.75.75 0 001.496-.106l-.5-7a.75.75 0 00-.801-.695zm4.606 0a.75.75 0 01.695.801l-.5 7a.75.75 0 01-1.496-.106l.5-7a.75.75 0 01.801-.695z" fill="currentColor" /><path fill-rule="evenodd" clip-rule="evenodd" d="M2.25 3a.75.75 0 000 1.5h1.066l.958 10.44c.045.489.083.898.14 1.233.06.35.15.675.331.98.279.47.691.846 1.185 1.08.32.153.652.213 1.006.24.338.027.75.027 1.24.027h3.647c.491 0 .903 0 1.24-.026.355-.028.687-.088 1.007-.24a2.75 2.75 0 001.185-1.081c.18-.305.27-.63.33-.98.058-.335.096-.744.14-1.233l.96-10.44h1.065a.75.75 0 000-1.5h-4.587a3.251 3.251 0 00-6.326 0H2.25zm3.516 11.774c.048.525.08.876.127 1.145.044.26.093.385.142.469.127.213.314.384.539.49.087.043.216.08.48.1.272.021.624.022 1.151.022h3.59c.527 0 .879 0 1.152-.022.263-.02.392-.057.48-.1a1.25 1.25 0 00.538-.49c.05-.084.098-.209.142-.469.046-.27.08-.62.127-1.145L15.178 4.5H4.822l.944 10.274zM10 2c-.698 0-1.3.409-1.582 1h3.164A1.75 1.75 0 0010 2z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?20:+e.width,height:isNaN(e.height)?20:+e.height}))};_.mountIcon=p;const m=_},967458:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 20 20",u="message_outline_20",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" id="message_outline_20"><g fill="none" fill-rule="evenodd"><path opacity=".4" d="M0 0h20v20H0z" /><path d="M6.828 15.752a.75.75 0 01.821-.207A7.52 7.52 0 0010.25 16c3.772 0 6.75-2.694 6.75-6s-2.978-6-6.75-6S3.5 6.694 3.5 10c0 1.21.4 2.367 1.14 3.349a.75.75 0 01.15.49c-.04.756-.403 1.785-1.085 3.135 1.483-.116 2.514-.534 3.123-1.222zM3.242 18.5a1.204 1.204 0 01-1.101-1.767c.644-1.216 1.016-2.14 1.121-2.73A7.009 7.009 0 012 10c0-4.17 3.681-7.5 8.25-7.5S18.5 5.83 18.5 10s-3.681 7.5-8.25 7.5a9.077 9.077 0 01-2.66-.393c-.996.881-2.456 1.336-4.348 1.393z" fill="currentColor" fill-rule="nonzero" /></g></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?20:+e.width,height:isNaN(e.height)?20:+e.height}))};_.mountIcon=p;const m=_},25347:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 24 24",u="door_arrow_left_outline_24",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="door_arrow_left_outline_24"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.754 20.366c-.763.407-1.512.534-3.082.534H13a.9.9 0 110-1.8h2.672c1.487 0 1.87-.128 2.233-.322.336-.18.594-.437.773-.773.194-.362.322-.746.322-2.233V8.228c0-1.487-.128-1.87-.322-2.233a1.847 1.847 0 00-.773-.774c-.362-.193-.746-.321-2.233-.321H13a.9.9 0 110-1.8h2.672c1.57 0 2.32.127 3.082.534.65.348 1.164.863 1.512 1.512.407.762.534 1.512.534 3.082v7.544c0 1.57-.127 2.32-.534 3.082a3.646 3.646 0 01-1.512 1.512zm-9.39-5.002l2.463-2.464H3.9a.9.9 0 110-1.8h7.927L9.364 8.636a.9.9 0 111.272-1.272l4 4a.9.9 0 010 1.272l-4 4a.9.9 0 11-1.272-1.272z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};_.mountIcon=p;const m=_},410902:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 24 24",u="error_circle_outline_24",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="error_circle_outline_24"><path d="M12 0c6.627 0 12 5.373 12 12s-5.373 12-12 12S0 18.627 0 12 5.373 0 12 0zm0 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 14a1.333 1.333 0 110 2.667A1.333 1.333 0 0112 16zm.324-10.667a1 1 0 011 1.037l-.266 7.276a1.059 1.059 0 01-2.116 0l-.265-7.276a1 1 0 01.963-1.036h.684z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};_.mountIcon=p;const m=_},573669:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 24 24",u="live_24",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="live_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path d="M12 22.5C6.201 22.5 1.5 17.799 1.5 12S6.201 1.5 12 1.5 22.5 6.201 22.5 12 17.799 22.5 12 22.5zm0-2a8.5 8.5 0 100-17 8.5 8.5 0 000 17zm0-2a6.5 6.5 0 110-13 6.5 6.5 0 010 13zm0-2a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-2a2.5 2.5 0 110-5 2.5 2.5 0 010 5z" fill="currentColor" /></g></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};_.mountIcon=p;const m=_},735144:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 24 24",u="phone_outline_24",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="phone_outline_24"><g fill="none"><path d="M0 0h24v24H0z" /><path d="M4.477 4.116c-2.924 3.217-1.362 8.196 2.932 12.51 4.204 4.222 9.407 5.8 12.486 2.936 1.685-1.567 1.436-4.343-.645-6.198l-.19-.161c-1.931-1.563-4.734-1.568-6.445-.027l-.088.082-.05-.042c-.187-.16-.43-.381-.724-.673l-.298-.303-.306-.326c-.092-.101-.174-.194-.246-.277l-.124-.147-.07.075c1.69-1.697 1.706-4.72.006-6.75-1.887-2.255-4.75-2.335-6.238-.699zM9.335 5.97c1.18 1.41 1.049 3.371.099 4.325l-.148.14c-.63.567-1.246.901 1.032 3.218 2.458 2.499 2.765 1.622 3.405.952 1.006-1.01 2.975-1.104 4.329.103 1.497 1.334 1.335 2.868.617 3.536-2.222 2.067-6.476.636-9.984-2.888-3.507-3.523-5.064-7.622-2.876-10.03.508-.558 2.101-1.057 3.526.644z" fill="currentColor" /></g></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};_.mountIcon=p;const m=_},250516:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 24 24",u="videocam_outline_24",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="videocam_outline_24"><path d="M11.872 4.5c1.783 0 2.43.186 3.082.534.651.349 1.163.86 1.512 1.512.21.393.36.783.447 1.42l2.478-1.444A2.4 2.4 0 0123 8.595v6.81a2.4 2.4 0 01-3.61 2.073l-2.477-1.444c-.087.637-.238 1.027-.447 1.42a3.635 3.635 0 01-1.512 1.512c-.652.348-1.299.534-3.082.534H6.128c-1.783 0-2.43-.186-3.082-.534a3.635 3.635 0 01-1.512-1.512C1.186 16.802 1 16.155 1 14.372V9.628c0-1.783.186-2.43.534-3.082a3.635 3.635 0 011.512-1.512c.652-.348 1.299-.534 3.082-.534h5.744zm0 1.8H6.128c-1.354 0-1.788.084-2.233.322-.338.18-.593.435-.773.773-.238.445-.322.879-.322 2.233v4.744c0 1.354.084 1.788.322 2.233.18.338.435.593.773.773.445.238.879.322 2.233.322h5.744c1.354 0 1.788-.084 2.233-.322.338-.18.593-.435.774-.773.237-.445.321-.879.321-2.233V9.628c0-1.354-.084-1.788-.321-2.233a1.835 1.835 0 00-.774-.773c-.445-.238-.879-.322-2.233-.322zm8.426 1.776L17 10v4l3.298 1.924a.6.6 0 00.902-.519v-6.81a.6.6 0 00-.902-.519z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?24:+e.width,height:isNaN(e.height)?24:+e.height}))};_.mountIcon=p;const m=_},529071:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 28 28",u="arrow_up_rectangle_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="arrow_up_rectangle_outline_28"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.07 4.801C6.164 4.216 7.243 4 9.691 4h8.616c2.448 0 3.527.216 4.622.801A5.465 5.465 0 0125.2 7.07c.585 1.096.801 2.175.801 4.623v4.616c0 2.448-.216 3.527-.801 4.622A5.465 5.465 0 0122.93 23.2c-1.095.585-2.174.801-4.622.801H9.692c-2.448 0-3.527-.216-4.623-.801a5.465 5.465 0 01-2.268-2.269C2.216 19.835 2 18.756 2 16.308v-4.616c0-2.448.216-3.527.801-4.623A5.466 5.466 0 015.07 4.801zM9.691 6c-2.335 0-3.019.212-3.68.565a3.466 3.466 0 00-1.447 1.448C4.212 8.673 4 9.357 4 11.692v4.616c0 2.335.212 3.019.565 3.68a3.466 3.466 0 001.448 1.447c.66.353 1.344.565 3.679.565h8.616c2.335 0 3.019-.212 3.68-.565a3.467 3.467 0 001.447-1.448c.353-.66.565-1.344.565-3.679v-4.616c0-2.335-.212-3.019-.565-3.68a3.466 3.466 0 00-1.448-1.447C21.327 6.212 20.643 6 18.308 6H9.692z" fill="currentColor" /><path d="M13 18a1 1 0 102 0v-5.586l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 101.414 1.414L13 12.414V18z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};_.mountIcon=p;const m=_},382459:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 28 28",u="chain_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="chain_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path d="M12.59 16.83c-.39.39-1.03.39-1.42 0a5.003 5.003 0 010-7.07l5.24-5.24a5.003 5.003 0 017.07 0 5.003 5.003 0 010 7.07l-1.436 1.436a.999.999 0 01-1.414-1.41l1.43-1.436a2.982 2.982 0 000-4.24 2.982 2.982 0 00-4.24 0l-5.23 5.23a2.982 2.982 0 000 4.24c.41.39.41 1.03 0 1.42zm2.82-5.66c.39-.39 1.03-.39 1.42 0a5.003 5.003 0 010 7.07l-5.24 5.24a5.003 5.003 0 01-7.07 0 5.003 5.003 0 010-7.07l1.431-1.431a1 1 0 011.414 0h.001c.39.392.39 1.025 0 1.415L5.94 17.82a2.982 2.982 0 000 4.24 2.982 2.982 0 004.24 0l5.23-5.23a2.982 2.982 0 000-4.24.973.973 0 010-1.42z" fill="currentColor" fill-rule="nonzero" /></g></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};_.mountIcon=p;const m=_},383925:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 28 28",u="chevron_right_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="chevron_right_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path d="M11 7.5l6.5 6.5-6.5 6.5" stroke="#8BC1FF" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" /><path d="M16.086 14l-5.793 5.793a1 1 0 001.414 1.414l6.5-6.5a1 1 0 000-1.414l-6.5-6.5a1 1 0 00-1.414 1.414L16.086 14z" fill="currentColor" fill-rule="nonzero" /></g></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};_.mountIcon=p;const m=_},835849:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 28 28",u="download_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="download_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path d="M21 22a1 1 0 110 2H7a1 1 0 010-2h14zM14 2a1 1 0 011 1v13.585l5.293-5.292a1 1 0 011.414 1.414l-7 7a1 1 0 01-1.414 0l-7-7a1 1 0 011.414-1.414L13 16.585V3a1 1 0 011-1z" fill="currentColor" fill-rule="nonzero" /></g></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};_.mountIcon=p;const m=_},196287:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 28 28",u="laptop_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="laptop_outline_28"><path clip-rule="evenodd" d="M8 5h-.151c-.781 0-1.4-.001-1.93.171A3.5 3.5 0 003.67 7.418C3.5 7.95 3.5 8.568 3.5 9.348V19H2.162a1.162 1.162 0 00-.367 2.265l1.466.489c.276.092.415.138.556.17.125.029.253.05.38.062.145.014.29.014.582.014H23.22c.291 0 .437 0 .581-.014.128-.012.256-.033.381-.062.141-.032.28-.078.556-.17l1.466-.49A1.162 1.162 0 0025.838 19H24.5V9.349c0-.781.001-1.4-.171-1.93a3.5 3.5 0 00-2.247-2.248C21.55 5 20.932 5 20.152 5H20zM6.536 7.073C6.724 7.013 6.992 7 8 7h12c1.008 0 1.276.012 1.464.073a1.5 1.5 0 01.963.963c.06.188.073.456.073 1.464V19h-17V9.5c0-1.008.012-1.276.073-1.464a1.5 1.5 0 01.963-.963z" fill="currentColor" fill-rule="evenodd" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};_.mountIcon=p;const m=_},539052:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 28 28",u="phone_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="phone_outline_28"><g fill-rule="nonzero" fill="none"><path d="M0 0h28v28H0z" /><path d="M16.112 17.259l-.734.734a.712.712 0 01-.75.166c-.73-.269-1.643-.95-2.74-2.047-1.095-1.096-1.778-2.01-2.045-2.74a.712.712 0 01.164-.75l.736-.734c1.354-1.354 1.478-3.487.284-4.903l-.862-1.024c-.984-1.17-2.756-1.288-3.96-.264a3.319 3.319 0 00-.974 1.443 3.25 3.25 0 00-.159.752c-.44 3.272 1.137 6.707 4.733 10.303 3.596 3.596 7.03 5.174 10.303 4.733a3.318 3.318 0 002.195-1.134c1.024-1.202.905-2.976-.263-3.96l-1.025-.862c-1.417-1.192-3.55-1.067-4.903.287zm-2.81-2.561c.525.523.982.92 1.35 1.191 2.124-2.123 5.428-2.317 7.652-.447l1.023.862c2.03 1.708 2.233 4.751.49 6.798-.896 1.036-2.156 1.687-3.442 1.808-3.982.536-7.987-1.303-11.984-5.3-3.997-3.998-5.837-8.004-5.31-11.896.036-.414.122-.822.257-1.22A5.33 5.33 0 014.91 4.174c2.037-1.732 5.079-1.53 6.785.5l.86 1.023c1.873 2.22 1.681 5.527-.4 7.608.227.413.624.87 1.148 1.394z" fill="currentColor" /></g></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};_.mountIcon=p;const m=_},590439:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 28 28",u="user_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="user_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path d="M17.5 8.5C17.5 6.566 15.934 5 14 5a3.499 3.499 0 00-3.5 3.5c0 1.934 1.566 3.5 3.5 3.5s3.5-1.566 3.5-3.5zm2 0c0 3.039-2.461 5.5-5.5 5.5a5.499 5.499 0 01-5.5-5.5C8.5 5.461 10.961 3 14 3s5.5 2.461 5.5 5.5zM7 20.643c0 .943-.08.857.456.857h13.588c.536 0 .456.086.456-.857 0-2.288-3.304-3.643-7.25-3.643S7 18.355 7 20.643zm-2 0C5 16.763 9.299 15 14.25 15s9.25 1.763 9.25 5.643c0 2.016-.781 2.857-2.456 2.857H7.456C5.78 23.5 5 22.66 5 20.643z" fill="currentColor" fill-rule="nonzero" /></g></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?28:+e.width,height:isNaN(e.height)?28:+e.height}))};_.mountIcon=p;const m=_},443774:(e,t,n)=>{"use strict";n.d(t,{default:()=>m});var a=n(667294),r=n(887854),i=n.n(r),o=n(408091),l=n(634777),s=n(379333),c="0 0 29 28",u="videocam_outline_28",d=!1;function p(){d||((0,l.addSpriteSymbol)(new(i())({id:u,viewBox:c,content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29 28" id="videocam_outline_28"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.857 5h4.286c1.084 0 1.958 0 2.666.058.729.06 1.369.185 1.961.487a5 5 0 012.185 2.185c.231.454.36.936.433 1.464l.437-.284.903-.585c.239-.155.52-.338.773-.471.255-.134.794-.395 1.482-.348a2.7 2.7 0 011.975 1.07c.415.552.49 1.148.516 1.434.026.285.026.62.026.904v6.172c0 .284 0 .619-.026.904-.026.286-.1.882-.516 1.434a2.7 2.7 0 01-1.975 1.07c-.688.047-1.227-.214-1.482-.348a10.407 10.407 0 01-.773-.47l-.905-.588-.435-.282c-.074.528-.202 1.01-.433 1.464a5 5 0 01-2.185 2.185c-.592.302-1.232.428-1.961.487C16.1 23 15.227 23 14.143 23H9.857c-1.084 0-1.958 0-2.666-.058-.728-.06-1.369-.185-1.96-.487a5 5 0 01-2.186-2.185c-.302-.592-.428-1.232-.487-1.961C2.5 17.6 2.5 16.727 2.5 15.643v-3.286c0-1.084 0-1.958.058-2.666.06-.728.185-1.369.487-1.961A5 5 0 015.23 5.545c.592-.302 1.233-.428 1.961-.487C7.9 5 8.773 5 9.857 5zM21.5 15.643v-4.138l2.27-1.472c.563-.365.844-.548 1.077-.532a.7.7 0 01.513.277c.14.187.14.522.14 1.192v6.06c0 .67 0 1.005-.14 1.192a.7.7 0 01-.513.277c-.233.016-.514-.167-1.077-.532l-2.27-1.472v-.852zM7.354 7.05c-.605.05-.953.142-1.216.276a3 3 0 00-1.311 1.311c-.134.263-.226.611-.276 1.216-.05.617-.051 1.41-.051 2.546v3.2c0 1.137 0 1.929.051 2.546.05.605.142.953.276 1.216a3 3 0 001.311 1.311c.263.134.611.226 1.216.276.617.05 1.41.051 2.546.051h4.2c1.137 0 1.929 0 2.546-.051.605-.05.953-.142 1.216-.276a3 3 0 001.311-1.311c.134-.263.226-.611.276-1.216.05-.617.051-1.41.051-2.546v-3.2c0-1.137 0-1.929-.051-2.546-.05-.605-.142-.953-.276-1.216a3 3 0 00-1.311-1.311c-.263-.134-.611-.226-1.216-.276-.617-.049-1.41-.05-2.546-.05H9.9c-1.137 0-1.929 0-2.546.051z" fill="currentColor" /></symbol>'})),d=!0)}var _=function(e){return(0,l.useIsomorphicLayoutEffect)((function(){p()}),[]),a.createElement(s.SvgIcon,(0,o.assign)({},e,{viewBox:c,id:u,width:isNaN(e.width)?29:+e.width,height:isNaN(e.height)?28:+e.height}))};_.mountIcon=p;const m=_},279353:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSpriteSymbol=function(e){o&&o.add(e)},t.useIsomorphicLayoutEffect=void 0;var a,r=(a=n(362548))&&a.__esModule?a:{default:a},i=n(667294);var o,l=!("undefined"==typeof window||!window.document||!window.document.createElement);if(l){var s="__SVG_SPRITE_NODE__";o=new r.default({attrs:{id:s}});var c=function(){var e=document.getElementById(s);e?o.attach(e):o.mount()};document.querySelector("body")?c():document.addEventListener("DOMContentLoaded",c)}else o=null;var u=l?i.useLayoutEffect:i.useEffect;t.useIsomorphicLayoutEffect=u},911099:(e,t,n)=>{"use strict";var a=n(595318);t.classNames=function(){for(var e=[],t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return n.forEach((function(t){if(t)switch((0,r.default)(t)){case"string":e.push(t);break;case"object":Object.keys(t).forEach((function(n){t[n]&&e.push(n)}));break;default:e.push("".concat(t))}})),e.join(" ")};var r=a(n(750008))},441143:e=>{"use strict";e.exports=function(e,t,n,a,r,i,o,l){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,a,r,i,o,l],u=0;(s=new Error(t.replace(/%s/g,(function(){return c[u++]})))).name="Invariant Violation"}throw s.framesToPop=1,s}}},869921:(e,t)=>{"use strict";var n="function"==typeof Symbol&&Symbol.for,a=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,l=n?Symbol.for("react.profiler"):60114,s=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,_=n?Symbol.for("react.suspense"):60113,m=n?Symbol.for("react.suspense_list"):60120,f=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,A=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,h=n?Symbol.for("react.responder"):60118,E=n?Symbol.for("react.scope"):60119;function C(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case a:switch(e=e.type){case u:case d:case i:case l:case o:case _:return e;default:switch(e=e&&e.$$typeof){case c:case p:case g:case f:case s:return e;default:return t}}case r:return t}}}function S(e){return C(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=s,t.Element=a,t.ForwardRef=p,t.Fragment=i,t.Lazy=g,t.Memo=f,t.Portal=r,t.Profiler=l,t.StrictMode=o,t.Suspense=_,t.isAsyncMode=function(e){return S(e)||C(e)===u},t.isConcurrentMode=S,t.isContextConsumer=function(e){return C(e)===c},t.isContextProvider=function(e){return C(e)===s},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===a},t.isForwardRef=function(e){return C(e)===p},t.isFragment=function(e){return C(e)===i},t.isLazy=function(e){return C(e)===g},t.isMemo=function(e){return C(e)===f},t.isPortal=function(e){return C(e)===r},t.isProfiler=function(e){return C(e)===l},t.isStrictMode=function(e){return C(e)===o},t.isSuspense=function(e){return C(e)===_},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===d||e===l||e===o||e===_||e===m||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===f||e.$$typeof===s||e.$$typeof===c||e.$$typeof===p||e.$$typeof===v||e.$$typeof===h||e.$$typeof===E||e.$$typeof===A)},t.typeOf=C},659864:(e,t,n)=>{"use strict";e.exports=n(869921)},366206:(e,t,n)=>{"use strict";var a=n(294757),r=n(933294),i=n(124961),o=n(76238),l=n(41437),s=n(116886),c=n(663527),u=n(621260);if(!window.Calls){var d=new o.ActionStatCollector(new o.ProductionStatCollector),p={getLang:l.getLang,langSex:function(e,t,n){return(0,s.langSex)(e,n)},langNumeric:function(e,t,n,a){return(0,s.langNumeric)(e,n,a)},langShortDateTime:function(e){return(0,s.langDate)(e,(0,l.getLang)("global_short_date_time",!0),0,(0,l.getLang)("months_of"),!0)},langShortDate:function(e,t){return void 0===t&&(t=!0),(0,s.langDate)(e,(0,l.getLang)("global_short_date",!0),0,(0,l.getLang)("months_sm_of"),t)}},_={onScreenSharingEnabled:null,onScreenSharingDisabled:null,onErrorStartCall:null,onHandCountChanged:null,onSuccessFeedback:function(){(0,u.showDoneBox)((0,l.getLang)("calls_feedback_success"))},onError:null};window.Calls=(0,a.init)({apiWrapper:r.apiWrapper,apiWrapperWithAuth:r.apiWrapperWithAuth,actionStatCollector:d,saveStatlogEvents:i.saveStatlogEvents,langUtils:p,navigateToConvo:function(e){window.nav.go((0,c.getConvoLocation)(e),null,{params:{entrypoint:"calls"}})},callSounds:{end:"/mp3/call_end.mp3",incoming:"/mp3/call_incoming.mp3",outgoing:"/mp3/call_outgoing.mp3",connected:"/mp3/call_connected.mp3",connecting:"/mp3/call_connecting.mp3"},navigateToProfile:function(e,t){!e.target.href&&window.Calls&&(window.Calls.collapseCall(),t&&window.nav.go(t))},eventHandlers:_})}try{window.stManager.done(window.jsc("web/calls.js"))}catch(e){}},820717:(e,t,n)=>{"use strict";n.d(t,{loadFriendsAction:()=>d,loadChatMembersAction:()=>p,loadAllowedToCallGroupMembersAction:()=>_,loadCallPeersWithWaitingImagesAction:()=>m,loadCallPeersWithoutWaitingImagesAction:()=>f,loadActiveCallDataAction:()=>g,loadCallParticipantsAccumulate:()=>v,loadCallParticipants:()=>h,loadCallUrlLink:()=>E,setActiveCallData:()=>C,startUpcomingStream:()=>S,startCallStream:()=>y,setAnonymousJoin:()=>T,setWaitingHall:()=>I,serverSearchGroupMembers:()=>b,loadAndCopyJoinLink:()=>N});var a=n(570655),r=n(121255),i=n(298811),o=n(329538),l=n(613335),s=n(834735),c=n(464380),u=n(659397);function d(e,t,n){if(e.authorizedGroupId)return Promise.resolve();if((0,i.unpackState)(t).friends.length>0)return Promise.resolve();if(e.getFriends){var a=e.getFriends();if(null!==a)return n({type:r.SET_FRIENDS,data:a}),Promise.resolve()}return(0,o.loadFriends)().then((function(e){return e.items.map(l.normalizeUser)})).then((function(e){n({type:r.SET_FRIENDS,data:e})}))}function p(e,t,n,a){return(0,o.loadChatMembers)(n).then((function(n){var o=n.profiles;o&&t({type:r.SET_CHAT_INFO,data:o.map(l.normalizeUser).sort((function(t,n){var a=(0,i.unpackState)(e).me;return t.peerId===a?-1:n.peerId===a?1:0})),conversation:a})}))}function _(e,t,n){return e.authorizedGroupId?t.groupMembers.length>0?Promise.resolve():(0,o.getGroupMembers)(-e.authorizedGroupId,0,r.COUNT_OF_GROUP_MEMBERS_TO_LOAD).then((function(e){var t=e.items,n=e.count,a=[],r=[];return t.forEach((function(e){e.deactivated||(a.push((0,l.normalizeUser)(e)),e.can_call_from_group||r.push(e.id))})),[a,r,n]})).then((function(e){var t=(0,a.__read)(e,3),i=t[0],o=t[1],l=t[2];return n({type:r.SET_GROUP_MEMBERS,groupMembersCount:l,groupMembers:i,unableToCallGroupMembersIds:o}),Promise.resolve()})):Promise.resolve()}function m(e,t,n){return(0,o.retryLoadCallPeers)(n).then((function(e){var n=(0,a.__read)((0,i.convertServerData)(e),3),r=n[0],o=n[1],l=n[2];return C(t,l),(0,s.preloadImagesFromResponse)([r,o])})).then((function(e){var i=(0,a.__read)(e,2),o=i[0],l=i[1];t({type:r.LOAD_PEERS,conversation:o,members:l,peerId:n})}))}function f(e,t,n,l){return(0,o.retryLoadCallPeers)(l).then((function(e){var o=(0,a.__read)((0,i.convertServerData)(e),3),l=o[0],u=o[1],d=o[2];C(t,d),(0,s.preloadImagesFromResponse)([l,u]).catch((function(e){n.eventHandlers.onError&&e&&n.eventHandlers.onError(e),(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)})),t({type:r.LOAD_PEERS,conversation:l,members:u})}))}function g(e,t,n){return n?(0,o.loadCallPeers)(n).then((function(e){var n=e.items,r=(0,a.__read)(n,1)[0];C(t,r)})):Promise.resolve()}var A={acc:[],timer:0,tasks:0,timeout:100};function v(e,t,n,r,i,o){var l;(l=A.acc).push.apply(l,(0,a.__spreadArray)([],(0,a.__read)(i))),A.timer&&clearTimeout(A.timer),A.timer=window.setTimeout((function(){var a=A.acc;A.acc=[],h(e,t,n,r,a,o).catch((function(e){n.eventHandlers.onError&&e&&n.eventHandlers.onError(e),(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}),A.timeout)}function h(e,t,n,u,d,p){var _=(0,i.unpackState)(e).me,m=(0,i.unpackState)(e).anonymSecret,f=_<0?_:void 0;return(0,o.getCallParticipants)(u,d,f,_<0,m).then((function(e){var i=e.profiles,o=void 0===i?[]:i,c=e.anonyms,_=void 0===c?[]:c,m=e.secret,f=e.groups,g=void 0===f?[]:f;m&&t({type:r.UPDATE_ANON_SECRET,secret:m});var A=(0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(o)),(0,a.__read)(_)),(0,a.__read)(g)),v=d.filter((function(e){return!A.find((function(t){return t&&t.id===e}))}));v.length>0&&n.eventHandlers.onError&&n.eventHandlers.onError(new Error("callId: "+u+", timestamp: "+Date.now()+", cant find in participants: "+v.join(", ")));var h=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(_)),(0,a.__read)(o)).map(l.normalizeUser);(null==g?void 0:g.length)>0&&(h=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(h)),(0,a.__read)(g.map(l.normalizeGroup))));var E=(0,s.preloadImagesFromResponse)([{},h]);return p.awaitImages?E.then((function(){return[null,h]})):[null,h]})).then((function(e){var n=(0,a.__read)(e,2)[1];n.length>0&&t({type:r.LOAD_PEERS,members:n})})).catch((function(e){n.eventHandlers.onError&&e&&n.eventHandlers.onError(e),(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}function E(e,t,n,a){return void 0===a&&(a=0),(0,o.getCallUrlLink)(t,n,a).then((function(t){var n=t.join_link;return e({type:r.CALL_STATE,callData:{callUrlLink:n}}),n}))}function C(e,t){if(t&&t.call_in_progress){var n=t.unread_count,a=t.last_message_id,i=t.call_in_progress.has_link,o=t.call_in_progress.can_finish_call;e({type:r.CALL_STATE,callData:{canFinishCall:o,hasUrlLink:i}}),(n||a)&&e({type:r.SET_UNREAD_COUNT,chatUnreadCount:n,chatUpToMsgId:a})}}function S(e){return(0,c.startStream)(!1,null,e).catch((function(e){(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}function y(e){return(0,o.videoStartStreaming)(e).then((function(e){return(0,c.startStream)(!1,null,e.stream.ov_id)})).catch((function(e){(0,c.debugMessage)(c.DebugMessageType.ERROR,e),console.error(e)}))}function T(e){var t;return(0,c.changeConversationOptions)(((t={})[c.ConversationOption.REQUIRE_AUTH_TO_JOIN]=e,t))}function I(e){var t;return(0,c.changeConversationOptions)(((t={})[c.ConversationOption.WAITING_HALL]=e,t))}function b(e,t,n,i){return void 0===t&&(t=""),(0,o.searchGroupMembers)(e,t).then((function(e){var t=e.items,o=[],s=[];return t&&t.forEach((function(e){e.deactivated||e.id in n.groupMembersCache||(o.push((0,l.normalizeUser)(e)),e.can_call_from_group||s.push(e.id))})),o.length>0&&i({type:r.SET_GROUP_MEMBERS,groupMembersCount:n.groupMembersCount,groupMembers:(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(n.groupMembers)),(0,a.__read)(o)),unableToCallGroupMembersIds:(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(n.unableToCallGroupMembersIds)),(0,a.__read)(s))}),o}))}function N(e,t,n){void 0===n&&(n=0),E(e,t,!1,n).then((function(t){(0,u.copyTextToClipboard)(t).then((function(t){t&&e({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.LINK_COPIED_TO_CLIPBOARD}})}))})).catch(console.log)}},444083:(e,t,n)=>{"use strict";n.d(t,{onForceCallFinish:()=>o});var a=n(121255),r=n(329538),i=n(421734);function o(e,t,n,o){var l=t.callData.callId||"";n({type:a.SHOW_LOADER,isLoaderVisible:!0}),n({type:a.SET_LAST_CALL_DATA,data:{isMeEndedCallForAll:!0}}),(0,r.forceCallFinish)(l).catch((function(e){console.error(e),n({type:a.ERROR,text:o("calls_error_force_call_finish"),handleType:a.ErrorHandleType.FATAL}),n({type:a.CLEAN_LAST_CALL_DATA})})).finally((function(){n({type:a.SHOW_LOADER,isLoaderVisible:!1})})),(0,i.sendVirtualBackgroundDisabled)(t)}},256480:(e,t,n)=>{"use strict";n.d(t,{dispatchSetHistoryCalls:()=>s,dispatchDeleteCall:()=>c,dispatchSetCurrentCalls:()=>u,dispatchSetError:()=>d,dispatchSetShowCreateButton:()=>p,dispatchSetLoading:()=>_,updateProfilesAndUrls:()=>m,loadCurrentCalls:()=>f,loadHistoryCalls:()=>g,changeQuery:()=>A});var a=n(570655),r=n(329538),i=n(613335),o=n(171659),l=n(362621),s=function(e){return{type:l.HistoryScreenActionTypes.SET_HISTORY_CALLS,data:e}},c=function(e){return{type:l.HistoryScreenActionTypes.DELETE_CALL,data:e}},u=function(e){return{type:l.HistoryScreenActionTypes.SET_CURRENT_CALLS,data:e}},d=function(e){return{type:l.HistoryScreenActionTypes.ERROR,data:e}},p=function(e){return{type:l.HistoryScreenActionTypes.SET_SHOW_CREATE_BUTTON,data:e}},_=function(e){return{type:l.HistoryScreenActionTypes.SET_LOADING,data:e}};function m(e,t){var n,r,s,c,u,d,p=[],_=[];try{for(var m=(0,a.__values)(t),f=m.next();!f.done;f=m.next()){var g=f.value;(null==g?void 0:g.profiles)&&(null===(s=g.profiles)||void 0===s?void 0:s.length)>0&&(p=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(p)),(0,a.__read)(g.profiles))),"anonyms"in g&&(null==g?void 0:g.anonyms)&&(null===(c=g.anonyms)||void 0===c?void 0:c.length)>0&&(p=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(p)),(0,a.__read)(g.anonyms))),(null==g?void 0:g.groups)&&(null===(u=g.groups)||void 0===u?void 0:u.length)>0&&(p=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(p)),(0,a.__read)(g.groups))),(null==g?void 0:g.items)&&(null===(d=g.items)||void 0===d?void 0:d.length)>0&&(_=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(_)),(0,a.__read)(g.items)))}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=m.return)&&r.call(m)}finally{if(n)throw n.error}}return p.length&&function(e,t){var n=t.reduce((function(e,t){var n=String(t.id);if(!(n in e)){var a=(0,i.normalizeUser)(t);a.nameGen=t.first_name_gen+" "+t.last_name_gen,"group"===t.type?e["-"+n]=a:e[n]=a}return e}),{});e((a=n,{type:l.HistoryScreenActionTypes.SET_PROFILES,data:a}));var a}(e,p),_.length&&function(e,t){var n=t.reduce((function(e,t){var n=0;n="type"in t?(0,o.getHistoryCallPeerId)(t):(0,o.getCurrentCallPeerId)(t);var a=String(n);return a in e||(null==t?void 0:t.join_link)&&(e[a]=null==t?void 0:t.join_link),e}),{});e({type:l.HistoryScreenActionTypes.SET_URLS,data:n})}(e,_),Promise.resolve(_.length>0)}function f(e){return(0,r.getCurrentCalls)().then((function(t){var n,a=null!==(n=null==t?void 0:t.items)&&void 0!==n?n:[];return a.length>0&&e(u(a)),t}))}function g(e,t,n,i,o,l,c){return void 0===t&&(t=5),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o="all"),void 0===l&&(l=[]),void 0===c&&(c=!1),(0,r.getCallsHistory)(t,n,i,o).then((function(t){var n,r=null!==(n=null==t?void 0:t.items)&&void 0!==n?n:[],i=r.length>0||c,o=[];return r.length>0&&(o=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(l)),(0,a.__read)(r))),i&&e(s(o)),t}))}function A(e){window.nav.setLoc(window.nav.fromStr(e))}},719481:(e,t,n)=>{"use strict";n.d(t,{promoteUserAndRemoveFromWaitingHall:()=>c,removeUserFromWaitingHall:()=>u,clearWaitingList:()=>d,loadWaitingHall:()=>p,loadAdditionalWaitingHall:()=>_,resetWaitingHallNew:()=>m});var a=n(570655),r=n(121255),i=n(613335),o=n(464380),l=n(329538),s=n(834735);function c(e,t,n){var a=(0,i.getExternalIdByUserId)(e);return(0,o.promoteParticipant)(a).then((function(){u(e,t,n)}))}function u(e,t,n){t&&(t.totalCount-=1,t.members.delete(e),n({type:r.SET_WAITING_HALL,data:t}))}function d(e){e({type:r.SET_WAITING_HALL,data:null})}function p(e,t,n,c){return new Promise((function(n){0!==t.length?e>t.length?(0,o.getWaitingHall)(null,e).then((function(e){n(e.participants)})):n(t):n([])})).then((function(t){var r={totalCount:e,members:new Map,hasNew:!1},o=[];if(n.waitingHall){var c=n.waitingHall,u=c.members,d=c.hasNew;r.hasNew=d,t.forEach((function(e){var t=+e.id;if(u.has(t)){var n=u.get(t);n&&r.members.set(t,n)}else o.push(t)}))}else o=t.map((function(e){return+e.id}));if(o.length>0){r.hasNew=!0;var p=n.me,_=n.callData,m=n.anonymSecret,f=_.callId||"",g=p<0,A=g?p:0;return(0,l.getCallParticipantsApiCall)(f,o,g,m,A).then((function(e){var t=e.profiles,n=void 0===t?[]:t,o=e.anonyms,l=void 0===o?[]:o,c=e.groups,u=void 0===c?[]:c,d=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(l)),(0,a.__read)(n)).map(i.normalizeUser);return(null==u?void 0:u.length)>0&&(d=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(d)),(0,a.__read)(u.map(i.normalizeGroup)))),(0,s.preloadImagesFromResponse)([{},d]),d.forEach((function(e){e&&e.peerId&&r.members.set(e.peerId,e)})),r})).catch((function(){return r}))}return r})).then((function(e){e.members&&c({type:r.SET_WAITING_HALL,data:e})}))}function _(e,t,n){var a;if(void 0===n&&(n=!1),n)a=void 0;else{if(!e.waitingHall)return Promise.resolve();if(!((a=e.waitingHall.totalCount)>e.waitingHall.members.size))return Promise.resolve()}return new Promise((function(n){(0,o.getWaitingHall)(null,a).then((function(a){p(a.totalCount,a.participants,e,t).then((function(){n()}))}))}))}function m(e,t){e&&(e.hasNew=!1,t({type:r.SET_WAITING_HALL,data:e}))}},734273:(e,t,n)=>{"use strict";n.d(t,{AdminPinUnmuteRequestModal:()=>i});var a=n(667294),r=n(7692),i=function(e){var t=e.onClose,n=e.actionButtons,i=e.title,o=e.description;return a.createElement(r.default,{className:"AdminPinUnmuteRequestModal",appearance:"blue",title:i,actionButtons:n,onClose:t},a.createElement("div",{className:"AdminPinUnmuteRequestModal__content"},o))}},908651:(e,t,n)=>{"use strict";n.d(t,{AssignAdminModal:()=>i});var a=n(667294),r=n(7692),i=function(e){var t=e.title,n=e.description,i=e.onClose,o=e.actionButtons;return a.createElement(r.default,{className:"AssignAdminModal",appearance:"blue",title:t,actionButtons:o,onClose:i},a.createElement("div",{className:"AssignAdminModal__content"},n))}},853055:(e,t,n)=>{"use strict";n.d(t,{BlurredBackground:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.id,n=e.className,i=e.children,o=(0,a.useMemo)((function(){return"radial-gradient(circle, rgb("+(48+Math.abs(t)%3*4)+","+(48+Math.abs(t)%4*5)+","+(52+Math.abs(t)%5*6)+") 40%, #0a0a0a 100%)"}),[]),l=(0,r.classNames)("BlurredBackground",n);return a.createElement("div",{className:l,style:{background:o}},i)}},492512:(e,t,n)=>{"use strict";n.d(t,{Call:()=>N});var a=n(570655),r=n(667294),i=n(309605),o=n(995141),l=n(423197),s=n(826988),c=n(815155),u=n(884609),d=n(747212),p=n(818114),_=n(659397),m=n(156482),f=n(748972),g=n(167903),A=n(172397),v=n(701683),h=n(722959),E=n(641221),C=n(112877),S=n(662208),y=n(498110),T=n(968125),I=n(573669),b=n(343379);function N(e){var t,n,N=e.info,w=e.chatUnreadCount,L=void 0===w?0:w,P=e.callMenuActions,k=e.isAudioAllowed,M=void 0!==k&&k,O=e.isVideoAllowed,D=void 0!==O&&O,R=e.isVideoEnabled,B=void 0!==R&&R,x=e.isAudioEnabled,U=void 0!==x&&x,H=e.isScreenSharingEnabled,G=void 0!==H&&H,V=e.isOratorMode,F=void 0===V||V,W=e.isFullScreen,z=void 0!==W&&W,j=e.onToggleVideo,K=e.onToggleAudio,Y=e.onLeaveCall,Q=e.onCollapseCall,Z=e.onToggleOratorMode,J=e.onChat,q=e.onHandClick,X=e.onToggleScreenShare,$=e.onFullScreenToggle,ee=e.onDeferredStreamStart,te=e.isParticipantControlActive,ne=void 0!==te&&te,ae=e.isLayoutSwitchShown,re=void 0!==ae&&ae,ie=e.isScreenShareControlShown,oe=void 0!==ie&&ie,le=e.isHandRaised,se=void 0!==le&&le,ce=e.isHandControlShown,ue=void 0!==ce&&ce,de=e.isChatControlShown,pe=void 0!==de&&de,_e=e.isStreamingControlShown,me=void 0!==_e&&_e,fe=e.isChainControlShown,ge=void 0===fe||fe,Ae=e.onParticipantsClick,ve=e.onTooltipChange,he=e.onHidePanel,Ee=e.notification,Ce=e.tooltips,Se=e.amISpeaking,ye=void 0!==Se&&Se,Te=e.onChainClick,Ie=e.notificationWithButton,be=e.withoutPadding,Ne=void 0!==be&&be,we=e.participantCount,Le=void 0===we?0:we,Pe=e.children,ke=e.isPopupOrModalOpen,Me=r.useContext(y.ConfigContext),Oe=Me.withAnimation,De=Me.isModalView,Re=r.useContext(S.LangContext).getLang,Be=(0,_.classNames)("Call",{"Call--fullscreen":z||!De}),xe=(0,_.classNames)("Call__content",{"Call__content--withoutPadding":Ne}),Ue=300,He=null===(n=null===(t=window.location)||void 0===t?void 0:t.host)||void 0===n?void 0:n.includes("vk.com"),Ge=r.useRef(null),Ve=r.useRef(null),Fe=r.useRef(null),We=r.useRef(null),ze=(0,a.__read)(r.useState(!1),2),je=ze[0],Ke=ze[1],Ye=(0,a.__read)(function(e,t,n,i,o,l){var s=(0,a.__read)(r.useState(!0),2),c=s[0],u=s[1],d=r.useRef(null),p=r.useRef(!1),m=r.useRef(!1),f=r.useRef(!1);f.current!==l&&(f.current=l);var g=r.useRef(!1),A=function(){p.current||g.current?g.current=!1:(d.current&&window.clearTimeout(d.current),u(!0),m.current||f.current||(d.current=window.setTimeout((function(){u(!1),d.current=null,o&&o()}),5e3)))};return r.useEffect((function(){A();var a=(0,_.throttle)((function(){A()}),1e3),r=function(){m.current=!0},o=function(){m.current=!1};return t.current.addEventListener("mouseenter",r),t.current.addEventListener("mouseleave",o),n.current.addEventListener("mouseenter",r),n.current.addEventListener("mouseleave",o),i.current.addEventListener("mouseenter",r),i.current.addEventListener("mouseleave",o),e.current.addEventListener("mousemove",a),function(){p.current=!0,d.current&&window.clearTimeout(d.current),t.current&&(t.current.removeEventListener("mouseenter",r),t.current.removeEventListener("mouseleave",o)),n.current&&(n.current.removeEventListener("mouseenter",r),n.current.removeEventListener("mouseleave",o)),i.current&&(i.current.removeEventListener("mouseenter",r),i.current.removeEventListener("mouseleave",o)),e.current&&e.current.removeEventListener("mousemove",a)}}),[m,f.current]),[c,function(e){e?u(!0):(u(!1),g.current=!0)}]}(Ge,Ve,Fe,We,he,je),2),Qe=Ye[0],Ze=Ye[1],Je=(0,_.classNames)({"Call__controlPanel--withAnimation":Oe,"Call__controlPanel--hideBottomWithAnimation":Oe,"Call__controlPanel--hideBottom":!Qe}),qe=(0,_.classNames)({"Call__controlPanel--withAnimation":Oe,"Call__controlPanel--hideBottomWithAnimation":Oe,"Call__controlPanel--hideBottom":!Qe},"Call__curtain"),Xe=(0,_.classNames)("Call__buttons",{"Call__controlPanel--withAnimation":Oe,"Call__controlPanel--hideBottomWithAnimation":Oe,"Call__controlPanel--hideBottom":!Qe}),$e=r.useCallback((function(){return Ze(!0)}),[]),et=r.useCallback((function(){ke||(Ze(!1),Ce.streaming&&ve("streaming",!1))}),[ke,Ce.streaming]);return r.createElement("section",{className:Be,onMouseEnter:$e,onMouseLeave:et,ref:Ge},N,Ee,r.createElement("div",{className:xe,"data-calls-id":"content"},Pe),r.createElement("div",{className:qe}),r.createElement(l.CallIconButtonGroup,{alignX:"l",alignY:"b",className:Je,ref:Fe},r.createElement(r.Fragment,null,pe&&r.createElement(E.TooltipNew,{content:Re("calls_chat"),open:Ce.chat,delay:Ue,onOpen:function(){return ve("chat",!0)},onClose:function(){return ve("chat",!1)}},r.createElement(u.ChatIconButton,{unreadCount:L,onClick:J})),ue&&r.createElement(E.TooltipNew,{content:Re(se?"calls_tooltip_lower_hand":"calls_tooltip_raise_hand"),open:Ce.hand,delay:Ue,onOpen:function(){return ve("hand",!0)},onClose:function(){return ve("hand",!1)}},r.createElement(o.CallIconButton,{icon:r.createElement(f.RaiseHandIcon,null),type:"hand",isActive:se,onClick:q})),oe&&r.createElement(E.TooltipNew,{content:Re(G?"calls_stop_screen_share":"calls_start_screen_share"),open:Ce.screenShare,delay:Ue,onOpen:function(){return ve("screenShare",!0)},onClose:function(){return ve("screenShare",!1)}},r.createElement(o.CallIconButton,{icon:r.createElement(m.ShareScreenIcon,null),isActive:G,onClick:X})),me&&r.createElement(E.TooltipNew,{content:Re("calls_call_menu_translation"),open:Ce.streaming,delay:Ue,onOpen:function(){return ve("streaming",!0)},onClose:function(){return ve("streaming",!1)}},r.createElement(o.CallIconButton,{icon:r.createElement(I.default,null),isActive:me,onClick:ee})))),r.createElement(l.CallIconButtonGroup,{alignX:"r",alignY:"b",style:z&&He?{right:"78px"}:void 0,className:Je,ref:We},r.createElement(r.Fragment,null,re&&r.createElement(E.TooltipNew,{content:Re(F?"calls_show_grid":"calls_show_orator"),open:Ce.layout,delay:Ue,onOpen:function(){return ve("layout",!0)},onClose:function(){return ve("layout",!1)}},r.createElement(o.CallIconButton,{type:F?"changeToGrid":"changeToOrator",onClick:Z})),P&&r.createElement(h.CallsDropdown,{items:P,open:je,setOpen:Ke},r.createElement(o.CallIconButton,{type:"settings"})),Q&&r.createElement(E.TooltipNew,{content:Re("calls_collapse"),open:Ce.collapse,delay:Ue,onOpen:function(){return ve("collapse",!0)},onClose:function(){return ve("collapse",!1)}},r.createElement(o.CallIconButton,{type:"collapse",onClick:Q})),$&&r.createElement(E.TooltipNew,{content:Re(z?"calls_tooltip_fullscreen_off":"calls_tooltip_fullscreen_on"),open:Ce.fullscreen,delay:Ue,onOpen:function(){return ve("fullscreen",!0)},onClose:function(){return ve("fullscreen",!1)}},r.createElement(o.CallIconButton,{onClick:$,icon:z?r.createElement(g.FullScreenOffIcon,null):r.createElement(A.FullScreenIcon,null)})))),r.createElement("footer",{className:"Call__footer",ref:Ve},r.createElement("div",{className:Xe},ge&&Te&&r.createElement(i.CallButton,{type:i.CallButtonTypes.ON,icon:r.createElement(T.ChainIcon,null),onClick:Te,className:"Call__footerButton"}),Ae&&r.createElement(b.ParticipantIconButton,{isParticipantControlActive:ne,onClick:Ae,participantCount:Le}),r.createElement(i.CallButton,{type:D?B?i.CallButtonTypes.ON:i.CallButtonTypes.OFF:i.CallButtonTypes.DISABLED,icon:B?r.createElement(s.VideoIcon,null):r.createElement(v.DisabledVideoIcon,null),onClick:j,className:"Call__footerButton"}),K&&r.createElement(i.CallButton,{type:M?U?i.CallButtonTypes.ON:i.CallButtonTypes.OFF:i.CallButtonTypes.DISABLED,icon:U?ye?r.createElement(C.MicIconWithSpeakingIndicator,null):r.createElement(p.MicIcon,null):r.createElement(d.MutedMicIcon,null),onClick:K,className:"Call__footerButton"}),r.createElement(i.CallButton,{type:i.CallButtonTypes.NEGATIVE,icon:r.createElement(c.EndCallIcon,null),onClick:Y,className:"Call__footerButton"}))),Ie&&Ie)}},309605:(e,t,n)=>{"use strict";n.d(t,{CallButtonTypes:()=>a,CallButton:()=>l});var a,r=n(570655),i=n(667294),o=n(659397);!function(e){e.POSITIVE="positive",e.NEGATIVE="negative",e.REGULAR="regular",e.ON="on",e.OFF="off",e.CLEAR="clear",e.DISABLED="disabled"}(a||(a={}));var l=function(e){var t=e.icon,n=e.text,l=e.type,s=e.className,c=(0,r.__rest)(e,["icon","text","type","className"]),u=(0,o.classNames)("CallButton","CallButton--"+l,s,{"CallButton--withText":!!n},"CallButton--withAnimation"),d=(0,o.classNames)("CallButton__icon","CallButton__icon--withAnimation"),p=(0,r.__assign)((0,r.__assign)({},c),{onMouseDown:function(e){e.preventDefault(),c.onMouseDown&&c.onMouseDown(e)}});return i.createElement("button",(0,r.__assign)({className:u},p,{disabled:l===a.DISABLED}),i.createElement("figure",{className:d},t),n)}},790281:(e,t,n)=>{"use strict";n.d(t,{CallByNameModal:()=>f});var a=n(667294),r=n(138671),i=n(838480),o=n(774415),l=n(662208),s=n(736434),c=n(295886),u=n(670546),d=n(248586),p=n(279060),_=n(750598),m=n(884143),f=function(e){var t=e.items,n=e.actionButtons,f=e.onListItemClick,g=e.selectedId,A=e.onClose,v=e.onSearchChange,h=a.useContext(l.LangContext).getLang;return a.createElement(r.default,{className:"CallByNameModal",onClose:A},a.createElement(i.ModalHeader,{title:h("calls_call_by_name_title"),onClose:A}),a.createElement("div",{className:"CallByNameModal__content"},a.createElement(s.BlockSearchInput,{className:"CallByNameModalList__input",placeholder:h("calls_call_by_name_search_placeholder"),onChange:v,onInput:v,onPaste:v}),a.createElement(c.ListHeader,{extra:t.length||""},h("calls_call_by_name_list_header")),0!==t.length&&a.createElement(u.default,{border:!1,className:"CallByNameModalList__list"},t.map((function(e){return function(e,t){var n=null;return n=t===e.id?a.createElement("span",{className:"CallByNameModalList__selected"},h("calls_call_by_name_selected")):a.createElement("span",{className:"CallByNameModalList__select"},h("calls_call_by_name_select")),a.createElement(_.default,{key:e.id,onClick:function(){return f(e.id)},className:"CallByNameModalList__listItem",aside:n},a.createElement(d.default,{photo:a.createElement(p.CallPhoto,{id:e.id,photo:e.photo,alt:e.name||"",className:"CallByNameModalList__photo"}),title:e.name,href:e.link,target:"_blank"}))}(e,g)}))),0===t.length&&a.createElement(m.default,null,h("calls_call_by_name_not_found"))),a.createElement(o.ModalFooter,{actionButtons:n}))}},440896:(e,t,n)=>{"use strict";n.d(t,{CallError:()=>o});var a=n(667294),r=n(7692),i=n(952907),o=function(e){var t=e.title,n=e.onClose,o=e.actionButtons,l=e.text;return a.createElement(r.default,{appearance:"blue",title:t,onClose:n,actionButtons:o,className:"CallError"},a.createElement(i.ErrorPopupText,null,l))}},225652:(e,t,n)=>{"use strict";n.d(t,{CallExitModal:()=>o});var a=n(667294),r=n(7692),i=n(662208),o=function(e){var t=e.onClose,n=e.actionButtons,o=a.useContext(i.LangContext).getLang;return a.createElement(r.default,{onClose:t,title:o("calls_exit_menu"),appearance:"blue",actionButtons:n,className:"CallExitModal"},a.createElement("div",{className:"CallExitModal__text"},o("calls_sure_leave_call")))}},362542:(e,t,n)=>{"use strict";n.d(t,{CallGridNew:()=>o});var a=n(667294),r=n(659397),i=n(148434),o=function(e){var t=e.onScroll,n=e.scrollPosition,o=e.participantsCount,l=e.participantsShiftCount,s=e.children,c=a.Children.toArray(s),u=(0,r.classNames)("CallGridNew","CallGridNew--c"+o),d=(0,a.useRef)(null);(0,a.useEffect)((function(){var e=function(){null!==d.current&&t(d.current.scrollTop)};return null!==d.current&&d.current.addEventListener("scroll",e),function(){d.current&&d.current.removeEventListener("scroll",e)}}),[]),(0,a.useEffect)((function(){var e;null===(e=d.current)||void 0===e||e.scrollTo(0,n)}),[d.current]);var p=(0,a.useMemo)((function(){return new Array(l).fill(0).map((function(e,t){return a.createElement("article",{className:"CallGridNew__item CallGridNew__item--empty",key:-t})}))}),[l]),_=o-l-c.length>0;return a.createElement("section",{className:u,ref:d},a.createElement("div",{className:"CallGridNew__in"},p,c.map((function(e,t){return a.createElement("article",{className:"CallGridNew__item",key:e.key||t,"data-calls-id":"grid-item"},e)}))),_&&a.createElement(i.default,{color:"white",size:64,duration:1,className:"CallGridNew__spinner"}))}},503592:(e,t,n)=>{"use strict";n.d(t,{CallHeader:()=>s});var a=n(667294),r=n(659397),i=n(796726),o=n(297627),l=n(838482),s=(0,a.memo)((function(e){var t=e.translation,n=e.speakers,s=e.hands,c=e.time,u=e.network,d=e.networkTooltipText,p=(0,r.classNames)("CallHeader__hands",{"CallHeader__hands--visible":s>0});return a.createElement("div",{className:"CallHeader"},a.createElement("div",{className:"CallHeader__main"},a.createElement("div",{className:"CallHeader__timeAndNetwork"},u<.6&&a.createElement(l.default,{text:d,align:"left",className:"Call__oldTooltip"},a.createElement("div",{className:"CallHeader__network"},a.createElement(o.default,{fill:u<=.3?"#ff5c5c":"#FECE00"}))),c),t&&a.createElement("div",{className:"CallHeader__translation"},t)),a.createElement("div",{className:"CallHeader__aside"},a.createElement("div",{className:"CallHeader__participants"},n),a.createElement("div",{className:p},a.createElement(i.RaisedHandIconXs,null)," ",s)))}))},343035:(e,t,n)=>{"use strict";n.d(t,{CallHistoryList:()=>s});var a=n(667294),r=n(670546),i=n(884143),o=n(374327),l=n(658861),s=function(e){var t=e.calls,n=e.onMenuItemClick,s=e.stubText,c=e.hasMore,u=e.onLoadMore,d=e.selectedOwnerId,p=void 0===d?0:d;return a.createElement(l.default,{useWindowScroll:!0,hasMore:c,loadMore:u},a.createElement(r.default,{className:"CallHistoryList",border:!1},t.map((function(e,t){return a.createElement(o.CallHistoryListItem,{selectedOwnerId:p,key:t,onMenuItemClick:n,call:e,index:t})})),0===t.length&&a.createElement(i.default,{className:"CallHistoryList--stub"},s)))}},374327:(e,t,n)=>{"use strict";n.d(t,{HistoryCallMenuActionsEnum:()=>a,CallHistoryListItem:()=>S});var a,r=n(667294),i=n(309739),o=n(890638),l=n(659397),s=n(263986),c=n(800055),u=n(967458),d=n(239446),p=n(735144),_=n(250516),m=n(248586),f=n(750598),g=n(171659),A=n(366521),v=n(664327),h=n(838482);!function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO",e[e.MESSAGE=2]="MESSAGE",e[e.DELETE=3]="DELETE"}(a||(a={}));var E=function(e,t){void 0===t&&(t=0);var n="";if(t){var a=new Date(t);if((0,l.isDateToday)(a)){var r=(0,l.leadingZero)(a.getMinutes());n=a.getHours()+":"+r}else n=t?e(t,!1):""}return n},C=function(e,t,n){return{text:r.createElement("div",{className:"CallHistoryListItem--dropdownItem"},e,r.createElement("div",{className:"CallHistoryListItem--dropdownItemText"},t)),onClick:n}},S=(0,r.memo)((function(e){var t=e.index,n=e.call,S=e.onMenuItemClick,y=e.selectedOwnerId,T=void 0===y?0:y,I=(0,A.useHistoryScreenSelector)((function(e){return e.profiles})),b=(0,v.useLangContext)(),N=b.getLang,w=b.langShortDate,L=(0,g.getHistoryItemOwner)(n,I),P=L.member,k=L.chat,M=(0,r.useMemo)((function(){var e=n.type,i=n.items,o=n.started_at,p=n.finished_at,_="";o&&p&&(_=(0,l.formatDuration)(Math.floor((p-o)/1e3)));var m=function(e){if(void 0===e&&(e=0),!e)return{date:"",time:""};var t=new Date(e),n=t.getDate(),a=t.getMonth()+1,r=t.getFullYear(),i=t.getHours(),o=t.getMinutes();return{date:[(0,l.leadingZero)(n),(0,l.leadingZero)(a),r].join("."),time:[(0,l.leadingZero)(i),(0,l.leadingZero)(o)].join(":")}}(p),f=m.date,A=m.time,v=k?function(e,t,n,a){var r=n.title,i=void 0===r?"":r,o=n.photo_100,l=void 0===o?"":o,s=n.id,c=void 0===s?0:s,u=a.finished_at,d=void 0===u?0:u,p=c?"/im?sel=c"+c:"",_=e("calls_history_call_type_group_hint"),m=E(t,d);return{title:i,href:p,hint:m?e("calls_history_call_type_group_time_hint").replace("{time}",m):"",photo:l,status:_}}(N,w,k,n):P?function(e,t,n,a){var i=n.name,o=void 0===i?"":i,u=n.photo,d=void 0===u?"":u,p=n.id,_=void 0===p?0:p,m=n.link,f=void 0===m?"":m,g=a.is_inbound,A=void 0!==g&&g,v=a.finished_at,h=void 0===v?0:v,C=a.reach_status,S=void 0===C?"":C,y=A?r.createElement(s.default,{className:"CallHistoryListItem--hintIcon"}):r.createElement(c.default,{className:"CallHistoryListItem--hintIcon"}),T=E(t,h),I="",b=!1;return A?"CANCELLED_BY_INITIATOR"===S?(I=e("calls_history_status_inb_cancelled_by_initiator"),b=!0):I=e("REACHED"===S?"calls_history_status_inb_reached":"REJECTED_BY_RECEIVER"===S?"calls_history_status_inb_reject_by_receiver":"calls_history_status_inb"):"CANCELLED_BY_INITIATOR"===S?I=e("calls_history_status_out_cancelled_by_initiator"):"REACHED"===S?I=e("calls_history_status_out_reached"):"REJECTED_BY_RECEIVER"===S?(I=e("calls_history_status_out_reject_by_receiver"),b=!0):I=e("calls_history_status_out"),{title:o,href:f||"/id"+_,hint:r.createElement("div",{className:(0,l.classNames)("CallHistoryListItem",{"CallHistoryListItem--important":b})},y,e("calls_history_call_list_item_description").replace("%type",I).replace("%time",T)),photo:d,status:I}}(N,w,P,n):{},h=v.title,y=void 0===h?"":h,T=v.photo,I=void 0===T?"":T,b=v.href,L=void 0===b?"":b,M=v.hint,O=void 0===M?"":M,D=v.status,R=void 0===D?"":D;y+="merged"===e?" ("+(null==i?void 0:i.length)+")":"";var B=(0,g.getHistoryCallPeerId)(n),x=[],U=function(e){return function(){return S(n,e,t)}};return x.push({onClick:function(){},noHover:!0,text:r.createElement("div",{className:"CallHistoryListItem--dropdownItemStatus"},r.createElement("div",{className:"CallHistoryListItem--dropdownItemStatusFinishTime"},r.createElement("div",{className:"CallHistoryListItem--dropdownItemStatusDate"},f),r.createElement("div",{className:"CallHistoryListItem--dropdownItemStatusTime"},A)),r.createElement("div",{className:"CallHistoryListItem--dropdownItemStatusType"},R),!!_&&r.createElement("div",{className:"CallHistoryListItem--dropdownItemStatusDuration"},_))}),B&&(x.push(C(r.createElement(u.default,null),N("calls_history_dropdown_item_message"),U(a.MESSAGE))),x.push({separator:!0})),x.push(C(r.createElement(d.default,null),N("calls_history_dropdown_item_delete"),U(a.DELETE))),{title:y,photo:I,href:L,hint:O,actions:x,peerId:B}}),[n]),O=M.title,D=M.photo,R=M.href,B=M.hint,x=M.actions,U=M.peerId;return P||k?r.createElement(f.default,{className:"CallHistoryListItem",selectable:!1,canBeHovered:!1,aside:r.createElement("div",{className:"CallHistoryListItem--aside"},!!U&&!(null==k?void 0:k.left_or_kicked)&&r.createElement(r.Fragment,null,r.createElement(h.default,{marginTop:-7,position:"t",text:N("calls_history_join_with_audio")},r.createElement(p.default,{className:"CallHistoryScreen--friendsIcon CallHistoryScreen--friendsIconsPhone",onClick:function(){return S(n,a.AUDIO,t,T)}})),r.createElement(h.default,{marginTop:-7,position:"t",text:N("calls_history_join_with_video")},r.createElement(_.default,{className:"CallHistoryScreen--friendsIcon",onClick:function(){return S(n,a.VIDEO,t,T)}}))),r.createElement(i.default,{className:"CallHistoryListItem--asideMenu",trigger:"hover",align:"right",data:x},r.createElement(o.default,{className:"CallHistoryScreen--friendsIcon CallHistoryListItem--asidePointers"})))},r.createElement(m.default,{className:"CallHistoryListItem--entity",photo:D,title:O,href:R,description:B||N("calls_history_call_type_group_hint"),target:"_blank"})):r.createElement(r.Fragment,null)}))},328962:(e,t,n)=>{"use strict";n.d(t,{CallHistoryScreen:()=>s});var a=n(667294),r=n(605329),i=n(575003),o=n(730300),l=n(765446),s=function(e){var t=e.showCreateCall,n=e.onCreateCallClick,s=e.activeMenuItem,c=e.menuItems,u=e.onMenuItemClick,d=e.loading,p=e.banner,_=e.children;return a.createElement(r.PageColumns,{narrow:a.createElement(a.Fragment,null,a.createElement(i.RightMenu,{tabs:c,activeTab:s,onTabClick:u,loading:d}),p)},a.createElement("div",{className:"CallHistoryScreen"},t&&a.createElement(o.CallHistoryScreenCreateCall,{onCreateCallClick:function(){return n(l.CallStatSource.HISTORY_CREATE)}}),_))}},730300:(e,t,n)=>{"use strict";n.d(t,{CallHistoryScreenCreateCall:()=>u});var a=n(667294),r=n(670546),i=n(750598),o=n(881150),l=n(744499),s=n(797847),c=n(664327),u=function(e){var t=e.onCreateCallClick,n=(0,c.useLangContext)().getLang;return a.createElement(l.default,{title:"",isSaved:!1,savedTitle:"",className:""},a.createElement(r.default,{className:"CallHistoryScreenCreateCall",border:!1},a.createElement(i.default,{chevron:!1,selectable:!1,icon:a.createElement(s.CreateCallIcon,null),aside:a.createElement(o.default,{onClick:t,size:"s"},n("calls_page_call_by_link_create"))},a.createElement("div",{className:"CallHistoryScreenCreateCall--title"},n("calls_page_call_by_link_header")))))}},115706:(e,t,n)=>{"use strict";n.d(t,{CallHistoryScreenLanding:()=>p});var a=n(667294),r=n(670546),i=n(750598),o=n(590439),l=n(382459),s=n(529071),c=n(881150),u=n(765446),d=n(664327),p=function(e){var t=e.onCreateCallClick,n=(0,d.useLangContext)().getLang;return a.createElement("div",{className:"CallHistoryScreenLanding"},a.createElement("div",{className:"CallHistoryScreenLanding--content"},a.createElement("div",{className:"CallHistoryScreenLanding--header"},n("calls_screen_landing_header")),a.createElement("div",{className:"CallHistoryScreenLanding--subheader"},n("calls_screen_landing_subheader")),a.createElement(r.default,{className:"CallHistoryScreenLanding--list",border:!1},a.createElement(i.default,{border:!1,chevron:!1,selectable:!1,icon:a.createElement(o.default,null)},n("calls_screen_landing_feature_participants")),a.createElement(i.default,{border:!1,chevron:!1,selectable:!1,icon:a.createElement(l.default,null)},n("calls_screen_landing_feature_anon")),a.createElement(i.default,{border:!1,chevron:!1,selectable:!1,icon:a.createElement(s.default,null)},n("calls_screen_landing_feature_share"))),a.createElement(c.default,{size:"l",className:"CallHistoryScreenLanding--createButton",onClick:function(){return t(u.CallStatSource.HISTORY_CREATE)}},n("calls_current_calls_create_call_by_link"))))}},995141:(e,t,n)=>{"use strict";n.d(t,{CallIconButton:()=>o});var a=n(570655),r=n(667294),i=n(659397),o=(0,r.forwardRef)((function(e,t){var n,o=e.type,l=e.isActive,s=e.icon,c=e.className,u=(0,a.__rest)(e,["type","isActive","icon","className"]),d=(0,i.classNames)("CallIconButton",c,"CallIconButton--withAnimation",((n={"CallIconButton--active":l})["CallIconButton--"+o]=!!o,n)),p=(0,a.__assign)((0,a.__assign)({},u),{onMouseDown:function(e){e.preventDefault(),u.onMouseDown&&u.onMouseDown(e)}});return r.createElement("button",(0,a.__assign)({},p,{className:d,ref:t}),s)}))},423197:(e,t,n)=>{"use strict";n.d(t,{CallIconButtonGroup:()=>o});var a=n(570655),r=n(667294),i=n(659397),o=(0,r.forwardRef)((function(e,t){var n=e.children,o=e.className,l=e.alignX,s=e.alignY,c=e.size,u=void 0===c?"m":c,d=(0,a.__rest)(e,["children","className","alignX","alignY","size"]),p=(0,i.classNames)("CallIconButtonGroup","CallIconButtonGroup--"+l,"CallIconButtonGroup--"+s,"CallIconButtonGroup--size-"+u,o);return r.createElement("div",(0,a.__assign)({className:p,ref:t},d),n)}))},177774:(e,t,n)=>{"use strict";n.d(t,{CallLink:()=>c});var a=n(667294),r=n(595775),i=n(629142),o=n(385177),l=n(880767),s=n(662208),c=function(e){var t=e.link,n=void 0===t?"":t,c=e.isLinkLoading,u=e.isCopied,d=e.hideCopiedText,p=a.useContext(s.LangContext).getLang;return a.createElement("div",{className:"CallLink"},a.createElement("p",{className:"CallLink__info"},p("calls_management_link_info_desc")),c?a.createElement(o.default,{className:"CallLink__input"},a.createElement(l.default,null)):a.createElement("div",{className:"CallLink__input"},a.createElement(r.default,{readOnly:"readonly",value:n}),a.createElement("div",null,a.createElement("div",{className:"CallLink__hint"},p("calls_management_add_warning"),a.createElement(i.default,{className:"CallLink__copied",shown:u,callback:d},p("calls_link_copied"))))))}},562192:(e,t,n)=>{"use strict";n.d(t,{CallLinkSettings:()=>_});var a=n(570655),r=n(667294),i=n(662208),o=n(277256),l=n(750598),s=n(670546),c=n(594504),u=n(560301),d=n(448625),p=n(25347),_=function(e){var t=e.requireAuthToJoin,n=void 0!==t&&t,_=e.onRequireAuthToJoinChanged,m=e.isWaitingHallBlockShown,f=void 0!==m&&m,g=e.isWaitingHallEnabled,A=void 0!==g&&g,v=e.onWaitingHallEnabledChanged,h=(0,r.useContext)(i.LangContext).getLang,E=(0,a.__read)((0,r.useState)(!n),2),C=E[0],S=E[1],y=(0,a.__read)((0,r.useState)(A),2),T=y[0],I=y[1],b=!1,N=(0,r.useCallback)((function(){if(!b){b=!0;var e=!C;S(e),_&&_(!e)}}),[n]),w=!1,L=(0,r.useCallback)((function(){if(!w){w=!0;var e=!T;I(e),v&&v(e)}}),[A]);return r.createElement(s.default,null,f&&r.createElement(u.ListItemWithHint,{onClick:L,canBeHovered:!1,icon:r.createElement(d.ListIcon,{icon:r.createElement(p.default,{width:20,height:20}),color:d.ListIconColors.BLUE}),hint:h("calls_menu_waiting_hall_description"),selectable:!0,aside:r.createElement(o.default,{onChange:L,checked:T})},h("calls_menu_waiting_hall_title")),r.createElement(l.default,{border:!0,canBeHovered:!1,onClick:N,selectable:!0,icon:r.createElement(c.AnonymousIcon,null),aside:r.createElement(o.default,{onChange:N,checked:C})},h("calls_management_link_allow_anonymous")))}},714783:(e,t,n)=>{"use strict";n.d(t,{CallLogoIcon:()=>o});var a=n(667294),r=n(213146),i=n(781313),o=function(e){return"ru"===e.lang?a.createElement(r.CallLogoIconRu,null):a.createElement(i.CallLogoIconEn,null)}},445586:(e,t,n)=>{"use strict";n.d(t,{CallManagementMenu:()=>d});var a=n(667294),r=n(670546),i=n(750598),o=n(448625),l=n(489685),s=n(607691),c=n(662208),u=n(498110),d=function(e){var t=e.isLinkBlockShown,n=e.linkBlockTitle,d=e.onLinkBlockClick,p=e.callUrlLink,_=(0,a.useContext)(u.ConfigContext).allowWaitingHall,m=a.useContext(c.LangContext).getLang;return a.createElement(r.default,null,t&&a.createElement(i.default,{onClick:d,chevron:!0,icon:a.createElement(o.ListIcon,{icon:a.createElement(l.LinkIcon,null),color:o.ListIconColors.GREEN}),aside:_?a.createElement("span",{className:"CallManagementMenu__asideHint"},m("calls_menu_link_setup")):""},n,p&&a.createElement(s.ListCopyControl,{value:p,copyText:m("calls_menu_link_copy"),doneText:m("calls_menu_link_copied")})))}},186983:(e,t,n)=>{"use strict";n.d(t,{CallManagementModal:()=>s});var a=n(667294),r=n(138671),i=n(838480),o=n(774415),l=n(662208),s=function(e){var t=e.title,n=e.onCloseModal,s=e.hint,c=e.actionButtons,u=e.isWithBackButton,d=e.onBackClick,p=e.children,_=a.useContext(l.LangContext).getLang;return a.createElement(r.default,{className:"CallManagementModal",disableBodyScroll:!1,onClose:n},a.createElement(i.ModalHeader,{title:t,onClose:n,backText:u?_("calls_back"):void 0,onBack:d}),a.createElement("div",{className:"CallManagementModal__content"},a.Children.toArray(p).map((function(e,t){return a.createElement("div",{className:"CallManagementModal__section",key:t},e)}))),(c||s)&&a.createElement(o.ModalFooter,{actionButtons:c||[],hint:s}))}},269481:(e,t,n)=>{"use strict";n.d(t,{CallModal:()=>u});var a=n(667294),r=n(50533),i=n(138671),o=n(431469),l=n(121255),s=n(659397),c=n(498110),u=function(e){var t=e.onClose,n=e.onBackdropClick,u=e.isIncoming,d=void 0!==u&&u,p=e.isCautionBoxShown,_=void 0!==p&&p,m=e.children,f=(0,r.useDispatch)(),g=(0,a.useContext)(c.ConfigContext).withAnimation,A=(0,s.classNames)("CallModal",{"CallModal--withAnimation":g});(0,o.usePseudoLayer)();var v=(0,a.useCallback)((function(){return _?void f({type:l.SHOW_CAUTION_BOX,isOpen:!0,isIncoming:d||!1}):t()}),[_]);return a.createElement(i.default,{className:A,disableBodyScroll:!0,onClose:v,onBackdropClick:n},m)}},925082:(e,t,n)=>{"use strict";n.d(t,{CallNotification:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.children,n=e.className,i=(0,r.classNames)("CallNotification",n);return a.createElement("div",{className:i},t)}},548237:(e,t,n)=>{"use strict";n.d(t,{CallOrator:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.children,n=e.orator,i=e.oratorTitle,o=e.onToggleParticipantsAside,l=e.isShownParticipantsAside,s=e.onScroll,c=e.scrollPosition,u=e.participantsAsideCount,d=e.participantsAsideShift,p=a.Children.toArray(t),_=(0,r.classNames)({CallOrator__toggleIcon:!0,"CallOrator__toggleIcon--withAnimation":!0}),m=(0,r.classNames)({CallOrator:!0,"CallOrator--withoutOthers":!l}),f=(0,r.classNames)({CallOrator__others:!0,"CallOrator__others--hide":!l}),g=(0,r.classNames)({CallOrator__toggleArrow:!0,"CallOrator__toggleArrow--toLeft":l,"CallOrator__toggleArrow--toRight":!l}),A=(0,a.useRef)(null);return(0,a.useEffect)((function(){var e=function(){null!==A.current&&s(A.current.scrollTop)};return null!==A.current&&A.current.addEventListener("scroll",e),function(){A.current&&A.current.removeEventListener("scroll",e)}}),[]),(0,a.useEffect)((function(){var e;null===(e=A.current)||void 0===e||e.scrollTo(0,c)}),[A.current]),a.createElement("article",{className:m,ref:A},a.createElement("main",{className:"CallOrator__orator"},n),a.createElement("button",{className:"CallOrator__toggleOthers",onClick:o},a.createElement("div",{className:_},a.createElement("div",{className:g}))),a.createElement("aside",{className:f},a.createElement("ul",{className:"CallOrator__list",style:{height:148*u-8+"px"}},d>0&&a.createElement("li",{className:"CallOrator__participant",key:-1,"data-calls-id":"participant",style:{height:d+"px"}}),p.map((function(e){return a.createElement("li",{className:"CallOrator__participant",key:"key"in e?e.key:void 0,"data-calls-id":"participant"},e)})))),i)}},813245:(e,t,n)=>{"use strict";n.d(t,{CallParticipantList:()=>s});var a=n(667294),r=n(736434),i=n(295886),o=n(670546),l=n(662208),s=function(e){var t=e.searchQuery,n=e.onSearchChange,s=e.length,c=e.children,u=e.waitingHallList,d=a.useContext(l.LangContext).getLang;return a.createElement("div",{className:"CallParticipantList"},a.createElement(r.BlockSearchInput,{value:t,placeholder:d("calls_search_participants_placeholder"),onChange:n,onInput:n,onPaste:n,className:"CallParticipantList__input"}),!!u&&u,a.createElement(i.ListHeader,{extra:s||""},d("calls_participant_list_header")),a.createElement(o.default,{border:!1,className:"CallParticipantList__list"},c))}},279060:(e,t,n)=>{"use strict";n.d(t,{CallPhoto:()=>u});var a=n(667294),r=n(906942),i=n(659397),o=n(121255),l=n(690128),s=n(498110),c=n(697483),u=function(e){var t,n,u=e.id,d=e.waves,p=void 0!==d&&d,_=e.size,m=e.photo,f=void 0===m?"":m,g=e.alt,A=e.letter,v=e.showCreatorBadge,h=e.showAdminBadge,E=e.className,C=(0,a.useContext)(s.ConfigContext),S=C.withAnimation,y=C.anonymPhoto,T=(0,c.isParticipantAnonym)(u),I=(0,i.classNames)("CallPhoto",E,((t={"CallPhoto--waves":S&&!!p})["CallPhoto--"+_]=!!_,t)),b=null!=A?A:String.fromCodePoint(null!==(n=g.codePointAt(0))&&void 0!==n?n:32);return!f||f.includes(o.DEFAULT_AVATAR)||T&&!y?a.createElement(a.Fragment,null,a.createElement(r.ConversationNoPhoto,{id:Math.abs(u),text:b,size:_,className:I}),v?a.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"creator"}):h?a.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"admin"}):null):a.createElement(a.Fragment,null,a.createElement("img",{src:f,className:I,alt:g}),v?a.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"creator"}):h?a.createElement(l.UserBadge,{className:"CallPhoto__badge",type:"admin"}):null)}},471304:(e,t,n)=>{"use strict";n.d(t,{CallSettings:()=>f});var a=n(570655),r=n(667294),i=n(539503),o=n(385177),l=n(662208),s=n(969135),c=n(838482),u=n(121255),d=n(498110),p=n(731585),_=n(32491),m=n(659397);function f(e){var t=e.cameras,n=e.mics,u=e.noiseCancellationOptions,f=e.videoResolutionOptions,v=e.currentCamId,h=e.currentMicId,E=e.currentNoiseCancellation,C=e.currentVideoResolution,S=e.isCamAvailable,y=void 0!==S&&S,T=e.isMicAvailable,I=void 0!==T&&T,b=e.onCameraChange,N=e.onMicChange,w=e.onNoiseCancellationChange,L=e.onVideoResolutionChange,P=e.pushToTalkEnabled,k=e.onPushToTalkChange,M=r.useContext(l.LangContext).getLang,O=r.useContext(d.ConfigContext).allowPushToTalk,D=(0,r.useRef)(null),R=(0,r.useRef)(null),B=(0,r.useRef)(null),x=(0,r.useRef)(null),U={controls:!1,crossOrigin:"anonymous",playsInline:!0};A({kind:"video",resolution:C,mediaElRef:D,streamRef:B,deviceId:v,isActive:y}),A({kind:"audio",mediaElRef:R,streamRef:x,deviceId:h,isActive:I});var H=(0,_.useVideoOptions)().storedVideoOptions;return r.createElement("div",{className:"CallSettings"},r.createElement("div",{className:"CallSettings__camera"},y?r.createElement("video",(0,a.__assign)({ref:D},U,{className:(0,m.classNames)({CallSettings__cameraStream:H[_.EVideoOptionType.IS_VIDEO_MIRRORED]},"CallSettings__cameraContent")})):r.createElement("div",{className:(0,m.classNames)("CallSettings__cameraStub","CallSettings__cameraContent")},M("calls_no_camera"))),I&&r.createElement("audio",(0,a.__assign)({ref:R},U)),r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},M("calls_settings_camera")),y?r.createElement(i.default,{options:t.map(g),value:v,onChange:function(e){var t=e.selected;return b(t.value)},appearance:"secondary",className:"CallSettings__field"}):r.createElement(o.default,{className:"CallSettings__field"},M("calls_settings_no_camera"))),y&&r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},M("calls_settings_video_resolution")),r.createElement(i.default,{options:f,value:C,onChange:function(e){var t=e.selected;return L(t.value)},appearance:"secondary",className:"CallSettings__field"})),r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},M("calls_settings_mic")),I?r.createElement(i.default,{options:n.map(g),value:h,onChange:function(e){var t=e.selected;return N(t.value)},appearance:"secondary",className:"CallSettings__field"}):r.createElement(o.default,{className:"CallSettings__field"},M("calls_settings_no_mic"))),O&&r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"}),r.createElement(p.default,{className:"CallSettings__field",onChange:k,checked:P},M("calls_settings_push_to_talk_mode_description")),r.createElement(c.default,{className:"CallSettings__tooltip",text:M("calls_settings_push_to_talk_mode_hint"),position:"t",appearance:"light",maxWidth:320},r.createElement(s.default,{className:"CallSettings__hint","aria-label":M("calls_settings_push_to_talk_mode_hint")}))),r.createElement("div",{className:"CallSettings__block"},r.createElement("div",{className:"CallSettings__label"},r.createElement("span",{dangerouslySetInnerHTML:{__html:M("calls_settings_noise")}})),I?r.createElement(i.default,{options:u,value:E,onChange:function(e){var t=e.selected;return w(t.value)},appearance:"secondary",className:"CallSettings__field"}):r.createElement(o.default,{className:"CallSettings__field"},M("calls_settings_no_mic")),r.createElement(c.default,{className:"CallSettings__tooltip",text:M("calls_settings_noise_description"),position:"t",appearance:"light",maxWidth:320},r.createElement(s.default,{className:"CallSettings__hint","aria-label":M("calls_settings_noise_description")}))))}function g(e){return{value:e.deviceId,label:e.label}}function A(e){var t=e.kind,n=e.resolution,i=e.mediaElRef,o=e.streamRef,l=e.deviceId,s=e.isActive,c={video:!1,audio:!1},d={deviceId:l};"video"===t&&n&&(d.width={min:428,max:u.VideoWidth[n]||u.VideoWidth.SD,ideal:u.VideoWidth[n]||u.VideoWidth.SD},d.height={min:240,max:u.VideoHeight[n]||u.VideoHeight.SD,ideal:u.VideoHeight[n]||u.VideoHeight.SD}),(0,r.useEffect)((function(){var e;s&&navigator.mediaDevices.getUserMedia((0,a.__assign)((0,a.__assign)({},c),(e={},e[t]=d,e))).then((function(e){var t=o.current;t&&t.getTracks().forEach((function(e){return e.stop()}));var n=i.current;n&&(o.current=e,n.srcObject=e,n.volume=0,n.play())})).catch((function(e){console.error("Error occurred: "+e)}))}),[l,s,n]),(0,r.useEffect)((function(){return function(){var e=o.current;e&&e.getTracks().forEach((function(e){return e.stop()}));var t=i.current;t&&(t.srcObject=null)}}),[])}},555700:(e,t,n)=>{"use strict";n.d(t,{CallSettingsModal:()=>l});var a=n(667294),r=n(7692),i=n(881150),o=n(662208);function l(e){var t=e.onClose,n=e.onSubmit,l=e.children,s=a.useContext(o.LangContext).getLang;return a.createElement(r.default,{onClose:t,title:s("calls_settings"),appearance:"blue",actionButtons:a.createElement(a.Fragment,null,a.createElement(i.default,{onClick:t,appearance:"tertiary"},s("calls_cancel")),a.createElement(i.default,{onClick:n},s("calls_save"))),className:"CallSettingsModal"},l)}},52777:(e,t,n)=>{"use strict";n.d(t,{CallTimer:()=>r});var a=n(667294),r=function(e){var t=e.duration;return a.createElement("div",{className:"CallTimer","aria-label":t,"data-duration":t})}},180474:(e,t,n)=>{"use strict";n.d(t,{CallVideoWidget:()=>_});var a=n(570655),r=n(667294),i=n(423197),o=n(838482),l=n(995141),s=n(952152),c=n(75794),u=n(662208),d=n(464380),p=n(32491),_=function(e){var t=e.localVideoStream,n=e.isLocalAudioEnabled,_=e.isLocalAudioAllowed,m=e.isLocalScreenSharing,f=e.participantId,g=e.isMe,A=void 0!==g&&g,v=e.isWithVideo,h=e.isWithAudio,E=e.isScreenSharing,C=e.stream,S=e.photo,y=e.name,T=e.status,I=void 0===T?d.ParticipantStatus.CONNECTED:T,b=e.networkStatus,N=e.onRestoreCall,w=e.onToggleAudio,L=e.children,P=r.useContext(u.LangContext).getLang,k=(0,a.__read)((0,r.useState)(!1),2),M=k[0],O=k[1],D=(0,p.useVideoOptions)().storedVideoOptions;(0,r.useEffect)((function(){t||O(!1)}),[t,M]);var R=(0,r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),N()}),[N]),B=(0,r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),w&&w()}),[w]);return r.createElement("div",{className:"CallVideoWidget",onClick:N},t&&r.createElement(s.Video,{className:"CallVideoWidget__local",stream:t,isMirrored:!m&&D[p.EVideoOptionType.IS_VIDEO_MIRRORED],isContained:!1,isStartWithVisible:!0}),r.createElement(c.Participant,{id:f,hasVideo:v,hasAudio:h,isSharingScreen:E,isMe:A,stream:C,photo:S,name:y,status:I,allowContain:!1,networkStatus:b}),L,r.createElement(i.CallIconButtonGroup,{alignX:"l",alignY:"b",size:"s",className:"CallVideoWidget__buttons"},r.createElement(o.default,{position:"t",align:"left",marginTop:6,text:P(n?"calls_mute":"calls_unmute")},r.createElement(l.CallIconButton,{type:n?"mute":"unmute",onClick:B,disabled:!_}))),r.createElement(i.CallIconButtonGroup,{alignX:"r",alignY:"b",size:"s",className:"CallVideoWidget__buttons"},r.createElement(o.default,{position:"t",align:"right",text:P("calls_restore"),marginTop:6},r.createElement(l.CallIconButton,{type:"restore",onClick:R}))))}},400412:(e,t,n)=>{"use strict";n.d(t,{CallWidget:()=>o});var a=n(667294),r=n(853055),i=n(279060),o=function(e){var t=e.id,n=e.photo,o=e.title,l=e.status,s=e.isIncoming,c=e.onClick,u=e.children;return a.createElement("div",{className:"CallWidget",onClick:c},a.createElement(r.BlurredBackground,{id:t,className:"CallWidget__background"}),a.createElement(i.CallPhoto,{id:t,photo:n,waves:s,alt:o||"",className:"CallWidget__photo"}),a.createElement("h1",{className:"CallWidget__name"},o),a.createElement("div",{className:"CallWidget__status"},l),u)}},647686:(e,t,n)=>{"use strict";n.d(t,{default:()=>i});var a=n(667294),r=n(659397);function i(e){var t=e.isInverted,n=(0,r.classNames)("CallingStatus",{"CallingStatus--inverted":!!t}),i=(0,r.classNames)("CallingStatus__part","CallingStatus__part--withAnimation");return a.createElement("div",{className:n},a.createElement("span",{className:i}),a.createElement("span",{className:i}),a.createElement("span",{className:i}))}},722959:(e,t,n)=>{"use strict";n.d(t,{CallsDropdown:()=>c});var a=n(570655),r=n(667294),i=n(617841),o=n(659397),l=n(30081),s=n(277256),c=function(e){var t=e.children,n=e.items,c=e.open,u=void 0!==c&&c,d=e.setOpen,p=(0,r.useRef)(null),_=(0,r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),d(!u)}),[u]),m=function(e){p.current&&p.current.contains(e.target)||d(!1)};return(0,r.useEffect)((function(){return u?document.documentElement.addEventListener("click",m,!0):document.documentElement.removeEventListener("click",m,!0),function(){return document.documentElement.removeEventListener("click",m,!0)}}),[u]),u?r.createElement(i.Popper,{content:r.createElement("ul",{className:"CallsDropdown",ref:p},n.map((function(e,t,n){return r.createElement("li",{className:"CallsDropdown__item",key:e.key||t},"separator"in e?(a=!t||n.length-1===t,r.createElement("div",{className:(0,o.classNames)({CallsDropdown__separator:!a})})):function(e,t,n){void 0===n&&(n=!1);var a=(0,o.classNames)("CallsDropdown__button",{"CallsDropdown__button--disabled":n});return"href"in e&&"onClick"in e&&void 0!==e.onClick?r.createElement("a",{href:e.href,rel:"noopener noreferrer",target:"_blank",onClick:n?void 0:function(n){n.stopPropagation(),e.onClick(n),t(!1)},className:a},e.text):"href"in e?r.createElement("a",{href:e.href,rel:"noopener noreferrer",target:"_blank",onClick:n?void 0:function(e){e.stopPropagation(),t(!1)},className:a},e.text):"onClick"in e?r.createElement("button",{onClick:n?void 0:function(n){n.stopPropagation(),e.onClick(n),t(!1)},className:a},r.createElement(l.default,null,String(e.text)),void 0!==e.isEnabled&&r.createElement(s.default,{className:"CallsDropdown__switch",checked:e.isEnabled})):null}(e,d,e.disabled));var a}))),mode:"point"},r.cloneElement(t,(0,a.__assign)((0,a.__assign)({},t.props),{onClick:_,"data-active":u}))):r.cloneElement(t,(0,a.__assign)((0,a.__assign)({},t.props),{onClick:_}))}},587551:(e,t,n)=>{"use strict";n.d(t,{CallsMultiSelect:()=>o});var a=n(667294),r=n(167578),i=n(662208),o=function(e){var t=e.tokens,n=e.onRemoveToken,o=e.value,l=e.onChange,s=e.onSelect,c=e.renderSuggest,u=e.data,d=a.useContext(i.LangContext).getLang;return a.createElement(r.default,{className:"CallsMultiSelect",tokens:t,removeTokenPlaceholder:d("calls_remove_token"),onRemoveToken:n,placeholder:d("calls_search_participants_placeholder"),value:o,onChange:l,onSelect:s,useInfiniteScroll:!1,hasMore:!1,virtualized:!1,loadMore:function(){},notFoundText:d("calls_participants_not_found"),autoFocus:!0,isSearching:!1,renderSuggest:c,data:u})}},152205:(e,t,n)=>{"use strict";n.d(t,{CallsSearchResult:()=>d});var a=n(667294),r=n(295886),i=n(750598),o=n(677247),l=n(121255),s=n(956462),c=n(881150),u=n(780573),d=function(e){var t=e.data,n=e.onClick,d=e.selected,p=e.disabled;if("type"in t)switch(t.type){case l.SearchResultType.HEADER:return a.createElement(r.ListHeader,{className:"CallsSearchResult CallsSearchResult--header",extra:t.count},t.text);case l.SearchResultType.CALL_ALL_IN_CHAT:return a.createElement("div",{className:"CallsSearchResult CallsSearchResult--select"},a.createElement(c.default,{appearance:"secondary",wide:!0,onClick:n},a.createElement("span",{className:"CallsSearchResult__icon"},a.createElement(u.PhoneIconS,null)),t.text));case l.SearchResultType.MEMBERS_MORE:case l.SearchResultType.FRIENDS_MORE:case l.SearchResultType.GROUP_MEMBERS_MORE:return a.createElement(s.ListMore,{onClick:n},t.text)}return a.createElement(i.default,{"data-id":t.peerId,onClick:n,selectable:!p},a.createElement(o.ParticipantSuggest,{member:t,selected:d,disabled:p}))}},884609:(e,t,n)=>{"use strict";n.d(t,{ChatIconButton:()=>l});var a=n(570655),r=n(667294),i=n(659397),o=n(498110),l=(0,r.forwardRef)((function(e,t){var n=e.unreadCount,l=void 0===n?0:n,s=(0,a.__rest)(e,["unreadCount"]),c=(0,r.useContext)(o.ConfigContext).withAnimation,u="",d="";switch(!0){case!l:u="none";break;case l<=9:u="single",d=l.toString();break;case l<=99:u="double",d=l.toString();break;case l>99:u="max",d="99+"}var p=(0,i.classNames)("ChatIconButton","ChatIconButton--"+u,{"ChatIconButton--withAnimation":c});return r.createElement("button",(0,a.__assign)({className:p},s,{ref:t}),d&&r.createElement("div",{className:"ChatIconButton__count "},d))}))},275109:(e,t,n)=>{"use strict";n.d(t,{CollapsedCall:()=>o});var a=n(667294),r=n(498110),i=n(659397),o=function(e){var t=e.children,n=(0,a.useContext)(r.ConfigContext).withAnimation,o=(0,i.classNames)("CollapsedCall",{"CollapsedCall--withAnimation":n});return a.createElement("div",{className:o},t)}},614183:(e,t,n)=>{"use strict";n.d(t,{CreateCallByLinkModal:()=>g});var a=n(667294),r=n(138671),i=n(838480),o=n(774415),l=n(662208),s=n(670546),c=n(750598),u=n(277256),d=n(539503),p=n(560301),_=n(625920),m=n(599318),f=n(460851),g=function(e){var t=e.actionButtons,n=e.onClose,g=e.ownerOptions,A=e.selectedOwnerId,v=e.waitingHall,h=e.allowAnon,E=e.onGroupSelectChange,C=e.onChangeWaitingHall,S=e.onChangeAllowAnon,y=a.useContext(l.LangContext).getLang;return a.createElement(r.default,{className:"CreateCallByLinkModal",onClose:n},a.createElement(i.ModalHeader,{title:y("calls_create_call_by_link_title"),onClose:n}),a.createElement("div",{className:"CreateCallByLinkModal__content"},a.createElement("div",{className:"CreateCallByLinkModal__description"},y("calls_create_call_by_link_description")),a.createElement(s.default,null,a.createElement(c.default,{border:!0,canBeHovered:!1,selectable:!1,icon:a.createElement(_.CreateCallUserIcon,null),aside:a.createElement(d.default,{className:"CreateCallByLinkModalOptions__longselect",options:g,value:A,onChange:E,disabled:g.length<=1})},y("calls_create_call_by_link_by_name")),a.createElement(p.ListItemWithHint,{canBeHovered:!1,onClick:C,icon:a.createElement(m.CreateCallWaitingHallIcon,null),hint:y("calls_menu_waiting_hall_description"),aside:a.createElement(u.default,{onChange:C,checked:v})},y("calls_menu_waiting_hall_title")),a.createElement(p.ListItemWithHint,{canBeHovered:!1,onClick:S,icon:a.createElement(f.CreateCallAnonymousIcon,null),hint:y("calls_create_call_by_link_anon_hint"),aside:a.createElement(u.default,{onChange:S,checked:h})},y("calls_create_call_by_link_anon")))),a.createElement(o.ModalFooter,{actionButtons:t}))}},462176:(e,t,n)=>{"use strict";n.d(t,{CurrentCallsList:()=>o});var a=n(667294),r=n(670546),i=n(423753),o=function(e){var t=e.currentCalls,n=e.onJoin,o=e.listItemBorder,l=void 0===o||o;return t.length?a.createElement(r.default,{border:!1},t.map((function(e,t){return a.createElement(i.CurrentCallsListItem,{key:t,listItemBorder:l,call:e,onJoin:n})}))):a.createElement(a.Fragment,null)}},423753:(e,t,n)=>{"use strict";n.d(t,{CurrentCallsListItem:()=>f});var a=n(570655),r=n(667294),i=n(121255),o=n(279060),l=n(881150),s=n(613335),c=n(750598),u=n(248586),d=n(622206),p=n(171659),_=n(366521),m=n(664327);var f=function(e){var t=e.call,n=e.onJoin,f=e.listItemBorder,g=void 0===f||f,A=(0,_.useHistoryScreenSelector)((function(e){return e.profiles})),v=(0,m.useLangContext)(),h=v.getLang,E=v.langNumeric,C=(0,p.getCurrentCallOwner)(t,A),S=C.member,y=C.chat,T=(0,r.useMemo)((function(){var e,n,r=y?function(e){var t=e.title,n=void 0===t?"":t,a=e.photo_100,r=void 0===a?"":a,i=e.id,o=void 0===i?0:i;return{title:n,photo:r,href:o?"/im?sel=c"+o:"",id:o}}(y):S?function(e){var t=e.name,n=void 0===t?"":t,a=e.photo,r=void 0===a?"":a,i=e.link,o=void 0===i?"":i,l=e.id,s=void 0===l?0:l;return{title:n,photo:r,href:o||"/im?sel=c"+s,id:s}}(S):{},i=r.id,o=void 0===i?0:i,l=r.title,c=void 0===l?"":l,u=r.photo,d=void 0===u?"":u,p=r.href,_=void 0===p?"":p,m=t.users_count,f=t.user_ids,g=t.join_link,v=void 0===g?"":g,C=E(m,"calls_history_members_count",h("calls_history_members_count",m)).replace("%n",String(m)),T=f.slice(0,3),I=[];try{for(var b=(0,a.__values)(T),N=b.next();!N.done;N=b.next()){var w=N.value;w in A&&I.push((0,s.getMemberForUserStack)(A[w]))}}catch(t){e={error:t}}finally{try{N&&!N.done&&(n=b.return)&&n.call(b)}finally{if(e)throw e.error}}return{id:o,title:c,photo:d,href:_,description:C,join_link:v,avatarItems:I}}),[y,t,S,A]),I=T.id,b=T.title,N=T.photo,w=T.href,L=T.description,P=T.avatarItems,k=T.join_link;return S||y?r.createElement(c.default,{border:g,className:"CurrentCallsListItem",key:I,selectable:!1,canBeHovered:!1,aside:r.createElement(r.Fragment,null,P.length>0&&r.createElement("div",{className:"CurrentCallsListItem--avatarStack"},r.createElement(d.AvatarsStackNoSvg,{size:d.AvatarsStackNoSvgSizes.SIZE_24,items:P})),r.createElement(l.default,{size:"s",onClick:function(){return n(k,I,i.CallStatSource.HISTORY)}},h("calls_history_join_call_button")))},r.createElement(u.default,{photo:r.createElement(o.CallPhoto,{id:I,photo:N,alt:b,size:"34"}),title:b,href:w,description:L,target:"_blank"})):r.createElement(r.Fragment,null)}},487318:(e,t,n)=>{"use strict";n.d(t,{DeleteCallModal:()=>o});var a=n(667294),r=n(7692),i=n(664327),o=function(e){var t=e.onClose,n=e.actionButtons,o=e.text,l=(0,i.useLangContext)().getLang;return a.createElement(r.default,{className:"DeleteCallModal",title:l("calls_history_delete_modal_title"),actionButtons:n,onClose:t,appearance:"blue",hasScroll:!1},a.createElement("div",{className:"DeleteCallModal__content"},o))}},952907:(e,t,n)=>{"use strict";n.d(t,{ErrorPopupText:()=>r});var a=n(667294),r=function(e){var t=e.children;return a.createElement("div",{className:"ErrorPopupText"},t)}},25947:(e,t,n)=>{"use strict";n.d(t,{FeedbackScreen:()=>o});var a=n(667294),r=n(662208),i=n(881150),o=function(e){var t=e.title,n=e.children,o=e.sendButtonClick,l=e.skipButtonClick,s=e.sendButtonDisabled,c=void 0===s||s,u=a.useContext(r.LangContext).getLang;return a.createElement("div",{className:"FeedbackScreen"},a.createElement("div",{className:"FeedbackScreen__close",onClick:l}),a.createElement("div",{className:"FeedbackScreen__title"},t),n,a.createElement("div",{className:"FeedbackScreen__actions"},a.createElement(i.default,{appearance:"overlay_secondary",onClick:l},u("calls_feedback_skip")),a.createElement(i.default,{appearance:"overlay_primary",onClick:o,disabled:c},u("calls_feedback_send"))))}},789241:(e,t,n)=>{"use strict";n.d(t,{IncomingCall:()=>u});var a=n(667294),r=n(853055),i=n(279060),o=n(782117),l=n(995141),s=n(838482),c=n(662208);function u(e){var t=e.id,n=e.photo,u=e.title,d=e.description,p=e.onCollapseCall,_=e.children,m=a.useContext(c.LangContext).getLang;return a.createElement("section",{className:"IncomingCall"},a.createElement(r.BlurredBackground,{id:t}),a.createElement(s.default,{position:"b",text:m("calls_collapse"),marginTop:-6},a.createElement(l.CallIconButton,{type:"collapse",className:"IncomingCall__collapse",onClick:p})),a.createElement(o.IncomingCallHeader,{title:u,description:d}),a.createElement(i.CallPhoto,{id:t,waves:!0,photo:n,alt:u||"",className:"IncomingCall__photo"}),a.createElement("footer",{className:"IncomingCall__footer"},_))}},782117:(e,t,n)=>{"use strict";n.d(t,{IncomingCallHeader:()=>i});var a=n(667294),r=n(659397);function i(e){var t=e.title,n=e.description,i=e.className;return a.createElement("header",{className:(0,r.classNames)("IncomingCallHeader",i)},a.createElement("h1",{className:"IncomingCallHeader__title"},t),a.createElement("div",{className:"IncomingCallHeader__description"},n))}},991989:(e,t,n)=>{"use strict";n.d(t,{JoinHeader:()=>r});var a=n(667294),r=function(e){var t=e.children;return a.createElement("h2",{className:"JoinHeader"},t)}},991390:(e,t,n)=>{"use strict";n.d(t,{JoinScreen:()=>f});var a=n(667294),r=n(991989),i=n(685537),o=n(881150),l=n(168634),s=n(780573),c=n(595775),u=n(659397),d=n(196287),p=n(590439),_=n(670546),m=n(750598),f=function(e){var t=e.isAnonym,n=e.title,f=e.label,g=e.items,A=e.onChangeName,v=e.name,h=e.namePlaceholder,E=e.joinWithVideoText,C=e.joinWithAudioText,S=e.onJoinWithVideo,y=e.onJoinWithAudio,T=e.disabled,I=e.inputDisabled,b=e.callByNameShow,N=e.onCallByNameClick,w=e.onCallViaNativeAppClick,L=e.callViaNativeAppShow,P=e.callByNameTitle,k=e.callViaNativeAppTitle;return a.createElement("div",{className:(0,u.classNames)("JoinScreen",{"JoinScreen--anonym":t})},a.createElement(r.JoinHeader,null,n),a.createElement("div",{className:"JoinScreen__members"},a.createElement(i.AvatarsStack,{items:g}),a.createElement("div",{className:"JoinScreen__membersLabel"},f)),a.createElement("footer",{className:"JoinScreen__footer"},t&&a.createElement(c.default,{onChange:A,className:"JoinScreen__input",value:v,placeholder:h,disabled:I,maxLength:25,onKeyDown:function(e){"Enter"===e.key&&S()}}),a.createElement(o.default,{appearance:"primary",onClick:S,disabled:T,type:"submit"},a.createElement(l.VideoIconS,{className:"JoinScreen__icon"}),a.createElement("span",null,E)),a.createElement(o.default,{appearance:"primary",title:C,"aria-label":C,onClick:y,disabled:T},a.createElement(s.PhoneIconS,{className:"JoinScreen__icon"}))),(b||L)&&a.createElement(_.default,{border:!1,className:"JoinScreen__options"},L&&a.createElement(m.default,{border:!1,selectable:!0,chevron:!0,onClick:w,icon:a.createElement(d.default,{className:"JoinScreen__optionIcon"})},k),b&&a.createElement(m.default,{border:!1,selectable:!0,chevron:!0,onClick:N,icon:a.createElement(p.default,{className:"JoinScreen__optionIcon"})},P)))}},963985:(e,t,n)=>{"use strict";n.d(t,{KickParticipantModal:()=>c});var a=n(570655),r=n(667294),i=n(7692),o=n(662208),l=n(731585),s=n(498110),c=function(e){var t=e.onClose,n=e.actionButtons,c=e.onAllowReconnectChange,u=e.description,d=e.allowBan,p=e.banText,_=(0,r.useContext)(o.LangContext).getLang,m=(0,r.useContext)(s.ConfigContext).allowBanParticipant,f=(0,a.__read)((0,r.useState)(!0),2),g=f[0],A=f[1],v=(0,r.useCallback)((function(e,t){c&&c(t),A(t)}),[]);return r.createElement(i.default,{className:"KickParticipantModal",appearance:"blue",title:_("calls_kick_participant_title"),actionButtons:n,onClose:t,hasScroll:!1},r.createElement("div",{className:"KickParticipantModal__content"},u,m&&d&&r.createElement("div",null,r.createElement(l.default,{className:"KickParticipantModal__checkbox",onChange:v,checked:g},p))))}},560301:(e,t,n)=>{"use strict";n.d(t,{ListItemWithHint:()=>l});var a=n(570655),r=n(667294),i=n(750598),o=n(911099),l=function(e){var t=e.hint,n=e.className,l=e.children,s=(0,a.__rest)(e,["hint","className","children"]),c=!!t,u={"ListItem--withHint":c};return r.createElement(i.default,(0,a.__assign)({},s,{className:(0,o.classNames)(u,n)}),l,c&&r.createElement("div",{className:"ListItem--hint"},t))}},112877:(e,t,n)=>{"use strict";n.d(t,{MicIconWithSpeakingIndicator:()=>i});var a=n(667294),r=n(911099),i=function(){var e=(0,r.classNames)({MicIconWithSpeakingIndicator__scale:!0});return a.createElement("svg",{height:"20",width:"16",xmlns:"http://www.w3.org/2000/svg",className:"MicIconWithSpeakingIndicator"},a.createElement("mask",{id:"MicIconWithSpeakingIndicatorMask"},a.createElement("path",{d:"M8 0a4 4 0 00-4 4v5a4 4 0 008 0V4a4 4 0 00-4-4z"})),a.createElement("path",{d:"M1.1 10c-.55 0-.98.49-.84 1.02a8 8 0 006.84 5.93v2.15a.9.9 0 101.8 0v-2.15a8 8 0 006.84-5.93c.14-.53-.29-1.02-.84-1.02-.45 0-.83.33-.95.76a6.2 6.2 0 01-11.9 0c-.12-.43-.5-.76-.95-.76z"}),a.createElement("g",{mask:"url(#MicIconWithSpeakingIndicatorMask)"},a.createElement("g",{className:e},a.createElement("path",{d:"M8 0a4 4 0 00-4 4v7h8V4a4 4 0 00-4-4z"}),a.createElement("path",{d:"M8 7a4 4 0 00-4 4v5a4 4 0 008 0v-5a4 4 0 00-4-4z",className:"MicIconWithSpeakingIndicator__filled"}))))}},467667:(e,t,n)=>{"use strict";n.d(t,{MuteParticipantModal:()=>i});var a=n(667294),r=n(7692),i=function(e){var t=e.title,n=e.description,i=e.onClose,o=e.actionButtons;return a.createElement(r.default,{className:"MuteParticipantModal",appearance:"blue",title:t,actionButtons:o,onClose:i},n&&a.createElement("div",{className:"MuteParticipantModal__content"},n))}},827244:(e,t,n)=>{"use strict";n.d(t,{NotificationDesktopApp:()=>p});var a=n(667294),r=n(700881),i=n(881150),o=n(662208),l=n(153907),s=n(121255),c=n(610781),u=n(865203),d=n(233194),p=function(e){var t=e.onClose,n=a.useContext(o.LangContext).getLang,p=(0,l.getPlatformUrl)(),_=d.Platform.OS===d.OS.MAC?"macOS":d.Platform.OS===d.OS.WINDOWS?"Windows":null,m=_?n("calls_notification_native_app_button_for").replace("{name}",_):n("calls_notification_native_app_button");return a.createElement("div",{className:"NotificationDesktopApp"},a.createElement(r.default,{className:"NotificationDesktopApp--close",onClick:t,width:16,height:16}),a.createElement(c.DesktopAppIcon,{className:"NotificationDesktopApp--icon"}),a.createElement("span",{className:"NotificationDesktopApp--text"},n("calls_notification_native_app_text")),null!==_&&a.createElement(i.default,{onClick:function(){p&&(0,l.download)(p.url,p.filename),t()},appearance:"overlay_primary",className:"NotificationDesktopApp--button"},m," ",a.createElement(u.AngleIcon,{className:"NotificationDesktopApp--angleIcon"})),null===_&&a.createElement("a",{href:s.DESKTOP_CALLS_DOWNLOAD_PAGE,rel:"noopener noreferrer",target:"_blank",className:"NotificationDesktopApp--button"},m," ",a.createElement(u.AngleIcon,{className:"NotificationDesktopApp--angleIcon"})))}},170181:(e,t,n)=>{"use strict";n.d(t,{NotificationWithButton:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.children,n=e.className,i=(0,r.classNames)("NotificationWithButton",n);return a.createElement("div",{className:i},t)}},341548:(e,t,n)=>{"use strict";n.d(t,{OnHangupModal:()=>l});var a=n(667294),r=n(7692),i=n(881150),o=n(275385),l=function(e){var t=e.onClose,n=e.title,l=e.description,s=(0,o.useLang)().getLang;return a.createElement(r.default,{className:"OnHangupModal",onClose:t,title:n,appearance:"blue",actionButtons:a.createElement(i.default,{onClick:t},s("calls_close"))},a.createElement("div",{className:"OnHangupModal__description"},l))}},242422:(e,t,n)=>{"use strict";n.d(t,{OneToOne:()=>o});var a=n(667294),r=n(659397),i=n(75794),o=function(e){var t=e.id,n=e.name,o=e.letter,l=e.hasAudio,s=e.hasVideo,c=e.isSharingScreen,u=e.stream,d=e.wasConnected,p=e.networkStatus,_=e.opponentId,m=e.opponentHasAudio,f=e.opponentHasVideo,g=e.opponentIsSharingScreen,A=e.opponentStream,v=e.opponentPhoto,h=e.opponentName,E=e.opponentWasConnected,C=e.opponentNetworkStatus,S=(0,r.classNames)("OneToOne",{"OneToOne--hasVideo":s,"OneToOne--opponentHasVideo":f});return a.createElement("div",{className:S},a.createElement("aside",{className:"OneToOne__local"},a.createElement(i.Participant,{id:t,hasVideo:s,hasAudio:l,isSharingScreen:c,stream:u,isMe:!0,name:n,letter:o,wasConnected:d,allowContain:!0,networkStatus:p})),a.createElement("main",{className:"OneToOne__remote"},a.createElement(i.Participant,{id:_,hasVideo:f,hasAudio:m,isSharingScreen:g,stream:A,photo:v,name:h,allowContain:!0,wasConnected:E,networkStatus:C})))}},766610:(e,t,n)=>{"use strict";n.d(t,{OratorTitle:()=>u});var a=n(667294),r=n(641221),i=n(662208),o=n(297627),l=n(722254),s=n(86339),c=n(607350),u=(0,a.memo)((function(e){var t,n,u,d,p,_=e.orator,m=e.me,f=e.isPinned,g=e.isPinnedByAdmin,A=e.isPinnedByShareScreen,v=e.isUnpinAllowed,h=e.onTooltipChange,E=e.onUnpin,C=e.tooltips,S=(0,a.useContext)(i.LangContext).getLang,y=g||A||f,T=(0,a.useCallback)((function(){h("oratorPin",!1),E()}),[E]),I=(0,a.useCallback)((function(){return h("oratorPin",!0)}),[]),b=(0,a.useCallback)((function(){return h("oratorPin",!1)}),[]),N=(_.wasConnected||_.peerId===m)&&!(null===(t=_.mediaSettings)||void 0===t?void 0:t.isAudioEnabled),w=null===(n=_.mediaSettings)||void 0===n?void 0:n.isScreenSharingEnabled,L=_.shortName||_.name,P=_.shortNameGen||_.shortName||_.name,k=((null===(u=_.mediaSettings)||void 0===u?void 0:u.isAudioEnabled)||(null===(d=_.mediaSettings)||void 0===d?void 0:d.isScreenSharingEnabled)||(null===(p=_.mediaSettings)||void 0===p?void 0:p.isVideoEnabled))&&_.networkStatus<.6,M=a.createElement(a.Fragment,null,k&&a.createElement(o.default,{fill:_.networkStatus<=.3?"#ff5c5c":"#FECE00"}),w&&a.createElement("span",{className:"OratorTitle__additionInfo"},S("calls_orator_screen_sharing")),w?P:L,N&&a.createElement(l.default,null),g&&a.createElement(s.default,null),!g&&(A||f)&&a.createElement(c.default,null));return y?a.createElement(r.TooltipNew,{position:"b",align:"center",content:S(g&&v?"calls_hint_admin_pin_for_admin":g?"calls_hint_admin_pin_for_user":"calls_hint_user_pin"),open:C.oratorPin,delay:300,onOpen:I,onClose:b},a.createElement("button",{className:"OratorTitle OratorTitle--button",onClick:T,disabled:!v},M)):a.createElement("div",{className:"OratorTitle"},M)}))},75794:(e,t,n)=>{"use strict";n.d(t,{Participant:()=>C});var a=n(570655),r=n(667294),i=n(853055),o=n(952152),l=n(659397),s=n(595285),c=n(830810),u=n(722959),d=n(662208),p=n(711034),_=n(498110),m=n(697483),f=n(122317),g=n(647686),A=n(464380),v=n(297627),h=n(279060),E=n(32491),C=(0,r.memo)((function(e){var t=e.id,n=e.isVisible,C=void 0===n||n,S=e.isOrator,y=void 0!==S&&S,T=e.isInfoShown,I=e.isPinned,b=e.isPinnedByAdmin,N=e.isHandRaised,w=e.photo,L=e.hasVideo,P=e.hasAudio,k=e.isSharingScreen,M=e.isSpeaking,O=void 0!==M&&M,D=e.stream,R=void 0===D?null:D,B=e.isMe,x=void 0!==B&&B,U=e.name,H=e.letter,G=e.status,V=void 0===G?A.ParticipantStatus.CONNECTED:G,F=e.wasConnected,W=void 0===F||F,z=e.networkStatus,j=void 0===z?1:z,K=e.onClickParticipant,Y=e.onDblClickParticipant,Q=e.onStopScreenShare,Z=e.allowContain,J=e.actions,q=r.useContext(d.LangContext).getLang,X=(0,r.useContext)(_.ConfigContext),$=X.withAnimation,ee=X.anonymPhoto,te=r.useRef(null),ne=(0,m.isParticipantAnonym)(t),ae=(0,E.useVideoOptions)().storedVideoOptions,re=!!K||!!Y,ie=y&&k&&x,oe=(0,l.classNames)("Participant",{"Participant--isInteractive":re,"Participant--isPinned":I,"Participant--isSpeaking":O,"Participant--isOrator":y,"Participant--withAnimation":$}),le=(0,l.classNames)("Participant__more",{"Participant__more--withAnimation":$}),se=(0,a.__read)(r.useState(!1),2),ce=se[0],ue=se[1],de=(0,r.useCallback)((function(e){K&&K(e,Number(t))}),[K]),pe=(0,r.useCallback)((function(e){Y&&Y(e,t)}),[Y]),_e=(0,l.classNames)({Participant__offsetCard:T,Participant__oratorPhoto:y});return r.createElement("article",{ref:te,className:oe,onClick:de,onDoubleClick:pe,"participant-id":String(t)},!C&&r.createElement(r.Fragment,null,r.createElement(i.BlurredBackground,{id:t,className:"Participant__main"},r.createElement(h.CallPhoto,{id:t,photo:!ee&&ne?"":w,alt:U||"",letter:H,className:_e})),T&&r.createElement("footer",{className:"Participant__footer"},r.createElement("span",{className:"Participant__name"},U),(W||x)&&!P&&r.createElement("span",{className:"Participant__statusIcon Participant__statusIcon--mic"}))),C&&r.createElement(r.Fragment,null,J&&J.length>0&&r.createElement(u.CallsDropdown,{items:J,open:ce,setOpen:ue},r.createElement("button",{className:le,"aria-label":q("calls_actions")},r.createElement(c.MoreIcon,null))),!(L&&y)&&r.createElement(i.BlurredBackground,{id:t,className:"Participant__main"},r.createElement(h.CallPhoto,{id:t,photo:!ee&&ne?"":w,alt:U||"",className:_e})),N&&r.createElement("div",{className:"Participant__handIndicator"},r.createElement(s.RaisedHandContourIcon,{className:"Participant__handIcon"})),ie&&r.createElement("div",{className:"Participant__screenSharer"},r.createElement(f.ShareScreenBigIcon,null),r.createElement("div",{className:"Participant__screenSharerText"},q("calls_you_are_screen_sharer")),r.createElement("button",{className:"Participant__screenSharerButton",onClick:Q},q("calls_screen_share_stop"))),R&&L&&!ie&&r.createElement(o.Video,{className:"Participant__main",stream:R,isMirrored:x&&!k&&ae[E.EVideoOptionType.IS_VIDEO_MIRRORED],isContained:Z||k,isStartWithVisible:x}),V!==A.ParticipantStatus.CONNECTED&&!x&&r.createElement("div",{className:"Participant__status"},r.createElement(g.default,{isInverted:!0})),!y&&T&&r.createElement("footer",{className:"Participant__footer"},(P||R||k)&&j<.6&&r.createElement(v.default,{fill:j<=.3?"#ff5c5c":"#FECE00"}),r.createElement("span",{className:"Participant__name"},U),(W||x)&&!P&&r.createElement("span",{className:"Participant__statusIcon Participant__statusIcon--mic"}))),!b&&I&&r.createElement("header",{className:"Participant__header"},r.createElement("div",{className:"Participant__pin"})),b&&r.createElement("header",{className:"Participant__header"},r.createElement(p.PinDotIcon,{className:"Participant__icon"})))}))},343379:(e,t,n)=>{"use strict";n.d(t,{ParticipantIconButton:()=>o});var a=n(667294),r=n(309605),i=n(494549),o=function(e){var t=e.participantCount,n=e.onClick,o=e.isParticipantControlActive,l=a.createElement(i.ParticipantsIcon,null);if(t&&t>0){var s="";(s=t>99?"99+":null==t?void 0:t.toString())&&(l=a.createElement("div",null,a.createElement("div",{className:"ParticipantIconButton__count"},s),l))}return a.createElement(r.CallButton,{type:o?r.CallButtonTypes.OFF:r.CallButtonTypes.ON,icon:l,onClick:n,className:"Call__footerButton"})}},51247:(e,t,n)=>{"use strict";n.d(t,{ParticipantIndicators:()=>d});var a=n(667294),r=n(659397),i=n(838482),o=n(647686),l=n(942775),s=n(135063),c=n(449587),u=n(662208),d=function(e){var t=e.showSpeaking,n=e.showAudioDisabled,d=e.showRaisedHand,p=e.showConnecting,_=e.showRaisedHandTooltip,m=e.onRaisedHandClick,f=(0,a.useContext)(u.LangContext).getLang,g=a.createElement("span",{className:(0,r.classNames)("ParticipantIndicators__item",{"ParticipantIndicators__item--interactive":void 0!==m}),onClick:null!=m?m:void 0},a.createElement(s.RaisedHandIconS,{className:"ParticipantIndicators__hand"}));return a.createElement("span",{className:"ParticipantIndicators"},t&&a.createElement("span",{className:"ParticipantIndicators__item"},a.createElement(c.VolumeMeterAnimation,null)),n&&a.createElement("span",{className:"ParticipantIndicators__item"},a.createElement(l.MutedMicIconS,{className:"ParticipantIndicators__muted"})),d?_?a.createElement(i.default,{className:"ParticipantIndicators__tooltip",text:f("calls_participant_menu_enable_media_request"),position:"t",align:"center",appearance:"light"},g):g:null,p&&a.createElement("span",{className:"ParticipantIndicators__item"},a.createElement(o.default,null)))}},707604:(e,t,n)=>{"use strict";n.d(t,{ParticipantLite:()=>d});var a=n(667294),r=n(853055),i=n(659397),o=n(711034),l=n(498110),s=n(697483),c=n(595285),u=n(279060),d=(0,a.memo)((function(e){var t=e.id,n=e.isInfoShown,d=e.isPinned,p=e.isPinnedByAdmin,_=e.isHandRaised,m=void 0!==_&&_,f=e.photo,g=e.hasAudio,A=e.isMe,v=void 0!==A&&A,h=e.name,E=e.letter,C=e.wasConnected,S=void 0===C||C,y=e.onClickParticipant,T=e.onDblClickParticipant,I=(0,a.useContext)(l.ConfigContext).anonymPhoto,b=a.useRef(null),N=(0,s.isParticipantAnonym)(t),w=(0,i.classNames)("Participant","Participant--withAnimation",{"Participant--isPinned":d}),L=(0,a.useCallback)((function(e){y&&y(e,Number(t))}),[y,t]),P=(0,a.useCallback)((function(e){T&&T(e,t)}),[T,t]);return a.createElement("article",{ref:b,className:w,onClick:L,onDoubleClick:P,"participant-id":String(t)},a.createElement(r.BlurredBackground,{id:t,className:"Participant__main"},a.createElement(u.CallPhoto,{id:t,photo:!I&&N?"":f,alt:h||"",letter:E,className:n?"Participant__offsetCard":""})),m&&a.createElement("div",{className:"Participant__handIndicator"},a.createElement(c.RaisedHandContourIcon,{className:"Participant__handIcon"})),n&&a.createElement("footer",{className:"Participant__footer"},a.createElement("span",{className:"Participant__name"},h),(S||v)&&!g&&a.createElement("span",{className:"Participant__statusIcon Participant__statusIcon--mic"})),!p&&d&&a.createElement("header",{className:"Participant__header"},a.createElement("div",{className:"Participant__pin"})),p&&a.createElement("header",{className:"Participant__header"},a.createElement(o.PinDotIcon,{className:"Participant__icon"})))}))},95939:(e,t,n)=>{"use strict";n.d(t,{ParticipantMenu:()=>o});var a=n(667294),r=n(919535),i=n(309739),o=function(e){var t=e.position,n=e.align,o=e.trigger,l=e.marginTop,s=e.marginLeft,c=e.actions;return c.length>0?a.createElement(i.default,{position:t,align:n,trigger:o,marginTop:l,marginLeft:s,className:"ParticipantMenu__dropdown",data:c},a.createElement(r.ListActionsControl,null)):null}},677247:(e,t,n)=>{"use strict";n.d(t,{ParticipantSuggest:()=>o});var a=n(667294),r=n(248586),i=n(659397);function o(e){var t=e.member,n=e.selected,o=void 0!==n&&n,l=e.disabled,s=void 0!==l&&l,c=(0,i.classNames)("ParticipantSuggest",{"ParticipantSuggest--selected":o,"ParticipantSuggest--disabled":s});return a.createElement("div",{className:c,"data-id":t.id},a.createElement(r.default,{size:"34",title:t.name,photo:t.photo}))}},338374:(e,t,n)=>{"use strict";n.d(t,{TransferAdminRightsModal:()=>g});var a=n(667294),r=n(50533),i=n(881150),o=n(138671),l=n(838480),s=n(774415),c=n(662208),u=n(670546),d=n(295886),p=n(750598),_=n(248586),m=n(595775),f=n(884143),g=function(e){var t=e.participants,n=e.selected,g=e.onSelect,A=e.onClose,v=e.onCallForceFinish,h=e.onRightsTransfer,E=e.onSearch,C=(0,a.useContext)(c.LangContext).getLang,S=(0,r.useSelector)((function(e){return e.me}));return a.createElement(o.default,{className:"TransferAdminRightsModal",disableBodyScroll:!1,onClose:A},a.createElement(l.ModalHeader,{title:C("calls_dialog_creator_exit_title"),onClose:A}),a.createElement("div",{className:"TransferAdminRightsModal__content"},a.createElement(m.default,{onChange:function(e){return E(e.target.value)},placeholder:C("calls_search_participants_placeholder"),className:"TransferAdminRightsModal__searchInput"}),a.createElement(u.default,{border:!1},a.createElement(d.ListHeader,{extra:t.length},C("calls_call_participants")),0===t.filter((function(e){return e.peerId!==S})).length&&a.createElement(f.default,null,C("calls_participants_not_found")),t.filter((function(e){return e.peerId!==S})).map((function(e){return a.createElement(p.default,{key:e.peerId,className:"TransferAdminRightsModal__item",onClick:function(){return g(n!==e.peerId?e:null)},aside:a.createElement("span",{className:"TransferAdminRightsModal__label","aria-selected":n===e.peerId},n===e.peerId?C("calls_dialog_creator_exit_selected"):C("calls_dialog_creator_exit_select"))},a.createElement(_.default,{size:"34",title:e.name,photo:e.photo}))})))),a.createElement(s.ModalFooter,{actionButtons:[a.createElement(i.default,{key:"force",appearance:"secondary",onClick:v},C("calls_force_call_finish")),a.createElement(i.default,{key:"action",onClick:h},C(null===n?"calls_leave_call":"calls_dialog_creator_exit_action"))]}))}},958713:(e,t,n)=>{"use strict";n.d(t,{TranslationCreateForm:()=>S});var a,r,i=n(570655),o=n(667294),l=n(595775),s=n(244809),c=n(662208),u=n(942019),d=n(750598),p=n(448625),_=n(670546),m=n(539503),f=n(823694),g=n(449608),A=n(329538),v=n(326542),h=n(874023),E=n(613335),C=n(50533);function S(e){var t=e.onSubmit,n=e.onClose,S=(0,o.useContext)(c.LangContext),y=S.getLang,T=S.langShortDateTime,I=(0,C.useSelector)((function(e){return e})),b=function(){var e=(new Date).toISOString().split("T")[0];return y("calls_translation_title_default_value").replace("%s",e)},N=function(e,t,n){return void 0===t&&(t=""),void 0===n&&(n=""),{id:e,name:t,photo:n,isGroup:e<0}},w=function(e){var t=[{value:a.ONLY_ME,label:y("calls_translation_privacy_only_me_and_chat")},{value:a.FRIENDS,label:y("calls_translation_privacy_friends_and_chat")}];return e&&t.push({value:a.ALL,label:y("calls_translation_privacy_all_users")}),t},L=(0,E.getMe)(I),P=I.config,k=(0,i.__read)((0,o.useState)(b()),2),M=k[0],O=k[1],D=(0,i.__read)((0,o.useState)(""),2),R=D[0],B=D[1],x=(0,i.__read)((0,o.useState)(I.groupId?a.ALL:a.ONLY_ME),2),U=x[0],H=x[1],G=(0,i.__read)((0,o.useState)((function(){return w(!L.isClosed||!!I.groupId)})),2),V=G[0],F=G[1],W=(0,i.__read)((0,o.useState)((function(){var e,t;return I.groupId?N(I.groupId,null===(e=I.meGroup)||void 0===e?void 0:e.name,null===(t=I.meGroup)||void 0===t?void 0:t.photo):N(L.peerId,L.name,L.photo)})),2),z=W[0],j=W[1],K=(0,i.__read)((0,o.useState)(r.MAIN),2),Y=K[0],Q=K[1],Z=(0,i.__read)((0,o.useState)({}),2),J=Z[0],q=Z[1],X=(0,i.__read)((0,o.useState)((function(){return I.groupId&&I.meGroup?[{value:I.meGroup.peerId,label:I.meGroup.name}]:[{value:L.peerId,label:L.name}]})),2),$=X[0],ee=X[1],te=(0,i.__read)((0,o.useState)([]),2),ne=te[0],ae=te[1],re=(0,i.__read)((0,o.useState)(!1),2),ie=re[0],oe=re[1],le=(0,i.__read)((0,o.useState)([]),2),se=le[0],ce=le[1],ue=(0,i.__read)((0,o.useState)([]),2),de=ue[0],pe=ue[1],_e=(0,o.useCallback)((function(){var e=M.trim(),n=R.trim(),a={};if(Object.keys(J).length>0){e||(e=J.title),n||(n=J.description);var r=n!=J.title||e!=J.description;r||(r=z.id>0&&J.privacy_view.category!=U),r&&(0,A.sendVideoEdit)(z.id,J.id,e,n,U).catch((function(e){return console.error(e)}));var i={ovId:J.ov_id};J.live_start_time&&(i.startTime=J.live_start_time),a.upcomingStreamParams=i}else a.streamParams={name:e||b(),description:n,privacy_view:U,group_id:z.id<0?-z.id:0,call:!0};t(a)}),[M,R,U,z,J]);(0,o.useEffect)((function(){I.groupId||(0,A.getGroupsForStreaming)().then((function(e){var t=(0,i.__spreadArray)([],(0,i.__read)($));e.length>0&&(e.forEach((function(e){t.push({value:-e.id,label:e.name})})),ee(t),ae(e))})).catch(console.error)}),[]),(0,o.useEffect)((function(){q({}),oe(!1),ce([]),(0,A.getUpcomingLives)([z.id]).then((function(e){var t=[];e.count>0&&(t=e.items.filter((function(e){return""!==e.ov_id})));var n=t.length>0;if(oe(n),ce(t),n){var a=[];t.forEach((function(e){e.owner_id&&e.owner_id>0&&a.push(e.owner_id.toString())})),a&&(0,A.loadUsers)({user_ids:a.join(",")}).then((function(e){var t=[];e.forEach((function(e){t.push({id:e.id,name:e.first_name+" "+e.last_name})})),pe(t)})).catch((function(e){return console.error(e)}))}})).catch((function(e){return console.error(e)}))}),[z]);var me=function(e){var t=e.date;e.live_start_time&&(t=e.live_start_time);var n=t-Date.now()/1e3;return n>0&&n<h.WEEK?y("calls_translation_date_label_soon"):""};return o.createElement(o.Fragment,null,Y===r.MAIN&&o.createElement(u.TranslationCreateModal,{onClose:n,onSubmit:_e,title:y("calls_translation_box_title")},o.createElement("div",{className:"TranslationCreateForm__link"},o.createElement(_.default,null,$.length>0&&o.createElement(d.default,{border:!0,canBeHovered:!1,selectable:!1,icon:o.createElement(p.ListIcon,{icon:o.createElement("img",{className:"TranslationCreateForm__ownerIcon",src:z.photo,alt:z.name}),color:p.ListIconColors.GRAY}),aside:o.createElement(m.default,{className:"TranslationCreateFormOptions__longselect",options:$,value:z.id,onChange:function(e){var t=e.selected.value;t<0?ne.forEach((function(e){e.id==-t&&(H(a.ALL),F(w(!0)),j(N(-e.id,e.name,e.photo_100)))})):(F(w(!L.isClosed)),H(a.ONLY_ME),j(N(L.peerId,L.name,L.photo)))},disabled:$.length<=1})},y("calls_translation_owner_title")),ie&&o.createElement(d.default,{onClick:function(){ie&&Q(r.SELECT_POSTPONE)},chevron:!0,border:!0,icon:o.createElement(p.ListIcon,{icon:o.createElement(g.TimeIcon,null),color:p.ListIconColors.GREEN})},y("calls_translation_postponed_title"),Object.keys(J).length>0&&o.createElement("div",{className:"TranslationCreateForm__copyControl"},o.createElement(v.default,{className:"TranslationCreateForm__copyButton",onClick:function(e){e.preventDefault(),e.stopPropagation(),q({}),O(b()),B("")}},y("calls_translation_postponed_reset")))),!P.sferum&&o.createElement(d.default,{border:!1,canBeHovered:!1,selectable:!1,icon:o.createElement(p.ListIcon,{icon:o.createElement(f.PrivacyIcon,null),color:p.ListIconColors.GRAY}),aside:o.createElement(m.default,{className:"TranslationCreateForm__privacySelector TranslationCreateFormOptions__longselect",disabled:z.isGroup,options:V,value:U,onChange:function(e){H(e.selected.value)}})},y("calls_translation_who_can_see_video_privacy"))),o.createElement("div",{className:"TranslationCreateForm__privacyHint"},y("calls_translation_who_can_see_video_privacy_hint"))),o.createElement("form",{className:"TranslationCreateForm__main",onSubmit:_e},o.createElement("div",{className:"TranslationCreateForm__section"},o.createElement("div",{className:"TranslationCreateForm__block"},o.createElement("label",{className:"TranslationCreateForm__label"},y("calls_translation_title"),o.createElement(l.default,{className:"TranslationCreateForm__field",value:M,onChange:function(e){var t=e.target;O(t.value)},placeholder:y("calls_translation_name_placeholder")}))),o.createElement("div",{className:"TranslationCreateForm__block"},o.createElement("label",{className:"TranslationCreateForm__label"},y("calls_translation_description"),o.createElement(s.default,{className:"TranslationCreateForm__field",placeholder:y("calls_translation_description_placeholder"),value:R,onChange:function(e){var t=e.target;B(t.value)}})))),o.createElement("div",{className:"TranslationCreateForm__tabSection"},o.createElement("div",{className:"TranslationCreateForm__warning"},y("calls_translation_notification_warning"))))),Y===r.SELECT_POSTPONE&&o.createElement(u.TranslationCreateModal,{title:y("calls_translation_select_upcoming_box_title"),isWithBackButton:!0,onBackClick:function(){return Q(r.MAIN)},onClose:n,contentClassName:"TranslationCreateForm__modalVideo"},o.createElement("div",null,se.length>0&&o.createElement(_.default,{className:"TranslationCreateForm__VideoList"},se.map((function(e,t){return o.createElement(d.default,{className:"TranslationCreateForm__videoItem",active:e.id===J,key:t,border:!0,canBeHovered:!0,selectable:!0,onClick:function(){return(t=e).owner_id>0&&(0,A.getVideos)(t.owner_id,[t.owner_id+"_"+t.id],!0).then((function(e){if(e.count>0){var n=e.items.filter((function(e){return e.id==t.id}));n.length>0&&(t.privacy_view=n[0].privacy_view,q(t),t.privacy_view&&H(t.privacy_view.category))}})),q(t),Q(r.MAIN),O(t.title),void B(t.description);var t},aside:o.createElement("span",{className:"TranslationCreateForm__videoLink"},y("calls_translation_select_video_link"))},o.createElement("div",{className:"TranslationCreateForm__videoImagePreview"},o.createElement("img",{className:"TranslationCreateForm__videoImage",src:e.image&&e.image[0]&&e.image[0].url?e.image[0].url:"",alt:e.title}),me(e)&&o.createElement("span",{className:"TranslationCreateForm__videoImageLabel"},me(e))),o.createElement("div",{className:"TranslationCreateForm__videoDescription"},o.createElement("div",{className:"TranslationCreateForm__videoTitle"},e.title),o.createElement("div",{className:"TranslationCreateForm__videoOwner"},function(e){if(!(e>0))return z.name;var t=de.filter((function(t){return t.id==e}));if(t.length>0){var n=t[0];if(n)return n.name}return""}(e.owner_id)),o.createElement("div",{className:"TranslationCreateForm__videoDate"},(a=(n=e).date,n.live_start_time&&(a=n.live_start_time),T(1e3*a)))));var n,a}))))))}!function(e){e.ONLY_ME="only_me",e.FRIENDS="friends",e.ALL="all"}(a||(a={})),function(e){e[e.MAIN=0]="MAIN",e[e.SELECT_POSTPONE=1]="SELECT_POSTPONE"}(r||(r={}))},942019:(e,t,n)=>{"use strict";n.d(t,{TranslationCreateModal:()=>c});var a=n(667294),r=n(881150),i=n(662208),o=n(138671),l=n(838480),s=n(774415);function c(e){var t=e.onClose,n=e.onSubmit,c=e.title,u=e.children,d=e.isWithBackButton,p=e.onBackClick,_=e.contentClassName,m=void 0===_?"TranslationCreateModal__content":_,f=a.useContext(i.LangContext).getLang,g=n&&t;return a.createElement(o.default,{disableBodyScroll:!0,onClose:t,className:"TranslationCreateModal",hasScroll:!1},a.createElement(l.ModalHeader,{title:c,onClose:t,backText:d?f("calls_back"):void 0,onBack:p}),a.createElement("div",{className:m},u),g&&a.createElement(s.ModalFooter,{actionButtons:a.createElement(a.Fragment,null,a.createElement(r.default,{onClick:t,appearance:"tertiary"},f("calls_cancel")),a.createElement(r.default,{onClick:n},f("calls_translation_start")))}))}},162144:(e,t,n)=>{"use strict";n.d(t,{TranslationLink:()=>u});var a=n(570655),r=n(667294),i=n(595775),o=n(881150),l=n(629142),s=n(58600),c=n(662208),u=function(e){var t=e.link,n=r.useContext(c.LangContext).getLang,u=(0,a.__read)((0,r.useState)(!1),2),d=u[0],p=u[1],_=(0,r.useCallback)((function(){return p(!0)}),[]),m=(0,r.useCallback)((function(){return p(!1)}),[]);return r.createElement("div",{className:"TranslationLink"},r.createElement("p",{className:"TranslationLink__info"},n("calls_translation_link_info")),r.createElement(i.default,{readOnly:"readonly",className:"TranslationLink__input",value:t}),t&&r.createElement(s.CopyText,{text:t,onCopyDone:_},r.createElement(o.default,null,n("calls_translation_link_copy"))),r.createElement(l.default,{className:"TranslationLink__copied",shown:d,callback:m},n("calls_translation_link_copied")))}},979414:(e,t,n)=>{"use strict";n.d(t,{TranslationStartCountdownModal:()=>l});var a=n(667294),r=n(138671),i=n(662208),o=n(881150),l=function(e){var t=e.onCloseModal,n=e.counter,l=e.onStopTranslation,s=a.useContext(i.LangContext).getLang;return a.createElement(r.default,{disableBackdropClick:!0,disableEscapeClose:!0,className:"TranslationStartCountdownModal",onClose:t},a.createElement("div",{className:"TranslationStartCountdownModal__content"},a.createElement("div",{className:"TranslationStartCountdownModal__counter"},n),a.createElement(o.default,{className:"TranslationStartCountdownModal__stop",onClick:l,appearance:"overlay_secondary"},s("calls_translation_cancel_button"))))}},880076:(e,t,n)=>{"use strict";n.d(t,{TranslationStatus:()=>u});var a=n(667294),r=n(801513),i=n(30933),o=n(659397),l=n(309739),s=n(607910),c=n(641221),u=function(e){var t=e.translationTimer,n=e.viewersCount,u=void 0===n?0:n,d=e.isLiveIndicatorOff,p=void 0!==d&&d,_=e.actions,m=void 0===_?[]:_,f=e.tooltipText,g=void 0===f?"":f,A=(0,o.classNames)("TranslationStatus__translationIndicator",{"TranslationStatus__translationIndicator--disabled":p}),v=(null==m?void 0:m.length)>0,h=(0,o.classNames)("TranslationStatus__translationTimer",{"TranslationStatus__translationTimer--hasIndicator":!p}),E=a.createElement("div",{className:"TranslationStatus__translation",key:"translation"},a.createElement(r.LiveIcon,{className:A}),a.createElement(a.Fragment,null,!!t&&a.createElement("div",{className:h},t),!p&&a.createElement("div",{className:"TranslationStatus__translationViewersCount"},a.createElement(i.ViewersCountIcon,null),a.createElement("div",{className:"TranslationStatus__translationViewersCountNumber"},u)),v&&a.createElement("div",{className:"TranslationStatus__translationDropdown"},a.createElement(s.TranslationStatusChevronIcon,null))));return v?E=a.createElement(l.default,{position:"b",align:"center",horizontalPosition:"right",trigger:"hover",marginLeft:-10,data:m,className:"TranslationStatus_dropdown"},E):g&&(E=a.createElement(c.TooltipNew,{content:a.createElement(a.Fragment,null,g)},E)),a.createElement("div",{className:"TranslationStatus"},E)}},389809:(e,t,n)=>{"use strict";n.d(t,{TranslationStopModal:()=>o});var a=n(667294),r=n(7692),i=n(662208),o=function(e){var t=e.onClose,n=e.actionButtons,o=a.useContext(i.LangContext).getLang;return a.createElement(r.default,{onClose:t,title:o("calls_translation_stop_confirmation"),appearance:"blue",actionButtons:n,className:"TranslationStopModal"},a.createElement("div",{className:"TranslationStopModal__text"},o("calls_translation_stop_sure")))}},904992:(e,t,n)=>{"use strict";n.d(t,{UnbanMembersModal:()=>l});var a=n(667294),r=n(7692),i=n(662208),o=n(685537),l=function(e){var t=e.onClose,n=e.actionButtons,l=e.description,s=e.subDescription,c=e.avatarsItems,u=(0,a.useContext)(i.LangContext).getLang;return a.createElement(r.default,{className:"UnbanMembersModal",appearance:"blue",title:u("calls_unban_participant_title"),actionButtons:n,onClose:t,hasScroll:!1},a.createElement("div",{className:"UnbanMembersModal__content"},a.createElement(o.AvatarsStack,{items:c}),a.createElement("div",{className:"UnbanMembersModal__description"},l),a.createElement("div",{className:"UnbanMembersModal__subDescription"},s)))}},860925:(e,t,n)=>{"use strict";n.d(t,{UnmuteRequestModal:()=>i});var a=n(667294),r=n(7692),i=function(e){var t=e.onClose,n=e.actionButtons,i=e.title,o=e.description;return a.createElement(r.default,{className:"UnmuteRequestModal",appearance:"blue",title:i,actionButtons:n,onClose:t},a.createElement("div",{className:"UnmuteRequestModal__content"},o))}},983179:(e,t,n)=>{"use strict";n.d(t,{UploadBackgroundErrorModal:()=>l});var a=n(667294),r=n(7692),i=n(881150),o=n(662208),l=function(e){var t=e.children,n=e.onClose,l=e.onSubmit,s=(0,a.useContext)(o.LangContext).getLang;return a.createElement(r.default,{onClose:n,title:s("calls_warning"),appearance:"blue",className:"UploadBackgroundErrorModal",actionButtons:a.createElement(a.Fragment,null,a.createElement(i.default,{onClick:n,appearance:"tertiary"},s("calls_cancel")),a.createElement(i.default,{onClick:l},s("calls_retry_action")))},a.createElement("div",{className:"UploadBackgroundErrorModal__content"},t))}},860228:(e,t,n)=>{"use strict";n.d(t,{UploadBackgroundPhoto:()=>l});var a=n(667294),r=n(662208),i=n(881150),o=n(760620),l=function(e){var t=e.onSubmit,n=e.loading,l=(0,a.useContext)(r.LangContext).getLang,s=(0,a.useRef)(null),c=(0,o.useFileReader)({$inputEl:s,onSubmit:t}),u=c.onClick,d=c.error,p=(0,a.useMemo)((function(){return(""+l("profile_oph_err_size")).replace("{sorry}","<b>"+l("global_sorry_error")+"</b>").replace("{min}","200").replace("{max}","7000")}),[]);return a.createElement("div",{className:"UploadBackgroundPhoto"},a.createElement("input",{ref:s,type:"file",className:"UploadBackgroundPhoto__upload"}),d&&a.createElement("div",{className:"UploadBackgroundPhoto__error"},a.createElement("div",{className:"UploadBackgroundPhoto__error__left"}),a.createElement("div",{className:"UploadBackgroundPhoto__error__right",dangerouslySetInnerHTML:{__html:p}})),a.createElement("div",{className:"UploadBackgroundPhoto__description",dangerouslySetInnerHTML:{__html:l("calls_you_can_upload_description")}}),!n&&a.createElement("div",{className:"UploadBackgroundPhoto__button"},a.createElement(i.default,{onClick:u},l("calls_choose_file"))),n&&a.createElement("div",{className:"UploadBackgroundPhoto__progress"}))}},760620:(e,t,n)=>{"use strict";n.d(t,{useFileReader:()=>o});var a=n(570655),r=n(667294),i=n(799401),o=function(e){var t=e.$inputEl,n=e.onSubmit,o=(0,a.__read)((0,r.useState)({}),2),l=o[0],s=o[1],c=(0,a.__read)((0,r.useState)(!1),2),u=c[0],d=c[1];return{error:u,fileData:l,onClick:(0,r.useCallback)((function(){t.current&&(t.current.onchange=function(e){var t;d(!1);var a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){var r=new FileReader;r.onload=function(){var e=new Image;e.onload=function(){(0,i.checkImageDimentions)(e)?(s({file:a,image:e}),n&&n(a)):d(!0)},e.onerror=function(){return d(!0)},e.src=r.result},r.onerror=function(){return d(!0)},r.readAsDataURL(a)}},t.current.click())}),[])}}},799401:(e,t,n)=>{"use strict";n.d(t,{checkImageDimentions:()=>a});var a=function(e){return(e.width>=510||e.width>7e3)&&(e.height>=200||e.height>7e3)}},654837:(e,t,n)=>{"use strict";n.d(t,{UploadBackgroundPhotoModal:()=>o});var a=n(667294),r=n(7692),i=n(662208),o=function(e){var t=e.children,n=e.onClose,o=(0,a.useContext)(i.LangContext).getLang;return a.createElement(r.default,{onClose:n,title:o("calls_upload_image_for_background"),appearance:"blue",className:"UploadBackgroundPhotoModal",footerHint:o("calls_if_you_have_problems_with_upload"),actionButtons:""},t)}},690128:(e,t,n)=>{"use strict";n.d(t,{UserBadge:()=>o});var a=n(667294),r=n(659397),i=n(995811),o=function(e){var t=e.className,n=e.type;return a.createElement("div",{className:(0,r.classNames)("UserBadge","UserBadge--"+n,t)},a.createElement(i.StarIcon,null))}},952152:(e,t,n)=>{"use strict";n.d(t,{Video:()=>l});var a=n(667294),r=n(659397),i=n(604233),o=new WeakMap,l=(0,a.memo)((function(e){var t=e.stream,n=e.isMirrored,l=void 0!==n&&n,s=e.isContained,c=void 0!==s&&s,u=e.isStartWithVisible,d=void 0!==u&&u,p=e.className,_=a.useRef(null),m=a.useRef(null),f=a.useRef(t);return a.useEffect((function(){var e,n,a,s;if(!(null===(e=_.current)||void 0===e?void 0:e.lastElementChild)||f.current!==t){var u=d;if(t&&(o.has(t)?null===(null===(n=o.get(t))||void 0===n?void 0:n.closest("body"))?(m.current=null!==(a=o.get(t))&&void 0!==a?a:null,u=!0):m.current=(0,i.createVideoTag)(t):(m.current=(0,i.createVideoTag)(t),o.set(t,m.current))),m.current&&_.current&&_.current.lastElementChild!==m.current){var p=(0,r.classNames)("Video",{"Video--contain":c,"Video--mirrored":l,"Video--visible":u||(null===(s=m.current)||void 0===s?void 0:s.classList.contains("Video--visible"))});_.current.lastElementChild&&(_.current.innerHTML=""),m.current.className=p,_.current.appendChild(m.current),m.current.play()}return function(){m.current&&m.current!==o.get(t)&&(m.current.srcObject=null,m.current.src="",m.current.pause(),m.current.removeAttribute("src"),m.current.load()),_.current&&(_.current.innerHTML="")}}}),[t,_.current]),(0,a.useEffect)((function(){m.current&&m.current.classList.toggle("Video--mirrored",l)}),[l]),a.createElement("div",{ref:_,className:p})}))},161010:(e,t,n)=>{"use strict";n.d(t,{CarouselItem:()=>r});var a=n(667294),r=(0,a.memo)((function(e){var t=e.onClick,n=e.id,r=e.content;return a.createElement("div",{className:"VirtualBackgroundSettingsCarousel__Item",onClick:function(){return null==t?void 0:t(n)}},r)}))},13912:(e,t,n)=>{"use strict";n.d(t,{ClearCanvas:()=>a});var a=function(){function e(e){this.$c=e,this.gl=this.$c.getContext("webgl")}return e.prototype.draw=function(){var e=this.gl;null==e||e.clearColor(0,0,0,0),null==e||e.clear(e.COLOR_BUFFER_BIT)},e}()},955590:(e,t,n)=>{"use strict";n.d(t,{ItemAddImage:()=>o});var a=n(667294),r=n(945873),i=n(659397),o=(0,a.memo)((function(){return a.createElement("div",{className:(0,i.classNames)("VirtualBackgroundSettings__item","VirtualBackgroundSettings__item--add-image")},a.createElement(r.AddImageIcon,null))}))},173001:(e,t,n)=>{"use strict";n.d(t,{ItemBackground:()=>d});var a=n(570655),r=n(667294),i=n(659397),o=n(324604),l=n(641221),s=n(827491),c=n(662208),u=n(20845),d=(0,r.memo)((function(e){var t=e.backgroundUrl,n=e.checked,d=e.onDelete,p=e.photoId,_=e.isPredefinedBackground,m=e.isStarBackground,f=(0,a.__rest)(e,["backgroundUrl","checked","onDelete","photoId","isPredefinedBackground","isStarBackground"]),g=(0,r.useContext)(c.LangContext).getLang,A=(0,r.useRef)(null),v=(0,a.__read)((0,r.useState)(!0),2),h=v[0],E=v[1],C=(0,r.useMemo)((function(){return r.createElement("div",{dangerouslySetInnerHTML:{__html:g(n?"calls_cant_remove_background":"calls_delete_background")}})}),[n]),S=(0,r.useCallback)((function(e){e.stopPropagation(),n||d(p)}),[n,p]);return(0,r.useEffect)((function(){var e,n;return A.current&&(e=new IntersectionObserver((function(r){var i,o;try{for(var l=(0,a.__values)(r),s=l.next();!s.done;s=l.next()){s.value.isIntersecting&&(e.disconnect(),(n=new Image).src=t,n.onload=function(){E(!1),n.remove()})}}catch(e){i={error:e}}finally{try{s&&!s.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}}),{threshold:0,root:null})).observe(A.current),function(){n&&(n.onload=null,n.remove()),null==e||e.disconnect()}}),[]),r.createElement(o.WithRadioButton,(0,a.__assign)({},f,{checked:n,className:(0,i.classNames)("VirtualBackgroundSettings__item","VirtualBackgroundSettings__item--background",{"VirtualBackgroundSettings__item--background-star":!h&&!!m}),passedRef:A,style:{backgroundImage:h?void 0:"url("+t+")"}}),h&&r.createElement(u.DivBlockSkeleton,{classNames:"VirtualBackgroundSettings__item--background__skeleton",height:80}),!_&&!h&&r.createElement("div",{className:(0,i.classNames)("VirtualBackgroundSettings__item--background__deletebtn",{"VirtualBackgroundSettings__item--background__deletebtn--disabled":n}),onClick:S},r.createElement(l.TooltipNew,{content:C,className:"VirtualBackgroundSettings__item__popper",position:"t",align:"center"},r.createElement(s.DeleteBackgroundIcon,null))))}))},667517:(e,t,n)=>{"use strict";n.d(t,{ItemBlur:()=>l});var a=n(570655),r=n(667294),i=n(659397),o=n(324604),l=(0,r.memo)((function(e){return r.createElement(o.WithRadioButton,(0,a.__assign)({},e,{className:(0,i.classNames)("VirtualBackgroundSettings__item","VirtualBackgroundSettings__item--blur")}))}))},290949:(e,t,n)=>{"use strict";n.d(t,{ItemNoBackground:()=>s});var a=n(570655),r=n(667294),i=n(659397),o=n(662208),l=n(324604),s=(0,r.memo)((function(e){var t=(0,r.useContext)(o.LangContext).getLang;return r.createElement(l.WithRadioButton,(0,a.__assign)({},e,{className:(0,i.classNames)("VirtualBackgroundSettings__item","VirtualBackgroundSettings__item--with-border")}),t("calls_virtual_background_settings_no_background"))}))},32351:(e,t,n)=>{"use strict";n.d(t,{PredefinedBackground:()=>a});var a=function(){function e(e){this.params=e}return e.prototype.getMappedParams=function(){return{id:this.params.id,originalUrl:this.params.original,previewUrl:this.params.preview,isPredefined:!0,tags:this.params.tags}},e}()},536228:(e,t,n)=>{"use strict";n.d(t,{VirtualBackgroundSettings:()=>f});var a=n(667294),r=n(659397),i=n(662208),o=n(821244),l=n(588283),s=n(530928),c=n(551974),u=n(916353),d=n(881150),p=n(220583),_=n(32491),m=n(161010),f=function(e){var t=e.backgroundList,n=e.onDeleteBackground,f=e.onChooseBackground,g=e.chosen,A=e.videoOptions,v=(0,a.useContext)(i.LangContext).getLang,h=(0,c.useUserMediaStream)(u.defaultConstraints),E=h.userStream,C=h.error,S=h.updateUserMediaStream,y=(0,o.useCurrentUserVideoElement)({userStream:E}).$video,T=(0,s.useVideoEffects)({backgroundList:t,$srcElement:y,userStream:E}),I=T.$canvas,b=T.onUpdateVideoEffectsSettings,N=T.isPlaying,w=(0,l.useCarouselItems)({backgroundList:t,onDeleteBackground:n,onUpdateVideoEffectsSettings:b,onChooseBackground:f,chosen:g}).carouselItems;return a.createElement("div",{className:"VirtualBackgroundSettings"},a.createElement("div",{className:"VirtualBackgroundSettings__userStream"},E&&a.createElement("video",{className:(0,r.classNames)("Video",{"Video--visible":!N},"Video--contain",{"Video--mirrored":A[_.EVideoOptionType.IS_VIDEO_MIRRORED]}),ref:y,controls:!1,crossOrigin:"anonymous",playsInline:!0,muted:!0,autoPlay:!0},"Video tag is not supported"),a.createElement("canvas",{ref:I,className:(0,r.classNames)("VirtualBackgroundSettings__userCanvas",{"VirtualBackgroundSettings__userCanvas--mirrored":A[_.EVideoOptionType.IS_VIDEO_MIRRORED]},{"VirtualBackgroundSettings__userCanvas--playing":N})}),C&&a.createElement("div",{className:"VirtualBackgroundSettings__error"},a.createElement("div",null,v("profile_no_camera_access")),a.createElement("div",null,a.createElement(d.default,{className:"VirtualBackgroundSettings__error__btn",size:"m",onClick:S},v("calls_button_allow_access"))))),a.createElement("div",{className:"VirtualBackgroundSettings__carousel__modalFix"},a.createElement("div",{className:"VirtualBackgroundSettings__carousel"},w.map((function(e){return a.createElement(m.CarouselItem,{key:e.id,id:e.id,onClick:e.onClick,content:e.content})}))),a.createElement(p.BorderCornerIcon,{className:"VirtualBackgroundSettings__carousel__cornerIcon"})))}},324604:(e,t,n)=>{"use strict";n.d(t,{WithRadioButton:()=>l});var a=n(570655),r=n(667294),i=n(62738),o=n(659397),l=function(e){var t=e.children,n=e.className,l=e.style,s=e.passedRef,c=(0,a.__rest)(e,["children","className","style","passedRef"]),u=(0,r.useCallback)((function(){}),[]);return r.createElement(r.Fragment,null,r.createElement("div",{className:(0,o.classNames)(n),style:l,ref:s},t),r.createElement("div",{className:"VirtualBackgroundSettings__item--radio"},r.createElement(i.default,(0,a.__assign)({},c,{onChange:u}))))}},916353:(e,t,n)=>{"use strict";n.d(t,{WIDTH:()=>o,HEIGHT:()=>l,defaultConstraints:()=>s,predefinedBackgrounds:()=>c});var a=n(570655),r=n(465127),i=n(32351),o=436,l=250,s=[{audio:!1,video:{frameRate:25,height:l,width:o}},{audio:!1,video:{frameRate:25}},{audio:!1,video:!0}],c=function(){var e,t,n=new Map;[3019,3026,3023,3024,3025,3020,3021,3022,3015,3013,3016,3012,3014,3017,3018].forEach((function(e){return n.set(e,null)}));try{for(var o=(0,a.__values)(r.Links.backgrounds),l=o.next();!l.done;l=o.next()){var s=l.value;n.has(s.id)&&n.set(s.id,new i.PredefinedBackground(s))}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return(0,a.__spreadArray)([],(0,a.__read)(n.values())).filter(Boolean)}()},20832:(e,t,n)=>{"use strict";n.d(t,{useBackgroundEffects:()=>o});var a=n(667294),r=n(465127),i=n(121255),o=function(e){var t=e.SDK,n=(0,a.useMemo)((function(){return{background:new r.EffectBackground,blur:new r.EffectBlur,effect:new r.VideoEffects({debug:!0})}}),[]);return(0,a.useEffect)((function(){return t.setVideoEffects(n.effect),function(){n.effect.destroy()}}),[]),{onSettingsChange:(0,a.useCallback)((function(e){switch(e.type){case i.EVideoEffectType.BACKGROUND:n.background.setBackgroundImage(e.value).then((function(){t.changeVideoEffect(n.background)}));break;case i.EVideoEffectType.BLUR:t.changeVideoEffect(n.blur);break;case i.EVideoEffectType.NONE:t.changeVideoEffect(null);break;case i.EVideoEffectType.ADD:}}),[])}}},72675:(e,t,n)=>{"use strict";n.d(t,{useBackgroundsList:()=>s});var a=n(570655),r=n(667294),i=n(32351),o=n(916353),l=n(739735),s=function(e){var t=e.photos;return{backgroundList:(0,r.useMemo)((function(){return(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(t)),(0,a.__read)(o.predefinedBackgrounds)).map((function(e){return e instanceof i.PredefinedBackground?e.getMappedParams():{id:e.id,originalUrl:(0,l.getMaxPhotoSizeUrl)(e),previewUrl:(0,l.getPreviewPhotoSizeUrl)(e),isPredefined:!1}}))}),[t])}}},588283:(e,t,n)=>{"use strict";n.d(t,{useCarouselItems:()=>d});var a=n(570655),r=n(667294),i=n(290949),o=n(667517),l=n(955590),s=n(173001),c=n(121255),u=n(569422),d=function(e){var t=e.onDeleteBackground,n=e.backgroundList,d=e.chosen,p=e.onUpdateVideoEffectsSettings,_=e.onChooseBackground,m=(0,u.useIsAnonymous)().isAnonymous;(0,r.useEffect)((function(){d!==c.EVideoEffectType.NONE&&p(d)}),[]);var f=(0,r.useCallback)((function(e){_(e),p(e)}),[_,p]),g=(0,r.useMemo)((function(){return n.map((function(e){var n;return{id:e.id,onClick:f,content:r.createElement(s.ItemBackground,{checked:d===e.id,backgroundUrl:e.previewUrl,onDelete:t,photoId:e.id,isPredefinedBackground:e.isPredefined,isStarBackground:null===(n=e.tags)||void 0===n?void 0:n.includes("star")})}}))}),[d,n,f]);return{carouselItems:(0,r.useMemo)((function(){var e=[{id:c.EVideoEffectType.NONE,onClick:f,content:r.createElement(i.ItemNoBackground,{checked:d===c.EVideoEffectType.NONE})},{id:c.EVideoEffectType.BLUR,onClick:f,content:r.createElement(o.ItemBlur,{checked:d===c.EVideoEffectType.BLUR})}];return m||e.push({id:c.EVideoEffectType.ADD,onClick:f,content:r.createElement(l.ItemAddImage,null)}),e.push.apply(e,(0,a.__spreadArray)([],(0,a.__read)(g))),e}),[d,g,f])}}},821244:(e,t,n)=>{"use strict";n.d(t,{useCurrentUserVideoElement:()=>i});var a=n(667294),r=n(739735),i=function(e){var t=e.userStream,n=(0,a.useRef)(null);return(0,a.useEffect)((function(){if(t&&n.current){var e=(0,r.getMediaStreamDimentions)(t),a=e.height,i=e.width;n.current.height=a,n.current.width=i,n.current.srcObject=t}}),[t]),{$video:n}}},363220:(e,t,n)=>{"use strict";n.d(t,{useInitialBackgroundEffect:()=>s});var a=n(667294),r=n(739735),i=n(121255),o=n(223724),l=n(70049),s=function(e){var t=e.userStream,n=e.onSettingsChange,s=e.backgroundList,c=e.isVideoEnabled,u=(0,l.useSendStatsDataVirtualBackground)(),d=u.sendVirtualBackgroundSelected,p=u.sendVirtualBackgroundDisabled;(0,a.useEffect)((function(){if(t){var e=o.effectStorage.getEffect();c?"number"==typeof e?(0,r.getPhotoById)(e,s).then((function(t){t&&(n({type:i.EVideoEffectType.BACKGROUND,value:t.url}),d(t.id,e))})):e===i.EVideoEffectType.BLUR&&(n({type:i.EVideoEffectType.BLUR}),d(i.VIRTUAL_BACKGROUND_BLUR_ID,e)):(n({type:i.EVideoEffectType.NONE}),p(e))}}),[t,c])}},591172:(e,t,n)=>{"use strict";n.d(t,{useSavedSettings:()=>s});var a=n(667294),r=n(121255),i=n(223724),o=n(739735),l=n(70049),s=function(e){var t=e.chosen,n=e.settingsOpened,s=e.onSettingsChange,c=e.setChosen,u=e.backgroundList,d=e.isVideoEnabled,p=(0,l.useSendStatsDataVirtualBackground)(),_=p.sendVirtualBackgroundSelected,m=p.sendVirtualBackgroundDisabled,f=(0,a.useRef)(null);return(0,a.useEffect)((function(){n&&(f.current=t)}),[n]),{onApplySettings:(0,a.useCallback)((function(){if(f.current!==t){var e=i.effectStorage.getEffect();i.effectStorage.saveEffect(t),"number"==typeof t?(0,o.getPhotoById)(t,u).then((function(t){t&&(s({type:r.EVideoEffectType.BACKGROUND,value:t.url}),d&&_(t.id,e))})):t===r.EVideoEffectType.BLUR?(s({type:r.EVideoEffectType.BLUR}),d&&_(r.VIRTUAL_BACKGROUND_BLUR_ID,e)):t===r.EVideoEffectType.NONE&&(s({type:r.EVideoEffectType.NONE}),d&&m(e))}}),[s,u,t,_,m,d]),onRestoreSettings:(0,a.useCallback)((function(){f.current&&c(f.current)}),[c])}}},116930:(e,t,n)=>{"use strict";n.d(t,{useSettingsItems:()=>s});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(223724),s=function(e){var t=e.backgroundList,n=(0,i.useDispatch)(),s=(0,a.__read)((0,r.useState)(l.effectStorage.getEffect),2),c=s[0],u=s[1],d=(0,r.useCallback)((function(e){switch(e){case o.EVideoEffectType.BLUR:u(e);break;case o.EVideoEffectType.ADD:n({type:o.TOGGLE_POPUP,data:o.POPUP_UPLOAD_BACKGROUND_PHOTO});break;case o.EVideoEffectType.NONE:u(e);break;default:t.some((function(t){return t.id===e}))&&u(e)}}),[t]),p=(0,r.useRef)(null),_=(0,r.useCallback)((function(e){return p.current=e}),[]);return(0,r.useEffect)((function(){p.current&&(d(p.current.id),p.current=null)}),[d]),{chosen:c,setChosen:u,onClick:d,onSuccessPhotoUpload:_}}},530928:(e,t,n)=>{"use strict";n.d(t,{useVideoEffects:()=>u});var a=n(570655),r=n(667294),i=n(465127),o=n(916353),l=n(739735),s=n(121255),c=n(13912),u=function(e){var t=e.backgroundList,n=e.$srcElement,u=e.userStream,d=(0,r.useRef)(null),p=(0,r.useRef)(null),_=(0,r.useRef)(null),m=(0,r.useRef)(null);null===m.current&&(m.current=new i.ImageEdit);var f=(0,r.useRef)(null),g=(0,r.useRef)(s.EVideoEffectType.NONE),A=(0,r.useRef)(s.EVideoEffectType.NONE),v=(0,r.useRef)(void 0),h=(0,r.useRef)(null),E=(0,r.useRef)(null),C=(0,r.useRef)(!1),S=(0,a.__read)((0,r.useState)(!1),2),y=S[0],T=S[1],I=(0,r.useCallback)((function(e){C.current="play"===e,T("play"===e)}),[]),b=(0,r.useCallback)((function(e,t){void 0===t&&(t=!1),A.current=e,t||(g.current=e)}),[]),N=(0,r.useCallback)((function(){if(h.current&&clearTimeout(h.current),C.current)if(n.current&&p.current)try{p.current.requestSegmentation(n.current)}catch(e){console.error("[useVideoEffects][onRequestSegmentation][error]",e)}else h.current=setTimeout((function(){N()}),300)}),[]),w=(0,r.useCallback)((function(e){var n,a;if(null===(n=d.current)||void 0===n?void 0:n.isReady)switch(e){case s.EVideoEffectType.ADD:break;case s.EVideoEffectType.BLUR:b(e),v.current&&(v.current=void 0),C.current||(I("play"),N());break;case s.EVideoEffectType.NONE:b(e),v.current&&(v.current=void 0),null===(a=f.current)||void 0===a||a.draw(),I("stop");break;default:var r=t.find((function(t){return t.id===e}));r&&(b(e,!0),(0,l.loadImage)(r.originalUrl).then((function(t){if(!d.current)throw new Error("output canvas is not initialized");if(!m.current)throw new Error("ImageEdit class is not initialized");if(A.current!==e)throw new Error("Settings changed during load");var n=d.current,a=n.width,r=n.height;return m.current.resize(t,a,r)})).then((function(t){if(A.current!==e)throw new Error("Settings changed during load");b(e),v.current=t,C.current||(I("play"),N())})).catch(console.warn))}else E.current=function(){w(e)}}),[t]),L=(0,r.useCallback)((function(e){switch(g.current){case s.EVideoEffectType.ADD:case s.EVideoEffectType.NONE:break;case s.EVideoEffectType.BLUR:requestAnimationFrame((function(){var t;null===(t=_.current)||void 0===t||t.draw(e),C.current&&N()}));break;default:requestAnimationFrame((function(){var t,n=Object.assign({background:v.current},e);null===(t=_.current)||void 0===t||t.draw(n),C.current&&N()}))}}),[]);return(0,r.useEffect)((function(){var e;if(u){if(d.current){var t=u.getVideoTracks()[0].getSettings(),n=t.width,r=t.height;d.current.width=n||o.WIDTH,d.current.height=r||o.HEIGHT,d.current.isReady=!0,null===(e=E.current)||void 0===e||e.call(E);_.current=new i.BlurFastWithMask(d.current),f.current=new c.ClearCanvas(d.current);var l=new Promise((function(e,t){new i.Segmentation({onReady:e,onError:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.warn.apply(console,(0,a.__spreadArray)([],(0,a.__read)(e))),t()},onFrame:L}).createModel(!0)})).then((function(e){return p.current=e,e})).catch((function(){p.current=null}));return function(){var e,t;null===(e=_.current)||void 0===e||e.close(),null===(t=p.current)||void 0===t||t.destroy(),l.then((function(e){e&&e.destroy()})),_.current=null,p.current=null,E.current=null}}console.error("[useVideoEffects][on-userStream-update] canvas is not initialized")}}),[u]),{$canvas:d,onRequestSegmentation:N,onUpdateVideoEffectsSettings:w,isPlaying:y}}},739735:(e,t,n)=>{"use strict";n.d(t,{getMaxPhotoSizeUrl:()=>l,getPreviewPhotoSizeUrl:()=>s,getPhotoById:()=>c,getMediaStreamDimentions:()=>u,loadImage:()=>d});var a=n(570655),r=n(329538),i=n(916353),o=function(e){var t;return null===(t=e.sizes)||void 0===t?void 0:t.reduce((function(e,t){return e[t.type]=t.url,e}),{})},l=function(e){var t=o(e);return(null==t?void 0:t.x)||(null==t?void 0:t.m)||(null==t?void 0:t.s)||""},s=function(e){var t=o(e);return(null==t?void 0:t.o)||(null==t?void 0:t.p)||(null==t?void 0:t.q)||(null==t?void 0:t.x)||(null==t?void 0:t.s)||""},c=function(e,t){if(t){var n=t.find((function(t){return t.id===e}));if(n)return Promise.resolve({id:n.id,url:n.originalUrl})}return(0,r.photosGetAllImages)({photo_ids:""+e}).then((function(e){try{var t=e.items[0];return t?{id:t.id,url:l(t)}:null}catch(e){return null}}))},u=function(e){var t=e.getVideoTracks()[0].getSettings(),n=t.width,a=void 0===n?i.WIDTH:n,r=t.height;return{width:a,height:void 0===r?i.HEIGHT:r}},d=function(e){return(0,a.__awaiter)(void 0,void 0,Promise,(function(){return(0,a.__generator)(this,(function(t){return[2,new Promise((function(t,n){var a=document.createElement("img");a.crossOrigin="anonymous",a.onerror=function(e){n("Failed image loading: "+e)},a.onload=function(){return t(a)},a.src=e}))]}))}))}},288540:(e,t,n)=>{"use strict";n.d(t,{VirtualBackgroundSettingsModal:()=>c});var a=n(667294),r=n(7692),i=n(881150),o=n(731585),l=n(662208),s=n(32491),c=function(e){var t=e.onClose,n=e.onSubmit,c=e.children,u=e.onChangeVideoOption,d=e.videoOptions,p=(0,a.useContext)(l.LangContext).getLang;return a.createElement(r.default,{onClose:t,title:p("calls_virtual_background"),appearance:"blue",disableEscapeClose:!0,actionButtons:a.createElement(a.Fragment,null,a.createElement("div",{className:"VirtualBackgroundSettings__options"},a.createElement(o.default,{checked:!!d[s.EVideoOptionType.IS_VIDEO_MIRRORED],name:s.EVideoOptionType.IS_VIDEO_MIRRORED,onChange:u},p("calls_mirror_display_view"))),a.createElement(i.default,{onClick:t,appearance:"tertiary"},p("calls_cancel")),a.createElement(i.default,{onClick:n},p("calls_save"))),className:"VirtualBackgroundSettingsModal"},c)}},449587:(e,t,n)=>{"use strict";n.d(t,{VolumeMeterAnimation:()=>i});var a=n(667294),r=n(911099),i=function(){var e=(0,r.classNames)("VolumeMeterAnimation","VolumeMeterAnimation--withAnimation");return a.createElement("div",{className:e})}},100741:(e,t,n)=>{"use strict";n.d(t,{WaitingHall:()=>i});var a=n(667294),r=n(75794),i=function(e){var t=e.id,n=e.name,i=e.letter,o=e.hasAudio,l=e.hasVideo,s=e.stream,c=e.wasConnected;return a.createElement("div",{className:"WaitingHall"},a.createElement("main",{className:"WaitingHall__main"},a.createElement(r.Participant,{id:t,hasVideo:l,hasAudio:o,isSharingScreen:!1,stream:s,isMe:!0,name:n,letter:i,allowContain:!0,wasConnected:c,networkStatus:1})))}},51443:(e,t,n)=>{"use strict";n.d(t,{WaitingHallInfo:()=>r});var a=n(667294),r=function(e){var t=e.text;return a.createElement("div",{className:"WaitingHallInfo"},a.createElement("div",{className:"WaitingHallInfo__text"},t))}},428990:(e,t,n)=>{"use strict";n.d(t,{WaitingHallList:()=>d});var a=n(667294),r=n(295886),i=n(662208),o=n(248586),l=n(279060),s=n(750598),c=n(881150),u=n(670546),d=function(e){var t=e.members,n=void 0===t?[]:t,d=e.totalCount,p=void 0===d?0:d,_=e.navigateToProfile,m=e.onPromote,f=e.onForbid,g=a.useContext(i.LangContext).getLang;return 0===n.length?a.createElement(a.Fragment,null):a.createElement(a.Fragment,null,a.createElement(r.ListHeader,{extra:p||""},g("calls_waiting_hall_list_header")),a.createElement(u.default,{border:!1,className:"CallParticipantList__list CallParticipantList__list--waitingList"},n.map((function(e){return a.createElement(s.default,{selectable:!1,border:!1,key:e.peerId,aside:a.createElement(a.Fragment,null,a.createElement(c.default,{onClick:function(){return f(e.peerId)},appearance:"secondary"},g("calls_waiting_hall_forbid")),a.createElement(c.default,{onClick:function(){return m(e.peerId)}},g("calls_waiting_hall_join")))},a.createElement(o.default,{onLinkClick:_,photo:a.createElement(l.CallPhoto,{id:e.peerId,photo:e.photo,alt:e.name||""}),title:e.name,href:e.link,target:"_blank"}))}))))}},94885:(e,t,n)=>{"use strict";n.d(t,{WarningDesktopApp:()=>m});var a=n(570655),r=n(667294),i=n(410902),o=n(700881),l=n(881150),s=n(662208),c=n(153907),u=n(121255),d=n(233194),p=n(659397),_=n(865203),m=function(e){var t=e.onClose,n=e.onClickJoin,m=r.useContext(s.LangContext).getLang,f=(0,c.getPlatformUrl)(),g=d.Platform.OS===d.OS.LINUX?"Linux":d.Platform.OS===d.OS.MAC?"macOS":d.Platform.OS===d.OS.WINDOWS?"Windows":null,A=(0,a.__read)((0,r.useState)(null!==p.localStorage.getItem(u.LOCALSTORAGE_IS_CALLS_APP_DOWNLOADED)),2),v=A[0],h=A[1],E=g?m("calls_warning_native_app_button_for").replace("{name}",g):m("calls_warning_native_app_button"),C=null===g||d.Platform.BROWSER===d.BROWSER.FIREFOX;return r.createElement("div",{className:"WarningDesktopApp"},r.createElement(i.default,{fill:"#FF5C5C"}),r.createElement("span",{className:"WarningDesktopApp--title"},m("calls_warning_native_app_title")),r.createElement("span",{className:"WarningDesktopApp--text"},m("calls_warning_native_app_text")),!v&&!C&&r.createElement(l.default,{onClick:function(){f&&((0,c.download)(f.url,f.filename),(0,c.setDownloadedFlag)(),h(!0))},appearance:"overlay_primary"},E),!v&&C&&r.createElement("a",{href:u.DESKTOP_CALLS_DOWNLOAD_PAGE,rel:"noopener noreferrer",target:"_blank",className:"WarningDesktopApp--link",onClick:function(){(0,c.setDownloadedFlag)(),h(!0)}},E,"  ",r.createElement(_.AngleIcon,{className:"NotificationDesktopApp--angleIcon"})),v&&r.createElement(l.default,{onClick:n,appearance:"overlay_primary"},m("calls_warning_native_app_join_button")),r.createElement(o.default,{className:"WarningDesktopApp--close",onClick:t,width:16,height:16}))}},782605:(e,t,n)=>{"use strict";n.d(t,{AddParticipantContainer:()=>h});var a,r=n(570655),i=n(667294),o=n(50533),l=n(121255),s=n(587551),c=n(697483),u=n(389953),d=n(431469),p=n(152205),_=n(662208),m=n(788822),f=n(820717),g=n(745284),A=function(e){return e?(0,m.escape)(e.replace(/\t/g,"\n")):""},v=!1,h=function(e){var t=e.onChange,n=e.onClickCallAll,u=e.groupId,m=(0,o.useSelector)((function(e){return e})),h=i.useContext(_.LangContext).getLang,T=(0,o.useDispatch)(),I=(0,r.__read)((0,i.useState)(""),2),b=I[0],N=I[1],w=(0,r.__read)((0,i.useState)({}),2),L=w[0],P=w[1],k=(0,r.__read)((0,i.useState)(!1),2),M=k[0],O=k[1],D=(0,r.__read)((0,i.useState)(!1),2),R=D[0],B=D[1],x=(0,r.__read)((0,i.useState)(!1),2),U=x[0],H=x[1],G=(0,r.__read)((0,i.useState)(E(m.chatMembers,u?[]:m.friends)),1)[0],V=(0,r.__read)((0,i.useState)(C(m.chatMembers,G,m.groupMembers)),2),F=V[0],W=V[1],z=(0,r.__read)((0,i.useState)(E(m.chatMembers,m.groupMembers)),2),j=z[0],K=z[1],Y=(m.preselectedIds||[]).filter((function(e){return!(0,c.isParticipantAnonym)(e)&&F[e]})),Q=(0,r.__read)((0,i.useState)(Y),2),Z=Q[0],J=Q[1],q=(0,r.__read)((0,i.useState)(!1),2),X=q[0],$=q[1],ee=(0,i.useCallback)((function(e){return e.name}),[]),te=(0,i.useCallback)((function(e){return e.peerId}),[]),ne=(0,d.useIndexer)((0,r.__spreadArray)((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(m.chatMembers)),(0,r.__read)(G)),(0,r.__read)(j)),ee,te),ae=m.groupMembersCount>l.COUNT_OF_GROUP_MEMBERS_TO_LOAD,re=(0,i.useCallback)((function(e){if(e){var t=ne.search(e);if(v){var n={};return t.forEach((function(e){n[e.id]=e})),Object.values(n)}return t}return function(e,t,n,a,i,o,s,c,u){var d=5,p=10,_=10,m={type:l.SearchResultType.MEMBERS_MORE,text:u("calls_show_all_members")},f={type:l.SearchResultType.FRIENDS_MORE,text:u("calls_show_all_friends")},g={type:l.SearchResultType.GROUP_MEMBERS_MORE,text:u("calls_show_all_group_members")},A={type:l.SearchResultType.HEADER,text:u("calls_chat_members"),count:e.length},v={type:l.SearchResultType.HEADER,text:u("calls_chat_group_members"),count:s},h={type:l.SearchResultType.HEADER,text:u("calls_friends")},E={type:l.SearchResultType.CALL_ALL_IN_CHAT,text:u("calls_call_all")},C=[];if(e.length>0)if(C.push(A),e.length<=c&&C.push(E),a||e.length<=d)C.push.apply(C,(0,r.__spreadArray)([],(0,r.__read)(e)));else{for(var S=0;S<d;S++)C.push(e[S]);C.push(m)}if(t.length>0)if(C.push(h),i||t.length<=p)C.push.apply(C,(0,r.__spreadArray)([],(0,r.__read)(t)));else{for(S=0;S<p;S++)C.push(t[S]);C.push(f)}if(n.length>0)if(C.push(v),o||n.length<=_)C.push.apply(C,(0,r.__spreadArray)([],(0,r.__read)(n)));else{for(S=0;S<_;S++)C.push(n[S]);C.push(g)}return C}(m.chatMembers,G,j,M,R,U,m.groupMembersCount,m.participantLimit,h)}),[m,M,R,U]),ie=(0,r.__read)((0,i.useState)(re(b)),2),oe=ie[0],le=ie[1],se=function(e){J(e),t(e)},ce=(0,i.useCallback)((function(e){return se((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(Z)),[+e]))}),[Z]),ue=(0,i.useCallback)((function(e){return se(Z.filter((function(t){return t!==+e})))}),[Z]),de=(0,c.getActiveParticipants)(m,!0).map((function(e){return{id:e.peerId.toString(),text:A(e.name),locked:!0}})).concat(Z.map((function(e){return{text:A(F[e].name),id:e.toString(),locked:!1}})));(0,i.useEffect)((function(){P(Z.reduce((function(e,t){return e[t]=!0,e}),{}))}),[]),(0,i.useEffect)((function(){le(re(b))}),[Z,M,R,U]),(0,i.useEffect)((function(){var e=b;return ae&&(e.length>=3&&!X?a=setTimeout((function(){(0,f.serverSearchGroupMembers)(-m.groupId,e,m,T).then((function(t){if($(!1),t.length>0){v=!0;var n=(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(j)),(0,r.__read)(t));K(E(m.chatMembers,n)),W(C(m.chatMembers,G,n)),t.forEach((function(e){ne.add(e)})),le(re(e))}}))}),1e3):a&&($(!1),clearTimeout(a))),function(){clearTimeout(a)}}),[b]);var pe=(0,i.useCallback)((function(e){N(e.target.value),le(re(e.target.value))}),[]),_e=(0,i.useCallback)((function(e){var t;return ue(e),P((0,r.__assign)((0,r.__assign)({},L),((t={})[e]=!1,t))),Promise.resolve()}),[L]),me=(0,i.useCallback)((function(e){var t,n;return S(e,m,L)?(ue(e),P((0,r.__assign)((0,r.__assign)({},L),((t={})[e]=!1,t)))):y(F[e],m,de,L,(0,g.isAuthedByGroupId)(m))||(ce(e),P((0,r.__assign)((0,r.__assign)({},L),((n={})[e]=!0,n))),N(""),le(re(""))),Promise.resolve()}),[Z,m,L]),fe=(0,i.useCallback)((function(){var e=(0,c.getActiveParticipants)(m,!0).reduce((function(e,t){return e[t.peerId]=!0,e}),{}),t=m.chatMembers.reduce((function(t,n){var a=n.peerId;return e[a]||y(n,m,de,L,(0,g.isAuthedByGroupId)(m))||t.push(a),t}),[]);n(t)}),[m,Z,L]),ge=(0,i.useCallback)((function(e,t){if(!("type"in e))return t;switch(e.type){case l.SearchResultType.CALL_ALL_IN_CHAT:return function(){return fe()};case l.SearchResultType.MEMBERS_MORE:return function(){return O(!0)};case l.SearchResultType.FRIENDS_MORE:return function(){return B(!0)};case l.SearchResultType.GROUP_MEMBERS_MORE:return function(){return H(!0)};default:return function(){}}}),[fe]);return i.createElement(s.CallsMultiSelect,{tokens:de,onRemoveToken:_e,value:b,onChange:pe,onSelect:me,renderSuggest:function(e,t){return function(e,t){var n="peerId"in e?e.peerId:0;return i.createElement(p.CallsSearchResult,{data:e,onClick:ge(e,t),selected:S(n,m,L),disabled:y(F[n],m,de,L,(0,g.isAuthedByGroupId)(m)),key:n||"text"in e&&e.text||void 0})}(e,t)},data:oe})};function E(e,t){var n=e.reduce((function(e,t){return e[t.id]=!0,e}),{});return t.filter((function(e){return!n[e.id]}))}function C(e,t,n){return[].concat(t,e,n).reduce((function(e,t){return e[t.id]=t,e}),{})}function S(e,t,n){return n&&n[e]||(0,c.isParticipantInCall)(t,e)}function y(e,t,n,a,r){void 0===r&&(r=!1);var i=(null==e?void 0:e.peerId)||0;if((0,c.isParticipantInCall)(t,i))return!0;if(S(i,t,a))return!1;if(r){if((0,c.isParticipantUnavailableToCallFromGroup)(t,i))return!0}else if(!(null==e?void 0:e.canCall))return!0;return n.length>=t.participantLimit||!(0,u.isUserPeer)(i)}},358898:(e,t,n)=>{"use strict";n.d(t,{AdminPinUnmuteRequestContainer:()=>d});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(662208),s=n(169610),c=n(734273),u=n(464380),d=function(e){var t=e.SDK,n=(0,r.useDispatch)(),d=a.useContext(l.LangContext).getLang,p=(0,r.useSelector)((function(e){return e})),_=p.participants[p.me].mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},m=function(){n({type:o.TOGGLE_POPUP})};return a.createElement(c.AdminPinUnmuteRequestModal,{onClose:m,title:d("calls_admin_pin_dialog_title"),description:d("calls_admin_pin_dialog_description"),actionButtons:[a.createElement(i.default,{onClick:m,appearance:"secondary",key:"cancel"},d("calls_admin_pin_dialog_cancel")),a.createElement(i.default,{onClick:function(){(_.isAudioEnabled?Promise.resolve():(0,s.checkPermissions)(t,[u.MediaOption.AUDIO])).then((function(){var e;(null===(e=p.notification)||void 0===e?void 0:e.type)===o.NotificationType.SPEAKING_ON_MUTE&&n({type:o.CALL_NOTIFICATION,notification:null}),t.toggleLocalAudio(!0).catch(console.log)})).then((function(){return m()}))},key:"mic"},d("calls_admin_pin_dialog_action"))]})}},262891:(e,t,n)=>{"use strict";n.d(t,{App:()=>j});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(536559),s=n(410531),c=n(923947),u=n(108519),d=n(187252),p=n(48755),_=n(165999),m=n(139230),f=n(656504),g=n(599648),A=n(94303),v=n(431469),h=n(474803),E=n(963532),C=n(325496),S=n(927229),y=n(353506),T=n(706885),I=n(485525),b=n(537817),N=n(410038),w=n(978335),L=n(358898),P=n(152532),k=n(350594),M=n(989819),O=n(379981),D=n(450273),R=n(858101),B=n(174635),x=n(241715),U=n(637880),H=n(955150),G=n(464380),V=n(745284),F=n(262409),W=n(465127),z=n(777152),j=function(e){var t,n,j,K,Y=e.SDK,Q=e.bridge,Z=e.onBeforeCallStart,J=e.onAfterCallFinish,q=e.tabIsMaster,X=e.navigateToConvo,$=e.callSounds,ee=e.navigateToProfile,te=e.onHandCountChanged,ne=e.onSuccessFeedback,ae=e.okPublicKey,re=e.config,ie=e.streamUrlExtractor,oe=re.allowAddMembers,le=re.incomingCall,se=re.showFeedbackScreen,ce=(0,i.useSelector)((function(e){return e})),ue=(0,i.useDispatch)(),de=r.useCallback((function(){ue({type:o.CHANGE_MODE,mode:o.Mode.READY})}),[]),pe=(0,a.__read)(r.useState(null),2),_e=pe[0],me=pe[1],fe=r.useCallback((function(e){ue({type:o.ERROR,text:e})}),[]),ge=r.useCallback((function(){return ue({type:o.CHANGE_MODE,mode:o.Mode.READY})}),[]);r.useEffect((function(){return ce.mode===o.Mode.CALL?((0,V.increaseCallsCount)(),(0,I.wakeLockRequest)(),function(){(0,I.wakeLockRelease)()}):function(){}}),[ce.mode]),(0,v.useFullScreen)(ce.uiMode===o.UIMode.FULLSCREEN&&ce.mode===o.Mode.CALL,(function(){var e;window.FastChat&&(me(window.FastChat.getFullScreenState()),window.FastChat.toggleFullScreenState(!0)),(null===(e=null===window||void 0===window?void 0:window.reforgedME)||void 0===e?void 0:e.setCollapsed)&&window.reforgedME.setCollapsed(!0,"call")}),(function(){var e;ce.uiMode===o.UIMode.FULLSCREEN&&ue({type:o.CHANGE_UI_MODE,mode:o.UIMode.DEFAULT}),window.FastChat&&(window.FastChat.toggleFullScreenState(_e),me(null)),(null===(e=null===window||void 0===window?void 0:window.reforgedME)||void 0===e?void 0:e.setCollapsed)&&window.reforgedME.setCollapsed(!1,"call")}),[ce.uiMode,ce.mode]),(0,h.usePriorities)(Y,ce),r.useEffect((function(){if(ce.mode===o.Mode.CALL&&((0,V.increaseCallsCount)(),ce.callsCount%3==0)){var e=setTimeout((function(){return ue({type:o.SET_SHOW_DESKTOP_NOTIFICATION,data:!0})}),1e3);return function(){return clearTimeout(e)}}}),[ce.mode]);var Ae=(0,r.useMemo)((function(){return re.enableVirtualBackground&&(0,W.isSupported)()}),[re.enableVirtualBackground]);return r.createElement(_.CallsErrorBoundary,{SDK:Y,mode:ce.mode,onReset:ge},r.createElement(r.Fragment,null,(le||q())&&r.createElement(u.AudioContainer,{onBeforeCallStart:Z,onAfterCallFinish:J,callSounds:$}),ce.localStatus!==G.ParticipantStatus.WAITING_HALL&&ce.mode===o.Mode.CALL&&ce.uiMode!==o.UIMode.COLLAPSED&&r.createElement(s.CallContainer,{SDK:Y,isVirtualBackgroundSupported:Ae,navigateToConvo:X,navigateToProfile:ee,onHandCountChanged:te}),ce.localStatus===G.ParticipantStatus.WAITING_HALL&&ce.mode===o.Mode.CALL&&ce.uiMode!==o.UIMode.COLLAPSED&&r.createElement(U.WaitingHallContainer,{SDK:Y,navigateToConvo:X,navigateToProfile:ee}),ce.mode===o.Mode.INCOMING&&ce.uiMode!==o.UIMode.COLLAPSED&&r.createElement(l.IncomingCallContainer,{SDK:Y,bridge:Q}),ce.localStatus!==G.ParticipantStatus.WAITING_HALL&&ce.mode!==o.Mode.READY&&ce.uiMode===o.UIMode.COLLAPSED&&r.createElement(c.CollapsedCallContainer,{SDK:Y}),ce.localStatus===G.ParticipantStatus.WAITING_HALL&&ce.mode!==o.Mode.READY&&ce.uiMode===o.UIMode.COLLAPSED&&r.createElement(x.CollapsedWaitingHallContainer,{SDK:Y}),ce.mode===o.Mode.START&&ce.uiMode!==o.UIMode.COLLAPSED&&r.createElement(R.StartCallContainer,null),se&&ce.mode===o.Mode.FEEDBACK&&r.createElement(O.FeedbackContainer,{onSuccessFeedback:ne}),ce.mode===o.Mode.CALL_BY&&r.createElement(B.CallByNameContainer,{bridge:Q}),ce.mode===o.Mode.JOIN&&r.createElement(f.JoinScreenContainer,(0,a.__assign)({},ce.join,{bridge:Q,withPopup:!0,onClose:de,onError:fe,okPublicKey:ae})),ce.mode===o.Mode.CREATE_CALL&&r.createElement(F.CreateCallByLinkContainer,{bridge:Q}),ce.errorShown&&r.createElement(g.ErrorContainer,{title:null===(t=ce.error)||void 0===t?void 0:t.title,text:null===(n=ce.error)||void 0===n?void 0:n.text,handleType:null===(j=ce.error)||void 0===j?void 0:j.handleType,callId:null===(K=ce.error)||void 0===K?void 0:K.callId,bridge:Q,onCloseFatal:de}),ce.cautionShown&&r.createElement(E.CautionContainer,{isIncoming:ce.isIncoming}),ce.groupCallSetup&&r.createElement(d.GroupCallSetupContainer,{bridge:Q,SDK:Y}),ce.isManagementOpen&&r.createElement(m.CallManagementContainer,{bridge:Q,SDK:Y,navigateToProfile:ee,navigateToConvo:X,allowAddMembers:oe}),ce.popup===o.POPUP_SETTINGS&&r.createElement(p.SettingsContainer,{SDK:Y}),ce.popup===o.POPUP_TRANSLATION&&r.createElement(b.TranslationContainer,null),ce.popup===o.POPUP_TRANSLATION_START_COUNTDOWN&&r.createElement(k.TranslationStartCountdownContainer,null),ce.popup===o.POPUP_TRANSLATION_STOP&&r.createElement(N.TranslationStopContainer,null),ce.popup===o.POPUP_TRANSLATION_SHARE&&r.createElement(w.TranslationShareContainer,{link:ce.translation.link,linkExtractor:ie}),ce.popup===o.POPUP_EXIT&&r.createElement(A.CallExitContainer,{SDK:Y}),ce.popup===o.POPUP_TRANSFER_ADMIN_RIGHTS&&r.createElement(P.TransferAdminRightsContainer,{SDK:Y}),ce.popup===o.POPUP_UNMUTE_REQUEST&&r.createElement(S.UnmuteRequestContainer,{SDK:Y,withVideo:!0}),ce.popup===o.POPUP_UNMUTE_AUDIO_REQUEST&&r.createElement(S.UnmuteRequestContainer,{SDK:Y,withVideo:!1}),ce.popup===o.POPUP_ADMIN_PIN_UNMUTE_REQUEST&&r.createElement(L.AdminPinUnmuteRequestContainer,{SDK:Y}),(ce.popup===o.POPUP_ON_CALL_HANGUP_BUSY||ce.popup===o.POPUP_ON_CALL_HANGUP_KILLED)&&r.createElement(z.OnHangupContainer,null),Ae&&r.createElement(H.VirtualBackgroundSettingsContainer,{SDK:Y}),ce.participantKick&&r.createElement(M.KickParticipantContainer,{SDK:Y}),ce.membersUnban&&r.createElement(D.UnbanParticipantContainer,{SDK:Y}),ce.participantsManagement&&r.createElement(C.MuteParticipantContainer,null),ce.adminAssignment&&r.createElement(y.AssignAdminContainer,{SDK:Y}),ce.isLoaderVisible&&r.createElement(T.default,null)))}},353506:(e,t,n)=>{"use strict";n.d(t,{AssignAdminContainer:()=>f});var a=n(570655),r=n(667294),i=n(50533),o=n(881150),l=n(121255),s=n(697483),c=n(662208),u=n(329538),d=n(908651),p=n(614914),_=n(745284),m=n(464380),f=function(e){var t=e.SDK,n=(0,i.useSelector)((function(e){return e.adminAssignment?e.participants[e.adminAssignment.participant.peerId]:void 0})),f=(0,i.useSelector)((function(e){return e})),g=(0,i.useDispatch)(),A=(0,a.__read)((0,r.useState)(!0),2),v=A[0],h=A[1],E=(0,a.__read)((0,r.useState)(""),2),C=E[0],S=E[1],y=r.useContext(c.LangContext).getLang;(0,r.useEffect)((function(){g({type:l.SHOW_LOADER,isLoaderVisible:!0}),new Promise((function(e,t){n&&n.peerId<0?(0,u.getGroupById)(-n.peerId).then((function(t){var n,a=t.groups;e(a&&a.length>0?null===(n=a[0])||void 0===n?void 0:n.name:"")})).catch((function(e){return t(e)})):(0,u.loadUsers)({user_ids:n&&String(n.peerId),name_case:"dat"}).then((function(t){var n=(0,a.__read)(t,1)[0];e((null==n?void 0:n.first_name)+" "+(null==n?void 0:n.last_name))})).catch((function(e){return t(e)}))})).then((function(e){S(e),h(!1),g({type:l.SHOW_LOADER,isLoaderVisible:!1})})).catch(console.log)}),[n]);var T=(0,r.useCallback)((function(){g({type:l.TOGGLE_ADMIN_ASSIGNMENT})}),[]),I=(0,r.useCallback)((function(){var e=(0,s.getParticipantExternalId)(n);e?(t.grantRoles(e,[m.UserRole.ADMIN],!1).then((function(){n&&g({type:l.CHANGE_PARTICIPANT_ROLES,participantId:n.peerId,data:n.roles?(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(n.roles)),[m.UserRole.ADMIN]):[m.UserRole.ADMIN]})})).catch(console.log),p.callStats.logEvent({call_event_type:l.CallActionEventType.ASSIGN_ADMIN,session_id:f.callData.callId,peer_id:f.peer,is_group_call:(0,_.isGroupCallByPeer)(f.peer)}),T()):T()}),[]);return v?null:r.createElement(d.AssignAdminModal,{onClose:T,title:y("calls_dialog_assign_admin_role_title"),description:y("calls_dialog_assign_admin_role_description").replace("{name}",C),actionButtons:[r.createElement(o.default,{onClick:T,appearance:"secondary",key:"cancel"},y("calls_dialog_assign_admin_role_action_later")),r.createElement(o.default,{onClick:I,key:"primary"},y("calls_dialog_assign_admin_role_action_primary"))]})}},108519:(e,t,n)=>{"use strict";n.d(t,{AudioContainer:()=>f});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(483379),s=n(745284),c=n(464380),u="incoming",d="outgoing",p="connecting",_="connected",m="end";function f(e){var t,n=e.onBeforeCallStart,f=e.onAfterCallFinish,g=e.callSounds,A=(0,i.useSelector)((function(e){return e})),v=(0,r.useRef)(),h=((t={}).incoming=(0,r.useRef)(null),t.outgoing=(0,r.useRef)(null),t.connecting=(0,r.useRef)(null),t.connected=(0,r.useRef)(null),t.end=(0,r.useRef)(null),t),E={controls:!1,preload:"auto"},C=(0,r.useCallback)((function(e){var t=h[e].current;t&&t.paused&&t.play().catch((function(){}))}),[]),S=(0,r.useCallback)((function(e){var t=h[e].current;t&&!t.paused&&(t.pause(),t.currentTime=0)}),[]),y=(0,r.useCallback)((function(){Object.keys(h).forEach(S)}),[]),T=(0,r.useCallback)((function(e){var t=h[e].current;if(t){var n=t.volume;t.volume=0,t.play().catch((function(){})),t.pause(),t.currentTime=0,t.volume=n}}),[]),I=(0,r.useCallback)((function(){n&&n()}),[n]),b=(0,r.useCallback)((function(){f&&f()}),[f]);return(0,r.useEffect)((function(){return l.browser.safari&&document.body.addEventListener("mousedown",(function e(){Object.keys(h).forEach(T),document.body.removeEventListener("mousedown",e)})),function(){y(),b()}}),[]),(0,r.useEffect)((function(){var e,t,n=v.current||A,r=A;n.mode!==r.mode&&(n.mode!==o.Mode.READY||r.mode!==o.Mode.INCOMING&&r.mode!==o.Mode.CALL||I(),n.mode===o.Mode.INCOMING&&S(u),r.mode===o.Mode.INCOMING&&C(u),r.mode!==o.Mode.READY||n.mode!==o.Mode.INCOMING&&n.mode!==o.Mode.CALL||(y(),C(m),b()));var i=r.me,l=n.participants,f=r.participants,g=null===(e=l[i])||void 0===e?void 0:e.status,h=null===(t=f[i])||void 0===t?void 0:t.status;g!==h&&(g===c.ParticipantStatus.CONNECTING&&S(p),h===c.ParticipantStatus.CONNECTING&&C(p));var E=Object.keys(f).some((function(e){return l[e]&&l[e].status===c.ParticipantStatus.CONNECTED})),T=Object.keys(f).some((function(e){var t=l[e],n=f[e];return t&&t.status!==n.status&&n.status===c.ParticipantStatus.CONNECTED}));!E&&T&&C(_),r.mode===o.Mode.CALL&&(!function(e,t,n,r){var i,o,l=!1;try{for(var s=(0,a.__values)(Object.values(e)),u=s.next();!u.done;u=s.next()){var d=u.value;if(d.peerId!==t){if(d.status===c.ParticipantStatus.CONNECTED)return!1;d.status===c.ParticipantStatus.WAITING&&(!r||n.has(d.peerId))&&(l=!0)}}}catch(e){i={error:e}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}return l}(f,i,r.participantsAddedByMe,(0,s.isGroupCallByPeer)(A.peer))?S(d):C(d)),v.current=A}),[A]),r.createElement(r.Fragment,null,r.createElement("audio",(0,a.__assign)({src:g.incoming,ref:h.incoming,loop:!0},E)),r.createElement("audio",(0,a.__assign)({src:g.outgoing,ref:h.outgoing,loop:!0},E)),r.createElement("audio",(0,a.__assign)({src:g.connected,ref:h.connected,loop:!1},E)),r.createElement("audio",(0,a.__assign)({src:g.connecting,ref:h.connecting,loop:!0},E)),r.createElement("audio",(0,a.__assign)({src:g.end,ref:h.end,loop:!1},E)))}},174635:(e,t,n)=>{"use strict";n.d(t,{CallByNameContainer:()=>m});var a=n(570655),r=n(667294),i=n(790281),o=n(662208),l=n(50533),s=n(121255),c=n(329538),u=n(881150),d=n(706885),p=n(431469),_=n(788822),m=function(e){var t=e.bridge,n=(0,l.useSelector)((function(e){return e})),m=(0,l.useDispatch)(),f=(0,a.__read)((0,r.useState)([]),2),g=f[0],A=f[1],v=(0,a.__read)((0,r.useState)(n.me),2),h=v[0],E=v[1],C=r.useContext(o.LangContext).getLang,S=(0,a.__read)((0,r.useState)(""),2),y=S[0],T=S[1],I=(0,r.useCallback)((function(e){return e.name}),[]),b=(0,r.useCallback)((function(e){return e.id}),[]),N=(0,p.useIndexer)([],I,b),w=n.participants[n.me],L=y?N.search(y):g,P=(0,r.useCallback)((function(e){T(e.target.value)}),[]),k=function(e,t){void 0===t&&(t=!1);var n="id"in e?e.id:e.peerId,a="screen_name"in e?"/"+e.screen_name:e.link,r="photo_100"in e?e.photo_100:e.photo;return{id:t?n:-n,name:(0,_.escape)(e.name),link:a,photo:r}};(0,r.useEffect)((function(){var e=[k(w,!0)];(0,c.getGroupsForCall)().then((function(t){t.count>0&&t.items.forEach((function(t){e.push(k(t))}))})).finally((function(){A(e),e.forEach((function(e){return N.add(e)}))}))}),[]);var M=(0,r.useCallback)((function(e){if(n.callByName){var a=n.callByName,r=a.peerId,i=a.entryPoint,o=a.joinLink;o?t.joinCallByLink(o,void 0,e,i,h>0?0:h):r?t.call(r,e,void 0,i,h>0?0:h):t.startCall(e,i,!0,h>0?0:h)}}),[h]);if(!g.length)return r.createElement(d.default,null);var O=[r.createElement(u.default,{onClick:function(){return M(!1)},key:"callByNameByAudio",appearance:"secondary"},C("calls_call_by_name_audio_button")),r.createElement(u.default,{onClick:function(){return M(!0)},key:"callByNameByVideo"},C("calls_call_by_name_video_button"))];return r.createElement(i.CallByNameModal,{items:L,actionButtons:O,selectedId:h,onListItemClick:function(e){E(e)},onClose:function(){m({type:s.CHANGE_MODE,mode:s.Mode.READY})},participantMe:w,onSearchChange:P})}},410531:(e,t,n)=>{"use strict";n.d(t,{CallContainer:()=>x});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(242422),s=n(492512),c=n(362542),u=n(548237),d=n(269481),p=n(75794),_=n(884143),m=n(279060),f=n(169610),g=n(690015),A=n(745284),v=n(697483),h=n(614914),E=n(561235),C=n(662208),S=n(498110),y=n(774351),T=n(464380),I=n(139230),b=n(613335),N=n(674543),w=n(659397),L=n(768606),P=n(290514),k=n(147853),M=n(259684),O=n(662727),D=n(766610),R=n(707604),B=n(820717);function x(e){var t,n,b,x,H,G,V,F=e.SDK,W=e.navigateToConvo,z=e.navigateToProfile,j=e.onHandCountChanged,K=e.isVirtualBackgroundSupported,Y=(0,i.useSelector)((function(e){return e})),Q=(0,i.useDispatch)(),Z=(0,r.useContext)(C.LangContext).getLang,J=(0,r.useContext)(S.ConfigContext),q=J.isModalView,X=J.debugLog,$=J.enableScreenTrack,ee=J.enableProducerScreenTrack,te=J.allowPushToTalk,ne=J.enableVirtualBackground,ae=Y.peer,re=(0,r.useMemo)((function(){var e,t,n,a;return(0,A.isGroupCallByPeer)(ae)||(null===(t=null===(e=Y.participants[Y.me])||void 0===e?void 0:e.mediaSettings)||void 0===t?void 0:t.isScreenSharingEnabled)||(null===(a=null===(n=Y.participants[ae])||void 0===n?void 0:n.mediaSettings)||void 0===a?void 0:a.isScreenSharingEnabled)}),[Y.peer,Y.participants]),ie=re?Y.callData.conversation:Y.participants[ae],oe=Y.participants[Y.me],le=oe.mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},se=oe.permissions,ce=(0,r.useMemo)((function(){return(0,v.getActiveParticipantsCount)(Y)}),[Y.participants]),ue=ce>1,de=ue||(0,v.isParticipantWithVideo)(oe),pe=(0,v.getNonAnonymousConnectParticipantsCount)(Y),_e=re&&((0,v.isAdmin)(oe)||(0,v.isCreator)(oe))&&pe>1&&1===(0,v.getConnectedAdminsCount)(Y),me=re||ce>2,fe=me&&de&&!Y.isOratorMode,ge=me&&de&&Y.isOratorMode,Ae=null!==Y.adminPinnedParticipant,ve=!Ae&&null!==Y.pinnedParticipant,he=!ve&&null!==Y.screenSharingPinnedParticipant,Ee=Y.uiMode===o.UIMode.FULLSCREEN,Ce=(0,r.useMemo)((function(){return F.browser.isScreenCapturingSupported()}),[]),Se=(null===(t=Y.callData)||void 0===t?void 0:t.canFinishCall)||re&&0===ae&&(0,v.participantIsAdmin)(oe),ye=!!Y.translation.deferredId&&!Y.translation.isOn,Te=(0,a.__read)((0,r.useState)(!1),2),Ie=Te[0],be=Te[1],Ne=(0,a.__read)((0,r.useState)(!1),2),we=Ne[0],Le=Ne[1],Pe=(0,a.__read)((0,r.useState)(0),2),ke=Pe[0],Me=Pe[1],Oe=(0,r.useMemo)((function(){return(0,v.getActiveParticipants)(Y)}),[Y.participants,Y.me,Y.groupId,Y.meGroup,Y.adminPinnedParticipant,Y.screenSharingPinnedParticipant,Y.pinnedParticipant,Y.speakers,Y.gridScrollPosition,Y.gridScrollFirstVisible,Y.oratorScrollPosition,Y.oratorScrollFirstVisible,Y.isOratorMode,Y.uiMode]),De=(0,r.useMemo)((function(){return(0,v.getActiveParticipants)(Y,!0)}),[Y.participants,Y.me,Y.groupId,Y.meGroup,Y.adminPinnedParticipant,Y.screenSharingPinnedParticipant,Y.pinnedParticipant]),Re=(0,r.useCallback)((function(e,t){var n=Y.pinnedParticipant===t?null:t;Y.screenSharingPinnedParticipant===t&&(n=null),Y.screenSharingPinnedParticipant&&Q({type:o.SET_SCREEN_SHARING_PINNED_PARTICIPANT,screenSharingPinnedParticipant:null}),Q({type:o.SET_PINNED_PARTICIPANT,pinnedParticipant:n})}),[Y.pinnedParticipant,Y.screenSharingPinnedParticipant]),Be=(0,r.useCallback)((function(e,t){Y.isOratorMode||Q({type:o.TOGGLE_ORATOR_MODE,isOratorMode:!0}),Y.pinnedParticipant!==t&&Q({type:o.SET_PINNED_PARTICIPANT,pinnedParticipant:t})}),[Y.isOratorMode,Y.pinnedParticipant]),xe=(0,r.useMemo)((function(){return Oe.map((function(e){var t,n,a,i,o,l,s,c,u,d,_=e.mediaSettings||{},m=_.isAudioEnabled,f=_.isScreenSharingEnabled,g=e.peerId===Y.me,A=g?Z("calls_own_label"):e.shortName?e.shortName:e.name;if(!e.visible)return r.createElement(R.ParticipantLite,{id:e.peerId,key:e.peerId,isInfoShown:!0,isMe:g,isHandRaised:e.wasConnected&&(null===(n=null===(t=e.statusData)||void 0===t?void 0:t.hand)||void 0===n?void 0:n.state),hasAudio:!!m,photo:e.photo,name:A,letter:null!==(i=null===(a=null==e?void 0:e.name)||void 0===a?void 0:a[0])&&void 0!==i?i:"",wasConnected:e.wasConnected,onClickParticipant:Re,isPinned:Y.isOratorMode&&(Number(e.peerId)===Number(Y.pinnedParticipant)||Number(e.peerId)===Number(Y.screenSharingPinnedParticipant)),isPinnedByAdmin:Y.isOratorMode&&e.peerId===Number(Y.adminPinnedParticipant)});var h=Y.isOratorMode&&($||ee),E=(0,v.getStream)(e,h&&(null===(o=e.mediaSettings)||void 0===o?void 0:o.isVideoEnabled)),C=!(h&&(null===(l=e.mediaSettings)||void 0===l?void 0:l.isVideoEnabled))&&f,S=(0,v.isParticipantWithVideo)(e),y=Y.localStatus===T.ParticipantStatus.CONNECTED?e.status:T.ParticipantStatus.CONNECTED,I=(0,v.getParticipantActions)(Y,F,Q,e,!0,Z,W,z,!1);return r.createElement(p.Participant,{id:e.peerId,key:e.peerId,isVisible:e.visible,isInfoShown:!0,isMe:g,isHandRaised:null===(c=null===(s=e.statusData)||void 0===s?void 0:s.hand)||void 0===c?void 0:c.state,hasVideo:!!S,hasAudio:!!m,isSharingScreen:!!C,isSpeaking:m&&Y.speakers[e.peerId]&&e.visible,stream:E,photo:e.photo,name:A,letter:null!==(d=null===(u=null==e?void 0:e.name)||void 0===u?void 0:u[0])&&void 0!==d?d:"",status:y,allowContain:!1,wasConnected:e.wasConnected,networkStatus:e.networkStatus,onClickParticipant:Y.isOratorMode?Re:void 0,onDblClickParticipant:Y.isOratorMode?void 0:Be,actions:I,isPinned:Y.isOratorMode&&(Number(e.peerId)===Number(Y.pinnedParticipant)||Number(e.peerId)===Number(Y.screenSharingPinnedParticipant)),isPinnedByAdmin:Y.isOratorMode&&e.peerId===Number(Y.adminPinnedParticipant)})}))}),[Oe,De]),Ue=function(e){return Q({type:o.CHANGE_UI_MODE,mode:e})},He=function(){(0,f.checkPermissions)(F,[T.MediaOption.AUDIO,T.MediaOption.VIDEO]).then((function(){Q({type:o.TOGGLE_POPUP,data:o.POPUP_SETTINGS})}))},Ge=function(){Q({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION})},Ve=(0,r.useCallback)((function(){q&&(Y.uiMode===o.UIMode.FULLSCREEN?((0,y.pause)(.3,null).then((function(){Ue(o.UIMode.COLLAPSED)})),Ue(o.UIMode.DEFAULT)):Ue(o.UIMode.COLLAPSED))}),[Y.uiMode]),Fe=(0,r.useCallback)((function(){Q({type:o.TOGGLE_ORATOR_MODE,isOratorMode:!Y.isOratorMode})}),[Y.isOratorMode]),We=(0,r.useCallback)((function(){Q({type:o.TOGGLE_PARTICIPANTS_ASIDE,isShownParticipantsAside:!Y.isShownParticipantsAside})}),[Y.isShownParticipantsAside]),ze=(0,r.useCallback)((function(){Q({type:o.MANAGEMENT,isOpen:!0})}),[]),je=(0,r.useCallback)((function(){Q({type:o.MANAGEMENT,isOpen:!0,managementView:I.ManagementViews.CALL_LINK})}),[]),Ke=(0,r.useCallback)((function(){if(!we){var e=!le.isVideoEnabled||le.isScreenSharingEnabled&&!$;(e?(0,f.checkPermissions)(F,[T.MediaOption.VIDEO]):Promise.resolve()).then((function(){Le(!0),$||le.isScreenSharingEnabled&&F.captureScreen(!1),F.toggleLocalVideo(e).finally((function(){Le(!1)}))})),h.callStats.logEvent({call_event_type:e?o.CallActionEventType.VIDEO_ENABLED:o.CallActionEventType.VIDEO_DISABLED,session_id:Y.callData.callId,peer_id:Y.peer,is_group_call:(0,A.isGroupCallByPeer)(Y.peer),reason:e?void 0:"manual"})}}),[le,we]),Ye=(0,r.useCallback)((function(){F.captureScreen(!le.isScreenSharingEnabled).catch((function(){Q({type:o.ERROR,text:Z("calls_error_disabled_screen_sharing")})})),h.callStats.logEvent({call_event_type:le.isScreenSharingEnabled?o.CallActionEventType.SCREEN_SHARING_STOPPED:o.CallActionEventType.SCREEN_SHARING_STARTED,session_id:Y.callData.callId,peer_id:Y.peer,is_group_call:(0,A.isGroupCallByPeer)(Y.peer)})}),[le.isScreenSharingEnabled,Y.screenSharers,Y.callData.callId,Y.peer]),Qe=(0,r.useCallback)((function(){Ve(),W(Y.peer)}),[Y.peer,Y.uiMode]),Ze=(0,r.useCallback)((function(){if(!Ie){var e=!le.isAudioEnabled;(e?(0,f.checkPermissions)(F,[T.MediaOption.AUDIO]):Promise.resolve()).then((function(){var t;be(!0),(null===(t=Y.notification)||void 0===t?void 0:t.type)===o.NotificationType.SPEAKING_ON_MUTE&&Q({type:o.CALL_NOTIFICATION,notification:null}),F.toggleLocalAudio(e).finally((function(){be(!1)}))}))}}),[le,Ie]),Je=(0,r.useCallback)((function(){var e,t,n,r,i=!(null===(t=null===(e=oe.statusData)||void 0===e?void 0:e.hand)||void 0===t?void 0:t.state);F.changeParticipantState({hand:i?o.SdkHandType.RAISED:o.SdkHandType.LOWERED}),Q({type:o.CHANGE_PARTICIPANT_STATE,participantId:oe.peerId,data:(0,a.__assign)((0,a.__assign)({},oe.statusData),{hand:{state:!(null===(r=null===(n=oe.statusData)||void 0===n?void 0:n.hand)||void 0===r?void 0:r.state),ts:Date.now()}})}),h.callStats.logEvent({call_event_type:i?o.CallActionEventType.HAND_RAISED:o.CallActionEventType.HAND_LOWERED,session_id:Y.callData.callId,peer_id:Y.peer,is_group_call:(0,A.isGroupCallByPeer)(Y.peer)})}),[null===(b=null===(n=oe.statusData)||void 0===n?void 0:n.hand)||void 0===b?void 0:b.state]),qe=(0,r.useCallback)((function(){Q({type:o.TOGGLE_POPUP,data:o.POPUP_EXIT})}),[]),Xe=(0,r.useCallback)((function(){Q({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSFER_ADMIN_RIGHTS})}),[]),$e=(0,r.useCallback)((function(){F.hangup(),h.callStats.logEvent({call_event_type:o.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:Y.callData.callId,peer_id:Y.peer,is_group_call:(0,A.isGroupCallByPeer)(Y.peer),reason:"none",group_call_users_count:ce})}),[Y.callData.callId,Y.peer,ce]),et=(0,r.useCallback)((function(){Q({type:o.CHANGE_UI_MODE,mode:Ee?o.UIMode.DEFAULT:o.UIMode.FULLSCREEN}),Q({type:o.SET_TOOLTIP,tooltips:null})}),[Y.uiMode]),tt=(0,r.useCallback)((function(e,t){var n;Q({type:o.SET_TOOLTIP,tooltips:(n={},n[e]=t,n)})}),[]),nt=(0,r.useCallback)((function(){Q({type:o.SET_TOOLTIP,tooltips:null})}),[]);(0,r.useEffect)((function(){ye&&tt("streaming",!0)}),[ye]);(0,r.useEffect)((function(){Y.isOratorMode||function(e){for(var t,n=(null===(t=document.querySelectorAll('[data-calls-id="grid-item"]')[0])||void 0===t?void 0:t.offsetWidth)||1/0,a=6*Math.floor(e/n),r=0;r<De.length;r++){var i=r>=a&&r<a+30;De[r].visible!==i&&(0,L.throttleAccumulateDispatchParticipant)(Q,De[r].peerId,{visible:i})}}(Y.gridScrollPosition)}),[Y.isOratorMode,Y.uiMode,Y.gridScrollPosition,De]),(0,r.useEffect)((function(){Y.isOratorMode&&function(e){for(var t,n=(null===(t=document.querySelectorAll('[data-calls-id="content"]')[0])||void 0===t?void 0:t.offsetHeight)||0,a=Math.floor(e/148)-1,r=Math.min(Y.config.videoSlotsCount,n/148+3),i=0;i<De.length;i++){var o=i>=a&&i<a+r;De[i].visible!==o&&(0,L.throttleAccumulateDispatchParticipant)(Q,De[i].peerId,{visible:o})}}(Y.oratorScrollPosition)}),[Y.isOratorMode,Y.uiMode,Y.oratorScrollPosition,De]);var at=(0,r.useCallback)((0,w.debounce)((function(e){var t,n=(null===(t=document.querySelectorAll('[data-calls-id="grid-item"]')[0])||void 0===t?void 0:t.offsetWidth)||1/0,a=6*Math.floor(e/n);Q({type:o.SET_GRID_SCROLL_POSITION,position:e,firstVisible:a})}),200),[]),rt=(0,r.useCallback)((0,w.throttle)((function(e){var t,n=document.querySelectorAll('[data-calls-id="participant"]')[0],a=n?n.offsetWidth+8:1/0,r=(null===(t=document.querySelectorAll('[data-calls-id="content"]')[0])||void 0===t?void 0:t.offsetHeight)||0,i=Math.floor(e/a)-1,l=Math.min(Y.config.videoSlotsCount,r/a+3);Q({type:o.SET_ORATOR_SCROLL_POSITION,position:e,firstVisible:i,numberOfVisible:l})}),100),[Y.config]),it=(0,r.useMemo)((function(){var e,t=[{text:Z("calls_call_menu_settings"),key:"settings",onClick:He,disabled:!1}];Y.config.streaming&&!(0,v.isParticipantAnonym)(Y.me)&&t.push({text:Z("calls_call_menu_translation"),key:"translation",onClick:Ge,disabled:!!(null===(e=Y.translation)||void 0===e?void 0:e.isOn)&&(0,N.canStopTranslation)(Y)}),(0,v.canMuteParticipants)(oe)&&re&&(t.push({text:Z("calls_call_menu_mute_audio_all"),key:"muteAllAudio",onClick:function(){Q({type:o.TOGGLE_PARTICIPANTS_MANAGEMENT,data:{mode:o.ParticipantsManagementMode.ALL_AUDIO}})}}),t.push({text:Z("calls_call_menu_mute_video_all"),key:"muteAllVideo",onClick:function(){Q({type:o.TOGGLE_PARTICIPANTS_MANAGEMENT,data:{mode:o.ParticipantsManagementMode.ALL_VIDEO}})}})),(0,v.canMuteParticipants)(oe)&&re&&ue&&t.push({text:Z("calls_call_menu_enable_media_request"),key:"unmuteRequest",onClick:function(){F.muteParticipant(null,{},[T.MediaOption.AUDIO,T.MediaOption.VIDEO,T.MediaOption.SCREEN_SHARING]).catch(console.log),h.callStats.logEvent({call_event_type:o.CallActionEventType.ASK_ALL_TO_UNMUTE,session_id:Y.callData.callId,peer_id:Y.peer,is_group_call:(0,A.isGroupCallByPeer)(Y.peer)})}});return X&&t.push({text:Z("calls_call_menu_debug"),key:"debugLog",onClick:function(){window.__VKCallsSDKLogs__()},disabled:!1}),ne&&K&&(t.push({separator:!0}),t.push({text:Z("calls_virtual_background"),key:o.POPUP_VIRUTAL_BACKGROUND,onClick:function(){Q({type:o.TOGGLE_POPUP,data:o.POPUP_VIRUTAL_BACKGROUND})}}),t.push({separator:!0})),t}),[Y.config.streaming,Y.me,null===(x=Y.translation)||void 0===x?void 0:x.isOn,Y.participants[Y.me],Y.conversationOptions,Y.permissions]);(0,r.useEffect)((function(){return function(){Q({type:o.SET_TOOLTIP,tooltips:null})}}),[]);var ot=(0,r.useCallback)((function(){Ae&&(0,v.canPinParticipants)(oe)?(F.pinParticipant(Y.adminPinnedParticipant,!0).then((function(){Q({type:o.SET_ADMIN_PINNED_PARTICIPANT,data:null})})).catch(console.log),h.callStats.logEvent({call_event_type:o.CallActionEventType.ADMIN_UNPIN,session_id:Y.callData.callId,peer_id:Y.peer,is_group_call:(0,A.isGroupCallByPeer)(Y.peer)})):(Q({type:o.SET_SCREEN_SHARING_PINNED_PARTICIPANT,screenSharingPinnedParticipant:null}),Q({type:o.SET_PINNED_PARTICIPANT,pinnedParticipant:null}))}),[Y.adminPinnedParticipant,Y.participants[Y.me].roles,Y.peer,Y.callData.callId]),lt=(0,r.useCallback)((function(e){se.audio>0&&(0,k.onPushToTalkHandler)(e,le.isAudioEnabled,Q,Y)}),[se.audio,le.isAudioEnabled,Y.notification]);(0,r.useEffect)((function(){te&&se.audio>0&&(0,k.pushToTalkToggleAudio)(Y.pushToTalkEnabled,le,!0)}),[]),(0,r.useEffect)((function(){return te&&!(0,M.isCollapsedLayout)(Y)&&Y.pushToTalkEnabled?((0,k.pushToTalkActivate)(lt),function(){(0,k.pushToTalkDeactivate)(lt)}):function(){}}),[Y.uiMode,Y.pushToTalkEnabled,lt]);var st=(0,r.useMemo)((function(){var e;return r.createElement(g.CallNotificationContainer,{dispatch:Q,notification:Y.notification,participant:Y.participants[null===(e=Y.notification)||void 0===e?void 0:e.data]})}),[Y.notification,Y.participants[null===(H=Y.notification)||void 0===H?void 0:H.data]]),ct=(0,r.useMemo)((function(){return r.createElement(P.NotificationWithButtonContainer,null)}),[Y.waitingHall,Y.shouldShowDesktopAppNotification,Y.shouldShowWarningDesktopAppNotification,Y.join]);(0,r.useEffect)((function(){if(!Y.callData.localTimeStamp&&!(0,A.isGroupCallByPeer)(Y.peer)&&!(0,O.getHangupStatus)(Y,Z)){var e=Y.participants[Y.peer];e&&e.status===T.ParticipantStatus.CONNECTED&&Q({type:o.LOCAL_TIME_START,data:Date.now()})}}),[Y]),(0,r.useEffect)((function(){re&&Me(ce)}),[ce]);var ut=(0,r.useRef)({}),dt=(0,r.useRef)({});return(0,r.useEffect)((function(){var e,t,n,r,i,o=[],l=function(e){var t;return(!Y.participants[e]||!Y.participants[e].mediaSettings||!Y.participants[e].name)&&(null!==(t=ut.current[e])&&void 0!==t?t:0)<5&&(void 0===dt.current[e]||Date.now()-dt.current[e]>1e4)},s=Date.now();try{for(var c=(0,a.__values)(Oe),u=c.next();!u.done;u=c.next()){var d=u.value;l(m=Number(d.peerId))&&(o.push(m),ut.current[m]=(null!==(i=ut.current[m])&&void 0!==i?i:0)+1,dt.current[m]=s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}try{for(var p=(0,a.__values)(Y.speakersInHeader),_=p.next();!_.done;_=p.next()){var m=_.value;l(Number(m))&&o.push(Number(m))}}catch(e){n={error:e}}finally{try{_&&!_.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}if(window.Calls&&o.length>0){var f=Y.callData.callId||"",g={withConversation:!Y.callData.conversation,awaitImages:!1};(0,B.loadCallParticipants)(Y,Q,window.Calls,f,o,g).catch((function(e){var t,n;(null===(t=window.Calls)||void 0===t?void 0:t.eventHandlers.onError)&&e&&(null===(n=window.Calls)||void 0===n||n.eventHandlers.onError(e)),(0,T.debugMessage)(T.DebugMessageType.ERROR,e),console.error(e)}))}}),[Y.peer,Y.speakersInHeader,Oe]),r.createElement(d.CallModal,{onClose:_e?Xe:$e,isCautionBoxShown:!_e,onBackdropClick:Ve},r.createElement(s.Call,{info:r.createElement(E.CallHeaderContainer,{onHandCountChanged:j}),callMenuActions:it,isVideoAllowed:le.isVideoEnabled||se.video>0,isAudioAllowed:le.isAudioEnabled||se.audio>0,isVideoEnabled:$?le.isVideoEnabled:le.isVideoEnabled&&!le.isScreenSharingEnabled,isAudioEnabled:le.isAudioEnabled,isScreenSharingEnabled:le.isScreenSharingEnabled,isOratorMode:Y.isOratorMode,isFullScreen:Ee,onToggleVideo:Ke,onToggleAudio:Ze,onToggleScreenShare:Ye,onLeaveCall:_e?Xe:Se?qe:$e,onCollapseCall:q?Ve:null,onToggleOratorMode:Fe,onFullScreenToggle:et,onTooltipChange:tt,onHidePanel:nt,onChat:Qe,onHandClick:Je,isParticipantControlActive:Y.isManagementOpen,isLayoutSwitchShown:re&&ue,isHandRaised:null===(V=null===(G=oe.statusData)||void 0===G?void 0:G.hand)||void 0===V?void 0:V.state,isHandControlShown:re,isChatControlShown:!!ae&&!Y.groupId,isScreenShareControlShown:se.screenSharing>0&&Ce,isStreamingControlShown:ye,isChainControlShown:!(0,v.isParticipantAnonym)(oe.peerId),onDeferredStreamStart:function(){if(Y.translation.deferredId){var e={isOn:!1,startStreamParams:{upcomingStreamParams:{ovId:Y.translation.deferredId}}};Q({type:o.SET_TRANSLATION,data:e}),Q({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_START_COUNTDOWN})}},onParticipantsClick:ze,chatUnreadCount:Y.chatUnreadCount,notification:st,tooltips:Y.tooltips,amISpeaking:!!Y.speakers[Y.me],onChainClick:je,notificationWithButton:ct,participantCount:ke,isPopupOrModalOpen:!(!Y.popup&&!Y.isManagementOpen)},r.createElement(r.Fragment,null,!me&&r.createElement(l.OneToOne,(0,a.__assign)({},function(e,t,n,a){var r,i=e[t]||{},o=e[n]||{},l=i.mediaSettings,s=o&&o.mediaSettings?o.mediaSettings:{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},c=(0,v.isParticipantWithVideo)(i),u=(0,v.getStream)(i),d=(0,v.isParticipantWithVideo)(o),p=(0,v.getStream)(o);return{hasAudio:!!(null==l?void 0:l.isAudioEnabled),hasVideo:c,isSharingScreen:!!(null==l?void 0:l.isScreenSharingEnabled),stream:u,id:t,name:a("calls_own_label"),letter:null===(r=i.name)||void 0===r?void 0:r.slice(0,1),wasConnected:!!i.wasConnected,networkStatus:i.networkStatus,opponentHasAudio:!!(null==s?void 0:s.isAudioEnabled),opponentHasVideo:d,opponentIsSharingScreen:!!(null==s?void 0:s.isScreenSharingEnabled),opponentStream:p,opponentPhoto:o.photo,opponentId:n,opponentName:o.name||n.toString(),opponentWasConnected:!!o.wasConnected,opponentNetworkStatus:o.networkStatus}}(Y.participants,Y.me,Y.peer,Z))),fe&&r.createElement(c.CallGridNew,{onScroll:at,scrollPosition:Y.gridScrollPosition,participantsCount:ce,participantsShiftCount:Y.gridScrollFirstVisible<60?0:Y.gridScrollFirstVisible-60},xe),ge&&r.createElement(u.CallOrator,{orator:U(Y,Z,Ye),oratorTitle:r.createElement(D.OratorTitle,{orator:(0,v.getOrator)(Y),me:Y.me,isPinned:ve,isPinnedByAdmin:Ae,isPinnedByShareScreen:he,isUnpinAllowed:(0,v.canPinParticipants)(oe)||!Ae,onUnpin:ot,tooltips:Y.tooltips,onTooltipChange:tt}),onToggleParticipantsAside:We,isShownParticipantsAside:Y.isShownParticipantsAside,onScroll:rt,scrollPosition:Y.oratorScrollPosition,participantsAsideCount:ce,participantsAsideShift:Y.oratorScrollFirstVisible<30?0:148*(Y.oratorScrollFirstVisible-30)-8},xe),me&&!de&&r.createElement(_.default,null,r.createElement(m.CallPhoto,{id:ae,photo:ie&&ie.photo||"",waves:!0,alt:ie&&ie.tab||"",className:"CallPhoto--orator"})))))}function U(e,t,n){var a,i=null!==(a=e.participants[e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator||e.me])&&void 0!==a?a:{},o=i.mediaSettings||{},l=o.isAudioEnabled,s=o.isScreenSharingEnabled,c=i.peerId===e.me;c&&e.groupId&&e.meGroup&&(i=(0,b.mergeGroupToParticipant)(e.meGroup,i));var u=(0,v.isParticipantWithVideo)(i),d=(0,v.getStream)(i);return r.createElement(p.Participant,{id:i.peerId,key:i.peerId,isOrator:!0,isInfoShown:!0,isMe:c,hasVideo:!!u,hasAudio:!!l,isSharingScreen:!!s,stream:d,photo:i.photo,name:c?t("calls_own_label"):i.name,status:i.status,wasConnected:i.wasConnected,networkStatus:i.networkStatus,allowContain:!0,onStopScreenShare:n})}},94303:(e,t,n)=>{"use strict";n.d(t,{CallExitContainer:()=>_});var a=n(667294),r=n(50533),i=n(225652),o=n(881150),l=n(121255),s=n(444083),c=n(614914),u=n(745284),d=n(697483),p=n(662208),_=function(e){var t=e.SDK,n=(0,r.useSelector)((function(e){return e})),_=(0,r.useDispatch)(),m=a.useContext(p.LangContext).getLang,f=function(){return c.callStats.logEvent({call_event_type:l.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:n.callData.callId,peer_id:n.peer,is_group_call:(0,u.isGroupCallByPeer)(n.peer),reason:"none",group_call_users_count:(0,d.getActiveParticipantsCount)(n)})},g=(0,a.useCallback)((function(){_({type:l.TOGGLE_POPUP})}),[]);return a.createElement(i.CallExitModal,{onClose:g,actionButtons:[a.createElement(o.default,{onClick:function(){_({type:l.TOGGLE_POPUP}),f(),(0,s.onForceCallFinish)(t,n,_,m)},key:"forceCallFinish",appearance:"secondary"},m("calls_force_call_finish")),a.createElement(o.default,{onClick:function(){return _({type:l.TOGGLE_POPUP}),f(),t.hangup()},key:"leave"},m("calls_leave_call"))]})}},561235:(e,t,n)=>{"use strict";n.d(t,{CallHeaderContainer:()=>_});var a=n(570655),r=n(667294),i=n(50533),o=n(910472),l=n(745284),s=n(503592),c=n(697483),u=n(298811),d=n(662208),p=n(662727);function _(e){var t,n,_=e.onHandCountChanged,m=(0,i.useSelector)((function(e){return e})),f=(0,l.isGroupCallByPeer)(m.peer),g=(0,r.useContext)(d.LangContext),A=g.getLang,v=g.langNumeric,h=(0,a.__read)((0,r.useState)(null),2),E=h[0],C=h[1],S=(0,a.__read)((0,r.useState)(0),2),y=S[0],T=S[1],I=(0,a.__read)((0,r.useState)(null),2),b=I[0],N=I[1],w=(0,a.__read)((0,r.useState)(""),2),L=w[0],P=w[1];return r.useEffect((function(){var e=(0,l.isGroupCallByPeer)(m.peer)?m.callData.ts:m.callData.localTimeStamp;N((0,p.getCallTimer)(e));var t=setInterval((function(){return N((0,p.getCallTimer)(e))}),1e3);return function(){return clearInterval(t)}}),[m.peer,m.callData.localTimeStamp,m.callData.ts]),(0,r.useEffect)((function(){var e=(0,c.getRaisedHands)(m);e!==y&&(T(e),_&&_(e))}),[m.participants]),(0,r.useEffect)((function(){if(f){var e=m.speakersInHeader.reduce((function(e,t){return m.participants[t]&&(m.participants[t].shortName||m.participants[t].name)&&e.push(m.participants[t]),e}),[]);if(e.length>0){var t=A("calls_participants_speak",e.length).split(" ");C(r.createElement(r.Fragment,null,r.createElement("span",{className:"CallHeader__speak"},t[0]," "),(0,u.getParticipantsListLabel)(e,e.slice(0,2),(function(e){return e.shortName||e.name}),A,v,0,2)))}else C(null)}}),[m.participants,m.speakersInHeader]),(0,r.useEffect)((function(){var e="";m.translation.isOn&&(e=r.createElement(o.TranslationStatusContainer,null)),P(e)}),[m.translation.isOn]),r.createElement(s.CallHeader,{translation:L,speakers:f?E:null,hands:y,time:b,network:null!==(n=null===(t=m.participants[m.me])||void 0===t?void 0:t.networkStatus)&&void 0!==n?n:1,networkTooltipText:A("calls_status_bad_internet_connection")})}},139230:(e,t,n)=>{"use strict";n.d(t,{ManagementViews:()=>a,CallManagementContainer:()=>I});var a,r=n(570655),i=n(667294),o=n(50533),l=n(121255),s=n(186983),c=n(445586),u=n(177774),d=n(154463),p=n(881150),_=n(187252),m=n(820717),f=n(444083),g=n(389953),A=n(662208),v=n(697483),h=n(562192),E=n(58600),C=n(745284),S=n(498110),y=n(719481),T=n(564840);!function(e){e[e.MAIN=0]="MAIN",e[e.CALL_LINK=1]="CALL_LINK",e[e.ADD_PARTICIPANTS=2]="ADD_PARTICIPANTS",e[e.WAITING_HALL=3]="WAITING_HALL"}(a||(a={}));var I=function(e){var t,n,I=e.bridge,b=e.SDK,N=e.navigateToConvo,w=e.navigateToProfile,L=e.allowAddMembers,P=void 0!==L&&L,k=(0,o.useSelector)((function(e){return e})),M=(0,o.useDispatch)(),O=(0,i.useContext)(S.ConfigContext).allowWaitingHall,D=(0,r.__read)((0,i.useState)(k.callData.callUrlLink||""),2),R=D[0],B=D[1],x=k.managementView||a.MAIN,U=(0,r.__read)((0,i.useState)(x),2),H=U[0],G=U[1],V=(0,r.__read)((0,i.useState)(!1),2),F=V[0],W=V[1],z=(0,r.__read)((0,i.useState)(!1),2),j=z[0],K=z[1],Y=(0,r.__read)((0,i.useState)(!1),2),Q=Y[0],Z=Y[1],J=(0,r.__read)((0,i.useState)(!1),2),q=J[0],X=J[1],$=(0,r.__read)((0,i.useState)(!1),2),ee=$[0],te=$[1],ne=P||!!(null===(t=k.callData.conversation)||void 0===t?void 0:t.canAddMembers),ae=null===(n=k.callData)||void 0===n?void 0:n.canFinishCall,re=i.useContext(A.LangContext).getLang,ie=(0,C.isRequireAuthToJoin)(k),oe=(0,C.isWaitingHallEnabled)(k),le=(0,i.useCallback)((function(){M({type:l.MANAGEMENT,isOpen:!1})}),[]),se=(0,i.useCallback)((function(){G(a.MAIN)}),[]),ce=function(e){var t=k.callData.callId||"";return W(!0),(0,m.loadCallUrlLink)(M,t,e,(0,C.isAuthedByGroupId)(k)?k.groupId:0).then((function(e){B(e),W(!1)})).catch((function(e){console.error(e),W(!1),M({type:l.ERROR,text:re("calls_get_url_link_error_text")})}))},ue=(0,i.useCallback)((function(){G(a.CALL_LINK),R||ce(!1).catch((function(){G(a.MAIN)}))}),[k.callData.callId,R]),de=(0,i.useCallback)((function(){M({type:l.SHOW_LOADER,isLoaderVisible:!0});var e=[(0,m.loadFriendsAction)(I,k,M)].concat((0,g.isChatPeer)(k.peer)?[(0,m.loadChatMembersAction)(k,M,k.peer,k.callData.conversation)]:[]).concat(I.authorizedGroupId?[(0,m.loadAllowedToCallGroupMembersAction)(I,k,M)]:[]);return Promise.all(e).then((function(){M({type:l.SHOW_LOADER,isLoaderVisible:!1}),G(a.ADD_PARTICIPANTS)})).catch((function(e){console.error(e),M({type:l.SHOW_LOADER,isLoaderVisible:!1})}))}),[k.peer,k.callData,k.friends,k.groupMembers]),pe=(0,i.useCallback)((function(){M({type:l.SHOW_LOADER,isLoaderVisible:!0});var e=[(0,y.loadAdditionalWaitingHall)(k,M)];return Promise.all(e).then((function(){M({type:l.SHOW_LOADER,isLoaderVisible:!1}),G(a.WAITING_HALL)})).catch((function(e){console.error(e),M({type:l.SHOW_LOADER,isLoaderVisible:!1})}))}),[k.waitingHall]),_e=(0,i.useCallback)((function(){M({type:l.TOGGLE_POPUP}),(0,f.onForceCallFinish)(b,k,M,re)}),[k.callData.callId,k.imHash]);(0,i.useEffect)((function(){x===a.CALL_LINK&&ue()}),[]),(0,i.useEffect)((function(){var e=k.participants[k.me],t=(0,v.participantIsAdmin)(e),n=t;Z(t),X(n),te(O&&t)}),[k.participants[k.me]]);var me=(0,i.useCallback)((function(e){(0,m.setAnonymousJoin)(e)}),[]),fe=(0,i.useCallback)((function(e){(0,m.setWaitingHall)(e)}),[]),ge=(0,i.useCallback)((function(){return K(!0)}),[]),Ae=(0,i.useCallback)((function(){return K(!1)}),[]),ve=(0,i.useCallback)((function(){ce(!0).catch((function(){G(a.MAIN)}))}),[k.callData.callId,R]);return i.createElement(i.Fragment,null,H===a.MAIN&&i.createElement(s.CallManagementModal,{title:re("calls_management_participants"),actionButtons:(ae?[i.createElement(p.default,{onClick:_e,key:"forceCallFinish",appearance:"secondary"},re("calls_force_call_finish"))]:[]).concat([i.createElement(p.default,{onClick:b.hangup,key:"leave"},re("calls_leave_call"))]),onCloseModal:le},i.createElement(c.CallManagementMenu,{isLinkBlockShown:ne,linkBlockTitle:re("calls_menu_link"),onLinkBlockClick:ue,callUrlLink:R}),i.createElement(d.CallParticipantListContainer,{SDK:b,onAddClick:de,onShowMoreWaitingHall:pe,navigateToProfile:w,navigateToConvo:N})),H===a.CALL_LINK&&i.createElement(s.CallManagementModal,{title:re("calls_management_link"),hint:ie?re("calls_management_link_anonymous_disallowed_hint"):"",onCloseModal:le,isWithBackButton:x!==a.CALL_LINK,onBackClick:se,actionButtons:(q?[i.createElement(p.default,{key:"invalidate-link",appearance:"tertiary",onClick:ve},re("calls_link_invalidate"))]:[]).concat([i.createElement(E.CopyText,{key:"copy-link",text:R},i.createElement(p.default,{className:"CallManagementModal__copyTextButton",disabled:F,onClick:ge},re("calls_link_copy")))])},i.createElement(u.CallLink,{link:R,isLinkLoading:F,isCopied:j,hideCopiedText:Ae}),Q&&i.createElement(h.CallLinkSettings,{onRequireAuthToJoinChanged:me,requireAuthToJoin:ie,isWaitingHallBlockShown:ee,onWaitingHallEnabledChanged:fe,isWaitingHallEnabled:oe})),H===a.ADD_PARTICIPANTS&&i.createElement(_.GroupCallSetupContainer,{bridge:I,SDK:b,isWithBackButton:!0,onBackClick:se}),H===a.WAITING_HALL&&i.createElement(T.WaitingHallListContainer,{isModal:!0,isWithBackButton:!0,onBackClick:se,navigateToProfile:w}))}},690015:(e,t,n)=>{"use strict";n.d(t,{CallNotificationContainer:()=>g});var a=n(570655),r=n(667294),i=n(121255),o=n(80125),l=n(662208),s=n(925082),c=n(112877),u=n(818114),d=n(911099),p=n(50533),_=n(745284),m=n(662727),f=n(697483),g=function(e){var t=e.dispatch,n=e.notification,g=e.participant,A=r.useContext(l.LangContext),v=A.getLang,h=A.langSex,E=(0,p.useSelector)((function(e){return e})),C=(0,r.useMemo)((function(){return function(e,t,n,a){void 0===a&&(a={name:"",sex:"0",shortName:""});if(!e)return null;switch(e.type){case i.NotificationType.SPEAKING_ON_MUTE:return t("calls_notification_mic_is_mute");case i.NotificationType.SCREEN_SHARING_STARTED:if(!a||!a.name)return r.createElement("span",null,t("calls_notification_screen_sharing_started"));var l=n(a.sex,"calls_notification_user_started_screen_sharing",t("calls_notification_user_started_screen_sharing",!0));return r.createElement("span",null,l.replace("{user}",a.name));case i.NotificationType.RAISED_HAND:if(!a||!a.name)return null;l=n(a.sex,"calls_notification_raised_hand",t("calls_notification_raised_hand",!0));return r.createElement("span",null,l.replace("{user}",a.name));case i.NotificationType.BAD_NETWORK_CONNECTION:return r.createElement("span",null,t("calls_notification_bad_network_connection"));case i.NotificationType.BAD_NETWORK_CONNECTION_DISABLE_CAMERA:return[r.createElement(o.DisabledVideoIconS,{key:"icon"}),r.createElement("span",{key:"text"},t("calls_notification_bad_network_connection_disable_camera"))];case i.NotificationType.ADMIN_ROLE_GRANTED:return r.createElement("span",{key:"text"},t("calls_notification_admin_role_granted"));case i.NotificationType.USER_GRANTED_WITH_ADMIN_ROLE:var s=t("calls_notification_user_granted_with_admin_role").replace("{name}",a.shortName||a.name);return r.createElement("span",{key:"text"},s);case i.NotificationType.PINNED_BY_ADMIN:return r.createElement("span",{key:"text"},t("calls_notification_admin_pinned_self"));case i.NotificationType.USER_PINNED_BY_ADMIN:s=t("calls_notification_admin_pinned_user").replace("{name}",a.shortName||a.name);return r.createElement("span",{key:"text"},s);case i.NotificationType.PUSH_TO_TALK:s=t("calls_notification_push_to_talk_enabled");return[e.data?r.createElement(c.MicIconWithSpeakingIndicator,{key:"icon"}):r.createElement(u.MicIcon,{key:"icon"}),r.createElement("div",{key:"text",className:"CallNotification__pushToTalkText"},s)];case i.NotificationType.LINK_COPIED_TO_CLIPBOARD:s=t("calls_create_call_by_link_copied");return r.createElement("span",{key:"text"},s);case i.NotificationType.ADMIN_MUTE:return r.createElement("span",{key:"text"},t("calls_notification_admin_mute"));case i.NotificationType.ADMIN_MUTE_AUDIO:return r.createElement("span",{key:"text"},t("calls_notification_admin_mute_audio"));case i.NotificationType.ADMIN_MUTE_VIDEO:return r.createElement("span",{key:"text"},t("calls_notification_admin_mute_video"));case i.NotificationType.ADMIN_MUTE_PERMANENT:return r.createElement("span",{key:"text"},t("calls_notification_admin_permanent_mute"));case i.NotificationType.ADMIN_MUTE_PERMANENT_AUDIO:return r.createElement("span",{key:"text"},t("calls_notification_admin_permanent_mute_audio"));case i.NotificationType.ADMIN_MUTE_PERMANENT_VIDEO:return r.createElement("span",{key:"text"},t("calls_notification_admin_permanent_mute_video"));case i.NotificationType.ADMIN_UNMUTE_PERMANENT:return r.createElement("span",{key:"text"},t("calls_notification_admin_unmute"));case i.NotificationType.ADMIN_UNMUTE_PERMANENT_AUDIO:return r.createElement("span",{key:"text"},t("calls_notification_admin_unmute_audio"));case i.NotificationType.ADMIN_UNMUTE_PERMANENT_VIDEO:return r.createElement("span",{key:"text"},t("calls_notification_admin_unmute_video"));default:return null}}(n,v,h,g)}),[n]),S=(0,r.useRef)(0);(0,r.useEffect)((function(){return S.current&&window.clearTimeout(S.current),n&&0!==n.timer&&(S.current=window.setTimeout((function(){t({type:i.CALL_NOTIFICATION,notification:null}),S.current=0}),n.timer||i.defaultNotificationLifeSpan)),function(){S.current&&window.clearTimeout(S.current)}}),[n]);var y=(0,r.useMemo)((function(){return(0,f.getActiveParticipants)(E,!0)}),[E.participants,E.me,E.groupId,E.meGroup]),T=(0,r.useMemo)((function(){return(0,_.isGroupCallByPeer)(E.peer)}),[E.peer]),I=y.length>1,b=T||y.length>2,N=I||(0,f.isParticipantWithVideo)(E.participants[E.me]),w=b&&N&&E.isOratorMode,L=(0,d.classNames)("",{CallNotification__pushToTalk:(null==n?void 0:n.type)===i.NotificationType.PUSH_TO_TALK,CallNotification__orator:w&&E.isShownParticipantsAside}),P=E.peer,k=(0,_.isGroupCallByPeer)(P)?E.callData.conversation:E.participants[P],M=(0,a.__read)(r.useState(),2),O=M[0],D=M[1],R=(0,a.__read)(r.useState(""),2),B=R[0],x=R[1];return(null==k?void 0:k.status)!==O&&(x((0,m.getCallStatus)(E,v)),D(null==k?void 0:k.status)),r.useEffect((function(){x((0,m.getCallStatus)(E,v))}),[E]),n||B?r.createElement(s.CallNotification,{className:L},B||C):null}},154463:(e,t,n)=>{"use strict";n.d(t,{CallParticipantListContainer:()=>C});var a=n(570655),r=n(667294),i=n(50533),o=n(813245),l=n(750598),s=n(248586),c=n(884143),u=n(431469),d=n(279060),p=n(310765),_=n(51247),m=n(916972),f=n(697483),g=n(662208),A=n(613335),v=n(564840),h=n(464380),E=n(956462),C=function(e){var t=e.SDK,n=e.onAddClick,C=e.navigateToProfile,S=e.navigateToConvo,y=e.onShowMoreWaitingHall,T=(0,i.useSelector)((function(e){return e})),I=r.useContext(g.LangContext).getLang,b=(0,a.__read)(function(e){var t=!!e.groupId;return Object.values(e.participants).reduce((function(n,a){var r=a,i=!1;return a.peerId===e.me?(t&&(null==e?void 0:e.meGroup)&&(r=(0,A.mergeGroupToParticipant)(e.meGroup,a)),i=!0):a.status&&(i=!0),i&&(n[0].push(r),r.name&&n[1].push(r)),n}),[[],[]])}(T),2),N=b[0],w=b[1],L=(0,a.__read)((0,r.useState)(""),2),P=L[0],k=L[1],M=(0,a.__read)((0,r.useState)(100),2),O=M[0],D=M[1],R=(0,r.useCallback)((function(e){return e.name}),[]),B=(0,r.useCallback)((function(e){return e.peerId}),[]),x=(0,u.useIndexer)(w,R,B),U=(0,f.canMuteParticipants)(T.participants[T.me]),H=P?x.search(P):N,G=(0,r.useCallback)((function(e){k(e.target.value)}),[]),V=!(0,f.isParticipantAnonym)(T.me);return r.createElement(o.CallParticipantList,{searchQuery:P,onSearchChange:G,length:H.length,waitingHallList:T.waitingHall&&r.createElement(v.WaitingHallListContainer,{isModal:!1,navigateToProfile:C,onMore:y})},!P&&V&&r.createElement(l.default,{selectable:!1,border:!1,key:"add"},r.createElement(m.ListAddControl,{onClick:n},I("calls_add_participants"))),H.length>0&&H.slice(0,O).map((function(e){var n,a,i,o,c=e.peerId!==T.me&&e.status===h.ParticipantStatus.WAITING,u=!c&&!(null===(n=e.mediaSettings)||void 0===n?void 0:n.isAudioEnabled),m=!c&&!(null===(a=e.mediaSettings)||void 0===a?void 0:a.isVideoEnabled),g=!c&&!!(null===(o=null===(i=e.statusData)||void 0===i?void 0:i.hand)||void 0===o?void 0:o.state),A=!!T.speakers[e.peerId],v=c||u||g||A,E=e.peerId===T.me,y=!c&&(u||m)&&U&&!E;return r.createElement(l.default,{selectable:!1,border:!1,key:e.peerId,aside:r.createElement(r.Fragment,null,v&&r.createElement(_.ParticipantIndicators,{showSpeaking:A,showRaisedHand:g,showAudioDisabled:u,showConnecting:c,showRaisedHandTooltip:y,onRaisedHandClick:y?function(){return function(e){var n=T.participants[e],a=(0,f.getParticipantExternalId)(n);a&&t.muteParticipant(a,{},[h.MediaOption.AUDIO,h.MediaOption.VIDEO,h.MediaOption.SCREEN_SHARING]).catch(console.log)}(e.peerId)}:void 0,key:"indicators"}),r.createElement(p.ParticipantMenuContainer,{SDK:t,participant:e,key:"menu",navigateToConvo:S,navigateToProfile:C}))},r.createElement(s.default,{onLinkClick:C,photo:r.createElement(d.CallPhoto,{id:e.peerId,photo:e.photo,alt:e.name||"",showCreatorBadge:(0,f.isCreator)(e),showAdminBadge:(0,f.isAdmin)(e)}),title:e.name,href:e.link,target:"_blank"}))})),H.length>O&&r.createElement(l.default,{key:"limit"},r.createElement(E.ListMore,{className:"CallParticipantList__more",onClick:function(){D(O+100)}},I("calls_participants_show_more").replace("{n}","100"))),P&&0===H.length&&r.createElement(c.default,null,I("calls_participants_not_found")))}},165999:(e,t,n)=>{"use strict";n.d(t,{CallsErrorBoundary:()=>o});var a=n(570655),r=n(667294),i=n(121255),o=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return(0,a.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e){switch(this.props.mode){case i.Mode.CALL:this.props.SDK.hangup();break;case i.Mode.INCOMING:this.props.SDK.declineCall()}this.props.onReset(),this.setState({hasError:!1}),console.error("Calls crashed:",e,e)},t.prototype.render=function(){return this.state.hasError?null:this.props.children},t}(r.Component)},963532:(e,t,n)=>{"use strict";n.d(t,{CautionContainer:()=>_});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(464380),s=n(614914),c=n(745284),u=n(697483),d=n(662208),p=n(440896),_=function(e){var t=e.isIncoming,n=void 0!==t&&t,_=(0,r.useSelector)((function(e){return e})),m=(0,r.useDispatch)(),f=(0,a.useContext)(d.LangContext).getLang,g=f(n?"calls_reject_title":"calls_hangup_description"),A=f(n?"calls_reject_description":"calls_hangup_description"),v=(0,a.useCallback)((function(){m({type:o.SHOW_CAUTION_BOX,isOpen:!1})}),[]),h=function(){v(),n?(0,l.declineCall)().catch((function(){})):((0,l.hangup)().catch((function(){})),s.callStats.logEvent({call_event_type:o.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:_.callData.callId,peer_id:_.peer,is_group_call:(0,c.isGroupCallByPeer)(_.peer),reason:"none",group_call_users_count:(0,u.getActiveParticipantsCount)(_)}))},E=a.createElement(a.Fragment,null,a.createElement(i.default,{appearance:"secondary",onClick:v},f("calls_cancel_reject")),a.createElement(i.default,{onClick:h},f("calls_reject"))),C=a.createElement(a.Fragment,null,a.createElement(i.default,{onClick:h},f("calls_yes")),a.createElement(i.default,{onClick:v},f("calls_no")));return a.createElement(p.CallError,{title:g,onClose:v,actionButtons:n?E:C,text:a.createElement("span",{dangerouslySetInnerHTML:{__html:A}})})}},923947:(e,t,n)=>{"use strict";n.d(t,{CollapsedCallContainer:()=>g});var a=n(570655),r=n(667294),i=n(50533),o=n(275109),l=n(400412),s=n(180474),c=n(121255),u=n(298811),d=n(745284),p=n(697483),_=n(662208),m=n(464380),f=n(147853),g=function(e){var t,n,g,A,v=e.SDK,h=(0,i.useSelector)((function(e){return e})),E=(0,i.useDispatch)(),C=r.useContext(_.LangContext).getLang,S=h.peer,y=(0,u.isAnyoneWithVideo)(h),T=(0,d.isGroupCallByPeer)(S)?h.callData.conversation:h.participants[S],I=h.participants[h.me],b=(0,p.getCallVisibleParticipant)(h,y),N=(0,p.isParticipantWithVideo)(I)&&b&&b.peerId!==h.me,w=(0,r.useCallback)((function(){E({type:c.CHANGE_UI_MODE,mode:c.UIMode.DEFAULT}),(0,f.setNeedPushToTalkToggleAudio)(!1)}),[]),L=(null===(t=null==I?void 0:I.mediaSettings)||void 0===t?void 0:t.isAudioEnabled)||(null===(n=I.permissions)||void 0===n?void 0:n.audio)>0,P=(0,r.useCallback)((function(){var e;v.toggleLocalAudio(!(null===(e=I.mediaSettings)||void 0===e?void 0:e.isAudioEnabled))}),[h]);return r.createElement(o.CollapsedCall,null,h.mode===c.Mode.INCOMING&&r.createElement(l.CallWidget,{id:S,title:(null==T?void 0:T.tab)||"",photo:(null==T?void 0:T.photo)||"",status:C("calls_incoming_collapsed"),isIncoming:!0,onClick:w}),h.mode!==c.Mode.INCOMING&&r.createElement(s.CallVideoWidget,(0,a.__assign)({localVideoStream:N?(0,p.getStream)(I):void 0,isLocalAudioEnabled:!!(null===(g=I.mediaSettings)||void 0===g?void 0:g.isAudioEnabled),isLocalAudioAllowed:L,isLocalScreenSharing:!!(null===(A=I.mediaSettings)||void 0===A?void 0:A.isScreenSharingEnabled)},function(e,t,n){var a,r;return e?{participantId:e.peerId,isMe:e.peerId===n,isWithVideo:(0,p.isParticipantWithVideo)(e),isWithAudio:!!(null===(a=e.mediaSettings)||void 0===a?void 0:a.isAudioEnabled),isScreenSharing:!!(null===(r=e.mediaSettings)||void 0===r?void 0:r.isScreenSharingEnabled),stream:(0,p.getStream)(e),photo:e.photo,name:e.name,status:e.status,networkStatus:e.networkStatus}:{participantId:t&&t.peerId||0,isMe:!1,isWithVideo:!1,isWithAudio:!1,isScreenSharing:!1,stream:void 0,photo:t&&t.photo||"",name:t&&t.tab||"",status:t&&t.status||m.ParticipantStatus.CONNECTED,networkStatus:1}}(b,T,h.me),{onRestoreCall:w,onToggleAudio:P})))}},241715:(e,t,n)=>{"use strict";n.d(t,{CollapsedWaitingHallContainer:()=>u});var a=n(570655),r=n(667294),i=n(50533),o=n(275109),l=n(180474),s=n(121255),c=n(697483),u=function(e){var t,n=e.SDK,u=(0,i.useSelector)((function(e){return e})),d=(0,i.useDispatch)(),p=u.participants[u.me],_=(0,r.useCallback)((function(){d({type:s.CHANGE_UI_MODE,mode:s.UIMode.DEFAULT})}),[]),m=(0,r.useCallback)((function(){var e;n.toggleLocalAudio(!(null===(e=p.mediaSettings)||void 0===e?void 0:e.isAudioEnabled))}),[u]);return r.createElement(o.CollapsedCall,null,r.createElement(l.CallVideoWidget,(0,a.__assign)({},function(e){var t,n;return{participantId:e.peerId,isMe:!0,isWithVideo:(0,c.isParticipantWithVideo)(e),isWithAudio:!!(null===(t=e.mediaSettings)||void 0===t?void 0:t.isAudioEnabled),isScreenSharing:!!(null===(n=e.mediaSettings)||void 0===n?void 0:n.isScreenSharingEnabled),stream:(0,c.getStream)(e),photo:e.photo,name:e.name,status:e.status,networkStatus:e.networkStatus}}(p),{onRestoreCall:_,isMe:!0,isLocalAudioEnabled:!!(null===(t=p.mediaSettings)||void 0===t?void 0:t.isAudioEnabled),isLocalAudioAllowed:!0,isLocalScreenSharing:!1,onToggleAudio:m})))}},262409:(e,t,n)=>{"use strict";n.d(t,{CreateCallByLinkContainer:()=>_});var a=n(570655),r=n(667294),i=n(662208),o=n(50533),l=n(121255),s=n(881150),c=n(614183),u=n(613335),d=n(329538),p=n(464380),_=function(e){var t=e.bridge,n=(0,o.useSelector)((function(e){return e})),_=(0,o.useDispatch)(),m=r.useContext(i.LangContext).getLang,f=(0,u.getMe)(n),g=(0,a.__read)((0,r.useState)(f.peerId),2),A=g[0],v=g[1],h=(0,a.__read)((0,r.useState)([{value:f.peerId,label:f.name}]),2),E=h[0],C=h[1],S=(0,a.__read)((0,r.useState)(!1),2),y=S[0],T=S[1],I=(0,a.__read)((0,r.useState)(!0),2),b=I[0],N=I[1];(0,r.useEffect)((function(){(0,d.getGroupsForCall)().then((function(e){var t=(0,a.__spreadArray)([],(0,a.__read)(E));e.count>0&&(e.items.forEach((function(e){t.push({value:-e.id,label:e.name})})),C(t))}))}),[]);var w=(0,r.useCallback)((function(e){v(Number(e.selected.value))}),[]),L=(0,r.useCallback)((function(e){void 0!==e&&(e.preventDefault(),T(!y))}),[y]),P=(0,r.useCallback)((function(e){void 0!==e&&(e.preventDefault(),N(!b))}),[b]),k=(0,r.useCallback)((function(){_({type:l.CHANGE_MODE,mode:l.Mode.READY})}),[]),M=(0,r.useCallback)((function(){var e,a={};b||(a[p.ConversationOption.REQUIRE_AUTH_TO_JOIN]=!0),y&&(a[p.ConversationOption.WAITING_HALL]=!0),t.startCall(!1,null!==(e=n.entryPoint)&&void 0!==e?e:l.CallStatSource.HISTORY_CREATE,!1,A>0?0:A,{conversationOptions:a,createLink:!0})}),[A,y,b]),O=[r.createElement(s.default,{key:"cancel",onClick:k,appearance:"tertiary"},m("calls_cancel")),r.createElement(s.default,{key:"call",onClick:M},m("calls_create_call_by_link"))];return r.createElement(c.CreateCallByLinkModal,{actionButtons:O,onClose:k,ownerOptions:E,selectedOwnerId:A,waitingHall:y,allowAnon:b,onGroupSelectChange:w,onChangeWaitingHall:L,onChangeAllowAnon:P})}},631183:(e,t,n)=>{"use strict";n.d(t,{DeleteCallContainer:()=>_});var a=n(570655),r=n(667294),i=n(881150),o=n(487318),l=n(171659),s=n(329538),c=n(464380),u=n(366521),d=n(664327),p=n(256480),_=function(){var e=(0,u.useHistoryScreenDispatch)(),t=(0,d.useLangContext)(),n=t.getLang,_=t.langShortDateTime,m=(0,u.useHistoryScreenSelector)((function(e){return e.deleteCallId})),f=(0,u.useHistoryScreenSelector)((function(e){return e.profiles})),g=(0,u.useHistoryScreenSelector)((function(e){return e.historyCalls})),A=(0,u.useHistoryScreenSelector)((function(e){return e.currentCalls})),v=m in g?g[m]:null,h=(0,r.useCallback)((function(){e((0,p.dispatchDeleteCall)(-1))}),[]),E=(0,r.useCallback)((function(){if((null==v?void 0:v.type)&&"merged"===(null==v?void 0:v.type)&&(null==v?void 0:v.items)){var t=v.items.reduce((function(e,t){return(null==t?void 0:t.id)&&e.push(t.id),e}),[]);t.length>0&&(0,c.removeHistoryRecords)(t)}else(null==v?void 0:v.id)&&(0,c.removeHistoryRecords)([v.id]);g.splice(m,1),e((0,p.dispatchSetHistoryCalls)((0,a.__spreadArray)([],(0,a.__read)(g)))),h()}),[v]),C=(0,r.useCallback)((function(){if(null==v?void 0:v.call_id){(0,s.forceCallFinish)(v.call_id);var t=A.filter((function(e){return e.call_id!==v.call_id}));e((0,p.dispatchSetCurrentCalls)(t))}E()}),[v]),S=[];if((null==v?void 0:v.can_finish_call)&&(S=S.concat([r.createElement(i.default,{onClick:function(){C()},key:"finishAndDeleteCall",appearance:"secondary"},n("calls_history_delete_and_finish_call_button"))])),S=S.concat([r.createElement(i.default,{onClick:function(){E()},key:"deleteCall"},n("calls_history_delete_call_button"))]),!v)return r.createElement(r.Fragment,null);var y=(0,l.getHistoryItemOwner)(v,f),T=y.member,I=y.chat;if(!T&&!I)return r.createElement(r.Fragment,null);var b="";if(I)b=n("calls_history_delete_group_call").replace("%name",I.title);else{if(!T)return r.createElement(r.Fragment,null);var N=v.is_missed,w=v.is_inbound;b=n(N&&w?"calls_history_delete_missed_call":!N&&w?"calls_history_delete_inbound_call":N&&!w?"calls_history_delete_declined_call":"calls_history_delete_outbound_call"),b=String(b).replace("%name",String(T.nameGen))}var L=(null==v?void 0:v.finished_at)?_(v.finished_at):"";return b=b.replace("%date",L),r.createElement(o.DeleteCallModal,{onClose:h,actionButtons:S,text:b})}},599648:(e,t,n)=>{"use strict";n.d(t,{ErrorContainer:()=>u});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(662208),s=n(464380),c=n(440896),u=function(e){var t=e.title,n=e.text,u=e.onCloseFatal,d=e.handleType,p=e.callId,_=e.bridge,m=(0,r.useDispatch)(),f=a.useContext(l.LangContext).getLang,g=function(){switch(m({type:o.ERROR,isClosed:!0}),d){case o.ErrorHandleType.FATAL:u();break;case o.ErrorHandleType.DECLINE:(0,s.declineCall)().catch((function(){}));break;case o.ErrorHandleType.PROCESS:(0,s.processPush)(p||"").then((function(){(0,s.declineCall)().catch((function(){}))})).catch((function(e){_.debug&&console.error("Delayed by error push process error",e)}))}},A=n||f("calls_error"),v=A.match(/<\s?[a-zA-Z0-9]+\s?\/?>/)?a.createElement("span",{dangerouslySetInnerHTML:{__html:A}}):A;return a.createElement(c.CallError,{title:t||f("calls_oops"),onClose:g,actionButtons:a.createElement(i.default,{onClick:g},f("calls_close")),text:v})}},379981:(e,t,n)=>{"use strict";n.d(t,{FeedbackContainer:()=>v});var a,r=n(570655),i=n(667294),o=n(50533),l=n(269481),s=n(121255),c=n(25947),u=n(662208),d=n(614914),p=n(745284),_=n(950890),m=n(659397),f=n(254060),g=n(731585),A=n(244809);!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.ADVANCE=1]="ADVANCE"}(a||(a={}));var v=function(e){var t=e.onSuccessFeedback,n=(0,o.useDispatch)(),v=(0,o.useSelector)((function(e){return e})),h=i.useContext(u.LangContext).getLang,E=(0,r.__read)((0,i.useState)(a.DEFAULT),2),C=E[0],S=E[1],y=(0,r.__read)((0,i.useState)(!0),2),T=y[0],I=y[1],b=(0,r.__read)((0,i.useState)(!1),2),N=b[0],w=b[1],L=new Map([["DID_NOT_HEAR_INTERLOCUTOR",h("calls_feedback_reason_did_not_hear_interlocutor")],["DID_NOT_SEE_INTERLOCUTOR",h("calls_feedback_reason_did_not_see_interlocutor")],["BAD_VIDEO_QUALITY",h("calls_feedback_reason_bad_video_quality")],["VIDEO_FREEZES",h("calls_feedback_reason_video_freezes")],["VERY_QUIET_SOUND",h("calls_feedback_reason_very_quiet_sound")],["BAD_SOUND_QUALITY",h("calls_feedback_reason_bad_sound_quality")],["SOUND_DID_NOT_MATCH_THE_VIDEO",h("calls_feedback_reason_sound_did_not_match_the_video")],["FAILED_TO_TURN_ON_CAMERA_OR_MICROPHONE",h("calls_feedback_reason_failed_to_turn_on_camera_or_microphone")]]),P=(0,r.__read)((0,i.useState)({user_response:0,feedback:[],custom_feedback:void 0}),2),k=P[0],M=P[1],O=(0,r.__read)((0,i.useState)(Array.from(L,(function(e){return{name:(0,r.__read)(e,1)[0],checked:!1}}))),1)[0],D=function(){n({type:s.CHANGE_MODE,mode:s.Mode.READY})},R=function(e){var t=e.target.getAttribute("data-response");if(t){var n=parseInt(t,10);n<=3&&S(a.ADVANCE),M((0,r.__assign)((0,r.__assign)({},k),{user_response:n})),I(!1)}},B=function(e,t){O.forEach((function(n){n.name===e&&(n.checked=t)})),M((function(e){return(0,r.__assign)((0,r.__assign)({},e),{feedback:O.filter((function(e){return e.checked})).map((function(e){return e.name}))})}))},x=function(e,t){w(t)},U=function(e){M((0,r.__assign)((0,r.__assign)({},k),{custom_feedback:e.currentTarget.value}))};return i.createElement(l.CallModal,{onClose:D,onBackdropClick:D},i.createElement("section",{className:"Call"},i.createElement(c.FeedbackScreen,{title:C===a.DEFAULT?h("calls_feedback_default_title"):h("calls_feedback_advance_title"),sendButtonClick:function(){var e=(v.lastCallData?v.lastCallData.peerId:0)||0;d.callStats.logEvent({call_event_type:s.CallActionEventType.USER_FEEDBACK_RECEIVED,session_id:v.lastCallData?v.lastCallData.callId:"",peer_id:e,is_group_call:(0,p.isGroupCallByPeer)(e),user_response:k.user_response,feedback:k.feedback,custom_feedback:N&&k.custom_feedback?k.custom_feedback:void 0}),n({type:s.CHANGE_MODE,mode:s.Mode.READY}),t&&t()},skipButtonClick:D,sendButtonDisabled:T},C===a.DEFAULT?i.createElement("div",{className:"FeedbackScreen__stars",onClick:R},[1,2,3,4,5].map((function(e,t){return i.createElement("div",{className:(0,m.classNames)("FeedbackScreen__star",{"FeedbackScreen__star--active":e<=k.user_response}),"data-response":e,key:t},i.createElement(_.StarOutline,{className:"FeedbackScreen__starIcon FeedbackScreen__starIcon--outline"}),i.createElement(f.StarFilled,{className:"FeedbackScreen__starIcon FeedbackScreen__starIcon--filled"}))}))):i.createElement("div",{className:"FeedbackScreen__voting"},Array.from(L,(function(e){var t=(0,r.__read)(e,2),n=t[0],a=t[1];return i.createElement("div",{className:"FeedbackScreen__votingItem",key:n},i.createElement(g.default,{name:n,className:"FeedbackScreen__votingItemCheckbox",onChange:B},a))})),i.createElement("div",{className:"FeedbackScreen__votingItem FeedbackScreen__votingItem--custom"},i.createElement(g.default,{name:"CUSTOM_FEEDBACK",className:"FeedbackScreen__votingItemCheckbox",onChange:x}),i.createElement(A.default,{className:"FeedbackScreen__votingItemTextArea",placeholder:h("calls_feedback_custom_reason_placeholder"),grow:!1,disabled:!N,onChange:U}))))))}},187252:(e,t,n)=>{"use strict";n.d(t,{GroupCallSetupContainer:()=>f});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(881150),s=n(186983),c=n(782605),u=n(298811),d=n(614914),p=n(745284),_=n(697483),m=n(662208),f=function(e){var t=e.SDK,n=e.bridge,f=e.isWithBackButton,A=e.onBackClick,v=(0,i.useSelector)((function(e){return e})),h=(0,i.useDispatch)(),E=r.useContext(m.LangContext).getLang,C=(0,a.__read)((0,r.useState)(v.preselectedIds||[]),2),S=C[0],y=C[1],T=(0,a.__read)((0,r.useState)((0,_.getActiveParticipantsCount)(v)),1)[0]+S.length,I=function(){h({type:o.GROUP_CALL_SETUP,open:!1,preselectedIds:null}),h({type:o.MANAGEMENT,isOpen:!1})},b=0===S.length,N=function(e){I(),h({type:o.MANUAL_ADD_PARTICIPANTS,participants:e});var n=e.map((function(e){return new Promise((function(n){t.addParticipant(String(e)).then(n).catch((function(t){"auth.banned"===t.message?n(e):"vk-participant-is-rejected-error"===t.message?h({type:o.ERROR,text:E("calls_error_cant_add_because_of_privacy")}):n(null)}))}))}));Promise.all(n).then((function(e){if((e=e.filter((function(e){return void 0!==e}))).length){var t=function(e,t){var n=(0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(e.friends)),(0,a.__read)(e.chatMembers)),(0,a.__read)(e.groupMembers)),r=[];return n.filter((function(e){var n=e.id;return!(!t.includes(n)||r.includes(n))&&(r.push(n),!0)}))}(v,e);h({type:o.UNBAN_PARTICIPANTS,data:{members:t}})}}));var r=(0,a.__read)((0,u.convertClientData)(function(e,t){var n=e.chatData||e.callData.conversation,r=t.reduce((function(t,n){return e.participants[n]||t.set(n,!0),t}),new Map);if(0===r.size)return[n,[]];var i=e.chatMembers.length<e.friends.length?e.chatMembers:e.friends,o=e.chatMembers.length<e.friends.length?e.friends:e.chatMembers,l=i.reduce((function(e,t){return r.get(t.id)&&(e.smallerListData.push(t),e.smallerListMap.set(t.id,!0)),e}),{smallerListData:[],smallerListMap:new Map}),s=l.smallerListData,c=l.smallerListMap;if(s.length===r.size)return[n,s];var u=o.filter((function(e){return!c.get(e.id)&&r.get(e.id)}));return[n,(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(s)),(0,a.__read)(u))]}(v,e)),2),i=r[0],l=r[1];h({type:o.LOAD_PEERS,conversation:i,members:l}),d.callStats.logEvent({call_event_type:o.CallActionEventType.OUTGOING_CALL_ADD_PARTICIPANTS_SENT,session_id:v.callData.callId,peer_id:v.peer.toString(),is_group_call:(0,p.isGroupCallByPeer)(v.peer),group_call_users_count:S.length})},w=(0,r.useCallback)((function(){N(S)}),[S]);return r.createElement(s.CallManagementModal,{title:E("calls_add_participants_to_call"),onCloseModal:I,actionButtons:r.createElement(l.default,{key:"add",disabled:b,onClick:w},E("calls_add")),hint:g(T,v.participantLimit,E),isWithBackButton:f,onBackClick:f?A:function(){}},r.createElement(c.AddParticipantContainer,{groupId:n.authorizedGroupId||0,onChange:y,onClickCallAll:function(e){N(e)}}))};function g(e,t,n){return e<2?n("calls_management_add_warning"):n("calls_selected").replace("{selected}",""+e).replace("{limit}",""+t)}},908484:(e,t,n)=>{"use strict";n.d(t,{default:()=>s});var a=n(667294),r=n(631183),i=n(328931),o=n(923469),l=n(366521);const s=function(){var e=(0,l.useHistoryScreenSelector)((function(e){return e.error})),t=(0,l.useHistoryScreenSelector)((function(e){return e.deleteCallId}));return a.createElement(a.Fragment,null,a.createElement(i.HistoryScreenContainer,null),t>=0&&a.createElement(r.DeleteCallContainer,null),null!==e&&a.createElement(o.HistoryScreenErrorContainer,null))}},328931:(e,t,n)=>{"use strict";n.d(t,{HistoryScreenContainer:()=>I});var a=n(667294),r=n(328962),i=n(256480),o=n(410326),l=n(410133),s=n(988121),c=n(749399),u=n(464578),d=n(124198),p=n(638178),_=n(366521),m=n(664327),f=n(362621),g=n(744499),A=n(714783),v=n(881150),h=n(473900),E=n(695265),C=n(255778),S=n(153907),y=n(233194),T=n(121255),I=function(){var e=(0,m.useLangContext)().getLang,t=(0,_.useHistoryScreenSelector)((function(e){return e.showCreateCall})),n=(0,_.useHistoryScreenSelector)((function(e){return e.showDesktopAppBanner})),I=(0,o.useHistoryScreenLocation)(window.location),b=I.section,N=I.setSection,w=(0,l.useHistoryScreenBridgeActions)().onCreateCallClick,L=(0,s.useHistoryScreenLoading)(),P=L.loading,k=L.setLoading,M=(0,a.useMemo)((function(){return[{id:"",label:e("calls_page_menu_all_calls"),href:"calls",ref:(0,a.createRef)()},{id:"missed",label:e("calls_page_menu_miss_calls"),href:"calls?section=missed",ref:(0,a.createRef)()},{id:"sep",separator:!0},{id:"current",label:e("calls_page_menu_current_calls"),href:"calls?section=current",ref:(0,a.createRef)()},{id:"friends",label:e("calls_page_menu_friends_calls"),href:"calls?section=friends",ref:(0,a.createRef)()}]}),[]),O=(0,a.useCallback)((function(e,t){return(0,i.changeQuery)(t),N(e),k(!0),Promise.resolve()}),[]),D=(0,a.useMemo)((function(){return b===f.HistoryScreenSections.MISS?a.createElement(c.HistoryScreenSectionMissedCallsContainer,null):b===f.HistoryScreenSections.FRIENDS?a.createElement(u.HistoryScreenSectionFriendsContainer,null):b===f.HistoryScreenSections.CURRENT?a.createElement(d.HistoryScreenSectionCurrentCallsContainer,null):a.createElement(p.HistoryScreenSectionAllCallsContainer,{onMenuItemClick:O})}),[b]),R=(0,a.useMemo)((function(){if(!n)return a.createElement(a.Fragment,null);var t=function(e,t,n){return a.createElement(v.default,{appearance:"secondary",className:"CallHistoryScreen--bannerButton",onClick:n},t,a.createElement("div",{className:"CallHistoryScreen--bannerButtonIcon"},e))},r=function(){return t(a.createElement(E.AppleIcon,null),"Mac",(function(){return(0,S.download)("/calls?act=download_app&type=mac",T.DESKTOP_CALLS_FILENAME[y.OS.MAC])}))},i=function(){return t(a.createElement(h.WindowsIcon,null),"Windows",(function(){return(0,S.download)("/calls?act=download_app&type=windows",T.DESKTOP_CALLS_FILENAME[y.OS.WINDOWS])}))},o=function(){return t(a.createElement(C.LinuxIcon,null),"Linux",(function(){return(0,S.openDesktopPage)("/calls?act=download_app&type=linux")}))},l=!1,s=a.createElement(a.Fragment,null);return y.Platform.OS===y.OS.WINDOWS?s=i():y.Platform.OS===y.OS.MAC?s=r():y.Platform.OS===y.OS.LINUX?s=o():(s=i(),l=!0),a.createElement(g.default,{className:"CallHistoryScreen--banner"},a.createElement(A.CallLogoIcon,{lang:window.langConfig.locale}),a.createElement("div",{className:"CallHistoryScreen--bannerDesc"},e("calls_history_desktop_banner_description")),a.createElement("div",{className:"CallHistoryScreen--bannerSubDesc"},e("calls_history_desktop_banner_sub_description")),a.createElement("div",{className:"CallHistoryScreen--bannerButtons"},s,l&&a.createElement("div",{className:"CallHistoryScreen--bannerButtonsSecond"},r(),o())))}),[n]);return a.createElement(r.CallHistoryScreen,{showCreateCall:t,onCreateCallClick:w,activeMenuItem:b,menuItems:M,onMenuItemClick:O,loading:P,banner:R},D)}},923469:(e,t,n)=>{"use strict";n.d(t,{HistoryScreenErrorContainer:()=>c});var a=n(667294),r=n(881150),i=n(440896),o=n(366521),l=n(664327),s=n(256480),c=function(){var e=(0,o.useHistoryScreenDispatch)(),t=(0,o.useHistoryScreenSelector)((function(e){return e.error})),n=(0,l.useLangContext)().getLang,c=function(){e((0,s.dispatchSetError)(null))};return a.createElement(i.CallError,{title:a.createElement(a.Fragment,null,(null==t?void 0:t.title)||n("calls_oops")," "),onClose:c,actionButtons:a.createElement(r.default,{onClick:c},n("calls_close")),text:a.createElement(a.Fragment,null,null==t?void 0:t.text)})}},638178:(e,t,n)=>{"use strict";n.d(t,{HistoryScreenSectionAllCallsContainer:()=>k});var a=n(570655),r=n(667294),i=n(121255),o=n(50533),l=n(343035),s=n(20845),c=n(744499),u=n(150364),d=n(409364),p=n(115706),_=n(410133),m=n(462176),f=n(856612),g=n(329538),A=n(539503),v=n(253312),h=n(164904),E=n(613335),C=n(581685),S=n(539052),y=n(295886),T=n(659397),I=n(148434),b=n(884143),N=n(366521),w=n(664327),L=n(457532),P=n(256480),k=function(e){var t=e.onMenuItemClick,n=(0,o.useStore)(),k=(0,N.useHistoryScreenDispatch)(),M=(0,w.useLangContext)().getLang,O=(0,N.useHistoryScreenSelector)((function(e){return e.joinLinks})),D=(0,N.useHistoryScreenSelector)((function(e){return e.profiles})),R=(0,N.useHistoryScreenSelector)((function(e){return e.historyCalls})),B=(0,d.useHistoryScreenLoadActions)("all"),x=B.onShowMoreHistory,U=B.loading,H=B.showMoreHistory,G=B.loadHistory,V=(0,u.useHistoryScreenContextActions)().onHistoryAction,F=(0,_.useHistoryScreenBridgeActions)(),W=F.onCreateCallClick,z=F.onJoin,j=(0,L.useBaseObjectsContext)(),K=j.SDK,Y=j.bridge,Q=(0,a.__read)((0,r.useState)(0),2),Z=Q[0],J=Q[1],q=(0,a.__read)((0,r.useState)([]),2),X=q[0],$=q[1],ee=(0,h.useHistoryScreenCurrentCallsLoadActions)(),te=ee.currentCallsBlockLoading,ne=ee.currentCalls,ae=(0,a.__read)((0,r.useState)(!1),2),re=ae[0],ie=ae[1],oe=(0,a.__read)((0,r.useState)(!1),2),le=oe[0],se=oe[1],ce=(0,a.__read)((0,r.useState)([]),2),ue=ce[0],de=ce[1],pe=(0,a.__read)((0,r.useState)(!1),2),_e=pe[0],me=pe[1];(0,r.useEffect)((function(){se(!0),(0,g.getFriends)(7).then((function(e){var t=e.items.map(E.normalizeUser);de(t)})).finally((function(){se(!1)}))}),[]),(0,r.useEffect)((function(){X.length||(0,g.getGroupsForCall)().then((function(e){var t=e.count,n=e.items,a=[{value:0,label:M("calls_history_list_personal_option")}];t>0&&(n.forEach((function(e){var t=e.id,n=e.name;a.push({value:-t,label:n})})),$(a))}))}),[]);var fe=(0,r.useCallback)((function(e){var t=Number(e.selected.value);ie(!0),J(t),G(0,t,[],!0).then((function(e){ie(!1),e&&(0,v.checkAuthByGroupId)(K,Y,n,t,k,!0)}))}),[D,O,R]),ge=(0,r.useCallback)((function(e,n,a){e.preventDefault(),t(n,a)}),[]),Ae=(0,r.useMemo)((function(){return M(0===Z?"calls_history_list_stub":"calls_history_list_groups_stub")}),[Z]),ve=(0,r.useMemo)((function(){return X.length>1?r.createElement(A.default,{className:"CallHistoryScreen--listHeaderSelector",options:X,value:Z,onChange:fe}):r.createElement(r.Fragment,null)}),[X]),he=(0,r.useCallback)((function(e,t){return!(!e.ctrlKey&&!e.metaKey)||(e.preventDefault(),z("",t,i.CallStatSource.HISTORY_FRIENDS_LIST),!1)}),[]);return(0,r.useEffect)((function(){if(!U){var e=!(te||ne.length||U||R.length||0!==Z);me(e),k((0,P.dispatchSetShowCreateButton)(!e))}return function(){k((0,P.dispatchSetShowCreateButton)(!0))}}),[te,ne.length,U,R.length,Z]),r.createElement("div",{className:"CallHistoryScreen--content"},_e&&r.createElement(c.default,{className:(0,T.classNames)({"CallHistoryScreenLanding--pageBlock":!le&&0===ue.length})},r.createElement(p.CallHistoryScreenLanding,{onCreateCallClick:W})),le&&r.createElement(c.default,null,r.createElement(s.DivBlockSkeleton,{height:147})),!le&&ue.length>0&&r.createElement(c.default,null,r.createElement(y.ListHeader,{className:"CallHistoryScreen--listHeader",right:r.createElement(f.default,{href:"/calls?section=friends",onClick:function(){return ge(event,"friends","calls?section=friends")},className:"CallHistoryScreen--moreLink"},M("calls_history_show_all_friends_header_link"))},M("calls_history_friends_block_header")),r.createElement("ul",{className:"CallHistoryScreen--friendsList"},ue.map((function(e){return r.createElement("li",{key:e.id,className:"CallHistoryScreen--friendsListItem"},r.createElement("a",{href:e.link,onClick:function(){return he(event,e.peerId)}},r.createElement("div",{className:"CallHistoryScreen--friendsListItemContent"},r.createElement(C.default,{className:"CallHistoryScreen--friendsListItemPhoto",photo:e.photo,title:e.name}),r.createElement("div",{className:"CallHistoryScreen--friendsListItemPhotoHoverIcon"},r.createElement(S.default,{fill:"white"})),r.createElement("div",{className:"CallHistoryScreen--friendsListItemName"},e.firstName))))})))),te&&r.createElement(c.default,null,r.createElement(s.DivBlockSkeleton,{height:300})),!te&&ne.length>0&&r.createElement(c.default,{className:"CallHistoryScreen--currentCalls"},r.createElement(y.ListHeader,{className:"CallHistoryScreen--listHeader",extra:ne.length,right:ne.length?r.createElement(f.default,{onClick:function(){return ge(event,"current","calls?section=current")},href:"/calls?section=current",className:"CallHistoryScreen--moreLink"},M("calls_history_show_all_header_link")):""},M("calls_history_current_list_header")),r.createElement(m.CurrentCallsList,{currentCalls:ne.slice(0,5),profiles:D,onJoin:z})),U&&r.createElement(s.DivBlockSkeleton,{height:500}),!U&&(R.length>0||Z<0||0===Z&&re)&&r.createElement(c.default,null,r.createElement(y.ListHeader,{className:"CallHistoryScreen--listHeader",right:ve},M("calls_history_list_header")),re&&r.createElement(b.default,null,r.createElement(I.default,null)),!re&&r.createElement(l.CallHistoryList,{selectedOwnerId:Z,calls:R,onMenuItemClick:V,stubText:Ae,hasMore:H,onLoadMore:x})))}},124198:(e,t,n)=>{"use strict";n.d(t,{HistoryScreenSectionCurrentCallsContainer:()=>p});var a=n(667294),r=n(20845),i=n(744499),o=n(410133),l=n(462176),s=n(884143),c=n(164904),u=n(988121),d=n(664327),p=function(){var e=(0,d.useLangContext)().getLang,t=(0,o.useHistoryScreenBridgeActions)().onJoin,n=(0,c.useHistoryScreenCurrentCallsLoadActions)(),p=n.currentCallsBlockLoading,_=n.currentCalls,m=n.profiles,f=(0,u.useHistoryScreenLoading)().setLoading,g=(0,a.useMemo)((function(){return p?a.createElement(i.default,null,a.createElement(r.DivBlockSkeleton,{height:300})):a.createElement(i.default,{title:e("calls_history_current_list_header"),className:"CallHistoryScreen--content CallHistoryScreen--currentCalls"},a.createElement(l.CurrentCallsList,{currentCalls:_,profiles:m,onJoin:t}),0===_.length&&a.createElement(s.default,{className:"CallHistoryList--stub"},e("calls_history_current_calls_list_stub")))}),[p]);return(0,a.useEffect)((function(){f(p)}),[p]),a.createElement(a.Fragment,null,g)}},464578:(e,t,n)=>{"use strict";n.d(t,{HistoryScreenSectionFriendsContainer:()=>I});var a=n(570655),r=n(667294),i=n(121255),o=n(20845),l=n(744499),s=n(988121),c=n(329538),u=n(613335),d=n(658861),p=n(670546),_=n(884143),m=n(750598),f=n(248586),g=n(581685),A=n(735144),v=n(250516),h=n(736434),E=n(431469),C=n(366521),S=n(664327),y=n(457532),T=100;var I=function(){var e=(0,S.useLangContext)(),t=e.getLang,n=e.langShortDate,I=e.langNumeric,b=e.langSex,N=(0,C.useHistoryScreenSelector)((function(e){return e.meId})),w=(0,s.useHistoryScreenLoading)(),L=w.setLoading,P=w.loading,k=(0,y.useBaseObjectsContext)().bridge,M=(0,a.__read)((0,r.useState)([]),2),O=M[0],D=M[1],R=(0,a.__read)((0,r.useState)(!1),2),B=R[0],x=R[1],U=(0,a.__read)((0,r.useState)(0),2),H=U[0],G=U[1],V=(0,a.__read)((0,r.useState)(0),2),F=V[0],W=V[1],z=(0,a.__read)((0,r.useState)(""),2),j=z[0],K=z[1],Y=(0,a.__read)((0,r.useState)(!1),2),Q=Y[0],Z=Y[1],J=(0,r.useRef)(null);(0,r.useEffect)((function(){L(!0);(0,c.getFriends)(100,H).then((function(e){var t=e.count,n=e.items;W(t);x(100<t),G(100);var a=n.map(u.normalizeUser);D(a)})).finally((function(){L(!1)}))}),[]);var q=(0,r.useMemo)((function(){return F>T}),[F]);(0,r.useEffect)((function(){var e=j;if(q){if(e.length>=1&&!Q)return J.current&&clearTimeout(J.current),J.current=setTimeout((function(){Z(!0),(0,c.friendsSearch)(N,e,50).then((function(e){var t=e.count,n=e.items;x(50<t),G(50);var a=n.map(u.normalizeUser);D(a)})).finally((function(){Z(!1)}))}),1e3),function(){clearTimeout(J.current)};0===e.length&&(0,c.getFriends)(T,0).then((function(e){var t=e.count,n=e.items;x(100<t),G(100);var a=n.map(u.normalizeUser);D(a)}))}}),[j]);var X=(0,r.useCallback)((function(e,t){k.call(e,t,void 0,i.CallStatSource.HISTORY_FRIENDS_LIST)}),[]),$=(0,r.useCallback)((function(e){return e.name}),[]),ee=(0,r.useCallback)((function(e){return e.peerId}),[]),te=(0,E.useIndexer)(O,$,ee),ne=j&&!q?te.search(j):O,ae=(0,r.useCallback)((function(e){K(e.target.value)}),[]),re=function(e,a){var i,o,l,s,c,u,d,p="";return(null===(i=e.onlineInfo)||void 0===i?void 0:i.is_online)?p="Online":(null===(o=e.onlineInfo)||void 0===o?void 0:o.last_seen)?p=function(e,t,n,a){var r=Math.floor((Date.now()-a)/1e3);return r<60?e("global_just_now"):r<3600?t(Math.floor(r/60),"global_mins_ago",e("global_mins_ago",!0)):r<21600?t(Math.floor(r/3600),"global_hours_ago",e("global_hours_ago",!0)):n(a,!1)}(t,I,n,1e3*(null===(l=e.onlineInfo)||void 0===l?void 0:l.last_seen)):(null===(s=e.onlineInfo)||void 0===s?void 0:s.status)&&(p="recently"===(null===(c=e.onlineInfo)||void 0===c?void 0:c.status)?b(e.sex,"global_online_was_recently",t("global_online_was_recently",!0)):"last_week"===(null===(u=e.onlineInfo)||void 0===u?void 0:u.status)?b(e.sex,"global_online_was_week",t("global_online_was_week",!0)):b(e.sex,"global_online_long_ago",t("global_online_long_ago",!0))),r.createElement(m.default,{key:a,selectable:!1,canBeHovered:!1,aside:r.createElement("div",{className:"CallHistoryScreen--friendsIcons"},r.createElement(A.default,{className:"CallHistoryScreen--friendsIcon CallHistoryScreen--friendsIconsPhone",onClick:function(){return X(e.peerId,!1)}}),r.createElement(v.default,{className:"CallHistoryScreen--friendsIcon",onClick:function(){return X(e.peerId,!0)}}))},r.createElement(f.default,{size:"34",photo:r.createElement(g.default,{id:a,photo:e.photo,title:e.name,isOnline:null===(d=e.onlineInfo)||void 0===d?void 0:d.is_online}),title:e.name,href:e.link,description:p,target:"_blank"}))};return P?r.createElement(l.default,null,r.createElement(o.DivBlockSkeleton,{height:500})):r.createElement(l.default,{title:t("calls_page_menu_friends_calls"),className:"CallHistoryScreen--content"},r.createElement(h.BlockSearchInput,{value:j,placeholder:t("global_search"),onChange:ae,onInput:ae,onPaste:ae,className:"CallParticipantList__input"}),r.createElement(d.default,{useWindowScroll:!0,hasMore:B,loadMore:function(){return j&&q?(0,c.friendsSearch)(N,j,50,H).then((function(e){var t=e.count,n=e.items,r=H+50;x(r<t),G(r);var i=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(O)),(0,a.__read)(n.map(u.normalizeUser)));return D(i),!0})):(0,c.getFriends)(T,H).then((function(e){var t=e.items,n=H+T;x(n<F),G(n);var r=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(O)),(0,a.__read)(t.map(u.normalizeUser)));return D(r),!0}))}},r.createElement(p.default,{className:"CallHistoryList",border:!1},ne.map((function(e,t){return re(e,t)})),0===ne.length&&r.createElement(_.default,{className:"CallHistoryList--stub"},t("calls_page_friends_not_found")))))}},749399:(e,t,n)=>{"use strict";n.d(t,{HistoryScreenSectionMissedCallsContainer:()=>d});var a=n(667294),r=n(343035),i=n(20845),o=n(744499),l=n(150364),s=n(409364),c=n(366521),u=n(664327),d=function(){var e=(0,c.useHistoryScreenSelector)((function(e){return e.historyCalls})),t=(0,u.useLangContext)().getLang,n=(0,s.useHistoryScreenLoadActions)("missed"),d=n.onShowMoreHistory,p=n.loading,_=n.showMoreHistory,m=(0,l.useHistoryScreenContextActions)().onHistoryAction;return p?a.createElement(o.default,null,a.createElement(i.DivBlockSkeleton,{height:500})):a.createElement(o.default,{title:t("calls_history_missed_list_header"),className:"CallHistoryScreen--content"},a.createElement(r.CallHistoryList,{calls:e,onMenuItemClick:m,stubText:t("calls_history_missed_list_stub"),hasMore:_,onLoadMore:d}))}},536559:(e,t,n)=>{"use strict";n.d(t,{IncomingCallContainer:()=>f});var a=n(667294),r=n(50533),i=n(309605),o=n(826988),l=n(995420),s=n(44781),c=n(789241),u=n(269481),d=n(745284),p=n(121255),_=n(614914),m=n(662208);function f(e){var t=e.SDK,n=e.bridge,f=(0,r.useSelector)((function(e){return e})),g=f.peer,A=f.callData,v=f.participants,h=f.caller,E=(0,r.useDispatch)(),C=a.useContext(m.LangContext).getLang,S=h;S||(S=(0,d.isGroupCallByPeer)(g)?A.conversation:v[g]);var y=A.type===p.CallType.VIDEO,T=C(y?"calls_incoming_videocall":"calls_incoming_audiocall"),I=C(y?"calls_reply_with_audio":"calls_reply"),b=C(y?"calls_reject_call":"calls_reject"),N=function(){t.declineCall(),_.callStats.logEvent({call_event_type:p.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:A.callId,peer_id:g,is_group_call:(0,d.isGroupCallByPeer)(g),reason:"none"})};return a.createElement(u.CallModal,{onClose:N,isIncoming:!0,isCautionBoxShown:!0},a.createElement(c.IncomingCall,{id:g,title:(null==S?void 0:S.tab)||"",description:T,photo:(null==S?void 0:S.photo)||"",onCollapseCall:function(){E({type:p.CHANGE_UI_MODE,mode:p.UIMode.COLLAPSED})}},a.createElement(a.Fragment,null,y&&a.createElement(i.CallButton,{text:C("calls_reply_with_video"),type:i.CallButtonTypes.POSITIVE,icon:a.createElement(o.VideoIcon,null),onClick:function(){return n.acceptCall(!0,!0)}}),a.createElement(i.CallButton,{text:I,type:y?i.CallButtonTypes.REGULAR:i.CallButtonTypes.POSITIVE,icon:a.createElement(l.PhoneIcon,null),onClick:function(){return n.acceptCall(!1,!0)}}),a.createElement(i.CallButton,{text:b,type:i.CallButtonTypes.NEGATIVE,icon:a.createElement(s.RejectIcon,null),onClick:N}))))}},656504:(e,t,n)=>{"use strict";n.d(t,{JoinScreenContainer:()=>g});var a=n(570655),r=n(667294),i=n(991390),o=n(138671),l=n(838480),s=n(121255),c=n(298811),u=n(788822),d=n(329538),p=n(662208),_=n(253312),m=n(498110),f=n(697483),g=function(e){var t=e.isAnonym,n=e.joinLink,g=e.vkJoinLink,v=e.title,h=e.members,E=e.membersCount,C=e.conversationData,S=e.withPopup,y=e.onBeforeCallStart,T=e.onAfterCallFinish,I=e.onClose,b=e.bridge,N=e.entryPoint,w=e.tabIsMaster,L=e.tabIsIdle,P=e.onError,k=e.isDev,M=e.okPublicKey,O=r.useContext(p.LangContext),D=O.getLang,R=O.langNumeric,B=(0,a.__read)((0,r.useState)(""),2),x=B[0],U=B[1],H=(0,a.__read)((0,r.useState)(null),2),G=H[0],V=H[1],F=(0,a.__read)((0,r.useState)(!1),2),W=F[0],z=F[1],j=!1,K=r.useContext(m.ConfigContext),Y=K.allowCallByName,Q=K.nativeAppJoin,Z=h?h.slice(0,3).map((function(e){var t=e.firstName||e.shortName||e.name||"";return e.photo_100?{src:e.photo_100,alt:t,key:e.peerId}:{id:e.peerId,text:t.slice(0,1)}})):[],J=(0,r.useCallback)((function(e){U(e.target.value)}),[]),q=(0,r.useCallback)((function(e){if(t)return j?Promise.resolve():(j=!0,function(e,t,n,a,r,i){if(e)return Promise.resolve(e);return(0,d.getJoinLinkDetails)(n,!0).then((function(e){var o=e.secret,l=void 0===o?"":o,c=e.user_id,u=void 0===c?0:c,p=e.preview;return(0,d.getAnonymCallToken)(n,u,a,l).then((function(e){var n,o=e.token,l=e.secret,c=void 0===l?"":l,d={is_dev:A(i),key:r,token:o,ok_user:u,secret:c,is_anonym:!0,me:{canAddMembers:!1,firstName:a,peerId:u,id:u,sex:"0",shortName:a,name:a,lastName:"",link:"",photo:"",photo_100:"",shortNameGen:""}},_={callPreview:{tab:null==p?void 0:p.title,photo:null===(n=null==p?void 0:p.photo)||void 0===n?void 0:n.photo_200},callsCredentials:d,participantLimit:128,callsOkStaging:A(i),callsLogging:!1,CallsIncomingCall:!1,callsAllowBanParticipant:!1,callsFeedbackScreenEnabled:!1,callsVideoSlotsEnabled:!0,videoSlotsCount:s.VIDEO_SLOTS_COUNT,browserWarnings:null,callsAllowCallByName:!1,callsNativeApp:!1,callsNativeAppJoin:!1,callsEnableScreenTrack:!0,callsEnableProducerScreenTrack:!0,callsAllowWaitingHall:!1,callsAllowPushToTalk:!1,callsBadNetwork:!1,callsBadNetworkP2P:!1,callsDesktopAppNotification:!1,callsEnableVirtualBackground:!0};return t(_),_}))}))}(G,V,g,x,M,k).then((function(e){return function(e){var t=e.bridge,n=e.inited,a=e.setInited,r=e.data,i=e.onBeforeCallStart,o=e.onAfterCallFinish,l=e.tabIsMaster,s=e.tabIsIdle,c=e.langUtils;if(n)return Promise.resolve();var u=r.callPreview,d=r.callsCredentials,p=r.participantLimit,_=r.callsOkStaging,m=r.callsLogging,f=r.CallsIncomingCall,g=r.callsAllowBanParticipant,A=r.callsFeedbackScreenEnabled,v=r.callsVideoSlotsEnabled,h=r.videoSlotsCount,E=r.browserWarnings,C=r.callsAllowCallByName,S=r.callsNativeApp,y=r.callsNativeAppJoin,T=r.callsEnableScreenTrack,I=r.callsEnableProducerScreenTrack,b=r.callsAllowWaitingHall,N=r.callsAllowPushToTalk,w=r.callsBadNetwork,L=r.callsBadNetworkP2P,P=r.callsDesktopAppNotification,k=r.callsEnableVirtualBackground;return t.init({callPreview:u,callsCredentials:d,imHash:"",participantLimit:p,callsOkStaging:_,onBeforeCallStart:i,onAfterCallFinish:o,tabIsMaster:l,tabIsIdle:s,langUtils:c,toggles:{debugLog:m,incomingCall:f,allowBanParticipant:g,showFeedbackScreen:A,enableVideoSlots:v,videoSlotsCount:h,browserWarnings:E,allowCallByName:C,nativeApp:S,nativeAppJoin:y,enableScreenTrack:T,enableProducerScreenTrack:I,allowWaitingHall:b,allowPushToTalk:N,badNetwork:w,badNetworkP2P:L,desktopAppNotification:P,enableVirtualBackground:k}}).then((function(){return a(!0)}))}({bridge:b,inited:W,setInited:z,data:e,onBeforeCallStart:y,onAfterCallFinish:T,tabIsMaster:w,tabIsIdle:L,langUtils:O})})).then((function(){return b.joinCallByLink(n,null,e,N)})).catch((function(e){b.eventHandlers.onError&&e&&b.eventHandlers.onError(e);var t="";t="string"==typeof e?e:e&&e.error&&e.error.error_code?(0,c.getTextForApiErrorByCode)(e.error.error_code,!0,D):(0,_.getCallStartErrorText)(e,!0,D)||D("calls_unknown_error"),P&&P(t)})).finally((function(){j=!1})));if(I&&I(),!C)throw Error("no peer_id to join");return b.joinCallByLink(n,[C,h],e,N).catch((function(e){var t="";t="string"==typeof e?e:e&&e.error&&e.error.error_code?(0,c.getTextForApiErrorByCode)(e.error.error_code,!0,D):D("calls_unknown_error"),P&&P(t)})),Promise.resolve()}),[n,I,x,G,W,M]),X=(0,r.useCallback)((function(){I&&I()}),[I]),$=(0,r.useMemo)((function(){return(0,u.escape)((0,u.decodeHTMLEntities)(v))}),[v]),ee=(0,r.useCallback)((function(){b.showCallByNamePopup(null,N,n)}),[]),te=(0,r.useCallback)((function(){b.showStartCallModal(null,n)}),[]),ne=r.createElement(i.JoinScreen,{isAnonym:t,name:x,onChangeName:J,namePlaceholder:D("calls_name_placeholder"),title:$,label:(0,c.getParticipantsListLabel)(h||[],Z,(function(e){return(0,f.isParticipantGroup)(e.peerId)?e.name:e.firstName}),D,R,E),items:Z,joinWithVideoText:D("calls_join_with_video"),joinWithAudioText:D("calls_join_with_audio"),onJoinWithVideo:function(){return q(!0)},onJoinWithAudio:function(){return q(!1)},disabled:t&&!/^[A-Za-zА-Яа-яЁё0-9_\- ]{2,25}$/.test(x),inputDisabled:!!G,callByNameShow:Y&&!t,callByNameTitle:D("calls_call_by_name_join_by"),callByNameDescription:"",onCallByNameClick:ee,callViaNativeAppShow:Q&&!t,callViaNativeAppTitle:D("calls_call_via_native_app_join"),onCallViaNativeAppClick:te});return S?r.createElement(o.default,{onClose:X},r.createElement(l.ModalHeader,{title:D("calls_invite"),onClose:X}),ne):ne},A=function(e){return void 0!==e?e:!(!window.vk||void 0===window.vk.isCallsDevEnv)&&window.vk.isCallsDevEnv}},989819:(e,t,n)=>{"use strict";n.d(t,{KickParticipantContainer:()=>p});var a=n(570655),r=n(667294),i=n(50533),o=n(881150),l=n(121255),s=n(662208),c=n(963985),u=n(697483),d=n(719481),p=function(){var e,t,n,p=(0,i.useDispatch)(),_=r.useContext(s.LangContext),m=_.getLang,f=_.langSex,g=(0,i.useSelector)((function(e){return e})),A=null===(e=g.participantKick)||void 0===e?void 0:e.participant,v=(null===(t=g.participantKick)||void 0===t?void 0:t.type)===l.KickParticipantType.CALL,h=(0,a.__read)((0,r.useState)(!0),2),E=h[0],C=h[1],S=!!A&&(!(0,u.participantIsAdmin)(A)&&!(0,u.participantIsChatAdmin)(A,g.callData.conversation)),y=(0,r.useCallback)((function(){p({type:l.TOGGLE_PARTICIPANTS_KICK})}),[]),T=(0,r.useCallback)((function(){(0,u.kickParticipant)(A,!E).then((function(){!v&&g.waitingHall&&(null==A?void 0:A.peerId)&&(0,d.removeUserFromWaitingHall)(null==A?void 0:A.peerId,g.waitingHall,p)})),y()}),[g.participantKick,E]),I=(0,r.useCallback)((function(e){C(e)}),[]),b=v?"calls_kick_participant_text":"calls_kick_participant_from_waiting_hall_text",N=f(null==A?void 0:A.sex,b,m(b,!0)).replace("{user}",null!==(n=null==A?void 0:A.name)&&void 0!==n?n:""),w=m(v?"calls_kick_participant_kick_button_text":"calls_kick_participant_from_waiting_hall_button_text"),L=m(v?"calls_kick_participant_with_ban_setting":"calls_kick_participant_from_waiting_hall_with_ban_setting");return r.createElement(c.KickParticipantModal,{onClose:y,onAllowReconnectChange:I,description:N,allowBan:S,banText:L,actionButtons:[r.createElement(o.default,{onClick:y,appearance:"secondary",key:"cancel"},m("calls_cancel")),r.createElement(o.default,{onClick:T,key:"stop"},w)]})}},325496:(e,t,n)=>{"use strict";n.d(t,{MuteParticipantContainer:()=>f});var a=n(570655),r=n(667294),i=n(50533),o=n(881150),l=n(467667),s=n(121255),c=n(697483),u=n(662208),d=n(614914),p=n(745284),_=n(329538),m=n(631635),f=function(){var e,t,n,f,g=(0,i.useSelector)((function(e){return e})),A=null===(e=g.participantsManagement)||void 0===e?void 0:e.participant,v=null!==(n=null===(t=g.participantsManagement)||void 0===t?void 0:t.mode)&&void 0!==n?n:s.ParticipantsManagementMode.SINGLE,h=[s.ParticipantsManagementMode.SINGLE_AUDIO,s.ParticipantsManagementMode.ALL_AUDIO].includes(v),E=[s.ParticipantsManagementMode.SINGLE,s.ParticipantsManagementMode.SINGLE_AUDIO,s.ParticipantsManagementMode.SINGLE_VIDEO].includes(v),C=E&&((0,c.isAdmin)(A)||(0,c.isCreator)(A)),S=(0,a.__read)((0,r.useState)(!0),2),y=S[0],T=S[1],I=(0,a.__read)((0,r.useState)(null!==(f=null==A?void 0:A.name)&&void 0!==f?f:""),2),b=I[0],N=I[1],w=(0,i.useDispatch)(),L=r.useContext(u.LangContext).getLang;(0,r.useEffect)((function(){var e;if(E&&!(0,c.isParticipantAnonym)((null==A?void 0:A.peerId)||0)){w({type:s.SHOW_LOADER,isLoaderVisible:!0});var t=null===(e=g.participantsManagement)||void 0===e?void 0:e.participant;new Promise((function(e,n){t&&t.peerId<0?(0,_.getGroupById)(-t.peerId).then((function(t){var n,a=t.groups;e(a&&a.length>0?null===(n=a[0])||void 0===n?void 0:n.name:"")})).catch((function(e){return n(e)})):(0,_.loadUsers)({user_ids:t&&String(t.peerId),name_case:"dat"}).then((function(t){var n=(0,a.__read)(t,1)[0];e(null==n?void 0:n.first_name)})).catch((function(e){return n(e)}))})).then((function(e){N(e),T(!1),w({type:s.SHOW_LOADER,isLoaderVisible:!1})})).catch(console.log)}else T(!1)}),[g.participantsManagement]);var P=function(e){var t=e.callEventType,n=e.sessionId,a=e.peerId,r=e.isGroupCall;return function(e){return d.callStats.logEvent({call_event_type:t,session_id:n,peer_id:a,is_group_call:r,mute_permanent:e})}}({callEventType:E?s.CallActionEventType.USER_MICS_AND_VIDEO_DISABLED:s.CallActionEventType.ALL_MICS_AND_VIDEO_DISABLED,sessionId:g.callData.callId,peerId:g.peer,isGroupCall:(0,p.isGroupCallByPeer)(g.peer)}),k=(0,r.useCallback)((function(){w({type:s.TOGGLE_PARTICIPANTS_MANAGEMENT})}),[]),M=(0,r.useCallback)((0,m.muteGenerator)({isAudio:h,isSingle:E,isPermanent:!0,participantExternalId:E?(0,c.getParticipantExternalId)(A):null,logEvent:P,closeDialog:k}),[]),O=(0,r.useCallback)((0,m.muteGenerator)({isAudio:h,isSingle:E,isPermanent:!1,participantExternalId:E?(0,c.getParticipantExternalId)(A):null,logEvent:P,closeDialog:k}),[]),D=(0,r.useMemo)((function(){return v===s.ParticipantsManagementMode.SINGLE_AUDIO?L("calls_mute_participant_dialog_title_audio").replace("{name}",b):v===s.ParticipantsManagementMode.SINGLE_VIDEO?L("calls_mute_participant_dialog_title_video").replace("{name}",b):v===s.ParticipantsManagementMode.ALL_AUDIO?L("calls_mute_all_participants_dialog_title_audio"):v===s.ParticipantsManagementMode.ALL_VIDEO?L("calls_mute_all_participants_dialog_title_video"):""}),[v,b]),R=(0,r.useMemo)((function(){return C?[r.createElement(o.default,{onClick:O,key:"mute"},L("calls_mute_participant_dialog_action"))]:[r.createElement(o.default,{onClick:M,appearance:"secondary",key:"mute_permanent"},L("calls_mute_participant_permanent_dialog_action")),r.createElement(o.default,{onClick:O,key:"mute"},L("calls_mute_participant_dialog_action"))]}),[C,M,O]);return E&&y?null:r.createElement(l.MuteParticipantModal,{title:D,onClose:k,actionButtons:R})}},290514:(e,t,n)=>{"use strict";n.d(t,{NotificationWithButtonContainer:()=>E});var a=n(667294),r=n(121255),i=n(662208),o=n(50533),l=n(881150),s=n(298811),c=n(719481),u=n(139230),d=n(700881),p=n(170181),_=n(498110),m=n(827244),f=n(94885),g=n(394886),A=n(767497),v=n(483379),h=n(745284),E=function(){var e,t,n,E,C=(0,o.useSelector)((function(e){return e})),S=(0,o.useDispatch)(),y=a.useContext(i.LangContext),T=y.getLang,I=y.langNumeric,b=(0,a.useContext)(_.ConfigContext).desktopAppNotification,N=(0,a.useMemo)((function(){return(0,v.getWarningBrowserInfo)(C.config.browserWarnings)}),[C.config.browserWarnings]),w=(0,a.useCallback)((function(e){var t,n=null===(t=C.waitingHall)||void 0===t?void 0:t.members.get(e);n&&S({type:r.TOGGLE_PARTICIPANTS_KICK,data:{type:r.KickParticipantType.WAITING_HALL,participant:n}})}),[null===(e=C.waitingHall)||void 0===e?void 0:e.members]),L=(0,a.useCallback)((function(){var e=[(0,c.loadAdditionalWaitingHall)(C,S)];return Promise.all(e).then((function(){S({type:r.MANAGEMENT,isOpen:!0,managementView:u.ManagementViews.WAITING_HALL})}))}),[C.waitingHall]),P=(0,a.useCallback)((function(e){C.waitingHall&&(0,c.promoteUserAndRemoveFromWaitingHall)(e,C.waitingHall,S)}),[null===(t=C.waitingHall)||void 0===t?void 0:t.members]),k=(0,a.useCallback)((function(){(0,c.resetWaitingHallNew)(C.waitingHall,S)}),[null===(n=C.waitingHall)||void 0===n?void 0:n.hasNew]);if(C.waitingHall&&0!==C.waitingHall.members.size&&C.waitingHall.hasNew){var M=Array.from(C.waitingHall.members.values()),O=T("calls_notification_users_in_waiting_hall_notification",C.waitingHall.totalCount).replace("{names}",(0,s.getParticipantsListLabel)(M,M.slice(0,3),(function(e){return e.shortName||e.name}),T,I,C.waitingHall.totalCount)),D=null;if(1===M.length){var R=M[0];D=a.createElement(a.Fragment,null,a.createElement(l.default,{onClick:function(){return P(R.peerId)},appearance:"overlay_primary"},T("calls_waiting_hall_join")),a.createElement(l.default,{onClick:function(){return w(R.peerId)},appearance:"overlay_secondary"},T("calls_waiting_hall_forbid")))}else D=a.createElement(l.default,{onClick:function(){return L()},appearance:"overlay_primary"},T("calls_waiting_show_participants"));return a.createElement(p.NotificationWithButton,null,a.createElement("div",null,a.createElement(d.default,{className:"NotificationWithButton--close",onClick:k}),a.createElement("span",null,O),a.createElement("div",{className:"NotificationWithButton--buttons"},D)))}if(N&&C.shouldShowWarningDesktopAppNotification&&(0,h.isGroupCallByPeer)(C.peer)&&(null===(E=C.join)||void 0===E?void 0:E.joinLink)){return a.createElement(f.WarningDesktopApp,{onClose:function(){S({type:r.SET_SHOW_WARNING_DESKTOP_NOTIFICATION,data:!1}),S({type:r.SET_SHOW_DESKTOP_NOTIFICATION,data:!1})},onClickJoin:function(){var e,t;if(null===(e=C.join)||void 0===e?void 0:e.joinLink)return(0,g.openDesktopDeepLink)((0,A.generateJoinCallsDeepLink)({joinLink:null===(t=C.join)||void 0===t?void 0:t.joinLink,userId:window.vk.id}))}})}if(b&&C.shouldShowDesktopAppNotification){return a.createElement(m.NotificationDesktopApp,{onClose:function(){S({type:r.SET_SHOW_DESKTOP_NOTIFICATION,data:!1})}})}return null}},777152:(e,t,n)=>{"use strict";n.d(t,{OnHangupContainer:()=>c});var a=n(667294),r=n(50533),i=n(341548),o=n(993663),l=n(275385),s=n(121255),c=function(){var e=(0,l.useLang)().getLang,t=(0,o.useClosePopup)().onClose,n=(0,r.useSelector)((function(e){return e.popup})),c=(0,r.useSelector)((function(e){var t;return null===(t=e.lastCallData)||void 0===t?void 0:t.opponentName})),u=(0,r.useSelector)((function(e){var t;return null===(t=e.lastCallData)||void 0===t?void 0:t.isMeEndedCallForAll})),d=(0,r.useDispatch)(),p="",_="",m=!1;switch(n){case s.POPUP_ON_CALL_HANGUP_BUSY:p=e("calls_user_busy"),_=e("calls_user_busy_description").replace("{username}",c||e("calls_opponent"));break;case s.POPUP_ON_CALL_HANGUP_KILLED:if(u){m=!0;break}p=e("calls_join_error_not_found_conversation"),_=e("calls_admin_ended_call_for_everyone")}return(0,a.useEffect)((function(){return function(){d({type:s.CLEAN_LAST_CALL_DATA})}}),[]),(0,a.useEffect)((function(){m&&t()}),[m,t]),m?null:a.createElement(i.OnHangupModal,{onClose:t,title:p,description:_})}},310765:(e,t,n)=>{"use strict";n.d(t,{ParticipantMenuContainer:()=>s});var a=n(667294),r=n(50533),i=n(697483),o=n(662208),l=n(95939),s=function(e){var t=e.SDK,n=e.participant,s=e.navigateToConvo,c=e.navigateToProfile,u=(0,r.useSelector)((function(e){return e})),d=(0,r.useDispatch)(),p=a.useContext(o.LangContext).getLang,_=(0,i.getParticipantActions)(u,t,d,n,!1,p,s,c,!0);return _.length>0?a.createElement(l.ParticipantMenu,{position:"b",align:"right",trigger:"hover",marginTop:-8,marginLeft:1,actions:_}):null}},670778:(e,t,n)=>{"use strict";n.d(t,{ParticipantStatusContainer:()=>l});var a=n(667294),r=n(580248),i=n(662208),o=n(464380),l=function(e){var t=e.status,n=a.useContext(i.LangContext).getLang;switch(t){case o.ParticipantStatus.WAITING:return a.createElement(r.default,null,n("calls_status_waiting"));case o.ParticipantStatus.CONNECTING:case o.ParticipantStatus.RECONNECT:return a.createElement(r.default,null,n("calls_status_connecting"));case o.ParticipantStatus.ERROR:return n("calls_error");case o.ParticipantStatus.HANGUP:return a.createElement(r.default,null,n("calls_status_hangup"));case o.ParticipantStatus.PERMISSIONS:return n("calls_status_no_permissions");case o.ParticipantStatus.CONNECTED:default:return null}}},48755:(e,t,n)=>{"use strict";n.d(t,{SettingsContainer:()=>m});var a=n(570655),r=n(667294),i=n(659397),o=n(50533),l=n(471304),s=n(555700),c=n(121255),u=n(662208),d=n(498110),p=n(147853),_=r.useState;function m(e){var t=e.SDK,n=r.useContext(u.LangContext).getLang,m=r.useContext(d.ConfigContext).fullHD,f=[{label:n("calls_noise_neural"),value:c.NoiseCancellationTypes.NEURAL,data:{denoise:!0,denoiseAnn:!0}},{label:n("calls_noise_simple"),value:c.NoiseCancellationTypes.SIMPLE,data:{denoise:!0,denoiseAnn:!1}},{label:n("calls_noise_none"),value:c.NoiseCancellationTypes.NONE,data:{denoise:!1,denoiseAnn:!1}}],g=[{label:n("calls_video_resolution_sd"),value:c.VideoResolutionTypes.SD},{label:n("calls_video_resolution_hd"),value:c.VideoResolutionTypes.HD}];m&&g.push({label:n("calls_video_resolution_fhd"),value:c.VideoResolutionTypes.FHD});var A=(0,o.useSelector)((function(e){return e})),v=(0,a.__read)((0,o.useSelector)((function(e){var t;return[e.mode,null===(t=e.participants[e.me].mediaSettings)||void 0===t?void 0:t.isVideoEnabled]})),2),h=v[0],E=v[1],C=(0,o.useDispatch)(),S=t.browser.getCameras(),y=t.browser.getMicrophones(),T=t.browser.hasCamera()&&t.browser.hasCameraPermission(),I=t.browser.hasMicrophone()&&t.browser.hasMicrophonePermission(),b=t.browser.getSavedCamera(),N=t.browser.getSavedMicrophone(),w=T&&(b&&b.deviceId||S[0].deviceId),L=I&&(N&&N.deviceId||y[0].deviceId),P=(0,a.__read)(_(!1===w?void 0:w),2),k=P[0],M=P[1],O=(0,a.__read)(_(!1===L?void 0:L),2),D=O[0],R=O[1],B=(0,a.__read)(_(A.noiseCancellation),2),x=B[0],U=B[1],H=i.localStorage.getItem(c.VIDEO_RESOLUTION_STORAGE_KEY),G=(0,a.__read)(_(H===c.VideoResolutionTypes.FHD?c.VideoResolutionTypes.FHD:H===c.VideoResolutionTypes.HD?c.VideoResolutionTypes.HD:c.VideoResolutionTypes.SD),2),V=G[0],F=G[1],W=(0,a.__read)(_(A.pushToTalkEnabled),2),z=W[0],j=W[1];return r.createElement(s.CallSettingsModal,{onClose:function(){C({type:c.TOGGLE_POPUP})},onSubmit:function(){var e,n=[Promise.resolve()];!b&&w===k&&h!==c.Mode.READY&&!E||!k||b&&b.deviceId===k||n.push(t.changeDevice("videoinput",k)),!D||N&&N.deviceId===D||n.push(t.changeDevice("audioinput",D)),A.noiseCancellation!==x&&n.push(t.setMediaModifiers((null===(e=f.find((function(e){return e.value===x})))||void 0===e?void 0:e.data)||{denoise:!0,denoiseAnn:!0}).then((function(){C({type:c.SET_NOISE_CANCELLATION,data:x})})));var a=function(){return Promise.resolve()};if(A.localVideoResolution!==V&&(console.debug("set resolution from -> to: ",A.localVideoResolution,V,c.VideoWidth[V],c.VideoHeight[V]),a=function(){return t.setLocalResolution(c.VideoWidth[V],c.VideoHeight[V],{effect:{width:c.VideoWidth[V],height:c.VideoHeight[V]}}).catch((function(e){console.error(e)})).finally((function(){i.localStorage.setItem(c.VIDEO_RESOLUTION_STORAGE_KEY,V),C({type:c.CHANGE_LOCAL_VIDEO_RESOLUTION,data:V})}))}),A.pushToTalkEnabled!==z){var r=A.participants[A.me];r.permissions.audio>0&&(0,p.pushToTalkToggleAudio)(z,r.mediaSettings),C({type:c.SET_PUSH_TO_TALK_ENABLE,data:z})}Promise.all(n).then(a).then((function(){C({type:c.TOGGLE_POPUP})})).catch((function(e){console.error("Device change failed",e),C({type:c.TOGGLE_POPUP})}))}},r.createElement(l.CallSettings,{mics:y,cameras:S,noiseCancellationOptions:f,videoResolutionOptions:g,currentCamId:k,currentMicId:D,currentNoiseCancellation:x,currentVideoResolution:V,isCamAvailable:T,isMicAvailable:I,onCameraChange:function(e){return M(e)},onMicChange:function(e){return R(e)},onNoiseCancellationChange:function(e){return U(e)},onVideoResolutionChange:function(e){return F(e)},pushToTalkEnabled:z,onPushToTalkChange:function(){j(!z)}}))}},858101:(e,t,n)=>{"use strict";n.d(t,{StartCallContainer:()=>v});var a=n(570655),r=n(667294),i=n(659397),o=n(86894),l=n(835849),s=n(443774),c=n(121255),u=n(662208),d=n(394886),p=n(767497),_=n(50533),m=n(269481),f=n(153907),g=n(30081),A=n(483379);function v(){var e,t,n,v=(0,_.useSelector)((function(e){return e})),h=(0,_.useDispatch)(),E=r.useContext(u.LangContext).getLang,C=!(null===(e=v.join)||void 0===e?void 0:e.joinLink),S=(0,a.__read)((0,r.useState)(null!==i.localStorage.getItem(c.LOCALSTORAGE_IS_CALLS_APP_DOWNLOADED)),2),y=S[0],T=S[1],I=(0,a.__read)((0,r.useState)(!y),2),b=I[0],N=I[1],w=(0,r.useRef)((0,f.getPlatformUrl)()),L=null!==w.current,P=(0,a.__read)((0,r.useState)(!y),2),k=P[0],M=P[1],O=function(){var e,t;return(null===(e=v.join)||void 0===e?void 0:e.joinLink)?(0,d.openDesktopDeepLink)((0,p.generateJoinCallsDeepLink)({joinLink:null===(t=v.join)||void 0===t?void 0:t.joinLink,userId:window.vk.id})):(0,d.openDesktopDeepLink)((0,p.generateStartCallsDeepLink)({peerId:v.peer,userId:window.vk.id}))};(0,r.useEffect)((function(){O().then((function(){N(!1)})).catch((function(){N(!1)}))}),[y]);var D=function(){h({type:c.CHANGE_MODE,mode:c.Mode.READY})},R=null!==(n=null===(t=(0,A.getWarningBrowserInfo)(v.config.browserWarnings))||void 0===t?void 0:t.block)&&void 0!==n&&n;return r.createElement(m.CallModal,{onClose:D,onBackdropClick:D},r.createElement(o.ModalCard,{nav:"StartCallModal",header:r.createElement(g.default,null,E(b&&L?"calls_download_started":y?"calls_app_title":C?"calls_start_call_after_install_app":"calls_join_call_after_install_app")),subheader:k?E("calls_download_and_install_app_for_pc"):y?E(C?"calls_try_manual_start_lesson":"calls_try_manual_join_lesson"):b?E("calls_wait_until_app_downloaded"):"",className:"StartCallModal"},b&&L&&w.current?r.createElement(r.Fragment,null,r.createElement(o.Spinner,{size:"large",className:"StartCallModal__action"}),r.createElement("div",{className:"StartCallModal__text"},E("calls_downloading_file").replace("{file}",w.current.filename))):k?w.current&&L?r.createElement(o.Button,{size:"l",before:r.createElement(l.default,null),onClick:function(){return e=w.current.url,t=w.current.filename,(0,f.setDownloadedFlag)(),(0,f.download)(e,t),N(!0),void setTimeout((function(){T(!0),N(!1),M(!1)}),3e3);var e,t},className:"StartCallModal__action"},E("calls_download_app")):r.createElement(o.Button,{size:"l",before:r.createElement(l.default,null),href:c.DESKTOP_CALLS_DOWNLOAD_PAGE,target:"_blank",onClick:function(){(0,f.setDownloadedFlag)(),M(!1)},className:"StartCallModal__action"},E("calls_download_app")):r.createElement(o.Button,{mode:"secondary",size:"l",before:r.createElement(s.default,null),onClick:O,className:"StartCallModal__action"},E(C?"calls_start_in_app":"calls_join_call_in_app")),!k&&r.createElement(o.Subhead,{weight:"regular",className:"StartCallModal__text"},r.createElement("div",null,E("calls_apps_for_all_platform")),r.createElement(o.Link,{href:c.DESKTOP_CALLS_DOWNLOAD_PAGE,target:"_blank"},E("calls_open_app_list"))),!R&&r.createElement(o.Subhead,{weight:"regular",className:"StartCallModal__text"},E("calls_calls_troubles_with_app"),r.createElement("br",null),r.createElement(o.Link,{onClick:function(){var e,t,n,a,r=v.peer;if(window.Calls)if(null===(e=v.join)||void 0===e?void 0:e.joinLink){var i=null!==(t=v.entryPoint)&&void 0!==t?t:c.CallStatSource.CONVO_JOIN_SNIPPET;window.Calls.joinCallByLink(null===(n=v.join)||void 0===n?void 0:n.joinLink,void 0,!1,i)}else{var o=null!==(a=v.entryPoint)&&void 0!==a?a:c.CallStatSource.CONVO_LIST;if(r)r>2e9?window.Calls.startGroupCall(r,void 0,null,!1,o):window.Calls.call(r,!1,void 0,o);else window.Calls.startCall(!1,o)}}},E(C?"calls_calls_start_lesson_in_browser":"calls_join_call_in_browser"))),R&&r.createElement(o.Subhead,{weight:"regular",className:"StartCallModal__text"},E("calls_warning_native_app_description"))))}},152532:(e,t,n)=>{"use strict";n.d(t,{TransferAdminRightsContainer:()=>f});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(431469),s=n(338374),c=n(662208),u=n(614914),d=n(745284),p=n(697483),_=n(444083),m=n(464380),f=function(e){var t=e.SDK,n=(0,i.useDispatch)(),f=(0,i.useSelector)((function(e){return e})),g=r.useContext(c.LangContext).getLang,A=(0,a.__read)((0,r.useState)(Object.values(f.participants).filter((function(e){return e.peerId===f.me||e.status===m.ParticipantStatus.CONNECTED&&!(0,p.isParticipantAnonym)(e.peerId)}))),2),v=A[0],h=A[1],E=(0,a.__read)((0,r.useState)(null),2),C=E[0],S=E[1],y=(0,r.useCallback)((function(e){return e.name}),[]),T=(0,r.useCallback)((function(e){return e.peerId}),[]),I=(0,l.useIndexer)(v,y,T),b=(0,r.useMemo)((function(){return(0,p.getActiveParticipantsCount)(f)}),[f.participants]),N=function(){return u.callStats.logEvent({call_event_type:o.CallActionEventType.CALL_DECLINED_OR_HANGED_LOCALLY,session_id:f.callData.callId,peer_id:f.peer,is_group_call:(0,d.isGroupCallByPeer)(f.peer),reason:"none",group_call_users_count:b})},w=(0,r.useCallback)((function(e){h(e?I.search(e):I.list),S(null)}),[f]),L=function(){n({type:o.TOGGLE_POPUP})},P=function(){n({type:o.TOGGLE_POPUP}),N(),t.hangup().catch(console.log)},k=(0,r.useCallback)((function(e){S(null===e?null:e.peerId)}),[]);return(0,r.useEffect)((function(){C&&!v.find((function(e){return e.peerId===C}))&&S(null)}),[C]),r.createElement(s.TransferAdminRightsModal,{participants:v,onClose:L,onSelect:k,selected:C,onCallForceFinish:function(){n({type:o.TOGGLE_POPUP}),N(),t.hangup(),(0,_.onForceCallFinish)(t,f,n,g)},onRightsTransfer:function(){if(null!==C){var e=(0,p.getParticipantExternalId)(f.participants[C]);e&&(t.grantRoles(e,[m.UserRole.ADMIN],!1).then((function(){return P()})).catch(console.log),L())}else P()},onSearch:w})}},537817:(e,t,n)=>{"use strict";n.d(t,{TranslationContainer:()=>_});var a=n(667294),r=n(958713),i=n(121255),o=n(50533),l=n(881150),s=n(186983),c=n(445586),u=n(662208),d=n(820717),p=n(674543);function _(){var e,t=(0,o.useSelector)((function(e){return e})),n=(0,o.useDispatch)(),_=a.useContext(u.LangContext).getLang,m=(0,a.useCallback)((function(){n({type:i.TOGGLE_POPUP})}),[]),f=(0,p.canStopTranslation)(t),g=(0,a.useCallback)((function(){n({type:i.TOGGLE_POPUP,data:i.POPUP_TRANSLATION_STOP})}),[]),A=(0,a.useCallback)((function(e){if(null==e?void 0:e.upcomingStreamParams){var t=e.upcomingStreamParams,a=t.startTime,r=t.ovId;if(a&&a>Date.now()/1e3+4)return(0,d.startUpcomingStream)(r).finally(m)}var o={isOn:!1,startStreamParams:e};return n({type:i.SET_TRANSLATION,data:o}),n({type:i.TOGGLE_POPUP,data:i.POPUP_TRANSLATION_START_COUNTDOWN}),Promise.resolve()}),[]),v=(0,a.useCallback)((function(){n({type:i.TOGGLE_POPUP,data:i.POPUP_TRANSLATION_SHARE})}),[]);return(null===(e=t.translation)||void 0===e?void 0:e.isOn)?a.createElement(s.CallManagementModal,{title:_("calls_translation_menu_title"),actionButtons:f?[a.createElement(l.default,{onClick:g,appearance:"negative",key:"stop"},_("calls_translation_menu_stop"))]:[],onCloseModal:m},a.createElement(c.CallManagementMenu,{isLinkBlockShown:!0,linkBlockTitle:_("calls_translation_menu_link"),onLinkBlockClick:v,callUrlLink:t.translation.link})):a.createElement(r.TranslationCreateForm,{onSubmit:A,onClose:m})}},978335:(e,t,n)=>{"use strict";n.d(t,{TranslationShareContainer:()=>c});var a=n(667294),r=n(50533),i=n(121255),o=n(662208),l=n(186983),s=n(162144),c=function(e){var t,n=e.onBack,c=e.link,u=e.linkExtractor,d=(0,r.useDispatch)(),p=a.useContext(o.LangContext).getLang,_=(0,r.useSelector)((function(e){return e.translation})),m=(0,a.useCallback)((function(){d({type:i.TOGGLE_POPUP})}),[]);return a.createElement(l.CallManagementModal,{title:p("calls_translation_link"),onCloseModal:m,isWithBackButton:!!n,onBackClick:n},a.createElement(s.TranslationLink,{link:null!==(t=null==u?void 0:u(_))&&void 0!==t?t:c}))}},350594:(e,t,n)=>{"use strict";n.d(t,{TranslationStartCountdownContainer:()=>d});var a=n(570655),r=n(667294),i=n(121255),o=n(50533),l=n(979414),s=n(874023),c=n(820717),u=n(329538);function d(){var e=(0,o.useDispatch)(),t=(0,o.useSelector)((function(e){return e})),n=(0,a.__read)((0,r.useState)(3),2),d=n[0],p=n[1],_=(0,r.useCallback)((function(){e({type:i.TOGGLE_POPUP})}),[]),m=(0,r.useCallback)((function(){var e,n=null===(e=t.translation)||void 0===e?void 0:e.startTime;n&&n>=Date.now()&&(0,u.stopVideoStream)(),_()}),[]);return(0,r.useEffect)((function(){var e=setInterval((function(){return p(d-1)}),s.SECOND_JS);return function(){return clearInterval(e)}}),[d]),(0,r.useEffect)((function(){var e;if(d<=0){var n=null===(e=t.translation)||void 0===e?void 0:e.startStreamParams;(null==n?void 0:n.streamParams)?(0,c.startCallStream)(n.streamParams):(null==n?void 0:n.upcomingStreamParams)&&(0,c.startUpcomingStream)(n.upcomingStreamParams.ovId),_()}}),[d]),r.createElement(l.TranslationStartCountdownModal,{onCloseModal:_,counter:d,onStopTranslation:m})}},910472:(e,t,n)=>{"use strict";n.d(t,{TranslationStatusContainer:()=>g});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(880076),s=n(52777),c=n(659397),u=n(462480),d=n(923522),p=n(662208),_=n(874023),m=n(329538),f=n(674543);function g(){var e=(0,r.useContext)(p.LangContext),t=e.getLang,n=e.langNumeric,s=(0,i.useSelector)((function(e){return e})),c=(0,i.useDispatch)(),g=(0,a.__read)((0,r.useState)(null),2),S=g[0],y=g[1],T=(0,a.__read)((0,r.useState)(!1),2),I=T[0],b=T[1],N=(0,a.__read)((0,r.useState)(""),2),w=N[0],L=N[1],P=(0,a.__read)((0,r.useState)(0),2),k=P[0],M=P[1],O=(0,a.__read)((0,r.useState)([]),2),D=O[0],R=O[1],B=(0,a.__read)((0,r.useState)(C(s.translation.startTime)),2),x=B[0],U=B[1],H=(0,a.__read)((0,r.useState)(E(x)),2),G=H[0],V=H[1],F=(0,a.__read)((0,r.useState)(""),2),W=F[0],z=F[1],j=(0,a.__read)((0,r.useState)(!1),2),K=j[0],Y=j[1];return(0,r.useEffect)((function(){var e=(0,f.canStopTranslation)(s);b(e)}),[s.translation,s.participants[s.me]]),(0,r.useEffect)((function(){var e,t;if(null===(e=s.translation.host)||void 0===e?void 0:e.id){var n=s.participants[null===(t=s.translation.host)||void 0===t?void 0:t.id],a=(null==n?void 0:n.shortName)||(null==n?void 0:n.name);a!==S&&y(a)}else S&&y(null)}),[s.translation,s.participants]),(0,r.useEffect)((function(){var e=[];if(I){if(G){var n={text:r.createElement("div",{className:"TranslationStatus__dropdownItemWillStartSoon"},t("calls_info_translation_will_start_soon"))};e.push(n)}e.push(A(r.createElement(u.ShareIcon,null),t("calls_info_translation_share_menu_item"),(function(){return c({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_SHARE})}))),e.push(A(r.createElement(d.CancelIcon,null),t("calls_translation_stop_menu_item"),(function(){return c({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_STOP})})))}R(e)}),[I,G]),(0,r.useEffect)((function(){var e=E(x);e&&x>-4&&I&&!K&&(Y(!0),c({type:o.TOGGLE_POPUP,data:o.POPUP_TRANSLATION_START_COUNTDOWN})),V(e)}),[x]),(0,r.useEffect)((function(){var e=C(s.translation.startTime);U(e);var t=setInterval((function(){return U(C(s.translation.startTime))}),_.SECOND_JS);return function(){return clearInterval(t)}}),[s.translation.startTime]),(0,r.useEffect)((function(){var e="";if(G){var a=Math.abs(x);if(a>_.DAY){var r=Math.floor(a/_.DAY);e=n(r,"calls_translation_upcoming_time_more_day_short",t("calls_translation_upcoming_time_more_day_short",r)).replace("%s",r)}else e=v("-"+h(a))}else e=v(h(x));L(e)}),[x,G]),(0,r.useEffect)((function(){var e,t=s.translation,n=t.ownerId,a=t.videoId;if(n&&a&&!G){var r=function(){var e={owner_id:n,video_id:a};(0,m.videoLiveGetSpectators)(e).then((function(e){var t;M(null===(t=e.spectators)||void 0===t?void 0:t.count)}))};r(),e=setInterval(r,15*_.SECOND_JS)}return function(){return clearInterval(e)}}),[G,s.translation.ownerId,s.translation.videoId]),(0,r.useEffect)((function(){if(!I){var e="";e=G?t("calls_info_translation_will_start_soon"):S?t("calls_translation_host_info").replace("{name}",S):t("calls_translation_host_info_unknown"),z(e)}}),[G,S,I]),r.createElement(l.TranslationStatus,{translationTimer:w,viewersCount:k,isLiveIndicatorOff:G,actions:D,tooltipText:W})}function A(e,t,n){return{text:r.createElement("div",{className:"TranslationStatus__dropdownItem"},e,r.createElement("div",{className:"TranslationStatus__dropdownItemText"},t)),onClick:n}}function v(e){return r.createElement(s.CallTimer,{duration:e})}function h(e){return 0===e?"00:00":e<=599?"0"+(0,c.formatDuration)(e):(0,c.formatDuration)(e)}function E(e){return e<0}function C(e){var t=Date.now();return Math.floor((t-e)/1e3)}},410038:(e,t,n)=>{"use strict";n.d(t,{TranslationStopContainer:()=>u});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(662208),s=n(389809),c=n(329538),u=function(){var e=(0,r.useDispatch)(),t=a.useContext(l.LangContext).getLang,n=(0,a.useCallback)((function(){e({type:o.TOGGLE_POPUP})}),[]);return a.createElement(s.TranslationStopModal,{onClose:n,actionButtons:[a.createElement(i.default,{onClick:n,appearance:"secondary",key:"cancel"},t("calls_cancel")),a.createElement(i.default,{onClick:function(){(0,c.stopVideoStream)().then((function(){e({type:o.TOGGLE_POPUP})}))},key:"stop"},t("calls_translation_stop"))]})}},450273:(e,t,n)=>{"use strict";n.d(t,{UnbanParticipantContainer:()=>d});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(662208),s=n(697483),c=n(613335),u=n(904992),d=function(e){var t,n=e.SDK,d=(0,r.useDispatch)(),p=a.useContext(l.LangContext),_=p.getLang,m=p.langNumeric,f=p.langSex,g=(0,r.useSelector)((function(e){return e})),A=g.participants[g.me],v=(0,s.participantIsAdmin)(A),h=null===(t=g.membersUnban)||void 0===t?void 0:t.members,E=(0,a.useCallback)((function(){d({type:o.UNBAN_PARTICIPANTS})}),[]),C=(0,a.useCallback)((function(){null==h||h.forEach((function(e){n.addParticipant(String(e.id),{unban:!0})})),E()}),[g.membersUnban]);if(!h||0===h.length)return a.createElement(a.Fragment,null);var S=null==h?void 0:h.length,y=m(S,"calls_unban_participant_text",_("calls_unban_participant_text",!0)),T="",I=[];if(1===S){var b=h[0];T=f(b.sex,"calls_unban_participant_description_text_one_person",_("calls_unban_participant_description_text_one_person",!0)).replace("{user}",b.name),I.push((0,c.getMemberForUserStack)(b))}else{var N=[h[0].name,h[1].name];I=h.slice(0,2).map((function(e){return(0,c.getMemberForUserStack)(e)}));if(S<=3)3===S&&(N.push(h[2].name),I.push((0,c.getMemberForUserStack)(h[2]))),T=_("calls_unban_participant_description_text_two_persons").replace("{users}",N.join(", "));else{var w=S-2;T=m(w,"calls_unban_participant_description_text_more_persons",_("calls_unban_participant_description_text_more_persons",!0)).replace("{users}",N.join(", ")).replace("{users_count}",w),I.push({id:w,text:"+"+w})}}var L=v?[a.createElement(i.default,{onClick:E,appearance:"secondary",key:"cancel"},_("calls_unban_participant_cancel_button_text")),a.createElement(i.default,{onClick:C,key:"stop"},_("calls_unban_participant_ok_button_text"))]:[a.createElement(i.default,{onClick:E,key:"cancel"},_("calls_unban_participant_disallowed_button_text"))];return a.createElement(u.UnbanMembersModal,{onClose:E,description:y,subDescription:T,actionButtons:L,avatarsItems:I})}},927229:(e,t,n)=>{"use strict";n.d(t,{UnmuteRequestContainer:()=>d});var a=n(667294),r=n(50533),i=n(881150),o=n(121255),l=n(662208),s=n(860925),c=n(169610),u=n(464380),d=function(e){var t=e.SDK,n=e.withVideo,d=(0,r.useDispatch)(),p=a.useContext(l.LangContext).getLang,_=(0,r.useSelector)((function(e){return e})),m=_.participants[_.me],f=m.mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},g=function(){d({type:o.TOGGLE_POPUP})},A=function(){var e=m.mediaSettings;(null==e?void 0:e.isAudioEnabled)||(f.isAudioEnabled?Promise.resolve():(0,c.checkPermissions)(t,[u.MediaOption.AUDIO])).then((function(){var e;(null===(e=_.notification)||void 0===e?void 0:e.type)===o.NotificationType.SPEAKING_ON_MUTE&&d({type:o.CALL_NOTIFICATION,notification:null}),t.toggleLocalAudio(!0).catch(console.log)}))},v=function(){A(),g()},h=function(){var e;A(),(null==(e=m.mediaSettings)?void 0:e.isVideoEnabled)||(null==e?void 0:e.isScreenSharingEnabled)||(!f.isVideoEnabled||f.isScreenSharingEnabled?(0,c.checkPermissions)(t,[u.MediaOption.VIDEO]):Promise.resolve()).then((function(){t.toggleLocalVideo(!0).catch(console.log)})),g()},E=(0,a.useMemo)((function(){return n?[a.createElement(i.default,{onClick:v,appearance:"secondary",key:"mic"},p("calls_dialog_unmute_request_mic_only_action")),a.createElement(i.default,{onClick:h,key:"all"},p("calls_dialog_unmute_request_action"))]:[a.createElement(i.default,{onClick:v,key:"mic"},p("calls_dialog_unmute_request_mic_action"))]}),[n]);return a.createElement(s.UnmuteRequestModal,{onClose:g,title:p(n?"calls_dialog_unmute_request_audio_and_video_title":"calls_dialog_unmute_request_audio_title"),description:p(n?"calls_dialog_unmute_request_audio_and_video_description":"calls_dialog_unmute_request_audio_description"),actionButtons:E})}},731388:(e,t,n)=>{"use strict";n.d(t,{UploadBackgroundErrorContainer:()=>s});var a=n(667294),r=n(50533),i=n(983179),o=n(662208),l=n(121255),s=function(){var e=(0,r.useDispatch)(),t=(0,a.useContext)(o.LangContext).getLang,n=(0,a.useCallback)((function(){e({type:l.TOGGLE_POPUP,data:l.POPUP_VIRUTAL_BACKGROUND})}),[]),s=(0,a.useCallback)((function(){e({type:l.TOGGLE_POPUP,data:l.POPUP_UPLOAD_BACKGROUND_PHOTO})}),[]);return a.createElement(i.UploadBackgroundErrorModal,{onClose:n,onSubmit:s},t("calls_error_upload_background_image"))}},67057:(e,t,n)=>{"use strict";n.d(t,{UploadBackgroundPhotoContainer:()=>s});var a=n(667294),r=n(50533),i=n(654837),o=n(860228),l=n(121255),s=function(e){var t=e.onAddBackground,n=e.loading,s=(0,r.useDispatch)(),c=(0,a.useCallback)((function(){s({type:l.TOGGLE_POPUP,data:l.POPUP_VIRUTAL_BACKGROUND})}),[]),u=(0,a.useCallback)((function(e){t(e).then(c).catch((function(){s({type:l.TOGGLE_POPUP,data:l.POPUP_UPLOAD_BACKGROUND_ERROR})}))}),[c]);return a.createElement(i.UploadBackgroundPhotoModal,{onClose:c},a.createElement(o.UploadBackgroundPhoto,{loading:n,onSubmit:u}))}},955150:(e,t,n)=>{"use strict";n.d(t,{VirtualBackgroundSettingsContainer:()=>C});var a=n(570655),r=n(667294),i=n(50533),o=n(288540),l=n(536228),s=n(116930),c=n(20832),u=n(363220),d=n(591172),p=n(72675),_=n(121255),m=n(993663),f=n(524384),g=n(915622),A=n(731388),v=n(67057),h=n(32491),E=n(223724),C=(0,r.memo)((function(e){var t=e.SDK,n=(0,a.__read)((0,r.useState)(!1),2),C=n[0],S=n[1],y=(0,i.useSelector)((function(e){return e.popup})),T=(0,i.useSelector)((function(e){return e.virtualBackgroundSettings.photos})),I=(0,p.useBackgroundsList)({photos:T}).backgroundList,b=(0,m.useClosePopup)().onClose,N=(0,f.useCurrentUserStream)(),w=N.userStream,L=N.isVideoEnabled,P=(0,s.useSettingsItems)({backgroundList:I}),k=P.chosen,M=P.setChosen,O=P.onClick,D=P.onSuccessPhotoUpload,R=(0,g.useUserBackgrounds)({photos:T,onSuccessPhotoUpload:D}),B=R.onCancelSettings,x=R.loadingUpload,U=R.onAddBackground,H=R.onDeleteBackground,G=R.onSaveSettings,V=(0,c.useBackgroundEffects)({SDK:t}).onSettingsChange;(0,u.useInitialBackgroundEffect)({onSettingsChange:V,userStream:w,backgroundList:I,isVideoEnabled:L});var F=(0,d.useSavedSettings)({chosen:k,onSettingsChange:V,settingsOpened:C,setChosen:M,backgroundList:I,isVideoEnabled:L}),W=F.onRestoreSettings,z=F.onApplySettings,j=(0,h.useVideoOptions)(),K=j.videoOptions,Y=j.onRestoreSettings,Q=j.onSaveSettings,Z=j.onChangeVideoOption;(0,r.useEffect)((function(){E.effectStorage.clearEffectTs()}),[]),(0,r.useEffect)((function(){y!==_.POPUP_VIRUTAL_BACKGROUND||C||S(!0)}),[y]);var J=(0,r.useCallback)((function(){G(),b(),S(!1),z(),Q()}),[G,b,z,Q]),q=(0,r.useCallback)((function(){B(),b(),S(!1),W(),Y()}),[B,b,W,Y]);return r.createElement(r.Fragment,null,y===_.POPUP_VIRUTAL_BACKGROUND&&r.createElement(o.VirtualBackgroundSettingsModal,{onClose:q,onSubmit:J,onChangeVideoOption:Z,videoOptions:K},r.createElement(l.VirtualBackgroundSettings,{chosen:k,backgroundList:I,onDeleteBackground:H,onChooseBackground:O,videoOptions:K})),y===_.POPUP_UPLOAD_BACKGROUND_PHOTO&&r.createElement(v.UploadBackgroundPhotoContainer,{onAddBackground:U,loading:x}),y===_.POPUP_UPLOAD_BACKGROUND_ERROR&&r.createElement(A.UploadBackgroundErrorContainer,null))}))},699637:(e,t,n)=>{"use strict";n.d(t,{WaitingContainer:()=>o});var a=n(667294),r=n(50533),i=n(706885);function o(){return(0,r.useSelector)((function(e){return e})).isLoaderVisible?a.createElement(i.default,null):null}},637880:(e,t,n)=>{"use strict";n.d(t,{WaitingHallContainer:()=>v});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(492512),s=n(269481),c=n(169610),u=n(690015),d=n(697483),p=n(662208),_=n(498110),m=n(774351),f=n(100741),g=n(464380),A=n(51443);function v(e){var t,n=e.SDK,v=e.navigateToConvo,h=(0,i.useSelector)((function(e){return e})),E=(0,i.useDispatch)(),C=(0,r.useContext)(p.LangContext).getLang,S=(0,r.useContext)(_.ConfigContext),y=S.isModalView,T=S.enableScreenTrack,I=h.peer,b=h.participants[h.me].mediaSettings||{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1},N=(0,r.useMemo)((function(){return(0,d.getActiveParticipants)(h)}),[h.participants,h.me,h.groupId,h.meGroup]),w=h.uiMode===o.UIMode.FULLSCREEN,L=(0,a.__read)((0,r.useState)(!1),2),P=L[0],k=L[1],M=(0,a.__read)((0,r.useState)(!1),2),O=M[0],D=M[1],R=function(e){return E({type:o.CHANGE_UI_MODE,mode:e})},B=(0,r.useCallback)((function(){y&&(h.uiMode===o.UIMode.FULLSCREEN?((0,m.pause)(.3,null).then((function(){R(o.UIMode.COLLAPSED)})),R(o.UIMode.DEFAULT)):R(o.UIMode.COLLAPSED))}),[h.uiMode]),x=(0,r.useCallback)((function(){if(!P){var e=!b.isAudioEnabled;(e?(0,c.checkPermissions)(n,[g.MediaOption.AUDIO]):Promise.resolve()).then((function(){var t;k(!0),(null===(t=h.notification)||void 0===t?void 0:t.type)===o.NotificationType.SPEAKING_ON_MUTE&&E({type:o.CALL_NOTIFICATION,notification:null}),n.toggleLocalAudio(e).finally((function(){k(!1)}))}))}}),[b,P]),U=(0,r.useCallback)((function(){if(!O){var e=!b.isVideoEnabled||b.isScreenSharingEnabled&&!T;(e?(0,c.checkPermissions)(n,[g.MediaOption.VIDEO]):Promise.resolve()).then((function(){D(!0),T||b.isScreenSharingEnabled&&n.captureScreen(!1),n.toggleLocalVideo(e).finally((function(){D(!1)}))}))}}),[b,O]),H=(0,r.useCallback)((function(){B(),v(h.peer)}),[h.peer,h.uiMode]),G=(0,r.useCallback)((function(){n.hangup()}),[h.callData.callId,h.peer,N]),V=(0,r.useCallback)((function(){E({type:o.CHANGE_UI_MODE,mode:w?o.UIMode.DEFAULT:o.UIMode.FULLSCREEN}),E({type:o.SET_TOOLTIP,tooltips:null})}),[h.uiMode]),F=(0,r.useCallback)((function(e,t){var n;E({type:o.SET_TOOLTIP,tooltips:(n={},n[e]=t,n)})}),[]),W=(0,r.useCallback)((function(){E({type:o.SET_TOOLTIP,tooltips:null})}),[]);(0,r.useEffect)((function(){return function(){E({type:o.SET_TOOLTIP,tooltips:null})}}),[]);var z=(0,r.useMemo)((function(){var e;return r.createElement(u.CallNotificationContainer,{dispatch:E,notification:h.notification,participant:h.participants[null===(e=h.notification)||void 0===e?void 0:e.data]})}),[h.notification,h.participants[null===(t=h.notification)||void 0===t?void 0:t.data]]),j=h.hangupType===o.HANGUP_TYPE_REMOVED?C("calls_waiting_hall_removed"):C("calls_waiting_hall_info");return r.createElement(s.CallModal,{onClose:G,onBackdropClick:B},r.createElement(l.Call,{info:null,isVideoAllowed:!0,isAudioAllowed:!0,isVideoEnabled:b.isVideoEnabled,isAudioEnabled:b.isAudioEnabled,isFullScreen:w,onToggleAudio:x,onToggleVideo:U,onLeaveCall:G,onCollapseCall:y?B:null,onFullScreenToggle:V,onTooltipChange:F,onHidePanel:W,onChat:H,isChatControlShown:!!I&&!h.groupId,chatUnreadCount:h.chatUnreadCount,notification:z,tooltips:h.tooltips,amISpeaking:!!h.speakers[h.me],notificationWithButton:null,withoutPadding:!0},r.createElement(r.Fragment,null,b.isVideoEnabled&&r.createElement(f.WaitingHall,(0,a.__assign)({},function(e,t){var n,a=e[t],r=a.mediaSettings,i=(0,d.isParticipantWithVideo)(a),o=(0,d.getStream)(a);return{id:t,name:"",letter:null===(n=a.name)||void 0===n?void 0:n.slice(0,1),hasAudio:!!(null==r?void 0:r.isAudioEnabled),hasVideo:i,stream:o,wasConnected:!!a.wasConnected}}(h.participants,h.me))),r.createElement(A.WaitingHallInfo,{text:j}))))}},564840:(e,t,n)=>{"use strict";n.d(t,{WaitingHallListContainer:()=>f});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(662208),s=n(428990),c=n(956462),u=n(719481),d=n(186983),p=n(736434),_=n(431469),m=n(884143),f=function(e){var t,n,f,A,v,h=e.isModal,E=e.onMore,C=e.navigateToProfile,S=e.isWithBackButton,y=e.onBackClick,T=S?y:function(){},I=(0,i.useSelector)((function(e){return e})),b=(0,i.useDispatch)(),N=r.useContext(l.LangContext).getLang,w=(0,a.__read)((0,r.useState)(g(I,h)),2),L=w[0],P=w[1],k=(0,a.__read)((0,r.useState)(""),2),M=k[0],O=k[1],D=I.waitingHall?Array.from(null===(t=I.waitingHall)||void 0===t?void 0:t.members.values()):[],R=(0,r.useCallback)((function(e){return e.name}),[]),B=(0,r.useCallback)((function(e){return e.peerId}),[]),x=(0,_.useIndexer)(h?D:[],R,B),U=(0,r.useCallback)((function(e){O(e.target.value)}),[]),H=h?D:D.slice(0,5);M&&(H=x.search(M)),(0,r.useEffect)((function(){P(g(I,h))}),[null===(n=I.waitingHall)||void 0===n?void 0:n.totalCount]);var G=(0,r.useCallback)((function(e){var t,n=null===(t=I.waitingHall)||void 0===t?void 0:t.members.get(e);n&&b({type:o.TOGGLE_PARTICIPANTS_KICK,data:{type:o.KickParticipantType.WAITING_HALL,participant:n}})}),[null===(f=I.waitingHall)||void 0===f?void 0:f.members]),V=(0,r.useCallback)((function(e){I.waitingHall&&(0,u.promoteUserAndRemoveFromWaitingHall)(e,I.waitingHall,b)}),[null===(A=I.waitingHall)||void 0===A?void 0:A.members]),F=(0,r.useCallback)((function(){E&&E()}),[I.waitingHall]),W=r.createElement(r.Fragment,null,r.createElement(s.WaitingHallList,{members:H,totalCount:null===(v=I.waitingHall)||void 0===v?void 0:v.totalCount,navigateToProfile:C,onPromote:V,onForbid:G}),L&&r.createElement(c.ListMore,{onClick:F},N("calls_waiting_hall_more_text")));return h?r.createElement(d.CallManagementModal,{title:N("calls_waiting_hall_title"),onCloseModal:function(){b({type:o.GROUP_CALL_SETUP,open:!1,preselectedIds:null}),b({type:o.MANAGEMENT,isOpen:!1})},isWithBackButton:S,onBackClick:T},r.createElement("div",{className:"CallParticipantList"},D.length>0&&r.createElement(r.Fragment,null,r.createElement(p.BlockSearchInput,{value:M,placeholder:N("calls_search_participants_placeholder"),onChange:U,onInput:U,onPaste:U,className:"CallParticipantList__input"}),W,M&&0===H.length&&r.createElement(m.default,null,N("calls_participants_not_found"))),0===D.length&&r.createElement(m.default,null,N("calls_waiting_hall_not_users")))):W};function g(e,t){if(t)return!1;var n=e.waitingHall;return!!n&&n.totalCount>5}},498110:(e,t,n)=>{"use strict";n.d(t,{ConfigContext:()=>i});var a=n(667294),r=n(121255),i=a.createContext({isModalView:!0,withAnimation:!0,allowAddMembers:!1,debugLog:!1,incomingCall:!1,streaming:!0,streamingPrivacy:!0,fullHD:!1,anonymPhoto:!0,allowBanParticipant:!1,showFeedbackScreen:!1,enableVideoSlots:!1,videoSlotsCount:r.VIDEO_SLOTS_COUNT,browserWarnings:null,allowCallByName:!1,nativeApp:!1,nativeAppJoin:!1,enableScreenTrack:!1,enableProducerScreenTrack:!1,allowWaitingHall:!1,allowPushToTalk:!1,badNetwork:!1,badNetworkP2P:!1,desktopAppNotification:!1,sferum:!1,enableVirtualBackground:!1})},662208:(e,t,n)=>{"use strict";n.d(t,{LangContext:()=>a});var a=n(667294).createContext({getLang:function(e){return e},langSex:function(e,t){return t},langNumeric:function(e,t){return""+t},langShortDateTime:function(e){return""+e},langShortDate:function(e){return""+e}})},641196:(e,t,n)=>{"use strict";n.d(t,{setApiWrappers:()=>i,getApiWrapper:()=>o});var a=null,r=null,i=function(e,t){a=e,r=t},o=function(e){return void 0===e&&(e=!0),e?a:r}},483379:(e,t,n)=>{"use strict";n.d(t,{browser:()=>r,getWarningBrowserInfo:()=>i});var a=navigator.userAgent.toLowerCase(),r={version:(a.match(/.+(?:me|ox|on|rv|it|era|opr|ie|edge)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:!/chrome/i.test(a)&&/webkit|safari|khtml/i.test(a),edge:/(edge)\/(\d+)\.(\d+)/.test(a),chrome:/(chrome)\/(\d+)\.(\d+)/.test(a),firefox:/(firefox)\/(\d+)\.(\d+)/.test(a)};function i(e){var t,n=null==e?void 0:e.find((function(e){return r[e.browser]&&void 0===e.version})),a=null==e?void 0:e.find((function(e){return r[e.browser]&&String(r.version).startsWith(String(e.version))}));return null!==(t=null!=a?a:n)&&void 0!==t?t:null}},745284:(e,t,n)=>{"use strict";n.d(t,{isGroupCallByPeer:()=>l,isActiveGroupCallMessage:()=>s,isRequireAuthToJoin:()=>c,isWaitingHallEnabled:()=>u,getDefaultConversation:()=>d,isAuthedByGroupId:()=>p,getMediaOptions:()=>_,isIAmSpeaking:()=>m,getCallsCount:()=>f,increaseCallsCount:()=>g});var a=n(389953),r=n(121255),i=n(464380),o=n(659397),l=function(e){return 0===e||(0,a.isChatPeer)(e)||null===e};function s(e){return e&&e.attaches&&e.attaches[0]&&"group_call_in_progress"===e.attaches[0].type}function c(e){return e.conversationOptions.includes(i.ConversationOption.REQUIRE_AUTH_TO_JOIN)}function u(e){return e.conversationOptions.includes(i.ConversationOption.WAITING_HALL)}function d(e){return{peerId:0,canAddMembers:!0,tab:e("calls_new_call_title"),photo:r.DEFAULT_GROUP_CALL_PHOTO}}function p(e){return!!e.groupId}function _(e){var t=e.audio,n=e.video,a=[];return t&&a.push(i.MediaOption.AUDIO),n&&a.push(i.MediaOption.VIDEO),a}function m(e){return!!e.speakers[e.me]}function f(){var e;return Number(null!==(e=o.localStorage.getItem(r.CALLS_DESKTOP_APP_NOTIFICATION))&&void 0!==e?e:0)}function g(){var e,t=Number(null!==(e=o.localStorage.getItem(r.CALLS_DESKTOP_APP_NOTIFICATION))&&void 0!==e?e:0)+1;o.localStorage.setItem(r.CALLS_DESKTOP_APP_NOTIFICATION,String(t))}},874023:(e,t,n)=>{"use strict";n.d(t,{DAY:()=>a,WEEK:()=>r,SECOND_JS:()=>i});var a=86400,r=7*a,i=1e3},767497:(e,t,n)=>{"use strict";n.d(t,{generateStartCallsDeepLink:()=>r,generateJoinCallsDeepLink:()=>i});var a=n(121255),r=function(e){var t=e.peerId,n=e.userId,r=""+a.DESKTOP_CALLS_SCHEME+a.DESKTOP_CALLS_HOST+"/join?peerId="+t+"&userId="+n;return console.log("deeplink: ",r),r},i=function(e){var t=e.joinLink,n=e.userId,r=""+a.DESKTOP_CALLS_SCHEME+a.DESKTOP_CALLS_HOST+"/join?joinLink="+t+"&userId="+n;return console.log("deeplink: ",r),r}},307915:(e,t,n)=>{"use strict";n.d(t,{getPermissionsErrorMessage:()=>r,getMediaErrorMessage:()=>i,createInvokeErrorWrapper:()=>o});var a=n(121255);function r(e,t,n){void 0===t&&(t=!0);var a="";return e&&t?a=n("calls_error_no_cam_and_mic"):e?a=n("calls_error_no_cam"):t&&(a=n("calls_error_no_mic")),a}function i(e,t){var n;return((n={})[a.MediaError.CAMERA_PERMISSION]=t("calls_error_no_cam"),n[a.MediaError.MIC_PERMISSION]=t("calls_error_no_mic"),n[a.MediaError.CAMERA_ACCESS]=t("calls_error_cameralock"),n[a.MediaError.MIC_ACCESS]=t("calls_error_miclock"),n[a.MediaError.MIC_NOT_FOUND]=t("calls_error_nomic"),n[a.MediaError.SCREEN_PERMISSION]=t("calls_error_screenpermission"),n[a.MediaError.SCREEN_ACCESS]=t("calls_error_screenlock"),n)[e]}function o(e,t){return function(n){e&&e({msg:n}),(null==t?void 0:t.onError)&&t.onError(new Error(n)),console.error(n)}}},153907:(e,t,n)=>{"use strict";n.d(t,{download:()=>o,openDesktopPage:()=>l,getPlatformUrl:()=>s,setDownloadedFlag:()=>c});var a=n(233194),r=n(121255),i=n(659397),o=function(e,t){var n=document.createElement("a");n.download=t,n.href=e,document.body.appendChild(n),n.click(),n.remove()},l=function(e){void 0===e&&(e=r.DESKTOP_CALLS_DOWNLOAD_PAGE);var t=document.createElement("a");t.target="_blank",t.href=e,document.body.appendChild(t),t.click(),t.remove()};function s(){var e=null;return a.Platform.OS===a.OS.MAC?e={url:r.DESKTOP_CALLS_DOWNLOAD[a.OS.MAC],filename:r.DESKTOP_CALLS_FILENAME[a.OS.MAC]}:a.Platform.OS===a.OS.WINDOWS?e={url:r.DESKTOP_CALLS_DOWNLOAD[a.OS.WINDOWS],filename:r.DESKTOP_CALLS_FILENAME[a.OS.WINDOWS]}:a.Platform.OS===a.OS.LINUX&&(e={url:r.DESKTOP_CALLS_DOWNLOAD[a.OS.LINUX].deb[a.ARCH.X64],filename:r.DESKTOP_CALLS_FILENAME[a.OS.LINUX].deb[a.ARCH.X64]}),e}function c(){i.localStorage.setItem(r.LOCALSTORAGE_IS_CALLS_APP_DOWNLOADED,"true")}},296951:(e,t,n)=>{"use strict";n.d(t,{get:()=>r});var a=n(659397),r=function(e,t){if((0,a.isString)(e)||(0,a.isArray)(e))for(var n=(0,a.isArray)(e)?e:e.split(".").filter(Boolean),r=n.length-1,i=t,o=0;o<n.length;o+=1){if(!(0,a.isObjectLike)(i))return;var l=i[n[o]];if(!l)return;if(o===r)return l;i=l}}},298811:(e,t,n)=>{"use strict";n.d(t,{fetchUserShortName:()=>m,convertClientData:()=>f,convertServerData:()=>g,convertCallerFromLongpoll:()=>A,convertChatFromLongpoll:()=>v,getPeerIdFromLongpoll:()=>h,isGroupCallEvent:()=>E,isAnyoneWithVideo:()=>C,calculateCallDuration:()=>S,getTextForApiErrorByCode:()=>y,getTextForServerError:()=>T,getTextForClientError:()=>I,createPayload:()=>b,isInReconnect:()=>N,compose:()=>w,exponentialRetry:()=>L,startCallRetryWrapper:()=>P,getParticipantsListLabel:()=>k,unpackState:()=>M,normalizePreviewData:()=>O});var a=n(570655),r=n(389953),i=n(745284),o=n(121255),l=n(774351),s=n(659397),c=n(788822),u=n(613335),d=n(464380),p=n(697483);function _(e){var t,n=e.shortName,r=e.firstName;e.lastName;return n&&r||(n=m(r=(t=(0,a.__read)(e.name.split(" "),2))[0],t[1],e.name)),(0,a.__assign)((0,a.__assign)({},e),{peerId:+e.id,tab:e.name,shortName:n,firstName:r})}function m(e,t,n){if(e){var a=t?t.length>2?t.substring(0,1)+".":t:"";return a?e+" "+a:e}return n}function f(e){var t=(0,a.__read)(e,2),n=t[0],r=t[1],i=n&&function(e){var t=e.callInProgress,n=void 0!==t&&t,r=(0,a.__rest)(e,["callInProgress"]);return!r.call_in_progress&&n&&(r.call_in_progress=n),r}(n);return[i&&("peerId"in i?i:_(i)),r?r.map(_):[]]}function g(e){var t,n=e.items,i=e.profiles,o=(0,a.__read)(n,1)[0],l=function(e){if(e.chat_settings){var t={peerId:e.peer.id,tab:e.chat_settings.title,name:e.chat_settings.title,canAddMembers:e.chat_settings.acl.can_invite,adminIds:e.chat_settings.admin_ids,ownerId:e.chat_settings.owner_id||-1};return e.chat_settings.photo&&(t.photo=e.chat_settings.photo.photo_100),t}return{canAddMembers:!0,peerId:e.peer.id}}(o),s=function(e){return e.map(u.normalizeUser)}(i);return[(0,a.__assign)((0,a.__assign)({},l),{tab:l.name}),(0,r.isUserPeer)(null!==(t=l.peerId)&&void 0!==t?t:0)?[(0,a.__assign)((0,a.__assign)({},s&&s.filter((function(e){return e.peerId===l.peerId}))[0]),l)]:s,o]}function A(e){var t=e.caller_info,n=t.first_name+" "+t.last_name;return{peerId:+t.user_id,name:n,tab:n,photo:t.photo_400||t.photo_200,firstName:t.first_name,lastName:t.last_name,shortName:m(t.first_name,t.last_name,n)}}function v(e){var t=e.chat_info;return{peerId:2e9+t.chat_id,tab:t.title,name:t.title,photo:t.photo_400||t.photo_200}}function h(e){var t=e.caller_info,n=e.chat_info;return n?2e9+n.chat_id:t.user_id}function E(e){return!!e.payload.chat_info}function C(e){return!!Object.values(e.participants).find((function(t){return(t.peerId===e.me||t.wasConnected)&&t.mediaSettings&&(0,p.isParticipantWithVideo)(t)}))}function S(e){var t=Date.now(),n=Math.max(0,Math.floor((t-e)/1e3));return 0===n?"00:00":n<=599?"0"+(0,s.formatDuration)(n):(0,s.formatDuration)(n)}function y(e,t,n){switch(+e){case o.SERVER_ERROR_MESSAGES_CALL_JOIN_NOT_ALLOWED:return n("calls_join_error_require_access");case o.SERVER_ERROR_MESSAGES_CALL_NOT_FOUND:return n("calls_join_error_text");case o.SERVER_ERROR_PRIVACY:return n("calls_privacy_error");case o.SERVER_ERROR_BUSY:return n(t?"calls_chat_busy_error":"calls_busy_error");case o.SERVER_ERROR_FLOOD_CONTROL:return n("calls_flood_error");case o.SERVER_ERROR_REQUIRE_AUTH:return n("calls_join_error_require_auth");case o.SERVER_ERROR_UNKNOWN:case o.SERVER_ERROR_INVALID_REQUEST:case o.SERVER_ERROR_INTERNAL:case o.SERVER_ERROR_OLD_RECEIVER_APP:default:return n("calls_start_error")}}function T(e,t,n){var a,r,i=0===e.search("EXTERNAL_API_ERROR"),l=e.match(/\d+/g),s=l?Number(null===(a=e.match(/\d+/g))||void 0===a?void 0:a[1]):o.CLIENT_ERROR_UNKNOWN,c=l?Number(null===(r=e.match(/\d+/g))||void 0===r?void 0:r[0]):o.CLIENT_ERROR_UNKNOWN;if(!i||Number.isNaN(s)){switch(c){case o.SDK_ERROR_AUTH:return n("calls_start_error_auth")}return function(e,t,n){switch(!0){case-1!==e.search("error.webrtc.auth.required"):return n("calls_join_error_require_auth");case-1!==e.search("error.webrtc.auth.banned"):case-1!==e.search("error.webrtc.participant.check.privacy"):return n("calls_join_error_banned");case-1!==e.search("error.webrtc.participant.check.killed_call"):return n("calls_join_error_killed_call");case-1!==e.search("not.found.webrtc.conversation"):return n("calls_join_error_not_found_conversation");default:return n("calls_start_error")}}(e,0,n)}switch(e){case d.HangupType.CANCELED:return n("calls_hangup_error_canceled");case d.HangupType.REJECTED:return n("calls_hangup_error_rejected");case d.HangupType.REMOVED:return n("calls_hangup_error_removed");case d.HangupType.HUNGUP:return n("calls_hangup_error_hangup");case d.HangupType.MISSED:return n("calls_hangup_error_missed");case d.HangupType.BUSY:return n("calls_hangup_error_busy");case d.HangupType.FAILED:return n("calls_hangup_error_failed");case d.HangupType.NETWORK_ERROR:return n("calls_hangup_error_network_error");case d.HangupType.CALLER_IS_BLOCKED:return n("calls_hangup_error_caller_is_blocked");case d.HangupType.NOT_FRIENDS:return n("calls_hangup_error_not_friends");case d.HangupType.CALLEE_IS_OFFLINE:return n("calls_hangup_error_callee_is_offline");case d.HangupType.UNKNOWN_ERROR:return n("calls_hangup_error_unknown_error");case d.HangupType.UNSUPPORTED:return n("calls_hangup_error_unsupported");case d.HangupType.OLD_VERSION:return n("calls_hangup_error_old_version");case d.HangupType.SERVICE_DISABLED:return n("calls_hangup_error_service_disabled");case d.HangupType.EXTERNAL_API_ERROR:return n("calls_hangup_error_external_api_error");case d.HangupType.SOCKET_CLOSED:return n("calls_hangup_error_socket_closed")}return y(+s,t,n)}function I(e,t,n){return n("calls_sorry_error")}function b(e,t){return JSON.stringify({is_video:t.includes(d.MediaOption.VIDEO),chat_id:(0,r.isChatPeer)(e)?e-2e9:void 0,with_join_link:(0,i.isGroupCallByPeer)(e),join_by_link:(0,i.isGroupCallByPeer)(e)})}function N(e){return!!Object.values(e.participants).find((function(e){return e.status===d.ParticipantStatus.RECONNECT}))}var w=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.reduce((function(e,t){return t(e)}),e).apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(n)))}};function L(e,t){return void 0===t&&(t={attempts:10,timeout:0}),function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.attempts>0?(0,l.pause)(t.timeout,null).then((function(){return e.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(n)))})).catch((function(r){return!t.timeout&&(t.timeout=1),t.attempts=r.type===o.SdkErrorType.API?0:t.attempts-1,t.timeout=Math.min(2*t.timeout,300),L(e,t).apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(n)))})):Promise.reject(o.CallErrorType.CANT_REACH_API)}}var P=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(n))).catch((function(r){if(r.error===o.FatalError.AUTH)return e().then((function(){return t.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(n)))}));throw r}))}};function k(e,t,n,a,r,i,o){void 0===i&&(i=0),void 0===o&&(o=3);var l=function(e){return(0,c.decodeHTMLEntities)(n(e)||"")};if(0===i&&e.length>0&&(i=e.length),i>t.length){var s=i-t.length,u=e.slice(0,o).map(l).join(", ");return r(s,"calls_members_list_label",a("calls_members_list_label",s)).replace("{name}",u)}if(t.length>1){var d=t.length>2?e.slice(0,2).map(l).join(", "):l(e[0]),p=l(e[t.length-1]);return a("calls_and").replace("{before}",d).replace("{after}",p)}return 1===t.length?l(e[0]):""}function M(e){return"current"in e?e.current:e}function O(e,t){var n=t.join_link,r=t.preview,i=t.profiles,o=t.anonyms,l=(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(o)),(0,a.__read)(i)).map(u.normalizeUser);return{joinLink:n,title:r.title,membersCount:r.members_count,photo_100:r.photo.photo_100,photo_200:r.photo.photo_200,members:l,conversationData:{peerId:0,canAddMembers:!0,tab:e("calls_new_call_title"),photo:"https://vk.com/images/call_convo_stub.png"}}}},171659:(e,t,n)=>{"use strict";n.d(t,{getHistoryCallPeerId:()=>r,getCurrentCallPeerId:()=>i,getCurrentCallOwner:()=>o,getHistoryItemOwner:()=>l});var a=n(121255);function r(e){var t,n=e.chat,r=e.user_ids,i=e.items,o=0;return n?n.id&&(o=a.CHAT_PEER_ID_OFFSET+n.id):r.length?o=r[0]:(null==i?void 0:i.length)&&(null===(t=i[0])||void 0===t?void 0:t.chat)&&i[0].chat.id&&(o=a.CHAT_PEER_ID_OFFSET+i[0].chat.id),o}function i(e){var t=0;return(null==e?void 0:e.chat)?t=a.CHAT_PEER_ID_OFFSET+e.chat.id:e.user_ids.length&&(t=e.user_ids[0]),t}function o(e,t){var n=e.chat,a=e.user_ids,r=void 0;if(!n&&a.length){var i=a[0];i in t&&(r=t[i])}return{member:r,chat:n}}function l(e,t){var n,a,r=e.chat,i=e.user_ids,o=e.items,l=void 0;if(!r)if(i.length){var s=i[0];s in t&&(l=t[s])}else(null==o?void 0:o.length)&&(null===(n=o[0])||void 0===n?void 0:n.chat)&&(r=null===(a=o[0])||void 0===a?void 0:a.chat);return{member:l,chat:r}}},223724:(e,t,n)=>{"use strict";n.d(t,{videoOptionsStorage:()=>i,effectStorage:()=>o});var a=n(570655),r=n(121255),i={queryOption:function(e){return i.getOptions()[e]},getOptions:function(){try{var e=localStorage.getItem(r.LS_KEYS.VIDEO_OPTIONS);if("string"!=typeof e)throw new Error("no value stored");return JSON.parse(e)}catch(e){return i.getDefaultOptions()}},saveOption:function(e,t){var n,o=(0,a.__assign)((0,a.__assign)({},i.getOptions()),((n={})[e]=t,n));return localStorage.setItem(r.LS_KEYS.VIDEO_OPTIONS,JSON.stringify(o)),o},saveOptions:function(e){return localStorage.setItem(r.LS_KEYS.VIDEO_OPTIONS,JSON.stringify(e)),e},getDefaultOptions:function(){return{calls_is_video_mirrored:!0}}},o={getEffect:function(){var e=localStorage.getItem(r.LS_KEYS.VIRTUAL_BACKGROUND_EFFECT);return"string"!=typeof e?r.EVideoEffectType.NONE:/^\d+$/.test(e)?+e:e},saveEffect:function(e){localStorage.setItem(r.LS_KEYS.VIRTUAL_BACKGROUND_EFFECT,""+e)},getEffectTs:function(){var e=localStorage.getItem(r.LS_KEYS.VIRTUAL_BACKGROUND_EFFECT_SELECTED_TS);return"string"!=typeof e?0:+e},saveEffectTs:function(e){localStorage.setItem(r.LS_KEYS.VIRTUAL_BACKGROUND_EFFECT_SELECTED_TS,""+e)},clearEffectTs:function(){localStorage.removeItem(r.LS_KEYS.VIRTUAL_BACKGROUND_EFFECT_SELECTED_TS)}}},631635:(e,t,n)=>{"use strict";n.d(t,{muteGenerator:()=>i});var a=n(464380),r=n(765446);function i(e){var t=e.isAudio,n=e.isSingle,i=e.isPermanent,o=e.participantExternalId,l=e.logEvent,s=e.closeDialog;return function(){var e,c,u=i?a.MuteState.MUTE_PERMANENT:a.MuteState.MUTE,d=t?((e={})[a.MediaOption.AUDIO]=u,e):((c={})[a.MediaOption.VIDEO]=u,c[a.MediaOption.SCREEN_SHARING]=u,c);(0,a.muteParticipant)(n?o:null,d).catch(console.log).finally(s),l(i?r.CallStatMuteType.ONCE:r.CallStatMuteType.PERMANENT)}}},697483:(e,t,n)=>{"use strict";n.d(t,{isParticipantAnonym:()=>c,isParticipantGroup:()=>u,getParticipantExternalId:()=>d,getParticipantActions:()=>_,isParticipantInCall:()=>m,isParticipantUnavailableToCallFromGroup:()=>f,getCallVisibleParticipant:()=>g,getActiveParticipants:()=>v,getActiveParticipantsCount:()=>h,getNonAnonymousConnectParticipantsCount:()=>E,getConnectedAdminsCount:()=>C,canPinParticipants:()=>I,isAdmin:()=>b,isCreator:()=>N,canMuteParticipants:()=>w,getRaisedHands:()=>P,kickParticipant:()=>k,participantIsChatAdmin:()=>M,participantIsAdmin:()=>O,isMutedPermanently:()=>D,getMeId:()=>R,getStream:()=>B,isParticipantWithVideo:()=>x,getOrator:()=>U});var a=n(570655),r=n(121255),i=n(745284),o=n(464380),l=n(614914),s=n(613335),c=function(e){return e>-19e8&&e<-189e7},u=function(e){return e<0&&e>-1e9},d=function(e){return(null==e?void 0:e.peerId)?c(e.peerId)?e.peerId.toString():{id:e.peerId.toString(),type:o.ExternalIdType.USER}:null},p={},_=function(e,t,n,a,s,_,m,f,g){void 0===g&&(g=!1);var A=a.peerId===e.me,v=c(a.peerId),h=(0,i.isGroupCallByPeer)(e.peer),E=e.participants[e.me],C=!!e.groupId,S=[],y=[],P=e.config.isModalView,k=u(a.peerId);if(A||!s||v||void 0===f||S.push({text:_(k?"calls_go_to_community":"calls_go_to_profile"),onClick:function(e){f(e,a.link)}}),A||v||c(e.me)||void 0===m||C||S.push({text:_(k?"calls_go_to_chat_with_community":"calls_go_to_chat_with_participant"),onClick:function(){P&&n({type:r.CHANGE_UI_MODE,mode:r.UIMode.COLLAPSED}),n({type:r.MANAGEMENT,isOpen:!1}),m(a.peerId)}}),!A&&h&&!c(e.me)&&function(e){return O(e)}(E)&&!N(a)){var M={negative:!0,text:_("calls_participant_menu_kick"),onClick:function(){n({type:r.TOGGLE_PARTICIPANTS_KICK,data:{type:r.KickParticipantType.CALL,participant:a}})}};g?y.push(M):S.push(M)}if(!A&&h&&!c(e.me)&&w(E)&&(S.push({text:_("calls_participant_menu_mute_audio"),onClick:function(){n({type:r.TOGGLE_PARTICIPANTS_MANAGEMENT,data:{mode:r.ParticipantsManagementMode.SINGLE_AUDIO,participant:a}})}}),S.push({text:_("calls_participant_menu_mute_video"),onClick:function(){n({type:r.TOGGLE_PARTICIPANTS_MANAGEMENT,data:{mode:r.ParticipantsManagementMode.SINGLE_VIDEO,participant:a}})}})),A||h||c(e.me)||!w(E)||S.push({text:_("calls_participant_menu_mute"),onClick:function(){var e,n=d(a);n&&t.muteParticipant(n,(e={},e[o.MediaOption.AUDIO]=o.MuteState.MUTE,e)).catch(console.log)}}),A||!h||c(e.me)||!w(e.participants[e.me])||function(e){if(!e.mediaSettings)return!1;var t=e.mediaSettings,n=t.isAudioEnabled,a=t.isVideoEnabled,r=t.isScreenSharingEnabled;return n&&(a||r)}(a)||S.push({text:_("calls_participant_menu_enable_media_request"),onClick:function(){t.muteParticipant(d(a),{},[o.MediaOption.AUDIO,o.MediaOption.VIDEO,o.MediaOption.SCREEN_SHARING]).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.ASK_USER_TO_UNMUTE,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)})}}),A||!h||c(e.me)||c(a.peerId)||!L(e.participants[e.me])||b(a)||N(a)||a.status!==o.ParticipantStatus.CONNECTED||S.push({text:_("calls_participant_menu_assign_admin_role"),onClick:function(){n({type:r.TOGGLE_ADMIN_ASSIGNMENT,data:{participant:a}})}}),!A&&h&&!c(e.me)&&L(e.participants[e.me])&&b(a)&&S.push({text:_("calls_participant_menu_revoke_admin_role"),onClick:function(){var s=d(a);s&&(t.grantRoles(s,[o.UserRole.ADMIN],!0).then((function(){n({type:r.CHANGE_PARTICIPANT_ROLES,participantId:a.peerId,data:a.roles.filter((function(e){return e!==o.UserRole.ADMIN}))})})).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.RETRIEVE_ADMIN,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)}))}}),h&&!c(e.me)&&I(e.participants[e.me])&&!T(e,a)&&S.push({text:_("calls_participant_menu_pin"),onClick:function(){var o=d(a);o&&(t.pinParticipant(o,!1).then((function(){n({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:a.peerId}),n({type:r.TOGGLE_ORATOR_MODE,isOratorMode:!0})})).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.ADMIN_PIN,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)}))}}),h&&!c(e.me)&&I(e.participants[e.me])&&T(e,a)&&S.push({text:_("calls_participant_menu_pin_cancel"),onClick:function(){var o=d(a);o&&(t.pinParticipant(o,!0).then((function(){n({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:null})})).catch(console.log),l.callStats.logEvent({call_event_type:r.CallActionEventType.ADMIN_UNPIN,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,i.isGroupCallByPeer)(e.peer)}))}}),g&&y.length>0&&(S.push({separator:!0}),S=S.concat(y)),p[a.peerId]){var D=S.length===p[a.peerId].length;if(D)for(var R=0;R<S.length;R++)S[R].text!==p[a.peerId][R].text&&(D=!1);D?S=p[a.peerId]:p[a.peerId]=S}else p[a.peerId]=S;return S},m=function(e,t){var n=e.participants[t];return n&&(n.peerId===e.me||!!n.status)},f=function(e,t){return!!e.unableToCallGroupMembersIds&&e.unableToCallGroupMembersIds.indexOf(t)>-1};function g(e,t){var n,r,o=(0,i.isGroupCallByPeer)(e.peer)?e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator:e.peer;if(o)return e.participants[o];var l=e.participants[e.me];try{for(var s=(0,a.__values)(Object.values(e.participants)),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.peerId!==e.me&&u.wasConnected&&(l||(l=u),!t||x(u)))return u}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return null!=l?l:e.participants[e.me]}var A=[];function v(e,t){var n,r,i,o,l,c,u=e.participants,d=e.me,p=e.groupId,_=e.meGroup,m=e.adminPinnedParticipant,f=e.isOratorMode?e.oratorScrollFirstVisible:e.gridScrollFirstVisible,g=e.isOratorMode?e.oratorScrollNumberOfVisible:30,v=e.isOratorMode?30:60,h=[],E=[],C=[],S=[],y=[],T=[];try{for(var I=(0,a.__values)(Object.values(u)),b=I.next();!b.done;b=I.next()){var N=b.value;N.status&&((null===(o=null===(i=N.statusData)||void 0===i?void 0:i.hand)||void 0===o?void 0:o.state)?h.push(N):N.peerId===m?E.push(N):N.peerId===d?C.push(p&&_?(0,s.mergeGroupToParticipant)(_,u[d]):u[d]):(null===(l=N.mediaSettings)||void 0===l?void 0:l.isScreenSharingEnabled)?S.push(N):(null===(c=N.mediaSettings)||void 0===c?void 0:c.isVideoEnabled)?y.push(N):T.push(N))}}catch(e){n={error:e}}finally{try{b&&!b.done&&(r=I.return)&&r.call(I)}finally{if(n)throw n.error}}var w=(0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(h.sort((function(e,t){var n,a,r,i,o,l;return(null!==(r=null===(a=null===(n=e.statusData)||void 0===n?void 0:n.hand)||void 0===a?void 0:a.ts)&&void 0!==r?r:0)-(null!==(l=null===(o=null===(i=null==t?void 0:t.statusData)||void 0===i?void 0:i.hand)||void 0===o?void 0:o.ts)&&void 0!==l?l:0)})))),(0,a.__read)(E)),(0,a.__read)(C)),(0,a.__read)(S)),(0,a.__read)(y)),(0,a.__read)(T));if(w.length!==A.length)A=w;else for(var L=0;L<w.length;L++)if(w[L]!==A[L]){A=w;break}return t?A:A.slice(f<v?0:f-v,f+g+v>=A.length?A.length:f+g+v)}function h(e){var t=e.participants,n=0;for(var a in t)t.hasOwnProperty(a)&&y(e,t[a])&&n++;return n}function E(e){return S(e).filter((function(e){return!c(e.peerId)})).length}function C(e){return S(e).filter((function(e){return b(e)||N(e)})).length}function S(e){return Object.values(e.participants).filter((function(e){return e.status===o.ParticipantStatus.CONNECTED})).concat(e.participants[e.me])}function y(e,t){return t.peerId===e.me||t.status}function T(e,t){return e.adminPinnedParticipant===t.peerId}function I(e){return b(e)||N(e)}function b(e){return!!(null==e?void 0:e.roles)&&e.roles.some((function(e){return e===o.UserRole.ADMIN}))}function N(e){return!!(null==e?void 0:e.roles)&&e.roles.some((function(e){return e===o.UserRole.CREATOR}))}function w(e){return!!e.roles&&(N(e)||b(e))}function L(e){return!!e.roles&&(N(e)||b(e))}function P(e){var t,n,a,r=e.participants,i=0;for(var o in r)r.hasOwnProperty(o)&&y(e,r[o])&&(null===(a=null===(n=null===(t=r[o])||void 0===t?void 0:t.statusData)||void 0===n?void 0:n.hand)||void 0===a?void 0:a.state)&&i++;return i}function k(e,t){void 0===t&&(t=!1);var n=d(e);return n?(0,o.removeParticipant)(n,t):Promise.resolve()}function M(e,t){if(!t)return!1;var n=null==e?void 0:e.peerId;return!!n&&(n===t.ownerId||!!t.adminIds&&t.adminIds.includes(n))}function O(e){return b(e)||N(e)}function D(e){var t=e.permissions||{};return[t.audio,t.video,t.screenSharing].some((function(e){return e===r.MediaPermissionType.DENY}))}function R(e){return(0,i.isAuthedByGroupId)(e)?e.groupId:e.me}function B(e,t){return void 0===t&&(t=!1),t?e.stream:e.screenSharingStream?e.screenSharingStream:e.stream}function x(e){var t;return!!(null===(t=e.mediaSettings)||void 0===t?void 0:t.isVideoEnabled)||function(e){var t;return!!(null===(t=e.mediaSettings)||void 0===t?void 0:t.isScreenSharingEnabled)&&!!e.screenSharingStream}(e)}function U(e){var t;return null!==(t=e.participants[e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator||e.me])&&void 0!==t?t:{}}},757054:(e,t,n)=>{"use strict";n.d(t,{getParticipantLayout:()=>c,getParticipantsLayoutDiff:()=>u});var a,r=n(121255),i=n(298811),o=n(464380),l=n(697483),s=n(745284);!function(e){e.CONTAIN="cn",e.COVER="cv"}(a||(a={}));function c(e,t,n){return(0,s.isGroupCallByPeer)(e.peer)?e.uiMode===r.UIMode.COLLAPSED?function(e){var t=(0,i.isAnyoneWithVideo)(e),n=(0,l.getCallVisibleParticipant)(e,t),a=(0,l.getActiveParticipants)(e,!0),r=e.config,s=r.enableScreenTrack,c=r.enableProducerScreenTrack;return a.reduce((function(t,a){var r=a.peerId,i=a.mediaSettings;if(r===e.me)return t;if(s||c){var l=Boolean(null==i?void 0:i.isScreenSharingEnabled),u=Boolean(null==i?void 0:i.isVideoEnabled),d=r===(null==n?void 0:n.peerId);d&&l&&(t.set(v(r,o.MediaType.SCREEN),_(n,o.MediaType.SCREEN)),t.set(v(r,o.MediaType.CAMERA),p(a,o.MediaType.CAMERA))),d&&!l&&u&&(t.set(v(r,o.MediaType.CAMERA),_(n,o.MediaType.CAMERA)),t.set(v(r,o.MediaType.SCREEN),p(a,o.MediaType.SCREEN))),d&&(l||u)||(t.set(v(r,o.MediaType.SCREEN),p(a,o.MediaType.SCREEN)),t.set(v(r,o.MediaType.CAMERA),p(a,o.MediaType.CAMERA)))}else r===(null==n?void 0:n.peerId)&&A(i)?t.set(r,_(n)):t.set(r,p(a));return t}),new Map)}(e):e.isOratorMode?function(e,t,n){var a,i,s,c,u=e.adminPinnedParticipant||e.screenSharingPinnedParticipant||e.pinnedParticipant||e.orator||e.me,d=(0,l.getActiveParticipants)(e,!0),_=0,m=e.config,h=m.enableScreenTrack,E=m.enableProducerScreenTrack;if(h||E){var C=new Map,S=Boolean(null===(i=null===(a=e.participants[u])||void 0===a?void 0:a.mediaSettings)||void 0===i?void 0:i.isScreenSharingEnabled),y=Boolean(null===(c=null===(s=e.participants[u])||void 0===s?void 0:s.mediaSettings)||void 0===c?void 0:c.isVideoEnabled),T=e.uiMode===r.UIMode.FULLSCREEN,I=u!==e.me;return S&&I&&(_++,C.set(v(u,o.MediaType.SCREEN),f(e.participants[u],T,!1,t,n,o.MediaType.SCREEN))),S&&y&&I&&(_++,C.set(v(u,o.MediaType.CAMERA),g(e.participants[u],o.MediaType.CAMERA))),S&&!y&&I&&C.set(v(u,o.MediaType.CAMERA),p(e.participants[u],o.MediaType.CAMERA)),!S&&y&&I&&(_++,C.set(v(u,o.MediaType.CAMERA),f(e.participants[u],T,!1,t,n,o.MediaType.CAMERA)),C.set(v(u,o.MediaType.SCREEN),p(e.participants[u],o.MediaType.SCREEN))),S||y||!I||(C.set(v(u,o.MediaType.CAMERA),p(e.participants[u],o.MediaType.CAMERA)),C.set(v(u,o.MediaType.SCREEN),p(e.participants[u],o.MediaType.SCREEN))),d.reduce((function(t,n){var a=n.peerId,r=n.mediaSettings;if(a===e.me||a===u)return t;var i=Boolean(null==r?void 0:r.isScreenSharingEnabled),l=Boolean(null==r?void 0:r.isVideoEnabled),s=n.visible&&_<=e.config.videoSlotsCount;return s&&l&&(_++,t.set(v(a,o.MediaType.CAMERA),g(n,o.MediaType.CAMERA)),t.set(v(a,o.MediaType.SCREEN),p(n,o.MediaType.SCREEN))),s&&!l&&i&&(_++,t.set(v(a,o.MediaType.SCREEN),g(n,o.MediaType.SCREEN)),t.set(v(a,o.MediaType.CAMERA),p(n,o.MediaType.CAMERA))),s&&(l||i)||(t.set(v(a,o.MediaType.SCREEN),p(n,o.MediaType.SCREEN)),t.set(v(a,o.MediaType.CAMERA),p(n,o.MediaType.CAMERA))),t}),C),C}return d.reduce((function(a,i){var o=i.peerId,l=i.mediaSettings;if(o===e.me)return a;if(u===o&&A(l)){var s=f(i,e.uiMode===r.UIMode.FULLSCREEN,!1,t,n);a.set(i.peerId,s)}else A(l)&&i.visible&&_<=e.config.videoSlotsCount?(_++,a.set(i.peerId,g(i))):a.set(i.peerId,p(i));return a}),new Map)}(e,t,n):function(e,t,n){var a=e.uiMode===r.UIMode.FULLSCREEN,i=a?t:900,s=a?n:504,c=(0,l.getActiveParticipants)(e,!0),u=function(e,t,n){switch(n){case 1:return t;case 2:return Math.round(e/2);case 3:return Math.round(e/3);case 4:case 5:case 6:return Math.round(t/2);case 7:case 8:return Math.round(e/4);case 9:case 10:return Math.round(e/5);case 11:case 12:case 13:case 14:case 15:return Math.round(t/3);default:return Math.round(e/6)}}(i,s,c.length),d=u<200?1:2,_=0,f=e.config,g=f.enableScreenTrack,h=f.enableProducerScreenTrack;return c.reduce((function(t,n){if(!(0,l.getParticipantExternalId)(n)||n.peerId===e.me)return t;var a=n.peerId,r=n.mediaSettings;if(g||h){var i=Boolean(null==r?void 0:r.isScreenSharingEnabled),s=Boolean(null==r?void 0:r.isVideoEnabled),c=n.visible&&_<=e.config.videoSlotsCount;return c&&i&&(_++,t.set(v(a,o.MediaType.SCREEN),m(n,u,d,o.MediaType.SCREEN)),t.set(v(a,o.MediaType.CAMERA),p(n,o.MediaType.CAMERA))),c&&!i&&s&&(_++,t.set(v(a,o.MediaType.CAMERA),m(n,u,d,o.MediaType.CAMERA)),t.set(v(a,o.MediaType.SCREEN),p(n,o.MediaType.SCREEN))),c&&(i||s)||(t.set(v(a,o.MediaType.CAMERA),p(n,o.MediaType.CAMERA)),t.set(v(a,o.MediaType.SCREEN),p(n,o.MediaType.SCREEN))),t}return A(r)&&n.visible&&_<=e.config.videoSlotsCount?(t.set(n.peerId,m(n,u,d)),_++):t.set(n.peerId,p(n)),t}),new Map)}(e,t,n):function(e,t,n){var a=new Map,i=e.participants[e.peer];if(!i)return a;var l=e.config,s=l.enableScreenTrack,c=l.enableProducerScreenTrack,u=e.uiMode===r.UIMode.FULLSCREEN,d=e.uiMode===r.UIMode.COLLAPSED,_=i.peerId,m=i.mediaSettings;if(_===e.me)return a;if(s||c){var h=Boolean(null==m?void 0:m.isScreenSharingEnabled),E=Boolean(null==m?void 0:m.isVideoEnabled);if(h&&E&&(a.set(v(_,o.MediaType.SCREEN),f(i,u,d,t,n,o.MediaType.SCREEN)),a.set(v(_,o.MediaType.CAMERA),g(i,o.MediaType.CAMERA))),h!==E){var C=h?o.MediaType.SCREEN:o.MediaType.CAMERA,S=h?o.MediaType.CAMERA:o.MediaType.SCREEN;a.set(v(_,C),f(i,u,d,t,n,C)),a.set(v(_,S),p(i,S))}return h||E||(a.set(v(_,o.MediaType.SCREEN),p(i,o.MediaType.SCREEN)),a.set(v(_,o.MediaType.CAMERA),p(i,o.MediaType.CAMERA))),a}return a.set(i.peerId,A(m)?f(i,u,d,t,n):p(i)),a}(e,t,n)}function u(e,t){var n=[];return t.forEach((function(t,a){var r=e.get(a);(d(r)||d(t))&&(r&&function(e,t){var n=e,a=t;if(!0===n.stopStream&&!0===a.stopStream)return!0;if(!0===n.stopStream||!0===a.stopStream)return!1;var r=e,i=t;return r.fit===i.fit&&r.width===i.width&&r.height===i.height&&r.priority===i.priority}(r,t)||n.push(t))})),n}function d(e){return e&&!e.stopStream}function p(e,t){return void 0===t&&(t=null),{stopStream:!0,uid:(0,l.getParticipantExternalId)(e)||"",mediaType:t}}function _(e,t){void 0===t&&(t=null);var n=(0,l.getParticipantExternalId)(e);return{fit:a.CONTAIN,width:265,height:200,priority:2,uid:n||"",keyFrame:!1,mediaType:t}}function m(e,t,n,r){void 0===r&&(r=null);var i=(0,l.getParticipantExternalId)(e);return{fit:a.COVER,width:t,height:t,priority:n,uid:i||"",keyFrame:!1,mediaType:r}}function f(e,t,n,r,i,o){void 0===o&&(o=null);var s=(0,l.getParticipantExternalId)(e);return{fit:a.CONTAIN,width:t?r:n?265:900,height:t?i:n?200:504,priority:3,uid:s||"",keyFrame:!1,mediaType:o}}function g(e,t){void 0===t&&(t=null);var n=e.mediaSettings,r=(0,l.getParticipantExternalId)(e);return{fit:(null==n?void 0:n.isScreenSharingEnabled)?a.CONTAIN:a.COVER,width:140,height:140,priority:1,uid:r||"",keyFrame:!1,mediaType:t}}function A(e){var t;return null!==(t=!!(null==e?void 0:e.isVideoEnabled)||!!(null==e?void 0:e.isScreenSharingEnabled))&&void 0!==t&&t}function v(e,t){return void 0===t&&(t=null),t?e+":"+t:e}},421734:(e,t,n)=>{"use strict";n.d(t,{mapPrevVirtualBackgroundData:()=>s,sendVirtualBackgroundDisabled:()=>c});var a=n(121255),r=n(745284),i=n(223724),o=n(765446),l=n(614914),s=function(e,t,n){var r=null,i=e;return e===a.EVideoEffectType.BLUR?(r=o.CallActionEventType.VIRTUAL_BACKGROUND_DISABLED,i=a.VIRTUAL_BACKGROUND_BLUR_ID):"number"==typeof e&&(r=e>4e3?o.CallActionEventType.CUSTOM_VIRTUAL_BACKGROUND_DISABLED:o.CallActionEventType.VIRTUAL_BACKGROUND_DISABLED),{prevSendValue:i,disabledActionType:r,effectDuration:Math.round((t-n)/1e3)}},c=function(e){var t=i.effectStorage.getEffectTs();if(t){i.effectStorage.clearEffectTs();var n=i.effectStorage.getEffect(),a=Date.now(),o=e.callData.callId,c=e.peer,u=(0,r.isGroupCallByPeer)(c),d=s(n,a,t),p=d.disabledActionType,_=d.effectDuration,m=d.prevSendValue;null!==p&&l.callStats.logEvent({call_event_type:p,is_group_call:u,peer_id:c,session_id:o,background_duration:_,background_id:m})}}},768606:(e,t,n)=>{"use strict";n.d(t,{throttleAccumulateDispatchParticipant:()=>l,applyParticipantsBatch:()=>s});var a=n(570655),r=n(121255),i=n(464380),o={acc:{},timer:0,tasks:0};function l(e,t,n,i){!function(e,t,n,r,i){void 0===r&&(r=100);i.acc[e]=i.acc[e]&&"object"==typeof i.acc[e]?(0,a.__assign)((0,a.__assign)({},i.acc[e]),t):t,i.tasks++,i.timer&&clearTimeout(i.timer);i.timer=window.setTimeout((function(){i.tasks>0&&(n(i.acc),i.acc={},i.tasks=0),i.timer=0}),r)}(t,n,(function(t){e({type:r.UPDATE_PARTICIPANTS_BATCH,data:t})}),i,o)}function s(e,t){var n,r=(0,a.__assign)((0,a.__assign)({},e),{participants:(0,a.__assign)({},e.participants)});for(var o in t)if(t.hasOwnProperty(o))if(void 0===(null===(n=e.participants[o])||void 0===n?void 0:n.status)&&t[o].status===i.ParticipantStatus.HANGUP)delete r.participants[o];else{var l=e.participants[o]||{},s=t[o],c=s.statusData?(0,a.__assign)((0,a.__assign)({},l.statusData),s.statusData):l.statusData,u=l.wasConnected||s.status===i.ParticipantStatus.CONNECTED;r.participants[o]=(0,a.__assign)((0,a.__assign)((0,a.__assign)({peerId:o},e.participants[o]),t[o]),{statusData:c,wasConnected:u})}return r}},674543:(e,t,n)=>{"use strict";n.d(t,{canStopTranslation:()=>i});var a=n(697483),r=n(613335);function i(e){var t,n,i,o,l=(0,r.getMe)(e);return!(!(0,a.isAdmin)(l)&&!(0,a.isCreator)(l))||!!(null===(n=null===(t=e.translation)||void 0===t?void 0:t.host)||void 0===n?void 0:n.id)&&+(null===(o=null===(i=e.translation)||void 0===i?void 0:i.host)||void 0===o?void 0:o.id)===(0,a.getMeId)(e)}},613335:(e,t,n)=>{"use strict";n.d(t,{normalizeUser:()=>s,normalizeGroup:()=>c,createFriendsCache:()=>u,getMe:()=>d,mergeGroupToParticipant:()=>p,getExternalIdByUserId:()=>_,getMemberForUserStack:()=>m});var a=n(570655),r=n(298811),i=n(788822),o=n(697483),l=n(464380),s=function(e){var t=e.id,n=e.sex,a=e.first_name,l=e.last_name,s=e.screen_name,c=e.first_name_gen,u=e.name,d=e.photo_400,p=e.photo_200,_=e.can_call,m=e.online_info;return(0,o.isParticipantGroup)(+t)&&(a=(0,i.escape)(a)),{id:+t,peerId:+t,name:u||a+" "+l,firstName:a,shortName:(0,r.fetchUserShortName)(a,l,u),shortNameGen:(0,r.fetchUserShortName)(c,l,u),link:s&&"/"+s,sex:n,canCall:_,photo:d||p,onlineInfo:m||null}},c=function(e){var t=e.id,n=e.name,a=e.screen_name,r=e.photo_400,o=e.photo_200,l=e.photo_100;return{id:-t,peerId:-t,name:(0,i.escape)(n),firstName:"",lastName:"",shortName:"",shortNameGen:"",link:a&&"/"+a,photo:r||o||l,photo_100:l}};function u(e){return e.reduce((function(e,t){return e[t.id]=!0,e}),{})}function d(e){return e.participants[e.me]}function p(e,t){var n=(0,a.__assign)({},t);return e.photo&&(n.photo=e.photo),e.name&&(n.name=e.name),e.link&&(n.link=e.link),n}function _(e){var t=l.ExternalIdType.USER;return(0,o.isParticipantGroup)(e)&&(t=l.ExternalIdType.GROUP),{id:e.toString(),type:t}}function m(e){var t=e.name||"";return e.photo?{src:e.photo,alt:t,key:e.peerId}:{id:e.peerId,text:t.slice(0,1)}}},604233:(e,t,n)=>{"use strict";function a(e,t){return"/video"+e+"_"+t}function r(e){var t=document.createElement("video"),n=function(){t.classList.add("Video--visible"),t.removeEventListener("loadeddata",n)};return t.addEventListener("loadeddata",n),t.autoplay=!0,t.controls=!1,t.crossOrigin="anonymous",t.playsInline=!0,t.preload="metadata",t.srcObject=e,t.volume=0,t}n.d(t,{getShortVideoUrl:()=>a,createVideoTag:()=>r})},362621:(e,t,n)=>{"use strict";var a,r;n.d(t,{HistoryScreenSections:()=>a,HistoryScreenActionTypes:()=>r}),function(e){e.ALL="",e.MISS="missed",e.FRIENDS="friends",e.CURRENT="current"}(a||(a={})),function(e){e.DELETE_CALL="DELETE_CALL",e.SET_CURRENT_CALLS="SET_CURRENT_CALLS",e.SET_HISTORY_CALLS="SET_HISTORY_CALLS",e.SET_PROFILES="SET_PROFILES",e.SET_URLS="SET_URLS",e.ERROR="ERROR",e.SET_LOADING="SET_LOADING",e.SET_SHOW_CREATE_BUTTON="SET_SHOW_CREATE_BUTTON"}(r||(r={}))},366521:(e,t,n)=>{"use strict";n.d(t,{useHistoryScreenSelector:()=>r,useHistoryScreenDispatch:()=>i});var a=n(50533),r=a.useSelector,i=function(){return(0,a.useDispatch)()}},457532:(e,t,n)=>{"use strict";n.d(t,{BaseObjectsContext:()=>r,useBaseObjectsContext:()=>i});var a=n(667294),r=(0,a.createContext)({bridge:{},SDK:{}}),i=function(){return(0,a.useContext)(r)}},993663:(e,t,n)=>{"use strict";n.d(t,{useClosePopup:()=>o});var a=n(667294),r=n(50533),i=n(121255),o=function(){var e=(0,r.useDispatch)();return{onClose:(0,a.useCallback)((function(){e({type:i.TOGGLE_POPUP,data:null})}),[])}}},524384:(e,t,n)=>{"use strict";n.d(t,{useCurrentUserStream:()=>r});var a=n(50533),r=function(){var e=(0,a.useSelector)((function(e){return e.me})),t=(0,a.useSelector)((function(t){var n;return null===(n=t.participants[e])||void 0===n?void 0:n.stream})),n=(0,a.useSelector)((function(t){var n;return null===(n=t.participants[e])||void 0===n?void 0:n.mediaSettings}));return{userStream:t,isVideoEnabled:!!(null==n?void 0:n.isVideoEnabled)}}},410133:(e,t,n)=>{"use strict";n.d(t,{useHistoryScreenBridgeActions:()=>i});var a=n(667294),r=n(457532),i=function(){var e=(0,r.useBaseObjectsContext)().bridge;return{onCreateCallClick:(0,a.useCallback)((function(t){e.showCreateCallByLinkPopup(t)}),[e]),onJoin:(0,a.useCallback)((function(t,n,a){void 0===n&&(n=0),e.showStartCallModal(n,t,a)}),[e])}}},150364:(e,t,n)=>{"use strict";n.d(t,{useHistoryScreenContextActions:()=>p});var a=n(667294),r=n(121255),i=n(374327),o=n(171659),l=n(745284),s=n(366521),c=n(772071),u=n(457532),d=n(256480),p=function(){var e=(0,s.useHistoryScreenSelector)((function(e){return e.profiles})),t=(0,s.useHistoryScreenSelector)((function(e){return e.joinLinks})),n=(0,s.useHistoryScreenDispatch)(),p=(0,c.useNavigationContext)().navigateToConvo,_=(0,u.useBaseObjectsContext)().bridge;return{onHistoryAction:(0,a.useCallback)((function(a,s,c,u){var m;void 0===u&&(u=0);var f=(0,o.getHistoryCallPeerId)(a);if(s===i.HistoryCallMenuActionsEnum.AUDIO||s===i.HistoryCallMenuActionsEnum.VIDEO){if(_.isInActiveCall)return;var g=s===i.HistoryCallMenuActionsEnum.VIDEO;if((0,l.isGroupCallByPeer)(f))if(f in t)_.joinCallByLink(t[f],void 0,g,r.CallStatSource.HISTORY,u);else{var A=(0,o.getHistoryItemOwner)(a,e).chat;(null==A?void 0:A.call_in_progress)&&(null===(m=null==A?void 0:A.call_in_progress)||void 0===m?void 0:m.join_link)?_.joinCallByLink(A.call_in_progress.join_link,void 0,g,r.CallStatSource.HISTORY,u):_.call(f,g,void 0,r.CallStatSource.HISTORY,u)}else _.call(f,g,void 0,r.CallStatSource.HISTORY,u)}else s===i.HistoryCallMenuActionsEnum.MESSAGE?p(f):n((0,d.dispatchDeleteCall)(c))}),[t,e,_])}}},164904:(e,t,n)=>{"use strict";n.d(t,{useHistoryScreenCurrentCallsLoadActions:()=>l});var a=n(570655),r=n(667294),i=n(256480),o=n(366521),l=function(){var e=(0,o.useHistoryScreenSelector)((function(e){return e.profiles})),t=(0,o.useHistoryScreenSelector)((function(e){return e.currentCalls})),n=(0,o.useHistoryScreenDispatch)(),l=(0,a.__read)((0,r.useState)(!0),2),s=l[0],c=l[1];(0,r.useEffect)((function(){(0,i.loadCurrentCalls)(n).then((function(e){(0,i.updateProfilesAndUrls)(n,[e])})).finally((function(){c(!1)}))}),[]);var u=(0,r.useRef)(null);return(0,r.useEffect)((function(){if(!s)return null===u.current&&(u.current=setInterval((function(){(0,i.loadCurrentCalls)(n).then((function(e){(0,i.updateProfilesAndUrls)(n,[e])}))}),3e4)),function(){clearInterval(u.current)}}),[s]),{currentCallsBlockLoading:s,currentCalls:t,profiles:e}}},409364:(e,t,n)=>{"use strict";n.d(t,{useHistoryScreenLoadActions:()=>c});var a=n(570655),r=n(667294),i=n(256480),o=n(988121),l=n(50533),s=n(366521),c=function(e){void 0===e&&(e="all");var t=(0,s.useHistoryScreenSelector)((function(e){return e.historyCalls})),n=(0,l.useDispatch)(),c=(0,o.useHistoryScreenLoading)(),u=c.setLoading,d=c.loading,p=(0,a.__read)((0,r.useState)(!1),2),_=p[0],m=p[1],f=(0,a.__read)((0,r.useState)(0),2),g=f[0],A=f[1],v=(0,a.__read)((0,r.useState)(!1),2),h=v[0],E=v[1];(0,r.useEffect)((function(){u(!0),(0,i.loadHistoryCalls)(n,25,g,0,e).then((function(e){var t,n;return m(null!==(t=e.has_more)&&void 0!==t&&t),A(null!==(n=e.next_from)&&void 0!==n?n:0),e})).then((function(e){(0,i.updateProfilesAndUrls)(n,[e]).then((function(e){E(!e)}))})).finally((function(){u(!1)}))}),[]);var C=function(t,a,r,o){return void 0===r&&(r=[]),void 0===o&&(o=!1),(0,i.loadHistoryCalls)(n,25,t,a,e,r,o).then((function(e){var t,n;return m(null!==(t=e.has_more)&&void 0!==t&&t),A(null!==(n=e.next_from)&&void 0!==n?n:0),e})).then((function(e){return(0,i.updateProfilesAndUrls)(n,[e])}))};return{onShowMoreHistory:function(){return C(g,0,t)},loadHistory:C,loading:d,showMoreHistory:_,showLanding:h,setLoading:u}}},988121:(e,t,n)=>{"use strict";n.d(t,{useHistoryScreenLoading:()=>o});var a=n(667294),r=n(366521),i=n(256480),o=function(){var e=(0,r.useHistoryScreenSelector)((function(e){return e.loading})),t=(0,r.useHistoryScreenDispatch)();return{loading:e,setLoading:(0,a.useCallback)((function(e){t((0,i.dispatchSetLoading)(e))}),[])}}},410326:(e,t,n)=>{"use strict";n.d(t,{useHistoryScreenLocation:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,r.useMemo)((function(){return{urlSection:new URLSearchParams(e.search).get("section")||""}}),[e]).urlSection,n=(0,a.__read)((0,r.useState)(t),2);return{section:n[0],setSection:n[1]}}},569422:(e,t,n)=>{"use strict";n.d(t,{useIsAnonymous:()=>i});var a=n(50533),r=n(697483),i=function(){var e=(0,a.useSelector)((function(e){return e.me}));return{isAnonymous:(0,r.isParticipantAnonym)(e)}}},190103:(e,t,n)=>{"use strict";n.d(t,{useIsMounted:()=>r});var a=n(667294),r=function(){var e=(0,a.useRef)(!0),t=(0,a.useCallback)((function(){return e.current}),[]);return(0,a.useEffect)((function(){return function(){e.current=!1}}),[]),t}},275385:(e,t,n)=>{"use strict";n.d(t,{useLang:()=>i});var a=n(667294),r=n(662208),i=function(){return(0,a.useContext)(r.LangContext)}},664327:(e,t,n)=>{"use strict";n.d(t,{useLangContext:()=>i});var a=n(667294),r=n(662208),i=function(){return(0,a.useContext)(r.LangContext)}},772071:(e,t,n)=>{"use strict";n.d(t,{NavigationContext:()=>r,useNavigationContext:()=>i});var a=n(667294),r=(0,a.createContext)({navigateToConvo:function(e){},navigateToProfile:function(e,t){}}),i=function(){return(0,a.useContext)(r)}},474803:(e,t,n)=>{"use strict";n.d(t,{usePriorities:()=>l});var a=n(570655),r=n(667294),i=n(757054),o=n(121255),l=function(e,t){var n=(0,a.__read)((0,r.useState)([0,0]),2),l=(0,a.__read)(n[0],2),s=l[0],c=l[1],u=n[1],d=(0,r.useRef)(new Map);(0,r.useEffect)((function(){var e=function(){return u([window.innerWidth,window.innerHeight])};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((function(){if(t.mode===o.Mode.CALL){var n=(0,i.getParticipantLayout)(t,s,c),a=(0,i.getParticipantsLayoutDiff)(d.current,n);a.length>0&&(d.current=n,e.updateDisplayLayout(a))}else d.current=new Map}),[s,c,t.participants,t.mode,t.uiMode,t.isOratorMode,t.orator,t.pinnedParticipant,t.adminPinnedParticipant,t.screenSharingPinnedParticipant,t.translation])}},637534:(e,t,n)=>{"use strict";n.d(t,{useSendStatsData:()=>c,ECallActionEventType:()=>s.CallActionEventType});var a=n(570655),r=n(667294),i=n(50533),o=n(745284),l=n(614914),s=n(765446),c=function(){var e=(0,i.useSelector)((function(e){return e.callData.callId})),t=(0,i.useSelector)((function(e){return e.peer})),n=(0,r.useMemo)((function(){return(0,o.isGroupCallByPeer)(t)}),[t]);return{sendStatsData:(0,r.useCallback)((function(r,i){void 0===i&&(i={}),l.callStats.logEvent((0,a.__assign)({call_event_type:r,session_id:e,peer_id:t,is_group_call:n},i))}),[e,t,n])}}},70049:(e,t,n)=>{"use strict";n.d(t,{useSendStatsDataVirtualBackground:()=>l});var a=n(667294),r=n(637534),i=n(421734),o=n(223724),l=function(){var e=(0,r.useSendStatsData)().sendStatsData,t=(0,a.useCallback)((function(t,n,a){var r=(0,i.mapPrevVirtualBackgroundData)(t,n,a),o=r.disabledActionType,l=r.prevSendValue,s=r.effectDuration;null!==o&&e(o,{background_id:l,background_duration:s})}),[e]),n=(0,a.useCallback)((function(n,a){var i,l=Date.now(),s=o.effectStorage.getEffectTs();s&&t(a,l,s),i=n>4e3?r.ECallActionEventType.CUSTOM_VIRTUAL_BACKGROUND_SELECTED:r.ECallActionEventType.VIRTUAL_BACKGROUND_SELECTED,e(i,{background_id:n}),o.effectStorage.saveEffectTs(l)}),[e,t]),l=(0,a.useCallback)((function(e){var n=o.effectStorage.getEffectTs();if(n){var a=Date.now();t(e,a,n),o.effectStorage.clearEffectTs()}}),[t]),s=(0,a.useCallback)((function(t){e(r.ECallActionEventType.CUSTOM_VIRTUAL_BACKGROUND_ADDED,{background_id:t})}),[e]);return{sendVirtualBackgroundSelected:n,sendVirtualBackgroundDisabled:l,sendVirtualBackgroundDeleted:(0,a.useCallback)((function(t){e(r.ECallActionEventType.CUSTOM_VIRTUAL_BACKGROUND_DELETED,{background_id:t})}),[e]),sendVirtualBackgroundAdded:s}}},915622:(e,t,n)=>{"use strict";n.d(t,{useUserBackgrounds:()=>u});var a=n(570655),r=n(667294),i=n(50533),o=n(329538),l=n(121255),s=n(70049),c=n(569422),u=function(e){var t=e.photos,n=e.onSuccessPhotoUpload,u=(0,i.useDispatch)(),p=(0,s.useSendStatsDataVirtualBackground)(),_=p.sendVirtualBackgroundAdded,m=p.sendVirtualBackgroundDeleted,f=(0,c.useIsAnonymous)().isAnonymous,g=(0,r.useRef)([]),A=(0,a.__read)((0,r.useState)(!1),2),v=A[0],h=A[1];(0,r.useEffect)((function(){t.length||f||(0,o.photosGetAllImages)().then((function(e){u({type:l.VB_SET_USER_PHOTOS,photos:d(e.items||[])})}))}),[]);var E=(0,r.useCallback)((function(e){var n=t.find((function(t){return t.id===e}));n&&(g.current.push(n),u({type:l.VB_REMOVE_USER_PHOTO,photoId:e}))}),[t]),C=(0,r.useCallback)((function(){var e=g.current;return g.current=[],function(e,t){var n=e.map((function(e){return(0,o.photosDelete)({photo_id:e.id})}));return Promise.allSettled(n).then((function(n){n.forEach((function(n,a){"fulfilled"===n.status&&t(e[a].id)}))}))}(e,m)}),[m]),S=(0,r.useCallback)((function(){var e=g.current;g.current=[];var n=t.concat(e);u({type:l.VB_SET_USER_PHOTOS,photos:d(n)})}),[t]),y=(0,r.useCallback)((function(e){return h(!0),(0,o.photosSaveBackgroundPhoto)(e).then((function(e){var t=e[0];if(!t)throw new Error("Something wrong with uploaded photo");return u({type:l.VB_ADD_USER_PHOTO,photo:t}),n(t),_(t.id),t})).finally((function(){h(!1)}))}),[n,_]);return{photos:t,onAddBackground:y,onDeleteBackground:E,onSaveSettings:C,onCancelSettings:S,loadingUpload:v}};function d(e){return e.sort((function(e,t){return e.date<t.date?1:-1}))}},551974:(e,t,n)=>{"use strict";n.d(t,{useUserMediaStream:()=>l});var a=n(570655),r=n(667294),i=n(190103),o=function(e){e.getTracks().forEach((function(e){return e.stop()}))},l=function(e){var t=(0,a.__read)((0,r.useState)(null),2),n=t[0],l=t[1],s=(0,a.__read)((0,r.useState)(!1),2),c=s[0],u=s[1],d=(0,r.useRef)(!1),p=(0,i.useIsMounted)(),_=(0,r.useRef)(0),m=(0,r.useCallback)((function(){if(!d.current){u(!1),d.current=!0;var t=function(n){return navigator.mediaDevices.getUserMedia(n).then((function(e){p()?l(e):o(e),d.current=!1})).catch((function(n){++_.current<e.length?t(e[_.current]):(l(null),u(n),d.current=!1)}))};t(e[_.current])}}),[e]);return(0,r.useEffect)((function(){m();var e=function(){_.current=0,m()};return navigator.mediaDevices.addEventListener("devicechange",e),function(){navigator.mediaDevices.removeEventListener("devicechange",e)}}),[m]),(0,r.useEffect)((function(){return function(){n&&o(n)}}),[n]),{userStream:n,error:c,updateUserMediaStream:m}}},32491:(e,t,n)=>{"use strict";n.d(t,{useVideoOptions:()=>c,EVideoOptionType:()=>o.EVideoOptionType});var a=n(570655),r=n(667294),i=n(50533),o=n(121255),l=n(223724),s=n(659397),c=function(){var e=(0,i.useSelector)((function(e){return e.virtualBackgroundSettings.videoOptions})),t=(0,i.useDispatch)(),n=(0,a.__read)((0,r.useState)(l.videoOptionsStorage.getOptions),2),c=n[0],u=n[1],d=(0,r.useCallback)((function(){u(l.videoOptionsStorage.getOptions())}),[]),p=(0,r.useCallback)((function(){l.videoOptionsStorage.saveOptions(c),t({type:o.VB_SET_VIDEO_OPTIONS,videoOptions:c})}),[c]),_=(0,r.useCallback)((function(e,t){u((function(n){var r;return(0,a.__assign)((0,a.__assign)({},n),((r={})[e]=t,r))}))}),[]);return(0,r.useEffect)((function(){(0,s.isEqual)(e,c)||t({type:o.VB_SET_VIDEO_OPTIONS,videoOptions:c})}),[]),{videoOptions:c,storedVideoOptions:e,setVideoOptions:u,onRestoreSettings:d,onSaveSettings:p,onChangeVideoOption:_}}},945873:(e,t,n)=>{"use strict";n.d(t,{AddImageIcon:()=>r});var a=n(667294),r=function(){return a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 11V2C11 1.44772 11.4477 1 12 1C12.5523 1 13 1.44772 13 2V11H22C22.5523 11 23 11.4477 23 12C23 12.5523 22.5523 13 22 13H13V22C13 22.5523 12.5523 23 12 23C11.4477 23 11 22.5523 11 22V13H2C1.44772 13 1 12.5523 1 12C1 11.4477 1.44772 11 2 11H11Z",fill:"#8FADC8"}))}},865203:(e,t,n)=>{"use strict";n.d(t,{AngleIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"12",height:"13",viewBox:"0 0 12 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.21967 2.96967C4.51256 2.67678 4.98744 2.67678 5.28033 2.96967L8.28033 5.96967C8.57322 6.26256 8.57322 6.73744 8.28033 7.03033L5.28033 10.0303C4.98744 10.3232 4.51256 10.3232 4.21967 10.0303C3.92678 9.73744 3.92678 9.26256 4.21967 8.96967L6.68934 6.5L4.21967 4.03033C3.92678 3.73744 3.92678 3.26256 4.21967 2.96967Z",fill:"white",fillOpacity:"0.64"}))}},594504:(e,t,n)=>{"use strict";n.d(t,{AnonymousIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"28",height:"28",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#paint0_linear)"}),r.createElement("path",{d:"M6.746 14.391c-.165-1.078-.204-1.206-.493-1.614-.363-.513-.415-1.1.38-1.255 2.042-.397 4.252-.1 6.265.268a5.546 5.546 0 002.204 0c2.013-.368 4.223-.665 6.264-.268.796.154.744.742.38 1.255-.288.408-.327.536-.492 1.614-.248 1.617-1.607 2.275-3.29 2.276-1.85 0-2.465-1.055-3.04-2.494-.557-1.398-1.29-1.398-1.849 0-.574 1.439-1.19 2.494-3.038 2.494-1.684 0-3.043-.66-3.29-2.276z",fill:"#fff"}),r.createElement("defs",null,r.createElement("linearGradient",{id:"paint0_linear",x1:"0",y1:"0",x2:"28.733",y2:".773",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#99A2AD"}),r.createElement("stop",{offset:"1",stopColor:"#99A2AD"}))))}},695265:(e,t,n)=>{"use strict";n.d(t,{AppleIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:16,height:16,fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M9.973 4.143c-1.02 0-1.85.595-2.381.595-.567 0-1.309-.561-2.199-.561C3.71 4.177 2 5.517 2 8.04c0 1.575.628 3.235 1.413 4.308C4.085 13.254 4.67 14 5.515 14c.838 0 1.204-.536 2.242-.536 1.056 0 1.291.52 2.216.52.916 0 1.527-.805 2.102-1.602A6.798 6.798 0 0 0 13 10.538c-.052-.016-1.806-.704-1.806-2.631 0-1.668 1.379-2.414 1.457-2.473-.907-1.257-2.294-1.29-2.678-1.29Zm-.48-1.064c.419-.486.716-1.149.716-1.82 0-.091-.01-.184-.027-.259-.68.025-1.5.436-1.989.989-.383.42-.741 1.09-.741 1.76 0 .1.017.201.026.235.044.008.114.017.183.017.611 0 1.379-.394 1.832-.922Z",fill:"#5181B8"}))}},220583:(e,t,n)=>{"use strict";n.d(t,{BorderCornerIcon:()=>r});var a=n(667294),r=function(e){var t=e.className;return a.createElement("svg",{className:t,width:"4",height:"4",viewBox:"0 0 4 4",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 4V0H0C2.20898 0 4 1.79077 4 4Z",fill:"white"}))}},781313:(e,t,n)=>{"use strict";n.d(t,{CallLogoIconEn:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:134,height:28,fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("g",{clipPath:"url(#a)"},r.createElement("g",{clipPath:"url(#b)"},r.createElement("path",{d:"M18.293 0C26.133 0 28 1.867 28 9.707v8.586C28 26.133 26.133 28 18.293 28H9.707C1.867 28 0 26.133 0 18.293V9.707C0 1.867 1.867 0 9.707 0h8.586Z",fill:"#07F"}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M27.873 21.307A16.203 16.203 0 0 1 21.75 22.5c-3.256 0-6.29-.958-8.832-2.607a.633.633 0 0 0-.596-.049c-1.508.654-3.198 1-5.085 1.152-.535.043-.896-.524-.667-1.01.765-1.62 1.265-3.084 1.569-4.542a.6.6 0 0 0-.086-.446A16.174 16.174 0 0 1 5.5 6.25c0-2.166.424-4.233 1.193-6.123C7.583.038 8.583 0 9.707 0h8.586C26.133 0 28 1.867 28 9.707v8.586c0 1.123-.038 2.124-.127 3.014Z",fill:"#77BEFF"}),r.createElement("path",{d:"M27.272 24.173c.297-.796.49-1.743.601-2.866A16.203 16.203 0 0 1 21.75 22.5c-3.256 0-6.29-.958-8.832-2.607a.633.633 0 0 0-.596-.049c-1.035.449-2.157.753-3.37.948l-.025.005a22.897 22.897 0 0 1-1.69.2c-.535.042-.896-.525-.667-1.011a25.164 25.164 0 0 0 .647-1.49l.003-.008c.412-1.05.711-2.048.919-3.044a.6.6 0 0 0-.086-.446A16.174 16.174 0 0 1 5.5 6.25c0-2.166.424-4.233 1.193-6.123-1.123.112-2.07.304-2.866.6A18.746 18.746 0 0 0 3 6.25c0 3.422.919 6.635 2.524 9.4-.265 1.019-.654 2.081-1.214 3.268-.973 2.059.497 4.782 3.128 4.57 1.72-.139 3.384-.432 4.954-.987A18.675 18.675 0 0 0 21.75 25c1.919 0 3.774-.29 5.522-.827Z",fill:"#fff"}),r.createElement("path",{d:"M14.701 5.32c-.37-.74-1.027-1.406-1.838-1.31a1.86 1.86 0 0 0-1.128.548c-.817.817-.936 2.238-.442 3.864.494 1.626 1.598 3.45 3.216 5.07 1.618 1.617 3.443 2.721 5.069 3.215 1.626.494 3.047.375 3.864-.442a1.86 1.86 0 0 0 .549-1.128c.095-.811-.57-1.468-1.311-1.838l-.824-.412a2.085 2.085 0 0 0-2.728.806.228.228 0 0 1-.323.074 16.542 16.542 0 0 1-2.51-2.062 16.535 16.535 0 0 1-2.062-2.51.228.228 0 0 1 .074-.323 2.085 2.085 0 0 0 .806-2.728L14.7 5.32Z",fill:"#fff"})),r.createElement("g",{clipPath:"url(#c)",fill:"#000"},r.createElement("path",{d:"M38.969 21.08h3.492l5.128-14.067h-2.535l-4.11 11.593h-.4l-3.97-11.593H34l4.969 14.068ZM60.702 21.08l-6.465-7.283 5.966-6.784H57.25L52.26 12.74h-.578V7.013h-2.395V21.08h2.395v-6.027h.598l5.268 6.027h3.153ZM72.623 21.28c2.893 0 5.348-1.616 6.345-4.17l-2.374-.4c-.699 1.497-2.155 2.375-3.891 2.375-2.674 0-4.51-2.055-4.51-5.048 0-2.973 1.856-5.029 4.51-5.029 1.716 0 3.112.838 3.791 2.275l2.374-.399c-.957-2.514-3.332-4.07-6.245-4.07-4.03 0-6.924 3.012-6.924 7.223 0 4.23 2.893 7.243 6.924 7.243ZM85.004 10.505c-2.016 0-3.791 1.037-4.31 2.833l2.115.36c.32-.639 1.037-1.238 2.075-1.238 1.257 0 1.995.898 2.095 2.255h-2.235c-3.053 0-4.57 1.337-4.57 3.253 0 1.935 1.497 3.312 3.612 3.312 1.697 0 2.834-.978 3.333-1.836l.479 1.637h1.696v-5.827c0-3.013-1.636-4.75-4.29-4.75Zm-.679 8.84c-1.117 0-1.835-.58-1.835-1.477 0-.798.578-1.357 2.334-1.357H87c0 1.696-1.077 2.834-2.674 2.834ZM91.883 21.08h2.295V7.014h-2.295V21.08ZM96.969 21.08h2.295V7.014h-2.295V21.08ZM105.687 21.28c2.973 0 4.33-1.477 4.33-3.153 0-2.055-1.916-2.674-3.552-3.132-1.217-.34-2.275-.659-2.275-1.497 0-.678.758-1.038 1.616-1.038.958 0 1.676.5 2.056 1.357l2.135-.359c-.579-1.816-2.155-2.953-4.211-2.953-2.115 0-3.971.978-3.971 3.053 0 2.175 1.996 2.753 3.652 3.212 1.177.32 2.195.619 2.195 1.417 0 .818-.878 1.137-1.796 1.137-1.177 0-2.055-.558-2.394-1.536l-2.215.38c.439 1.915 2.075 3.112 4.43 3.112Z"}))),r.createElement("defs",null,r.createElement("clipPath",{id:"a"},r.createElement("path",{fill:"#fff",d:"M0 0h134v28H0z"})),r.createElement("clipPath",{id:"b"},r.createElement("path",{fill:"#fff",d:"M0 0h28v28H0z"})),r.createElement("clipPath",{id:"c"},r.createElement("path",{fill:"#fff",transform:"translate(34)",d:"M0 0h100v28H0z"}))))}},213146:(e,t,n)=>{"use strict";n.d(t,{CallLogoIconRu:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:134,height:28,fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("g",{clipPath:"url(#a)"},r.createElement("path",{d:"M18.293 0C26.133 0 28 1.867 28 9.707v8.586C28 26.133 26.133 28 18.293 28H9.707C1.867 28 0 26.133 0 18.293V9.707C0 1.867 1.867 0 9.707 0h8.586Z",fill:"#07F"}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M27.873 21.307A16.203 16.203 0 0 1 21.75 22.5c-3.256 0-6.29-.958-8.832-2.607a.633.633 0 0 0-.596-.049c-1.508.654-3.198 1-5.085 1.152-.535.043-.896-.524-.667-1.01.765-1.62 1.265-3.084 1.569-4.542a.6.6 0 0 0-.086-.446A16.174 16.174 0 0 1 5.5 6.25c0-2.166.424-4.233 1.193-6.123C7.583.038 8.583 0 9.707 0h8.586C26.133 0 28 1.867 28 9.707v8.586c0 1.123-.038 2.124-.127 3.014Z",fill:"#77BEFF"}),r.createElement("path",{d:"M27.272 24.173c.297-.796.49-1.743.601-2.866A16.205 16.205 0 0 1 21.75 22.5c-3.256 0-6.29-.958-8.832-2.607a.633.633 0 0 0-.596-.049c-1.035.449-2.157.753-3.37.948l-.025.005a22.79 22.79 0 0 1-1.69.2c-.535.042-.896-.525-.667-1.011a25.215 25.215 0 0 0 .647-1.49l.003-.008a18.66 18.66 0 0 0 .919-3.044.6.6 0 0 0-.086-.446A16.174 16.174 0 0 1 5.5 6.25c0-2.166.424-4.233 1.193-6.123-1.123.112-2.07.304-2.866.6A18.746 18.746 0 0 0 3 6.25c0 3.422.919 6.635 2.524 9.4-.265 1.019-.654 2.081-1.214 3.268-.973 2.059.497 4.782 3.128 4.57 1.72-.139 3.384-.432 4.954-.987A18.675 18.675 0 0 0 21.75 25c1.919 0 3.774-.29 5.522-.827Z",fill:"#fff"}),r.createElement("path",{d:"M14.701 5.32c-.37-.74-1.027-1.406-1.838-1.31a1.86 1.86 0 0 0-1.128.548c-.817.817-.936 2.238-.442 3.864.494 1.626 1.598 3.45 3.216 5.07 1.618 1.617 3.443 2.721 5.069 3.215 1.626.494 3.047.375 3.864-.442a1.86 1.86 0 0 0 .549-1.128c.095-.811-.57-1.468-1.311-1.838l-.824-.412a2.085 2.085 0 0 0-2.728.806.228.228 0 0 1-.323.074 16.542 16.542 0 0 1-2.51-2.062 16.538 16.538 0 0 1-2.062-2.51.228.228 0 0 1 .074-.323 2.085 2.085 0 0 0 .806-2.728L14.7 5.32Z",fill:"#fff"})),r.createElement("g",{clipPath:"url(#b)",fill:"#000"},r.createElement("path",{d:"M38.969 21.08h3.492l5.128-14.067h-2.535l-4.11 11.593h-.4l-3.97-11.593H34l4.969 14.068ZM60.702 21.08l-6.465-7.283 5.966-6.784H57.25L52.26 12.74h-.578V7.013h-2.395v14.068h2.395v-6.026h.598l5.268 6.026h3.153ZM73.52 13.797c1.258-.399 2.156-1.476 2.156-3.053 0-2.294-2.035-3.93-4.909-3.93-2.514 0-4.39 1.257-5.228 3.631l2.255.38c.519-1.098 1.517-1.817 2.913-1.817 1.457 0 2.554.779 2.554 1.916 0 1.157-1.137 1.936-2.733 1.936h-1.776v2.095h1.776c2.075 0 2.973.878 2.973 2.015 0 1.297-1.058 2.115-2.814 2.115-1.636 0-2.554-.698-3.192-2.015l-2.295.379c.579 2.275 2.654 3.831 5.507 3.831 3.313 0 5.248-1.856 5.248-4.21 0-1.756-1.137-2.834-2.434-3.273ZM85.286 15.693c.898-.419 1.477-1.117 1.477-2.195 0-1.636-1.497-2.793-3.652-2.793h-4.968V21.08h5.188c2.235 0 3.791-1.218 3.791-2.874a2.605 2.605 0 0 0-1.836-2.514ZM80.437 12.6h2.674c.798 0 1.357.479 1.357 1.138 0 .658-.559 1.117-1.357 1.117h-2.674V12.6Zm2.894 6.585h-2.894v-2.534h2.894c.898 0 1.496.519 1.496 1.277 0 .758-.598 1.257-1.496 1.257ZM94.16 21.28c3.252 0 5.547-2.235 5.547-5.387 0-3.153-2.295-5.388-5.547-5.388-3.253 0-5.548 2.235-5.548 5.388 0 3.152 2.295 5.387 5.548 5.387Zm0-2.095c-1.876 0-3.153-1.337-3.153-3.292 0-1.956 1.277-3.293 3.153-3.293 1.875 0 3.152 1.337 3.152 3.293 0 1.955-1.277 3.292-3.152 3.292ZM108.646 10.704v4.091h-4.649v-4.09h-2.295V21.08h2.295v-4.19h4.649v4.19h2.295V10.704h-2.295ZM119.975 21.08h3.013l-4.769-5.387 4.37-4.989h-2.734l-3.472 4.031h-.558v-4.03h-2.295V21.08h2.295v-4.13h.558l3.592 4.13ZM124.286 21.08h3.253l3.871-7.702h.319v7.703h2.195V10.704h-3.252l-3.871 7.703h-.32v-7.703h-2.195v10.377Z"})),r.createElement("defs",null,r.createElement("clipPath",{id:"a"},r.createElement("path",{fill:"#fff",d:"M0 0h28v28H0z"})),r.createElement("clipPath",{id:"b"},r.createElement("path",{fill:"#fff",transform:"translate(34)",d:"M0 0h100v28H0z"}))))}},923522:(e,t,n)=>{"use strict";n.d(t,{CancelIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"20",height:"20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.72 4.72a.75.75 0 011.06 0L10 8.94l4.22-4.22a.75.75 0 111.06 1.06L11.06 10l4.22 4.22a.75.75 0 11-1.06 1.06L10 11.06l-4.22 4.22a.75.75 0 01-1.06-1.06L8.94 10 4.72 5.78a.75.75 0 010-1.06z",fill:"#99A2AD"}))}},968125:(e,t,n)=>{"use strict";n.d(t,{ChainIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.49 4.293a4.402 4.402 0 116.225 6.225l-1.072 1.072a.9.9 0 01-1.273-1.273l1.071-1.072a2.601 2.601 0 10-3.678-3.678l-3.537 3.537a2.601 2.601 0 000 3.678.9.9 0 01-1.274 1.273 4.402 4.402 0 010-6.225l3.537-3.537zm-.708 5.66a.9.9 0 011.273 0 4.402 4.402 0 010 6.225l-3.537 3.537a4.402 4.402 0 11-6.225-6.226l1.122-1.121a.9.9 0 111.273 1.273l-1.121 1.122a2.601 2.601 0 103.678 3.678l3.537-3.537a2.601 2.601 0 000-3.678.9.9 0 010-1.274z",fill:"#fff"}))}},460851:(e,t,n)=>{"use strict";n.d(t,{CreateCallAnonymousIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#CreateCallAnonymousIconGradient)"}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m9.52 10.906.503-2.328A2 2 0 0 1 11.978 7h4.044a2 2 0 0 1 1.955 1.578l.503 2.328a.916.916 0 0 1 .015.094H20a1 1 0 1 1 0 2H8a1 1 0 1 1 0-2h1.505a.902.902 0 0 1 .015-.094Zm3.447 7a2.5 2.5 0 1 1-.217-1.497 4.984 4.984 0 0 1 2.5 0 2.5 2.5 0 1 1-.217 1.498 3.488 3.488 0 0 0-2.066 0Z",fill:"#fff"}),r.createElement("defs",null,r.createElement("linearGradient",{id:"CreateCallAnonymousIconGradient",x1:"0",y1:"0",x2:"28.733",y2:".773",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#99A2AD"}),r.createElement("stop",{offset:"1",stopColor:"#99A2AD"}))))}},797847:(e,t,n)=>{"use strict";n.d(t,{CreateCallIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("rect",{width:"28",height:"28",rx:"14",fill:"url(#CreateCallIconGradientA)"}),r.createElement("rect",{x:".25",y:".25",width:"27.5",height:"27.5",rx:"13.75",stroke:"#000",strokeOpacity:".08",strokeWidth:".5",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("rect",{width:"28",height:"28",rx:"14",fill:"url(#CreateCallIconGradientB)"}),r.createElement("rect",{x:".25",y:".25",width:"27.5",height:"27.5",rx:"13.75",stroke:"#000",strokeOpacity:".08",strokeWidth:".5"}),r.createElement("path",{d:"M9.622 9.405c-1.704 1.875-.794 4.775 1.708 7.288 2.449 2.46 5.48 3.38 7.274 1.71.981-.912.836-2.53-.376-3.61-1.096-.931-2.819-1.092-3.917-.062-.37-.311-.684-.679-1.023-1.023.949-.995.946-2.727-.032-3.896-1.1-1.313-2.767-1.36-3.634-.407Zm2.83 1.08c.617.738.7 1.914-.029 2.602-.367.33-.725.525.602 1.874 1.432 1.456 1.61.945 1.983.555.586-.589 1.733-.643 2.522.06.872.777.778 1.671.36 2.06-1.295 1.204-3.773.37-5.817-1.682-2.043-2.053-2.95-4.44-1.675-5.843.296-.326 1.224-.617 2.054.374ZM17.792 8.167c.29 0 .525.235.525.525v.991h.991a.525.525 0 1 1 0 1.05h-.991v.992a.525.525 0 0 1-1.05 0v-.992h-.992a.525.525 0 1 1 0-1.05h.992v-.991c0-.29.235-.525.525-.525Z",fill:"#fff"}),r.createElement("defs",null,r.createElement("linearGradient",{id:"CreateCallIconGradientA",x1:"-14",y1:"14",x2:"14",y2:"42",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#FFB73D"}),r.createElement("stop",{offset:"1",stopColor:"#FFA000"})),r.createElement("linearGradient",{id:"CreateCallIconGradientB",x1:"-14",y1:"14",x2:"14",y2:"42",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#70B2FF"}),r.createElement("stop",{offset:"1",stopColor:"#5C9CE6"}))))}},625920:(e,t,n)=>{"use strict";n.d(t,{CreateCallUserIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#CreateCallUserIconGradient)"}),r.createElement("path",{d:"M17.25 10.25a3.25 3.25 0 1 0-6.5 0 3.25 3.25 0 1 0 6.5 0ZM7.5 18.462v.7c0 .463.375.838.838.838h11.325a.838.838 0 0 0 .837-.837v-.701C20.5 15.769 16.17 15 14 15s-6.5.77-6.5 3.462Z",fill:"#fff"}),r.createElement("defs",null,r.createElement("linearGradient",{id:"CreateCallUserIconGradient",x1:"0",y1:"0",x2:"28.733",y2:".773",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#70B2FF"}),r.createElement("stop",{offset:"1",stopColor:"#5C9CE6"}))))}},599318:(e,t,n)=>{"use strict";n.d(t,{CreateCallWaitingHallIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#CreateCallWaitingHallIconGradient)"}),r.createElement("path",{d:"M13.85 6.85h1.072c1.529 0 2.095.127 2.657.428.493.263.88.65 1.143 1.143.3.562.428 1.129.428 2.657v5.842c0 1.528-.127 2.098-.428 2.66a2.74 2.74 0 0 1-1.143 1.14c-.562.3-1.128.43-2.657.43H13.85",stroke:"#fff",strokeWidth:"1.7",strokeLinecap:"round"}),r.createElement("path",{d:"M10.85 10.85 14 14l-3.15 3.15M6.85 14h6.6",stroke:"#fff",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("defs",null,r.createElement("linearGradient",{id:"CreateCallWaitingHallIconGradient",x1:"0",y1:"0",x2:"28.733",y2:".773",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#50C750"}),r.createElement("stop",{offset:"1",stopColor:"#32B332"}))))}},827491:(e,t,n)=>{"use strict";n.d(t,{DeleteBackgroundIcon:()=>i});var a=n(570655),r=n(667294),i=(0,r.forwardRef)((function(e,t){var n=(0,a.__rest)(e,[]);return r.createElement("div",(0,a.__assign)({},n,{ref:t,style:{width:18,height:18}}),r.createElement("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("rect",{width:"18",height:"18",rx:"2",fill:"black",fillOpacity:"0.4"}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.10202 5L5 6.10202L7.89798 9L5 11.898L6.10202 13L9 10.102L11.898 13L13 11.898L10.102 9L13 6.10202L11.898 5L9.10108 7.7969L9 7.89798L6.10202 5Z",fill:"white",fillOpacity:"0.72"})))}))},610781:(e,t,n)=>{"use strict";n.d(t,{DesktopAppIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"56",height:"56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M36.587 0C52.267 0 56 3.733 56 19.413v17.174C56 52.267 52.267 56 36.587 56H19.413C3.733 56 0 52.267 0 36.587V19.413C0 3.733 3.733 0 19.413 0h17.174Z",fill:"url(#a)"}),r.createElement("path",{d:"M55.75 42.571a32.585 32.585 0 0 1-11.884 2.23 32.514 32.514 0 0 1-17.04-4.791 1.491 1.491 0 0 0-1.384-.087c-3.084 1.37-6.552 2.091-10.434 2.403-1.071.086-1.793-1.048-1.333-2.02 1.533-3.243 2.537-6.178 3.148-9.098a1.402 1.402 0 0 0-.212-1.06 32.514 32.514 0 0 1-5.412-18.015c0-4.192.79-8.2 2.23-11.883C15.196.075 17.183 0 19.411 0h17.174c15.68 0 19.413 3.733 19.413 19.413v17.174c0 2.228-.075 4.215-.25 5.984Z",fill:"url(#b)"}),r.createElement("path",{d:"M43.867 49.467c3.768 0 7.411-.56 10.847-1.602.502-1.499.835-3.251 1.036-5.294A32.583 32.583 0 0 1 43.867 44.8a32.514 32.514 0 0 1-17.04-4.79 1.491 1.491 0 0 0-1.384-.088c-2.257 1.004-4.72 1.659-7.4 2.06l-.021.003c-.203.03-.406.06-.611.087-.783.104-1.583.188-2.402.254-1.072.086-1.793-1.048-1.334-2.02a50.648 50.648 0 0 0 1.16-2.643l.003-.006c.9-2.23 1.545-4.344 1.986-6.45a1.403 1.403 0 0 0-.212-1.06A32.515 32.515 0 0 1 11.2 12.134c0-4.192.79-8.2 2.229-11.883-2.043.201-3.795.534-5.294 1.036a37.33 37.33 0 0 0-1.602 10.847 37.18 37.18 0 0 0 5.427 19.394c-.54 2.118-1.34 4.322-2.504 6.785-1.847 3.908.944 9.065 5.926 8.665 3.642-.292 7.143-.93 10.424-2.163a37.185 37.185 0 0 0 18.06 4.653Z",fill:"#fff"}),r.createElement("path",{d:"M28.902 11.332c-.723-1.445-1.974-2.684-3.48-2.507a3.524 3.524 0 0 0-2.14 1.042c-1.554 1.554-1.803 4.285-.836 7.47.964 3.175 3.123 6.749 6.296 9.921 3.172 3.172 6.746 5.332 9.92 6.296 3.186.967 5.917.718 7.471-.836a3.525 3.525 0 0 0 1.042-2.14c.177-1.506-1.062-2.757-2.507-3.48l-1.621-.81a3.967 3.967 0 0 0-5.191 1.532.585.585 0 0 1-.829.192 32.7 32.7 0 0 1-4.963-4.076 32.696 32.696 0 0 1-4.076-4.963.585.585 0 0 1 .192-.829 3.967 3.967 0 0 0 1.533-5.19l-.81-1.622Z",fill:"#fff"}),r.createElement("defs",null,r.createElement("linearGradient",{id:"a",x1:"0",y1:"0",x2:"56",y2:"56",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:".208",stopColor:"#2B72F6"}),r.createElement("stop",{offset:".599",stopColor:"#1657D0"}),r.createElement("stop",{offset:"1",stopColor:"#0040B8"})),r.createElement("linearGradient",{id:"b",x1:"15.635",y1:"0",x2:"55.999",y2:"40.364",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:".214",stopColor:"#8FC3FF"}),r.createElement("stop",{offset:".771",stopColor:"#3E92F2"}),r.createElement("stop",{offset:"1",stopColor:"#1E7EED"}))))}},701683:(e,t,n)=>{"use strict";n.d(t,{DisabledVideoIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"16",width:"22",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M1.514.242A.9.9 0 00.286 1.558l1.092 1.02C1.13 3.053 1 3.548 1 4.846v6.308c0 1.338.14 1.822.4 2.311.262.49.646.873 1.135 1.134.489.262.974.401 2.31.401h7.31c1.207 0 1.72-.114 2.168-.328l1.163 1.086a.9.9 0 001.228-1.316L1.514.242zM15.999 11.346L4.924 1h7.23c1.338 0 1.822.14 2.311.4.49.262.873.646 1.134 1.135.262.489.401.974.401 2.31 0 2.167.023 4.335-.001 6.501zM22 4.497v7.006c0 .815-.964 1.277-1.6.8l-2.2-1.653a.5.5 0 01-.2-.4v-4.5a.5.5 0 01.2-.4l2.2-1.652c.651-.49 1.6.003 1.6.8z"}))}},80125:(e,t,n)=>{"use strict";n.d(t,{DisabledVideoIconS:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"14",height:"12",fill:"currentColor"},t,{xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M9.574 11.13a.751.751 0 001.061-1.06L1.48.92A.75.75 0 10.42 1.98l.82.82c-.153.282-.24.606-.24.95v4.5a2 2 0 002 2h5a2 2 0 00.601-.092l.973.972zM13.897 3.664A.454.454 0 0114 3.95v4.075c0 .415-.392.602-.825.382-.475-.24-1.572-.789-1.572-.789a.233.233 0 01-.103-.19v-2.88c0-.075.038-.146.103-.19 0 0 1.378-.694 1.572-.79.193-.094.55-.115.722.096zM10 7.425V3.75a2 2 0 00-2-2H4.32L10 7.425z"}))}},815155:(e,t,n)=>{"use strict";n.d(t,{EndCallIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M4.3 4.3a1 1 0 011.4 0l6.3 6.29 6.3-6.3a1 1 0 111.4 1.42L13.42 12l6.3 6.3a1 1 0 01-1.42 1.4L12 13.42l-6.3 6.3a1 1 0 01-1.4-1.42L10.58 12l-6.3-6.3a1 1 0 010-1.4z"}))}},172397:(e,t,n)=>{"use strict";n.d(t,{FullScreenIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M6.5 15a1 1 0 01-1 1H1a1 1 0 01-1-1v-4.5a1 1 0 012 0v2.071l3.363-3.364a1 1 0 011.414 0l.016.016a1 1 0 010 1.414L3.428 14H5.5a1 1 0 011 1zM14 3.428l-3.363 3.365a1 1 0 01-1.414 0l-.016-.016a1 1 0 010-1.414L12.571 2H10.5a1 1 0 010-2H15a1 1 0 011 1v4.5a1 1 0 01-2 0z"}))}},167903:(e,t,n)=>{"use strict";n.d(t,{FullScreenOffIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M6.1 9a.9.9 0 01.9.9v4.2a.9.9 0 11-1.8 0v-2.027l-3.664 3.663a.9.9 0 11-1.272-1.272L3.927 10.8H1.9a.9.9 0 110-1.8zM15.736.264a.9.9 0 010 1.272L12.073 5.2h2.025a.9.9 0 010 1.8H9.9a.9.9 0 01-.9-.9V1.9a.9.9 0 111.8 0v2.027L14.464.264a.9.9 0 011.272 0z"}))}},255778:(e,t,n)=>{"use strict";n.d(t,{LinuxIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:16,height:16,fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M12.744 12.112c-.336-.26-.205-.835-.554-1.118.338-1.963-.61-3.693-1.739-4.802-.948-.93-.642-1.836-.642-2.62C9.809 2.321 9.27 1 7.639 1 5.896 1 5.418 2.388 5.401 3.18c-.042 1.903.403 2.398-.764 3.783-1.373 1.63-1.575 3.254-1.265 4.116-.145.161-.34.34-.706.487-1.01.42-.27 1.123-.549 1.622A.883.883 0 0 0 2 13.62c0 .437.364.816 1.026.76.893-.077 1.717.527 2.25.527.47 0 .856-.255 1.036-.607.841-.198 1.88-.173 2.721.034.151.404.56.666 1.016.666.997 0 1.189-1.079 2.332-1.444a.9.9 0 0 0 .619-.868c0-.227-.085-.444-.256-.576Zm-5.59-6.105c-.195 0-.356-.15-.611-.331-.323-.229-.65-.36-.647-.6 0-.166.231-.217.53-.398.322-.194.448-.391.764-.391.324 0 .422.156.862.337.433.18.734.25.734.451 0 .207-.453.355-.708.506-.374.221-.567.426-.924.426Zm1.018-3.042c.539.083.6.987.341 1.432l-.217-.085c.113-.317.11-.838-.266-.871-.238-.021-.392.28-.425.538a1.07 1.07 0 0 0-.32-.075c.038-.538.402-1.013.887-.939Zm-2.08.193c.413-.098.657.36.659.837l-.19.111c-.025-.2-.119-.523-.354-.454-.25.075-.21.632-.07.746l-.187.1c-.256-.413-.256-1.245.142-1.34ZM4.8 14.383c-1.2-.52-1.608-.402-1.837-.402-.475 0-.63-.338-.452-.658.152-.27.105-.555.068-.783-.058-.35-.068-.463.292-.614.498-.201.72-.461.884-.655.463-.547.93.313 1.314 1.079.249.496.738.748.89 1.298.138.508-.435 1.05-1.16.735Zm4.27-1.093c-.846.393-1.924.573-2.73.175-.12-.329-.31-.541-.515-.755.33-.082.574-.474.281-.868-.312-.42-.95-.714-1.595-1.19-.603-.445-.794-1.542.028-2.769-.4 1.087-.167 2.087.034 2.374.042-.576.09-1.539.915-2.692.416-.582.422-1.351.431-1.832l.379.248c.279.196.512.413.847.413.495 0 .769-.272 1.15-.498.15-.088.375-.176.564-.3.318 1.445 1.634 3.182 1.708 4.171.306-.601-.087-2.05-.087-2.05.515.75.556 1.375.579 2.141.36.141.746.507.781.99l-.15-.017c-.077-.536-1.593-1.323-1.73-.314-.726.106-.462 1.205-.608 1.918-.068.326-.192.584-.283.855Zm2.96-.024c-.601.222-1.008.693-1.287.985-.538.564-1.249.293-1.325-.234-.08-.563.22-.87.35-1.501.118-.576-.014-1.462.263-1.557.18 1.023 1.263.593 1.51.314.401 0 .435.13.525.488.056.225.133.414.353.636.255.26.177.661-.388.87ZM7.143 5.68c-.398 0-.696-.252-.938-.448-.124-.1.031-.284.155-.184.237.192.475.394.783.394.37 0 .698-.303 1.14-.47.152-.056.238.167.088.223-.43.162-.775.486-1.228.486Z",fill:"#5181B8"}))}},801513:(e,t,n)=>{"use strict";n.d(t,{LiveIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"28px",height:"10px",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 28 10"},t),r.createElement("path",{fill:"#F2F3F5",fillRule:"evenodd",d:"M1 0a1 1 0 00-1 1v8a1 1 0 001 1h4a1 1 0 100-2H2V1a1 1 0 00-1-1zm7 1a1 1 0 112 0v8a1 1 0 11-2 0V1zm15-1a1 1 0 00-1 1v8a1 1 0 001 1h4a1 1 0 100-2h-3V6h3a1 1 0 100-2h-3V2h3a1 1 0 100-2h-4zm-8.325 9.31l-2.55-7.824a.993.993 0 01-.117-.363L12 1.1h.005A1 1 0 1113.995.9L14 .9l2 6.4 2-6.4h.005a1 1 0 011.99.2H20l-.008.023a.993.993 0 01-.118.363l-2.55 7.824a1 1 0 01-.95.69h-.748a1 1 0 01-.95-.69z",clipRule:"evenodd"}))}},818114:(e,t,n)=>{"use strict";n.d(t,{MicIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"20",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M8 0a4 4 0 00-4 4v5a4 4 0 008 0V4a4 4 0 00-4-4z"}),r.createElement("path",{d:"M1.1 10c-.551 0-.982.486-.843 1.02A8.007 8.007 0 007.1 16.95v2.15a.9.9 0 101.8 0v-2.15a8.007 8.007 0 006.843-5.93c.139-.534-.292-1.02-.843-1.02-.45 0-.826.329-.953.76a6.203 6.203 0 01-11.894 0C1.926 10.33 1.55 10 1.1 10z"}))}},830810:(e,t,n)=>{"use strict";n.d(t,{MoreIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"12",height:"20",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M4 3a2 2 0 104 0 2 2 0 00-4 0zm0 7a2 2 0 104 0 2 2 0 00-4 0zm2 9a2 2 0 110-4 2 2 0 010 4z",fill:"currentColor"}))}},747212:(e,t,n)=>{"use strict";n.d(t,{MutedMicIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"20",width:"16",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M1.721 2.307L4 4.586v-.002l7.029 7.029 4.693 4.695a1 1 0 01-1.414 1.414l-1.938-1.937A8.482 8.482 0 019 16.941V19a1 1 0 01-1.993.117L7.001 19v-2.06c-3.234-.384-5.995-2.611-6.955-5.646a.995.995 0 01.681-1.25 1.035 1.035 0 011.287.662C2.808 13.216 5.257 15 7.999 15c1.03 0 2.016-.25 2.89-.695l-1.538-1.539A4 4 0 014 9V7.414L.307 3.721a1 1 0 011.414-1.414zm13.55 7.737c.544.162.85.72.684 1.249a7.825 7.825 0 01-.75 1.666l-1.51-1.51c.113-.239.21-.487.29-.742a1.035 1.035 0 011.287-.663zM8 0a4 4 0 014 4v5c0 .237-.02.468-.06.694L4.433 2.188A4 4 0 018 0z"}))}},942775:(e,t,n)=>{"use strict";n.d(t,{MutedMicIconS:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"13",width:"12",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 13",fill:"currentColor"},t),r.createElement("path",{d:"M3.497 5.06v.44a2.501 2.501 0 002.91 2.467l1.199 1.198a4.005 4.005 0 01-5.521-2.822.75.75 0 00-1.469.314A5.508 5.508 0 005.25 10.95v1.301a.75.75 0 001.501 0v-1.3a5.472 5.472 0 001.973-.669l1.25 1.25a.751.751 0 001.062-1.061L1.88 1.32A.75.75 0 10.82 2.38l2.677 2.68zM9.672 7.097l1.117 1.117a5.463 5.463 0 00.594-1.557.75.75 0 10-1.468-.314 3.963 3.963 0 01-.243.754zM3.827 1.258l4.644 4.64c.02-.13.031-.263.031-.398v-3a2.502 2.502 0 00-4.675-1.242z"}))}},494549:(e,t,n)=>{"use strict";n.d(t,{ParticipantsIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M17 12.5c2.294 0 6.5.857 6.5 4.286 0 1.5-.382 1.714-1.147 1.714h-6.09c.158-.488.237-1.062.237-1.714 0-1.723-.631-3.067-1.672-4.062.783-.16 1.548-.224 2.172-.224zm-9 0c2.294 0 6.5.857 6.5 4.286 0 1.5-.382 1.714-1.147 1.714H2.647c-.765 0-1.147-.214-1.147-1.714C1.5 13.357 5.706 12.5 8 12.5zM8 5a3 3 0 110 6 3 3 0 110-6zm9 0a3 3 0 110 6 3 3 0 110-6z"}))}},995420:(e,t,n)=>{"use strict";n.d(t,{PhoneIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"18",width:"18",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M11.112 12.259c1.354-1.354 3.486-1.48 4.903-.287l1.025.863c1.168.983 1.287 2.757.263 3.96a3.318 3.318 0 01-2.195 1.133c-3.273.44-6.707-1.137-10.303-4.733C1.21 9.6-.369 6.165.072 2.892a3.25 3.25 0 01.159-.752c.19-.56.527-1.058.974-1.443C2.41-.327 4.181-.21 5.165.96l.862 1.024c1.194 1.416 1.07 3.55-.284 4.903l-.736.735a.712.712 0 00-.164.748c.267.732.95 1.645 2.046 2.74 1.096 1.097 2.01 1.78 2.74 2.048.26.095.553.03.749-.166z"}))}},780573:(e,t,n)=>{"use strict";n.d(t,{PhoneIconS:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"16",height:"16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M9.3 9.99c.93-.93 2.32-.75 3.63.35.94.79.82 2.85-1.18 3.12s-4.11-.7-6.32-2.9c-2.2-2.2-3.1-4.1-2.9-6.3a1.8 1.8 0 013.12-1.18c1.06 1.25 1.38 2.6.36 3.62-.48.48-.67.6-.56.91.41 1.1 2.19 2.65 2.94 2.93.35.13.46-.1.9-.55z"}))}},711034:(e,t,n)=>{"use strict";n.d(t,{PinDotIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"25",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M10 8a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"}),r.createElement("path",{d:"M6.558 10a.024.024 0 00-.017.04l3.254 3.255-2.947 2.948a1 1 0 001.414 1.414l2.948-2.948 3.25 3.25c.015.015.04.005.04-.017v-2.114c0-1.81.72-3.547 2-4.828l1.658-.414a.2.2 0 00.093-.336l-4-4a.2.2 0 00-.336.093L13.5 8a6.828 6.828 0 01-4.829 2H6.558z"}))}},748972:(e,t,n)=>{"use strict";n.d(t,{RaiseHandIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M6 5.18c.65 0 1 .54 1 1.2v5.48c0 .22.26.4.47.4.23 0 .52-.18.52-.4V4c0-.66.33-1.2.99-1.2.65 0 1.02.54 1.02 1.2v7.08c0 .22.29.4.5.4.22 0 .5-.18.5-.4V3.19c0-.66.31-1.2.97-1.2.66 0 1.04.54 1.04 1.2v7.88c0 .22.24.4.46.4.22 0 .52-.18.52-.4V4.79c0-.67.32-1.18.98-1.18.66 0 1.02.51 1.02 1.17v10.73l2.29-2.67c.33-.45 1-.68 1.65-.26.34.2.86.81.2 1.68 0 0-2.45 3.09-3.81 4.74-1.3 1.65-3.81 2.5-5.51 2.5C5.25 21.5 5 17.71 5 16.43V6.37c0-.65.33-1.19 1-1.19z"}))}},595285:(e,t,n)=>{"use strict";n.d(t,{RaisedHandContourIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 21 24"},t),r.createElement("path",{d:"M21.442 10.058c.513.77.588 1.831.192 2.663l-2.679 5.625C17.435 21.538 13.54 24 9.998 24H9c-4.422 0-8-3.58-8-8.009V8.128a2.746 2.746 0 013.5-2.642v-.732a2.75 2.75 0 013.571-2.629A2.749 2.749 0 0110.75 0c1.47 0 2.67 1.15 2.746 2.604A2.748 2.748 0 0117 5.254v4.264c1.299-1.278 3.357-1.087 4.442.54zM3.75 7.383a.746.746 0 00-.75.745v7.863A5.998 5.998 0 009 22h.998c2.773 0 5.964-2.02 7.152-4.514l2.678-5.625a.787.787 0 00-.05-.694c-.428-.642-1.123-.65-1.55-.01l-2.177 3.267c-.576.864-1.051.726-1.051-.323V5.255a.748.748 0 00-.75-.755.746.746 0 00-.75.747v5.757c0 .55-.448.996-1 .996-.556 0-1-.446-1-.995V2.752a.75.75 0 10-1.5 0v8.253c0 .54-.448.995-1 .995-.556 0-1-.446-1-.997v-6.25A.756.756 0 007.25 4a.75.75 0 00-.75.754v6.738c0 .551-.448 1.008-1 1.008-.556 0-1-.447-1-.999V8.138a.751.751 0 00-.75-.755z"}))}},135063:(e,t,n)=>{"use strict";n.d(t,{RaisedHandIconS:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"15",height:"15",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M2.75 3a.75.75 0 01.75.75V7.5a.5.5 0 001 0V2A.75.75 0 016 2v4.75a.5.5 0 001 0v-5.5a.75.75 0 011.5 0v5.5a.5.5 0 001 0V2.5a.75.75 0 011.5 0v7.25l1.614-1.796a.9.9 0 011.36 1.177c-.73.873-2.044 2.449-2.809 3.367C9.913 14 8.08 14.5 6.701 14.5 2.2 14.5 2 11.47 2 10.444V3.75A.75.75 0 012.75 3z"}))}},796726:(e,t,n)=>{"use strict";n.d(t,{RaisedHandIconXs:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"10px",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 10 11"},t),r.createElement("path",{fill:"#F5F5F5",d:"M.5 2.5A.5.5 0 011 3v2.5a.5.5 0 001 0v-4a.5.5 0 011 0V5a.5.5 0 001 0V1a.5.5 0 011 0v4.063a.5.5 0 001 0V1.938a.5.5 0 011 0V7.5l-.28-.032L8.494 5.57a.67.67 0 01.995.9 232.32 232.32 0 00-2.615 3.029C5.935 10.624 4.56 11 3.526 11 .15 11 0 8.727 0 7.958V3a.5.5 0 01.5-.5z"}))}},44781:(e,t,n)=>{"use strict";n.d(t,{RejectIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"14",width:"14",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M13.3.7a.99.99 0 00-1.4 0L7 5.6 2.1.7A.99.99 0 00.7 2.1L5.6 7 .7 11.9a.99.99 0 001.4 1.4L7 8.4l4.9 4.9a.99.99 0 001.4-1.4L8.4 7l4.9-4.9a.99.99 0 000-1.4z"}))}},462480:(e,t,n)=>{"use strict";n.d(t,{ShareIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"20",height:"20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M9.978 3.423a1.792 1.792 0 00-1.645 1.785v1.765l-.1.021a8.254 8.254 0 00-6.44 8.917.75.75 0 001.343.379l.175-.22a7.577 7.577 0 015.022-2.721v2.08a1.792 1.792 0 002.897 1.41l6.52-5.11a1.792 1.792 0 000-2.82l-6.52-5.11a1.791 1.791 0 00-1.105-.382l-.147.006zm.147 1.494c.065 0 .129.021.18.062l6.52 5.11a.292.292 0 010 .459l-6.52 5.11a.292.292 0 01-.472-.23v-2.873a.75.75 0 00-.767-.75l-.215.005-.305.016a9.065 9.065 0 00-5.162 2.056l-.037.032.004-.027a6.752 6.752 0 015.823-5.533.75.75 0 00.659-.744V5.208c0-.16.13-.291.292-.291z",fill:"#99A2AD"}))}},122317:(e,t,n)=>{"use strict";n.d(t,{ShareScreenBigIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"56",height:"56",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M28.5 37.5A1.5 1.5 0 0030 36V22.622l4.94 4.939a1.5 1.5 0 002.007.103l.114-.103a1.5 1.5 0 000-2.122l-7.5-7.5a1.5 1.5 0 00-2.122 0l-7.5 7.5a1.5 1.5 0 002.122 2.122l4.938-4.939L27 36a1.5 1.5 0 001.355 1.493l.145.007z"}),r.createElement("path",{d:"M19.883 8c-5.019 0-7.117.465-9.244 1.603a10.924 10.924 0 00-4.536 4.536C4.965 16.266 4.5 18.364 4.5 23.383v9.234c0 5.019.465 7.117 1.603 9.244a10.924 10.924 0 004.536 4.536C12.766 47.535 14.864 48 19.883 48h17.234c5.019 0 7.117-.465 9.244-1.603a10.924 10.924 0 004.536-4.536c1.138-2.127 1.603-4.225 1.603-9.244v-9.234c0-5.019-.465-7.117-1.603-9.244a10.924 10.924 0 00-4.536-4.536C44.234 8.465 42.136 8 37.117 8H19.883zm-7.83 4.248c1.486-.794 3-1.248 7.83-1.248h17.234c4.83 0 6.344.454 7.83 1.248a7.925 7.925 0 013.305 3.306c.794 1.485 1.248 3 1.248 7.83v9.233c0 4.83-.454 6.344-1.248 7.83a7.925 7.925 0 01-3.306 3.305c-1.485.794-3 1.248-7.83 1.248H19.884c-4.83 0-6.344-.454-7.83-1.248a7.925 7.925 0 01-3.305-3.306c-.794-1.485-1.248-3-1.248-7.83v-9.233c0-4.83.454-6.344 1.248-7.83a7.925 7.925 0 013.306-3.305z"}))}},156482:(e,t,n)=>{"use strict";n.d(t,{ShareScreenIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"24",height:"24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M20.465 4.4c-.489-.26-.974-.4-2.31-.4H5.844c-1.336 0-1.821.14-2.31.4A2.726 2.726 0 002.4 5.536C2.139 6.024 2 6.509 2 7.845v8.31c0 1.336.14 1.821.4 2.31.262.49.646.873 1.135 1.134.489.262.974.401 2.31.401h12.31c1.336 0 1.821-.14 2.31-.4a2.726 2.726 0 001.134-1.135c.262-.489.401-.974.401-2.31v-8.31c0-1.336-.14-1.821-.4-2.31A2.726 2.726 0 0020.464 4.4zm-11.81 5.728l2.97-2.978c.207-.2.543-.2.75 0l2.97 2.978c.33.318.077.872-.376.872H13v4.979c0 .564-.442 1.021-1 1.021s-1-.457-1-1.021V11H9.031c-.44 0-.715-.545-.375-.872z"}))}},254060:(e,t,n)=>{"use strict";n.d(t,{StarFilled:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"28",width:"28",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M14 21.5l-4.6 2.9A2.2 2.2 0 016 22l1.2-5.3L3.2 13a2.2 2.2 0 011.2-3.8l5.5-.5 2-5a2.2 2.2 0 014.1 0l2.1 5 5.5.5a2.2 2.2 0 011.2 3.8l-4.1 3.6 1.2 5.3a2.2 2.2 0 01-3.3 2.4L14 21.5z"}))}},995811:(e,t,n)=>{"use strict";n.d(t,{StarIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"10",height:"10",viewBox:"0 0 10 10",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M6.80486 3.06621L9.19457 3.30079C10.0261 3.38241 10.2811 4.21346 9.63901 4.75944L7.76813 6.35033L8.46267 8.94201C8.69075 9.79313 7.98312 10.3084 7.27435 9.79614L5.0011 8.15325L2.72785 9.79614C2.02194 10.3063 1.31141 9.79324 1.53953 8.94201L2.23406 6.35033L0.363183 4.75944C-0.281598 4.21116 -0.0275869 3.38278 0.807493 3.30079L3.19677 3.06621L4.24943 0.583062C4.57908 -0.194562 5.42332 -0.194173 5.75269 0.583142L6.80486 3.06621Z"}))}},950890:(e,t,n)=>{"use strict";n.d(t,{StarOutline:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"28",width:"28",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M14 19.2l5.7 3.5a.2.2 0 00.3-.3L18.4 16l5.1-4.3a.2.2 0 00-.1-.4l-6.7-.5-2.5-6.1a.2.2 0 00-.4 0l-2.5 6.1-6.7.5a.2.2 0 00-.1.4l5 4.3L8 22.4a.2.2 0 00.3.3zm0 2.3l-4.6 2.9A2.2 2.2 0 016 22l1.2-5.3L3.2 13a2.2 2.2 0 011.2-3.8l5.5-.5 2-5a2.2 2.2 0 014.1 0l2.1 5 5.5.5a2.2 2.2 0 011.2 3.8l-4.1 3.6 1.2 5.3a2.2 2.2 0 01-3.3 2.4z"}))}},607910:(e,t,n)=>{"use strict";n.d(t,{TranslationStatusChevronIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({xmlns:"http://www.w3.org/2000/svg",width:"8",height:"4",viewBox:"0 0 10 5",fill:"currentColor","aria-hidden":"true"},t),r.createElement("path",{d:"M5 4.8c-.2 0-.3 0-.4-.1l-4.3-3.2c-.3-.3-.4-.8-.2-1.1.2-.3.7-.4 1-.2l3.9 2.9 3.8-2.9c.3-.3.8-.2 1 .1.3.3.2.8-.1 1.1l-4.2 3.2c-.2.1-.3.2-.5.2z"}))}},826988:(e,t,n)=>{"use strict";n.d(t,{VideoIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({height:"14",width:"21",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t),r.createElement("path",{d:"M11.154 0c1.337 0 1.822.14 2.311.4.49.262.873.646 1.134 1.135.262.489.401.974.401 2.31v6.31c0 1.336-.14 1.821-.4 2.31a2.726 2.726 0 01-1.135 1.134c-.489.262-.974.401-2.31.401h-7.31c-1.336 0-1.821-.14-2.31-.4A2.726 2.726 0 01.4 12.464C.139 11.976 0 11.491 0 10.155v-6.31c0-1.336.14-1.821.4-2.31A2.726 2.726 0 011.536.4C2.024.139 2.509 0 3.845 0zM20.8 2.897a1 1 0 01.2.6v7.006a1 1 0 01-1.6.8L17.2 9.65a.5.5 0 01-.2-.4v-4.5a.5.5 0 01.2-.4l2.2-1.652a1 1 0 011.4.199z"}))}},168634:(e,t,n)=>{"use strict";n.d(t,{VideoIconS:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"16",height:"16",fill:"currentColor"},t,{xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M3.14 3C1.96 3 1 3.96 1 5.14v5.72C1 12.04 1.96 13 3.14 13h5.72c1.18 0 2.14-.96 2.14-2.14V5.14C11 3.96 10.04 3 8.86 3H3.14zM14.95 4.87c.23-.17.55 0 .55.28v5.7c0 .28-.32.45-.55.28L12 9.01V6.99l2.95-2.12z"}))}},30933:(e,t,n)=>{"use strict";n.d(t,{ViewersCountIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"16",height:"10",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 0C4.546 0 1.596 2.073.4 5c1.196 2.927 4.146 5 7.6 5 3.455 0 6.405-2.073 7.6-5-1.195-2.927-4.145-5-7.6-5zm3.5 5a3.5 3.5 0 11-7 0 3.5 3.5 0 017 0zM8 7a2 2 0 100-4 2 2 0 000 4z",fill:"#F5F5F5"}))}},473900:(e,t,n)=>{"use strict";n.d(t,{WindowsIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:16,height:16,fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M2 8V3.677l5-.678V8H2Zm5.5 0H14V2l-6.5.904V8Zm-.5.5H2v3.823l5 .678V8.5Zm.5 0v4.597L14 14V8.5H7.5Z",fill:"#5181B8"}))}},294757:(e,t,n)=>{"use strict";n.d(t,{init:()=>L});var a=n(570655),r=n(667294),i=n(973935),o=n(659397),l=n(262891),s=n(656504),c=n(641196),u=n(89085),d=n(253312),p=n(464380),_=n(662208),m=n(498110),f=n(170794),g=n(614914),A=n(699637),v=n(14890),h=n(989189),E=n(815615),C=n(50533),S=n(121255),y=n(613335),T=n(307915),I=n(567354),b=n(908484),N=n(772071),w=n(457532);n(329538);function L(e){var t=e.actionStatCollector,n=e.saveStatlogEvents,L=e.langUtils,k=e.navigateToConvo,M=e.navigateToProfile,O=e.apiWrapperWithAuth,D=e.apiWrapper,R=e.callSounds,B=e.config,x=void 0===B?{isModalView:!0,withAnimation:!0,allowAddMembers:!1,debugLog:!1,streaming:!0,streamingPrivacy:!0,fullHD:!1,anonymPhoto:!0,incomingCall:!1,allowBanParticipant:!1,showFeedbackScreen:!1,enableVideoSlots:!1,videoSlotsCount:S.VIDEO_SLOTS_COUNT,browserWarnings:null,allowCallByName:!1,nativeApp:!1,nativeAppJoin:!1,enableScreenTrack:!1,enableProducerScreenTrack:!1,allowWaitingHall:!1,allowPushToTalk:!1,badNetwork:!1,badNetworkP2P:!1,desktopAppNotification:!1,sferum:!1,enableVirtualBackground:!1}:B,U=e.eventHandlers,H=e.streamUrlExtractor;return(0,c.setApiWrappers)(O,D),{initialized:!1,initializing:!1,eventHandlers:null!=U?U:{},init:function(e){var s,c=this,T=e.callPreview,I=e.callsCredentials,b=e.imHash,N=e.participantLimit,w=e.callsOkStaging,O=e.tabIsMaster,D=e.onBeforeCallStart,B=e.onAfterCallFinish,G=e.onError,V=e.toggles,F=void 0===V?{}:V,W=e.friends,z=e.isFriend,j=e.getFriends,K=e.pushToTalkEnabled;if(!(null==I?void 0:I.me))return console.log("Calls were not initialized as there are no callsCredentials.me"),!1;this.initialized=!0,this.isFriend=z,this.getFriends=j;var Y=(0,a.__assign)((0,a.__assign)({},x),F);if(!p.browser.isBrowserSupported()){var Q=function(){var e=L.getLang("calls_unsupported_browser_error");return G&&G({msg:e}),(null==U?void 0:U.onError)&&U.onError(new Error(e)),console.error(e),Promise.resolve()};return this.call=Q,this.startGroupCall=Q,this.startCall=Q,this.acceptCall=Q,this.joinCallByLink=Q,this.showJoinPopup=Q,this.showCallByNamePopup=Q,void(this.showCreateCallByLinkPopup=Q)}this.id=window.vk&&window.vk.id||I.me.peerId;var Z=O||function(){return!0},J=null!==(s=o.localStorage.getItem(S.VIDEO_RESOLUTION_STORAGE_KEY))&&void 0!==s?s:S.VideoResolutionTypes.SD,q=(0,v.createStore)(E.callsReducer,(0,h.getInitialState)(I.me,b,T,{participantLimit:N,isDev:!!I.is_dev,token:I.secret,config:Y,localVideoResolution:Y.fullHD?J:J===S.VideoResolutionTypes.HD?S.VideoResolutionTypes.HD:S.VideoResolutionTypes.SD,friends:W||[],friendsCache:(0,y.createFriendsCache)(W||[]),ipSettingEnabled:I.ip_setting_enabled,privacySettings:I.privacySettings,pushToTalkEnabled:K}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());return this.collapseCall=function(){q.dispatch({type:S.MANAGEMENT,isOpen:!1}),q.dispatch({type:S.CHANGE_UI_MODE,mode:S.UIMode.COLLAPSED})},this.restoreCall=function(){q.dispatch({type:S.CHANGE_UI_MODE,mode:S.UIMode.DEFAULT})},this.showStartCallModal=function(e,t,n){c.isInActiveCall||q.dispatch({type:S.CHANGE_MODE,mode:S.Mode.START,peerId:e,joinLink:t,entryPoint:n})},n&&(0,f.setStatlogEventsHandler)(n),t&&g.callStats.setActionStatCollector(t),i.render(r.createElement(C.Provider,{store:q},r.createElement(_.LangContext.Provider,{value:L},r.createElement(m.ConfigContext.Provider,{value:Y},r.createElement(A.WaitingContainer,null)))),P("calls")),this.initializing=(0,d.sdkService)(this,p,I,q,L.getLang,w).finally((function(){(0,u.longpollService)(c,p,L.getLang,q);var e=P("calls");i.unmountComponentAtNode(e),i.render(r.createElement(C.Provider,{store:q},r.createElement(_.LangContext.Provider,{value:L},r.createElement(m.ConfigContext.Provider,{value:Y},r.createElement(l.App,{bridge:c,SDK:p,tabIsMaster:Z,onBeforeCallStart:D,onAfterCallFinish:B,callSounds:R,navigateToConvo:k,onHandCountChanged:null==U?void 0:U.onHandCountChanged,onSuccessFeedback:null==U?void 0:U.onSuccessFeedback,navigateToProfile:M,okPublicKey:I.key,config:Y,streamUrlExtractor:H})))),e)})),this.initializing.catch((function(e){if(null==U?void 0:U.onError){var t=e?e.message||e.msg:"sdk did not send the reasons for the error",n=e?e.error:"";[401].includes(n)||U.onError(new Error("Could not init calls. "+t+": "+n))}console.error("Could not init calls",e.error,e)}))},showJoinScreen:function(e,o,l,c,u){var d=(0,T.createInvokeErrorWrapper)(c,U);if(!p.browser.isBrowserSupported())return d(L.getLang("calls_unsupported_browser_error"));(0,f.setStatlogEventsHandler)(n),g.callStats.setActionStatCollector(t);var A=e.callsAllowCallByName,v=e.callsAllowWaitingHall,h=document.querySelector(o),E=(0,a.__assign)((0,a.__assign)({},x),{allowCallByName:A,allowWaitingHall:v});i.render(r.createElement(_.LangContext.Provider,{value:L},r.createElement(m.ConfigContext.Provider,{value:E},r.createElement(s.JoinScreenContainer,(0,a.__assign)({},e,{withPopup:!1,bridge:this,entryPoint:l,onError:d,okPublicKey:u})))),h)},showHistoryScreen:function(e,t,a){var o,l;void 0===t&&(t={}),void 0===a&&(a=!0);var s=(0,T.createInvokeErrorWrapper)(void 0,U);if(!p.browser.isBrowserSupported())return s(L.getLang("calls_unsupported_browser_error"));(0,f.setStatlogEventsHandler)(n);var c=(0,v.createStore)(I.historyScreenReducer,(0,h.getHistoryScreenInitialState)(t),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),u=document.querySelector(e),d={navigateToConvo:k,navigateToProfile:M},g={bridge:this,SDK:p};if(i.render(r.createElement(C.Provider,{store:c},r.createElement(w.BaseObjectsContext.Provider,{value:g},r.createElement(N.NavigationContext.Provider,{value:d},r.createElement(_.LangContext.Provider,{value:L},r.createElement(m.ConfigContext.Provider,{value:x},r.createElement(b.default,null)))))),u),a){var A=document.querySelector("#l_ca");A&&A.classList.contains("AppLeftMenuWithNotify")&&A.classList.remove("AppLeftMenuWithNotify"),A&&A.classList.contains("AppLeftMenuWithNotifyBlueDot")&&A.classList.remove("AppLeftMenuWithNotifyBlueDot")}null===(l=null===(o=window.cur)||void 0===o?void 0:o.destroy)||void 0===l||l.push((function(){u&&i.unmountComponentAtNode(u)}))},debug:!1,setDebug:function(e){this.debug=e,p.debug(e)}}}function P(e){var t=document.getElementById(e);if(t)return t;var n=document.createElement("section");return n.setAttribute("id",e),document.body.appendChild(n),n}},169610:(e,t,n)=>{"use strict";n.d(t,{checkPermissions:()=>r});var a=n(464380);function r(e,t){var n=e.browser.hasMicrophonePermission(),r=e.browser.hasCameraPermission(),i=t.includes(a.MediaOption.AUDIO)&&!n,o=t.includes(a.MediaOption.VIDEO)&&!r;return(i||o)&&function(e,t,n){e.browser.getUserMedia(t,n).then((function(e){e.getTracks().forEach((function(e){return e.stop()}))}))}(e,o,i),Promise.resolve()}},567354:(e,t,n)=>{"use strict";n.d(t,{historyScreenReducer:()=>i});var a=n(570655),r=n(362621);function i(e,t){switch(t.type){case r.HistoryScreenActionTypes.DELETE_CALL:return(0,a.__assign)((0,a.__assign)({},e),{deleteCallId:t.data});case r.HistoryScreenActionTypes.SET_CURRENT_CALLS:return(0,a.__assign)((0,a.__assign)({},e),{currentCalls:t.data});case r.HistoryScreenActionTypes.SET_HISTORY_CALLS:return(0,a.__assign)((0,a.__assign)({},e),{historyCalls:t.data});case r.HistoryScreenActionTypes.SET_PROFILES:return(0,a.__assign)((0,a.__assign)({},e),{profiles:(0,a.__assign)((0,a.__assign)({},e.profiles),t.data)});case r.HistoryScreenActionTypes.SET_URLS:return(0,a.__assign)((0,a.__assign)({},e),{joinLinks:(0,a.__assign)((0,a.__assign)({},e.joinLinks),t.data)});case r.HistoryScreenActionTypes.ERROR:return(0,a.__assign)((0,a.__assign)({},e),{error:t.data});case r.HistoryScreenActionTypes.SET_LOADING:return(0,a.__assign)((0,a.__assign)({},e),{loading:t.data});case r.HistoryScreenActionTypes.SET_SHOW_CREATE_BUTTON:return(0,a.__assign)((0,a.__assign)({},e),{showCreateCall:t.data})}return e}},989189:(e,t,n)=>{"use strict";n.d(t,{getInitialState:()=>l,getHistoryScreenInitialState:()=>s});var a=n(570655),r=n(121255),i=n(464380),o=n(745284),l=function(e,t,n,l){var s,c=l.participantLimit,u=void 0===c?128:c,d=l.isDev,p=void 0!==d&&d,_=l.token,m=l.config,f=void 0===m?{isModalView:!0,withAnimation:!0,allowAddMembers:!1,debugLog:!1,incomingCall:!1,streaming:!0,streamingPrivacy:!0,fullHD:!1,anonymPhoto:!0,allowBanParticipant:!1,showFeedbackScreen:!1,enableVideoSlots:!1,videoSlotsCount:r.VIDEO_SLOTS_COUNT,browserWarnings:null,allowCallByName:!1,nativeApp:!1,nativeAppJoin:!1,enableScreenTrack:!1,enableProducerScreenTrack:!1,allowWaitingHall:!1,allowPushToTalk:!1,badNetwork:!1,badNetworkP2P:!1,desktopAppNotification:!1,sferum:!1,enableVirtualBackground:!1}:m,g=l.localVideoResolution,A=void 0===g?r.VideoResolutionTypes.SD:g,v=l.friends,h=void 0===v?[]:v,E=l.friendsCache,C=l.privacySettings,S=l.ipSettingEnabled,y=l.pushToTalkEnabled,T=void 0!==y&&y,I=window.vk&&window.vk.id||e.peerId;return{anonymSecret:_,me:I,groupId:0,mode:r.Mode.READY,peer:0,participants:(s={},s[I]=(0,a.__assign)((0,a.__assign)({},e),{mediaSettings:{isAudioEnabled:!0,isVideoEnabled:!1,isScreenSharingEnabled:!1},statusData:{hand:{state:!1,ts:Date.now()}},networkStatus:1,roles:[],permissions:{audio:r.MediaPermissionType.ALLOW,video:r.MediaPermissionType.ALLOW,screenSharing:r.MediaPermissionType.ALLOW}}),s),callData:{type:null,ts:null,localTimeStamp:null,conversation:n},imHash:t,participantLimit:u,isDev:p,popup:null,uiMode:r.UIMode.DEFAULT,orator:null,adminPinnedParticipant:null,screenSharingPinnedParticipant:null,screenSharingNeedDisableOratorModeAfterStop:!0,screenSharingOldPinnedParticipant:null,pinnedParticipant:null,screenSharers:{},isShownParticipantsAside:!0,isOratorMode:!0,chatMembers:[],groupMembers:[],groupMembersCount:0,preselectedIds:null,friends:h,speakers:{},speakersInHeader:[],chatUnreadCount:0,chatUpToMsgId:null,tooltips:{chat:!1,hand:!1,screenShare:!1,layout:!1,collapse:!1,fullscreen:!1},participantsAddedByMe:new Set,groupCallSetup:!1,isManagementOpen:!1,notification:null,errorShown:!1,cautionShown:!1,isLoaderVisible:!1,translation:{deferredId:null,isOn:!1},participantsManagement:null,adminAssignment:null,participantKick:null,membersUnban:null,noiseCancellation:r.NoiseCancellationTypes.NEURAL,config:f,localVideoResolution:A,conversationOptions:[],privacySettings:{callsIp:(null==C?void 0:C.callsIp)||"friends"},friendsCache:E||{},groupMembersCache:{},unableToCallGroupMembersIds:[],ipSettingEnabled:S||!1,localStatus:i.ParticipantStatus.WAITING,isIncoming:!1,pushToTalkEnabled:T,gridScrollPosition:0,gridScrollFirstVisible:0,oratorScrollPosition:0,oratorScrollFirstVisible:0,oratorScrollNumberOfVisible:5,callsCount:(0,o.getCallsCount)(),shouldShowDesktopAppNotification:!1,shouldShowWarningDesktopAppNotification:!0,virtualBackgroundSettings:{photos:[],videoOptions:{}},permissions:{}}},s=function(e){var t,n,a;return{meId:null!==(t=e.meId)&&void 0!==t?t:0,currentCalls:[],historyCalls:[],deleteCallId:-1,profiles:{},joinLinks:{},isDev:null!==(n=e.isDev)&&void 0!==n&&n,error:null,loading:!0,showCreateCall:!0,showDesktopAppBanner:null!==(a=e.showDesktopAppBanner)&&void 0!==a&&a}}},815615:(e,t,n)=>{"use strict";n.d(t,{callsReducer:()=>u});var a=n(570655),r=n(121255),i=n(989189),o=n(768606),l=n(613335),s=n(464380),c=!0;function u(e,t){var n,u,m,f,g,A;switch(t.type){case r.LOAD_PEERS:var v=t.conversation||e.callData.conversation,h=t.members;return(0,a.__assign)((0,a.__assign)({},e),{participants:(0,a.__assign)((0,a.__assign)({},e.participants),h.reduce((function(t,n){return n&&n.peerId&&(t[n.peerId]=(0,a.__assign)((0,a.__assign)({mediaSettings:{isAudioEnabled:!1,isVideoEnabled:!1,isScreenSharingEnabled:!1}},e.participants[n.peerId]||{}),n)),t}),{})),callData:(0,a.__assign)((0,a.__assign)({},e.callData),{conversation:v}),peer:"peerId"in t?t.peerId:e.peer,caller:"caller"in t?t.caller:e.caller});case r.CHANGE_MODE:var E=t.mode!==r.Mode.READY&&t.data&&t.data.type?t.data.type:null;if(t.mode===r.Mode.READY||t.mode===r.Mode.FEEDBACK){v=e.callData&&e.callData.conversation;var C=(0,i.getInitialState)(e.participants[e.me],e.imHash,v,{participantLimit:e.participantLimit,token:e.anonymSecret,config:e.config,localVideoResolution:e.localVideoResolution,friends:e.friends,privacySettings:e.privacySettings,friendsCache:e.friendsCache,ipSettingEnabled:e.ipSettingEnabled,isDev:e.isDev});return t.mode===r.Mode.FEEDBACK&&(C.mode=r.Mode.FEEDBACK,C.lastCallData={callId:null!==(m=null===(u=e.callData)||void 0===u?void 0:u.callId)&&void 0!==m?m:"",peerId:null!==(f=e.peer)&&void 0!==f?f:0}),C.virtualBackgroundSettings=e.virtualBackgroundSettings,e.hangupType===s.HangupType.BUSY?C.lastCallData=(0,a.__assign)((0,a.__assign)({},C.lastCallData||{}),{opponentName:null===(g=e.participants[e.peer])||void 0===g?void 0:g.name}):e.hangupType===s.HangupType.KILLED&&(C.lastCallData=(0,a.__assign)((0,a.__assign)({},C.lastCallData||{}),{isMeEndedCallForAll:null===(A=e.lastCallData)||void 0===A?void 0:A.isMeEndedCallForAll})),C}return(0,a.__assign)((0,a.__assign)({},e),{mode:t.mode,peer:"peerId"in t?t.peerId:e.peer,callData:(0,a.__assign)((0,a.__assign)({},e.callData),{type:E,ts:t.ts||e.callData.ts||null}),hangupType:e.hangupType,join:t.joinLink?{joinLink:t.joinLink}:e.join,entryPoint:t.entryPoint||e.entryPoint});case r.HANGUP:return(0,a.__assign)((0,a.__assign)({},e),{hangupType:t.data});case r.TIME_START:return(0,a.__assign)((0,a.__assign)({},e),{callData:(0,a.__assign)((0,a.__assign)({},e.callData),{ts:t.data})});case r.LOCAL_TIME_START:return(0,a.__assign)((0,a.__assign)({},e),{callData:(0,a.__assign)((0,a.__assign)({},e.callData),{localTimeStamp:t.data})});case r.REMOVE_USER:var S=d(e,t.participantId,{status:void 0,statusData:void 0,wasConnected:void 0,mediaSettings:void 0,stream:void 0,screenSharingStream:void 0});if(e.screenSharers[t.participantId]&&delete S.screenSharers[t.participantId],e.orator===t.participantId&&(S.orator=null),e.pinnedParticipant===t.participantId&&(S.pinnedParticipant=null),e.adminPinnedParticipant===t.participantId&&(S.adminPinnedParticipant=null),e.screenSharingPinnedParticipant===t.participantId&&(S.screenSharingPinnedParticipant=null),e.participantsAddedByMe.has(t.participantId)){var y=new Set(e.participantsAddedByMe);y.delete(t.participantId),S.participantsAddedByMe=y}return S;case r.SET_CHAT_INFO:return(0,a.__assign)((0,a.__assign)({},e),{chatMembers:t.data,chatData:t.conversation});case r.GROUP_CALL_SETUP:return(0,a.__assign)((0,a.__assign)({},e),{groupCallSetup:t.open,peer:t.peerId||e.peer||0,preselectedIds:t.preselectedIds});case r.TOGGLE_POPUP:return(0,a.__assign)((0,a.__assign)({},e),{popup:t.data||null});case r.UPDATE_HASH:return(0,a.__assign)((0,a.__assign)({},e),{imHash:t.hash});case r.CHANGE_UI_MODE:return(0,a.__assign)((0,a.__assign)({},e),{uiMode:t.mode||r.UIMode.DEFAULT});case r.TOGGLE_ORATOR_MODE:return(0,a.__assign)((0,a.__assign)({},e),{isOratorMode:t.isOratorMode});case r.TOGGLE_PARTICIPANTS_ASIDE:return(0,a.__assign)((0,a.__assign)({},e),{isShownParticipantsAside:t.isShownParticipantsAside});case r.SET_ORATOR:return(0,a.__assign)((0,a.__assign)({},e),{orator:t.orator||null});case r.SET_PINNED_PARTICIPANT:return(0,a.__assign)((0,a.__assign)({},e),{pinnedParticipant:t.pinnedParticipant});case r.SET_ADMIN_PINNED_PARTICIPANT:return(0,a.__assign)((0,a.__assign)({},e),{adminPinnedParticipant:t.data});case r.SET_SCREEN_SHARING_PINNED_PARTICIPANT:return(0,a.__assign)((0,a.__assign)({},e),{screenSharingPinnedParticipant:t.screenSharingPinnedParticipant,screenSharingNeedDisableOratorModeAfterStop:t.screenSharingNeedDisableOratorModeAfterStop,screenSharingOldPinnedParticipant:t.screenSharingOldPinnedParticipant});case r.MANAGEMENT:return(0,a.__assign)((0,a.__assign)({},e),{isManagementOpen:t.isOpen,managementView:t.managementView});case r.CALL_STATE:return(0,a.__assign)((0,a.__assign)({},e),{callData:(0,a.__assign)((0,a.__assign)({},e.callData),t.callData),join:t.joinLink?{joinLink:t.joinLink}:e.join});case r.CALL_NOTIFICATION:return(0,a.__assign)((0,a.__assign)({},e),{notification:t.notification});case r.JOIN:return(0,a.__assign)((0,a.__assign)({},e),{mode:r.Mode.JOIN,join:t.data});case r.CALL_BY_NAME:return(0,a.__assign)((0,a.__assign)({},e),{mode:r.Mode.CALL_BY,callByName:t.data});case r.ERROR:return(0,a.__assign)((0,a.__assign)({},e),{mode:t.handleType===r.ErrorHandleType.FATAL?r.Mode.ERROR:e.mode,errorShown:!t.isClosed,error:{title:t.title,text:t.text,handleType:t.handleType,callId:t.callId}});case r.CHANGE_PARTICIPANT_STATE:var T=e.participants[t.participantId].statusData;return d(e,t.participantId,{statusData:(0,a.__assign)((0,a.__assign)({},T),t.data)});case r.CHANGE_PARTICIPANT_ROLES:return d(e,t.participantId,{roles:t.data});case r.CHANGE_PARTICIPANT_PERMISSIONS:var I=e.participants[t.participantId];return d(e,t.participantId,{permissions:(0,a.__assign)((0,a.__assign)({},I.permissions),t.data)});case r.UPDATE_PARTICIPANT_MEDIA_SETTINGS:var b=t.data;I=e.participants[b.participantId];return d(e,b.participantId,{permissions:(0,a.__assign)((0,a.__assign)({},I.permissions),b.permissions||{}),mediaSettings:(0,a.__assign)((0,a.__assign)({},I.mediaSettings),b.mediaSettings)});case r.SET_SCREEN_SHARER:return(0,a.__assign)((0,a.__assign)({},e),{screenSharers:(0,a.__assign)((0,a.__assign)({},e.screenSharers),(n={},n[t.participantId]=t.isScreenSharingEnabled,n))});case r.SET_FRIENDS:return(0,a.__assign)((0,a.__assign)({},e),{friends:t.data,friendsCache:(0,l.createFriendsCache)(t.data)});case r.SET_GROUP_MEMBERS:return(0,a.__assign)((0,a.__assign)({},e),{groupMembersCount:t.groupMembersCount,groupMembers:t.groupMembers,unableToCallGroupMembersIds:t.unableToCallGroupMembersIds,groupMembersCache:(0,l.createFriendsCache)(t.groupMembers)});case r.SET_SPEAKERS:var N=t.data,w=N.speakers,L=N.speakersInHeader;return c?(e.speakers=w||e.speakers,e.speakersInHeader=L||e.speakersInHeader):e=(0,a.__assign)((0,a.__assign)({},e),{speakers:w||e.speakers,speakersInHeader:L||e.speakersInHeader}),c=!c,e;case r.UPDATE_PARTICIPANTS_BATCH:return(0,o.applyParticipantsBatch)(e,t.data);case r.SET_UNREAD_COUNT:return(0,a.__assign)((0,a.__assign)({},e),{chatUnreadCount:t.chatUnreadCount,chatUpToMsgId:"chatUpToMsgId"in t?t.chatUpToMsgId:e.chatUpToMsgId});case r.SHOW_CAUTION_BOX:return(0,a.__assign)((0,a.__assign)({},e),{cautionShown:t.isOpen,isIncoming:t.isIncoming});case r.SHOW_LOADER:return(0,a.__assign)((0,a.__assign)({},e),{isLoaderVisible:t.isLoaderVisible});case r.SET_TOOLTIP:var P=t.tooltips?t.tooltips:Object.keys(e.tooltips).reduce((function(e,t){return e[t]=!1,e}),{});return(0,a.__assign)((0,a.__assign)({},e),{tooltips:(0,a.__assign)((0,a.__assign)({},e.tooltips),P)});case r.MANUAL_ADD_PARTICIPANTS:return(0,a.__assign)((0,a.__assign)({},e),{participantsAddedByMe:(t.participants||[]).reduce((function(e,t){return e.add(t)}),new Set(e.participantsAddedByMe))});case r.SET_TRANSLATION:return(0,a.__assign)((0,a.__assign)({},e),{translation:(0,a.__assign)((0,a.__assign)({},e.translation),t.data)});case r.UPDATE_ANON_SECRET:return(0,a.__assign)((0,a.__assign)({},e),{anonymSecret:t.secret});case r.TOGGLE_PARTICIPANTS_KICK:return(0,a.__assign)((0,a.__assign)({},e),{participantKick:t.data?{participant:t.data.participant,type:t.data.type}:null});case r.UNBAN_PARTICIPANTS:return(0,a.__assign)((0,a.__assign)({},e),{membersUnban:t.data?{members:t.data.members}:null});case r.TOGGLE_PARTICIPANTS_MANAGEMENT:return(0,a.__assign)((0,a.__assign)({},e),{participantsManagement:t.data?{mode:t.data.mode,participant:t.data.participant}:null});case r.TOGGLE_ADMIN_ASSIGNMENT:return(0,a.__assign)((0,a.__assign)({},e),{adminAssignment:t.data?{participant:t.data.participant}:null});case r.SET_NOISE_CANCELLATION:return(0,a.__assign)((0,a.__assign)({},e),{noiseCancellation:t.data});case r.CHANGE_LOCAL_VIDEO_RESOLUTION:return(0,a.__assign)((0,a.__assign)({},e),{localVideoResolution:t.data});case r.SET_CONVERSATION_OPTIONS:return(0,a.__assign)((0,a.__assign)({},e),{conversationOptions:t.data});case r.SET_PRIVACY_SETTINGS:return(0,a.__assign)((0,a.__assign)({},e),{privacySettings:t.data});case r.SET_GROUP:return(0,a.__assign)((0,a.__assign)({},e),{groupId:t.groupId,meGroup:t.meGroup});case r.SET_WAITING_HALL:return(0,a.__assign)((0,a.__assign)({},e),{waitingHall:t.data});case r.SET_LOCAL_STATUS:return(0,a.__assign)((0,a.__assign)({},e),{localStatus:t.data});case r.SET_PUSH_TO_TALK_ENABLE:return(0,a.__assign)((0,a.__assign)({},e),{pushToTalkEnabled:t.data});case r.SET_GRID_SCROLL_POSITION:return(0,a.__assign)((0,a.__assign)({},e),{gridScrollPosition:t.position,gridScrollFirstVisible:t.firstVisible});case r.SET_ORATOR_SCROLL_POSITION:return(0,a.__assign)((0,a.__assign)({},e),{oratorScrollPosition:t.position,oratorScrollFirstVisible:t.firstVisible,oratorScrollNumberOfVisible:t.numberOfVisible});case r.SET_SHOW_DESKTOP_NOTIFICATION:return(0,a.__assign)((0,a.__assign)({},e),{shouldShowDesktopAppNotification:t.data});case r.SET_SHOW_WARNING_DESKTOP_NOTIFICATION:return(0,a.__assign)((0,a.__assign)({},e),{shouldShowWarningDesktopAppNotification:t.data});case r.SET_START_OPTIONS:return(0,a.__assign)((0,a.__assign)({},e),{startOptions:t.data});case r.VB_SET_USER_PHOTOS:return p(e,{photos:(0,a.__spreadArray)([],(0,a.__read)(t.photos))});case r.VB_ADD_USER_PHOTO:return p(e,{photos:(0,a.__spreadArray)([t.photo],(0,a.__read)(e.virtualBackgroundSettings.photos))});case r.VB_REMOVE_USER_PHOTO:return p(e,{photos:e.virtualBackgroundSettings.photos.filter((function(e){return e.id!==t.photoId}))});case r.VB_SET_VIDEO_OPTIONS:return p(e,{videoOptions:t.videoOptions});case r.SET_CALL_PERMISSIONS:var k=t.data;return k[s.MediaOption.AUDIO]===e.permissions[s.MediaOption.AUDIO]&&k[s.MediaOption.VIDEO]===e.permissions[s.MediaOption.VIDEO]&&k[s.MediaOption.SCREEN_SHARING]===e.permissions[s.MediaOption.SCREEN_SHARING]?e:(0,a.__assign)((0,a.__assign)({},e),{permissions:t.data});case r.CLEAN_LAST_CALL_DATA:return _(e,{opponentName:void 0,isMeEndedCallForAll:void 0});case r.SET_LAST_CALL_DATA:return _(e,t.data)}return e}function d(e,t,n){var r;return(0,a.__assign)((0,a.__assign)({},e),{participants:(0,a.__assign)((0,a.__assign)({},e.participants),(r={},r[t]=(0,a.__assign)((0,a.__assign)({},e.participants[t]),n),r))})}function p(e,t){return(0,a.__assign)((0,a.__assign)({},e),{virtualBackgroundSettings:(0,a.__assign)((0,a.__assign)({},e.virtualBackgroundSettings),t)})}function _(e,t){return(0,a.__assign)((0,a.__assign)({},e),{lastCallData:(0,a.__assign)((0,a.__assign)({},e.lastCallData||{}),t)})}},329538:(e,t,n)=>{"use strict";n.d(t,{loadCallPeers:()=>d,retryLoadCallPeers:()=>f,loadChatMembers:()=>g,getCallAuthToken:()=>A,getCallUrlLink:()=>v,getJoinLinkDetails:()=>h,loadFriends:()=>E,forceCallFinish:()=>C,getConversationsByCall:()=>S,getAnonymCallToken:()=>y,getCallParticipants:()=>T,videoStartStreaming:()=>I,getGroupById:()=>b,getUpcomingLives:()=>N,getVideos:()=>w,sendVideoEdit:()=>L,loadUsers:()=>P,logCallReceived:()=>k,videoLiveGetSpectators:()=>M,stopVideoStream:()=>O,loadPrivacySettings:()=>D,getGroupsForCall:()=>R,getGroupMembers:()=>B,searchGroupMembers:()=>x,getCallParticipantsApiCall:()=>U,getGroupsForStreaming:()=>H,getCurrentCalls:()=>G,getCallsHistory:()=>V,photosGetAllImages:()=>F,photosSaveBackgroundPhoto:()=>z,photosDelete:()=>j,getFriends:()=>K,friendsSearch:()=>Y});var a=n(570655),r=n(298811),i=n(641196),o=n(464380),l=n(296951),s=["photo_200","sex","screen_name","first_name_gen"].join(","),c=["photo_200","sex","screen_name","first_name_gen"].join(","),u=["name","photo_100","photo_200","can_upload_video"].join(","),d=function(e){return(0,i.getApiWrapper)()()("messages.getConversationsById",{peer_ids:[e],extended:1,fields:c})},p=0,_=[],m=[],f=(0,r.exponentialRetry)((function(e,t){return void 0===t&&(t=50),_.push(e),new Promise((function(e){m.push(e),p||(p=window.setTimeout((function(){(function(e){return(0,i.getApiWrapper)()()("messages.getConversationsById",{peer_ids:e,extended:1,fields:c})})(_).then((function(e){m.forEach((function(t){t(e)})),m=[]})),_=[],p=0}),t))}))})),g=function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getConversationMembers",data:{peerId:e}}),(0,i.getApiWrapper)()()("messages.getConversationMembers",{peer_id:e,fields:s.concat(",can_call")}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getConversationMembers",data:e}),e}))},A=function(e,t){return void 0===t&&(t=0),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallToken",data:{isDev:e,groupId:t}}),(0,i.getApiWrapper)()()("messages.getCallToken",{env:e?"development":"production",group_id:t},{version:"5.149"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallToken",data:e}),e}))},v=((0,r.exponentialRetry)(A),function(e,t,n){void 0===n&&(n=0);var a={call_id:e,invalidate:t?1:0,group_id:n};return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallToken",data:a}),(0,i.getApiWrapper)()()("messages.getJoinLink",a).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getJoinLink",data:e}),e}))}),h=function(e,t){return void 0===t&&(t=!1),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallPreview",data:{link:e,fields:c,device_id:"anyId"}}),(0,i.getApiWrapper)(!t)()("messages.getCallPreview",{link:e,fields:c,device_id:"anyId"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallPreview",data:e}),e}))},E=function(){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"friends.get",data:{fields:s,order:"hints"}}),(0,i.getApiWrapper)()()("friends.get",{fields:s.concat(",can_call"),order:"hints"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"friends.get",data:e}),e}))},C=function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.forceCallFinish",data:{call_id:e}}),(0,i.getApiWrapper)()()("messages.forceCallFinish",{call_id:e}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.forceCallFinish",data:e}),e}))},S=function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getConversationsByCall",data:{call_ids:e,fields:c}}),(0,i.getApiWrapper)()()("messages.getConversationsByCall",{call_ids:e,fields:c}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getConversationsByCall",data:e}),e}))},y=function(e,t,n,a){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getAnonymCallToken",data:{link:e,user_id:t,name:n,secret:a,device_id:"anyId"}}),(0,i.getApiWrapper)(!1)()("messages.getAnonymCallToken",{link:e,user_id:t,name:n,secret:a,device_id:"anyId"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getAnonymCallToken",data:e}),e}))},T=function(e,t,n,a,o){void 0===a&&(a=!1);for(var l=[],s=Array.from(new Set(t));s.length;)s.length>1e3?(l.push(s.slice(0,1e3)),s=s.slice(1e3)):(l.push(s),s=[]);var u=(0,r.exponentialRetry)((function(t,r){var o=a?{call_id:e,peer_ids:r.join(","),fields:c,device_id:"anyId",secret:t.secret,user_id:n}:{call_id:e,peer_ids:r.join(","),fields:c};return(0,i.getApiWrapper)(!a)()("messages.getCallParticipants",o,{version:"5.149"}).then((function(e){return{count:e.count+t.count,secret:e.secret,profiles:(t.profiles||[]).concat(e.profiles||[]),anonyms:(t.anonyms||[]).concat(e.anonyms||[]),groups:(t.groups||[]).concat(e.groups||[])}}))})),d=Promise.resolve({secret:o,count:0});return l.reduce((function(e,t){return e.then((function(e){return u(e,t)}))}),d)},I=function(e){return(0,i.getApiWrapper)()()("video.startStreaming",e)},b=function(e){return(0,i.getApiWrapper)()()("groups.getById",{group_id:e,fields:u},{version:"5.149"})},N=function(e){return(0,i.getApiWrapper)()()("video.getUpcomingLives",{owner_ids:e})},w=function(e,t,n){return(0,i.getApiWrapper)()()("video.get",{owner_id:e,videos:t,need_privacy:n})},L=function(e,t,n,a,r){return(0,i.getApiWrapper)()()("video.edit",{owner_id:e,video_id:t,name:n,desc:a,privacy_view:r})},P=function(e){return(0,i.getApiWrapper)()()("users.get",e)},k=function(e){return(0,i.getApiWrapper)()()("messages.callReceived",{call_id:e})},M=function(e){return(0,i.getApiWrapper)()()("video.liveGetSpectators",{owner_id:e.owner_id,video_id:e.video_id})},O=function(){return(0,o.stopStream)()},D=function(e){return(0,i.getApiWrapper)()()("account.getPrivacySettings",e)},R=function(){return(0,i.getApiWrapper)()()("messages.getGroupsForCall",{count:200})},B=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=10);var a={fields:s.concat(",can_call_from_group"),group_id:e,offset:t,count:n,sort:"time_asc"};return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"groups.getMembers",params:a}),(0,i.getApiWrapper)()()("groups.getMembers",a).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"groups.getMembers",data:e}),e}))},x=function(e,t){return void 0===t&&(t=""),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"users.search",data:{groupId:e,q:t}}),(0,i.getApiWrapper)()()("users.search",{fields:s.concat(",can_call_from_group"),group_id:e,q:t}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"users.search",data:e}),e}))};function U(e,t,n,r,l){void 0===n&&(n=!1),void 0===r&&(r=""),void 0===l&&(l=0);var s={call_id:e,peer_ids:t.join(","),fields:c};return n&&(s=(0,a.__assign)((0,a.__assign)({},s),{device_id:"anyId",secret:r,user_id:l})),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallParticipants",data:s}),(0,i.getApiWrapper)(!n)()("messages.getCallParticipants",s,{version:"5.149"}).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallParticipant",response:e}),e}))}function H(){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"video.getGroupsForStreaming"}),(0,i.getApiWrapper)()()("video.getGroupsForStreaming",null).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"video.getGroupsForStreaming",response:e}),e}))}function G(e){void 0===e&&(e=s);var t={fields:e};return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCurrentCalls",data:t}),(0,i.getApiWrapper)()()("messages.getCurrentCalls",t).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCurrentCalls",response:e}),e}))}function V(e,t,n,a){void 0===e&&(e=5),void 0===t&&(t=0),void 0===n&&(n=0),void 0===a&&(a="all");var r={count:e,start_from:t,fields:s+",last_name_gen",filter:a,group_id:n};return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallHistory",data:r}),(0,i.getApiWrapper)()()("messages.getCallHistory",r).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallHistory",response:e}),e}))}var F=function(e){void 0===e&&(e={});var t=(0,i.getApiWrapper)(!0)();return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"photos.get",params:e}),t("photos.get",(0,a.__assign)({album_id:"-166"},e)).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"photos.get",response:e}),e}))},W=function(e){return["error_msg","error_code"].some((function(t){return(0,l.get)(t,e)}))?Promise.reject(e):Promise.resolve(e)},z=function(e){var t=(0,i.getApiWrapper)(!0)(),n=(0,i.getApiWrapper)(!0)();return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"photos.getCallBackgroundsPhotoUploadServer"}),t("photos.getCallBackgroundsPhotoUploadServer",{}).then(W).then((function(t){(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"photos.getCallBackgroundsPhotoUploadServer",response:t});var n=new FormData;return n.append("file1",e,e.name),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"[photoUploadUrl] "+t.upload_url,formData:n}),fetch(t.upload_url,{method:"POST",body:n}).then((function(e){return e.json()})).then(W)})).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"[photoUploadUrl]",json:e}),(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"photos.saveBackgroundPhoto",json:e}),n("photos.saveBackgroundPhoto",{response_json:JSON.stringify(e)})})).then(W)},j=function(e){var t=(0,i.getApiWrapper)(!0)();return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"photos.delete",params:e}),t("photos.delete",e).then(W)},K=function(e,t,n){void 0===e&&(e=10),void 0===t&&(t=0),void 0===n&&(n="hints");var a={fields:s.concat(",can_call,online_info"),count:e,offset:t,order:n};return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"friends.get",data:a}),(0,i.getApiWrapper)()()("friends.get",a).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"friends.get",data:e}),e}))},Y=function(e,t,n,a){void 0===t&&(t=""),void 0===n&&(n=10),void 0===a&&(a=0);var r={user_id:e,q:t,fields:s.concat(",can_call,online_info"),count:n,offset:a};return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"request",method:"friends.search",data:r}),(0,i.getApiWrapper)()()("friends.search",r).then((function(e){return(0,o.debugMessage)(o.DebugMessageType.DEBUG,{type:"response",method:"friends.search",data:e}),e}))}},394886:(e,t,n)=>{"use strict";n.d(t,{openDesktopDeepLink:()=>r});var a=n(233194);function r(e){return new Promise((function(t,n){if(a.Platform.isMobile)n("is_mobile");else if(document.body.focus(),"hidden"===document.visibilityState||document.hidden)n("hidden_page");else{var r,i=function(){r&&clearTimeout(r),window.removeEventListener("blur",i),t(!0)};if(window.addEventListener("blur",i),r=setTimeout((function(){window.removeEventListener("blur",i),n("timed_out")}),3e3),a.Platform.BROWSER===a.BROWSER.SAFARI||a.Platform.BROWSER===a.BROWSER.FIREFOX){var o=document.createElement("iframe");o.style.display="none",document.body.appendChild(o);var l=o.contentWindow;l?(l.location.href=e,setTimeout((function(){o.parentNode&&o.parentNode.removeChild(o)}),100)):window.location.href=e}else window.location.href=e}}))}},834735:(e,t,n)=>{"use strict";function a(e){return new Promise((function(t,n){var a=new Image;a.src=e,a.onload=t,a.onerror=n}))}function r(e){return Promise.resolve(e)}n.d(t,{preloadImage:()=>a,preloadImagesFromResponse:()=>r})},431469:(e,t,n)=>{"use strict";n.d(t,{useIndexer:()=>o,usePseudoLayer:()=>l,useFullScreen:()=>s});var a=n(570655),r=n(667294),i=n(337057),o=function(e,t,n){var o=(0,r.useRef)(null);o.current=o.current?o.current:new i.VkIndexer(e,t);var l=o.current,s=(0,r.useCallback)((function(e){return e.reduce((function(e,t){return e[n(t)]=!0,e}),{})}),[]),c=(0,a.__read)((0,r.useState)(e),2),u=c[0],d=c[1],p=(0,a.__read)((0,r.useState)(s(e)),2),_=p[0],m=p[1];return(0,r.useEffect)((function(){var t=s(e),a=e.filter((function(e){return!_[n(e)]})),r=u.filter((function(e){return!t[n(e)]}));(a.length||r.length)&&(a.forEach((function(e){l.add(e)})),r.forEach((function(e){l.remove(e)})),d(e),m(t))}),[e]),l};function l(){(0,r.useEffect)((function(){return document.body.classList.add("layers_shown"),function(){document.body.classList.remove("layers_shown")}}),[])}var s=function(e,t,n,a){void 0===a&&(a=[]);var i=window.document,o=i.documentElement,l=o.requestFullscreen||o.webkitRequestFullscreen;if(l){var s=!o.requestFullscreen,c=s?i.webkitExitFullscreen:i.exitFullscreen,u=s?"webkitfullscreenchange":"fullscreenchange",d=s?"webkitFullscreenElement":"fullscreenElement";(0,r.useEffect)((function(){var e=function(){i.fullscreenElement?t&&t():n&&n()};return i.addEventListener(u,e),function(){return i.removeEventListener(u,e)}}),[]),(0,r.useEffect)((function(){e&&!i[d]?l.call(i.documentElement):!e&&i[d]&&c.call(i)}),a)}}},259684:(e,t,n)=>{"use strict";n.d(t,{isCollapsedLayout:()=>r});var a=n(121255);function r(e){return e.uiMode===a.UIMode.COLLAPSED}},89085:(e,t,n)=>{"use strict";n.d(t,{longpollService:()=>m});var a=n(570655),r=n(121255),i=n(298811),o=n(788822),l=n(834735),s=n(862191),c=n(614914),u=n(389953),d=n(745284),p=n(820717),_=n(329538);function m(e,t,n,l){var m=l.dispatch,A=function(){for(var A=[],v=0;v<arguments.length;v++)A[v]=arguments[v];A.forEach((function(e){e.type===r.INCOMING_CALL&&(0,_.logCallReceived)(e.payload.call_id)}));var h=l.getState();f(h,m,e,A,n).then((function(){A.forEach((function(n){switch(n.type){case r.INCOMING_CALL:if(g(h,n))l.getState().ipSettingEnabled&&t.forceRelayPolicy(!n.payload.p2p_allowed),t.processPush(n.payload.call_id).then((function(){var e=JSON.parse((0,o.decodeHTMLEntities)(n.payload.payload)),t=e.is_video?r.CallType.VIDEO:r.CallType.AUDIO,l=(0,i.getPeerIdFromLongpoll)(n.payload),u=(0,i.isGroupCallEvent)(n);l<0&&(u=e.with_join_link),m({type:r.CHANGE_MODE,mode:r.Mode.INCOMING,peerId:l<0&&u?0:l,data:(0,a.__assign)((0,a.__assign)({},n.payload),{type:t,payload:e})}),s.callStatDataStorage.set({timeStart:Date.now(),startType:t}),c.callStats.logEvent({call_event_type:r.CallActionEventType.INCOMING_CALL_RECEIVED,session_id:n.payload.call_id,peer_id:l,is_group_call:u,reason:e.is_video?r.CallType.VIDEO:r.CallType.AUDIO})})).catch((function(t){if(e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),e.debug)if("object"==typeof t){var n=t.hangup,a=t.message;console.error("Push process error",n,a)}else console.error("Push process error",t)}));else if(n.type===r.INCOMING_CALL){var _=function(t){e.eventHandlers.onError&&t&&e.eventHandlers.onError(new Error(t)),e.debug&&console.warn("Incoming push skipped:",t,n)};switch(!0){case!n.payload.call_id:_("old lib call");break;case h.mode===r.Mode.CALL||h.mode===r.Mode.INCOMING:_("already in a call"),t.processPush(n.payload.call_id).then((function(){e.eventHandlers.onError&&e.eventHandlers.onError(new Error("processPush was incorrect accepted with call_id: "+n.payload.call_id)),e.debug&&console.warn("processPush was incorrect accepted",n.payload.call_id)})).catch((function(t){e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),e.debug&&console.warn("processPush rejected:",t,n.payload.call_id)}));break;default:_("reason of decline is unknown")}}break;case r.ADD_MESSAGE:var f=l.getState(),A=(0,u.isChatPeer)(f.peer),v=f.callData.callId;if(f.peer!==n.peerId||n.flags&r.FLAG_OUTBOUND||f.me===n.userId||m({type:r.SET_UNREAD_COUNT,chatUnreadCount:f.chatUnreadCount?f.chatUnreadCount+1:1}),A||!(0,d.isActiveGroupCallMessage)(n))return;var E=n.peerId;if(v===n.kludges.attach1_call_id)return(0,p.loadCallPeersWithWaitingImagesAction)(l.getState(),m,E);break;case r.READ_INBOUND:null!==n.chatUnreadCount&&l.getState().peer===n.peerId&&m({type:r.SET_UNREAD_COUNT,chatUnreadCount:n.unread,chatUpToMsgId:n.upToId});break;case r.SET_FLAGS:(f=l.getState()).peer===n.peerId&&null!==f.chatUpToMsgId&&n.messageId>f.chatUpToMsgId&&!(n.flags&r.FLAG_OUTBOUND)&&(n.flags&r.FLAG_DELETED||n.flags&r.FLAG_SPAM)&&m({type:r.SET_UNREAD_COUNT,chatUnreadCount:f.chatUnreadCount?f.chatUnreadCount-1:0});break;case r.DELETE_DIALOG:l.getState().peer===n.peerId&&m({type:r.SET_UNREAD_COUNT,chatUnreadCount:0,chatUpToMsgId:null});break;case r.EDIT_MESSAGE:case r.REPLACE_MESSAGE:(f=l.getState()).peer===n.peerId&&null!==f.chatUpToMsgId&&n.messageId>f.chatUpToMsgId&&n.kludges.is_expired&&m({type:r.SET_UNREAD_COUNT,chatUnreadCount:f.chatUnreadCount?f.chatUnreadCount-1:0});break;case r.CONVERSATION_UPDATED:E=n.peerId;var C=n.updateType;if(l.getState().peer!==E)return;if(C!==r.MAIL_CHAT_UPDATE_TYPE_CALL_IN_PROGRESS_CHANGED)return;void 0!==l.getState().callData.canFinishCall&&l.getState().callData.hasUrlLink||(0,p.loadActiveCallDataAction)(l.getState(),m,E)}}))})).catch((function(t){e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),e.debug&&console.error("Resource loading error",t),A.forEach((function(e){switch(e.type){case r.INCOMING_CALL:if(!g(h,e))return;m({type:r.ERROR,text:n("calls_incoming_process_error"),handleType:r.ErrorHandleType.PROCESS,callId:e.payload.call_id})}}))}))};if(e.handleEvent=A,void 0!==window.Notifier){var v=window.Notifier.getLpInstance();v&&v.onData(A)}}function f(e,t,n,a,s){var c=a.reduce((function(a,c){switch(c.type){case r.INCOMING_CALL:if(!g(e,c)){a.push(Promise.resolve());break}var u=(0,i.isGroupCallEvent)(c),_=u,m=(0,i.convertCallerFromLongpoll)(c.payload);if(!u&&m.peerId<0)JSON.parse((0,o.decodeHTMLEntities)(c.payload.payload)).with_join_link&&(_=!0);if(_){var f=u?(0,i.convertChatFromLongpoll)(c.payload):(0,d.getDefaultConversation)(s);if(t({type:r.LOAD_PEERS,conversation:f,members:[m],peerId:f.peerId,caller:u?f:m}),f.photo&&a.push((0,l.preloadImage)(f.photo)),u){var A=(0,p.loadCallPeersWithoutWaitingImagesAction)(e,t,n,f.peerId);a.push(A)}}else t({type:r.LOAD_PEERS,conversation:m,members:[m],peerId:m.peerId});m.photo&&a.push((0,l.preloadImage)(m.photo))}return a}),[]);return Promise.all(c)}function g(e,t){return function(e){return!!e.payload.call_id}(t)&&e.mode!==r.Mode.INCOMING&&e.mode!==r.Mode.CALL}},147853:(e,t,n)=>{"use strict";n.d(t,{setNeedPushToTalkToggleAudio:()=>s,pushToTalkToggleAudio:()=>c,pushToTalkActivate:()=>u,pushToTalkDeactivate:()=>d,onPushToTalkHandler:()=>m});var a=n(745284),r=n(121255),i=n(464380),o=!1,l=!0;function s(e){l=e}function c(e,t,n){if(void 0===n&&(n=!0),l)if(e){var a=!(!t||!t.isAudioEnabled);n&&(o=a),a&&(0,i.toggleLocalAudio)(!1)}else o&&(0,i.toggleLocalAudio)(!0);else s(!0)}function u(e){window.addEventListener("keydown",e),window.addEventListener("keyup",e)}function d(e){window.removeEventListener("keydown",e),window.removeEventListener("keyup",e)}var p,_=!1;function m(e,t,n,o){var l=e.keyCode,s=e.type,c=e.repeat,u="keydown"===s;if(32===l){if(e&&e.target){if(["FCComposer__input","FCSearch__input","fc_editable","fc_clist_filter_text"].some((function(t){return e.target.classList.contains(t)})))return}if(e.preventDefault(),c)return;if(_)return clearTimeout(p),void(_=!1);_=!0,p=setTimeout((function(){(function(e,t,n,o){var l=function(){var t,i,l=(null===(t=o.notification)||void 0===t?void 0:t.type)===r.NotificationType.PUSH_TO_TALK,s=!1;if(e&&!l?s=!0:e&&l?s=(null===(i=o.notification)||void 0===i?void 0:i.data)!==(0,a.isIAmSpeaking)(o):!e&&l&&(s=!0),s){var c=null;e&&(c={type:r.NotificationType.PUSH_TO_TALK,timer:0,data:(0,a.isIAmSpeaking)(o)}),n({type:r.CALL_NOTIFICATION,notification:c})}};return e&&t||!e&&!t?Promise.resolve().then(l):(0,i.toggleLocalAudio)(e).then(l)})(u,t,n,o).then((function(){_=!1}))}),u?200:100)}}},253312:(e,t,n)=>{"use strict";n.d(t,{sdkService:()=>w,checkAuthByGroupId:()=>M,getCallStartErrorText:()=>B});var a=n(570655),r=n(121255),i=n(329538),o=n(298811),l=n(834735),s=n(387691),c=n(169610),u=n(525046),d=n(774351),p=n(389953),_=n(745284),m=n(170794),f=n(862191),g=n(614914),A=n(820717),v=n(307915),h=n(697483),E=n(768606),C=n(464380),S=n(604233),y=n(613335),T=n(719481),I=n(233194),b=n(421734),N=n(483379);function w(e,t,n,y,w,B){var G=y.dispatch,V=y.getState(),F=V.me,W=(0,o.compose)(O,o.startCallRetryWrapper.bind(null,P.bind(null,t,e,y))),z=(0,o.compose)(t.joinCallByLink,o.startCallRetryWrapper.bind(null,P.bind(null,t,e,y))),j=V.localVideoResolution===r.VideoResolutionTypes.SD?r.VideoHeight.SD:r.VideoHeight.HD,K=V.localVideoResolution===r.VideoResolutionTypes.SD?r.VideoWidth.SD:r.VideoWidth.HD,Y={apiKey:n.key,apiEnv:n.is_dev?"VIDEOTEST":"PROD",anonymToken:n.is_anonym?n.token:"",filteredMessages:!0,batchParticipantsOnStart:!0,participantStateMapped:!0,voiceParams:{speakerLevelMultiplier:1.3,smoothing:.5},domain:B?"vk_corp":void 0,videoTracksCount:V.config.enableVideoSlots?V.config.videoSlotsCount:void 0,videoMaxHeight:j,videoMaxWidth:K,videoEffectMaxHeight:j,videoEffectMaxWidth:K,debugLog:V.config.debugLog,consumerScreenTrack:V.config.enableScreenTrack,producerScreenTrack:V.config.enableProducerScreenTrack,onLocalStream:function(t,n){e.debug&&console.warn("onLocalStream",t,n),(0,E.throttleAccumulateDispatchParticipant)(G,F,{stream:t,mediaSettings:n}),f.callStatDataStorage.set({hadVideoEnabled:n.isVideoEnabled})},onLocalStreamUpdate:function(t,n){e.debug&&console.warn("onLocalStreamUpdate",t,n);var i=y.getState(),o=i.participants[F],l=o.mediaSettings,s=o.permissions,c={mediaSettings:t};if(s.audio!==r.MediaPermissionType.ONCE&&s.video!==r.MediaPermissionType.ONCE&&s.screenSharing!==r.MediaPermissionType.ONCE||(c.permissions={audio:s.audio,video:s.video,screenSharing:s.screenSharing},s.audio===r.MediaPermissionType.ONCE&&(null==l?void 0:l.isAudioEnabled)&&!t.isAudioEnabled&&(c.permissions.audio=r.MediaPermissionType.DENY),s.video===r.MediaPermissionType.ONCE&&(null==l?void 0:l.isVideoEnabled)&&!t.isVideoEnabled&&(c.permissions.video=r.MediaPermissionType.DENY),s.screenSharing===r.MediaPermissionType.ONCE&&(null==l?void 0:l.isScreenSharingEnabled)&&!t.isScreenSharingEnabled&&(c.permissions.screenSharing=r.MediaPermissionType.DENY)),(null==l?void 0:l.isVideoEnabled)!==c.mediaSettings.isVideoEnabled){var u={type:r.UPDATE_PARTICIPANT_MEDIA_SETTINGS,data:(0,a.__assign)((0,a.__assign)({},c),{participantId:F})};G(u)}else(0,E.throttleAccumulateDispatchParticipant)(G,F,c);t.isScreenSharingEnabled!==(null==l?void 0:l.isScreenSharingEnabled)&&(U(i,G,t.isScreenSharingEnabled,F),t.isScreenSharingEnabled?e.eventHandlers.onScreenSharingEnabled&&e.eventHandlers.onScreenSharingEnabled():e.eventHandlers.onScreenSharingDisabled&&e.eventHandlers.onScreenSharingDisabled()),f.callStatDataStorage.set({hadVideoEnabled:t.isVideoEnabled})},onRemoteStream:function(t,n){e.debug&&console.warn("onRemoteStream",t.id,n),(0,E.throttleAccumulateDispatchParticipant)(G,t.id,{stream:n})},onScreenStream:function(t,n){e.debug&&console.warn("onScreenStream",t,n);var a={screenSharingStream:t,mediaSettings:n};(0,E.throttleAccumulateDispatchParticipant)(G,F,a)},onRemoteScreenStream:function(t,n){e.debug&&console.warn("onRemoteScreenStream",t.id,n),(0,E.throttleAccumulateDispatchParticipant)(G,t.id,{screenSharingStream:n})},onConversation:function(n,i,o,l){var s,c,u,d,p,_;if(e.debug&&((0,C.debugMessage)(C.DebugMessageType.LOG,{type:"start call info",os:I.Platform.OS,arch:I.Platform.ARCH,isMobile:I.Platform.isMobile,browser:(0,I.getBrowserInfo)(),config:y.getState().config,cameras:t.browser.getCameras(),microphones:t.browser.getMicrophones(),hasMicrophonePermission:t.browser.hasMicrophonePermission(),hasCameraPermission:t.browser.hasCameraPermission(),screenHeight:window.screen.availHeight,screenWidth:window.screen.availWidth,windowHeight:window.screen.height,windowWidth:window.screen.width}),console.warn("onConversation",n,i,l)),!y.getState().callData.ts){var m=Date.now();G({type:r.TIME_START,data:m})}var f=y.getState().peer;if(0!==f&&(0,A.loadActiveCallDataAction)(V,G,f),l){G({type:r.LOAD_PEERS,members:l.map((function(e){return{peerId:Number(e.uid.id),mediaSettings:e.mediaSettings,status:e.status||C.ParticipantStatus.CONNECTING,statusData:e.participantState?H(e.participantState):void 0,wasConnected:!1}}))});try{for(var g=(0,a.__values)(l),v=g.next();!v.done;v=g.next()){var h=v.value,E=(null===(d=null===(u=V.participants[h.uid.id])||void 0===u?void 0:u.mediaSettings)||void 0===d?void 0:d.isScreenSharingEnabled)||!1;(null===(p=null==h?void 0:h.mediaSettings)||void 0===p?void 0:p.isScreenSharingEnabled)!==E&&U(V,G,null===(_=null==h?void 0:h.mediaSettings)||void 0===_?void 0:_.isScreenSharingEnabled,Number(h.uid.id),!0)}}catch(e){s={error:e}}finally{try{v&&!v.done&&(c=g.return)&&c.call(g)}finally{if(s)throw s.error}}}},onRemoteMediaSettings:function(t,n){var a,r,i,o=+t.id,l=y.getState(),s=null===(a=l.participants[o])||void 0===a?void 0:a.mediaSettings;if((null==s?void 0:s.isVideoEnabled)!==n.isVideoEnabled||(null==s?void 0:s.isAudioEnabled)!==n.isAudioEnabled||(null==s?void 0:s.isScreenSharingEnabled)!==n.isScreenSharingEnabled){e.debug&&console.warn("onRemoteMediaSettings",t.id,n);var c=(null===(i=null===(r=l.participants[o])||void 0===r?void 0:r.mediaSettings)||void 0===i?void 0:i.isScreenSharingEnabled)||!1;n.isScreenSharingEnabled!==c&&U(l,G,n.isScreenSharingEnabled,o,!0),(0,E.throttleAccumulateDispatchParticipant)(G,o,{mediaSettings:n}),f.callStatDataStorage.set({hadVideoEnabled:n.isVideoEnabled})}},onRemoteStatus:function(t,n,i){var o,l,s=y.getState(),c=n;e.debug&&console.warn("onRemoteStatus",t,n,i);var u=[],d={};try{for(var p=(0,a.__values)(t),_=p.next();!_.done;_=p.next()){var m=_.value,v=Number(m.id);s.participants[v]&&s.participants[v].mediaSettings&&s.participants[v].shortName||u.push(v),d[String(v)]={status:c,statusData:i}}}catch(e){o={error:e}}finally{try{_&&!_.done&&(l=p.return)&&l.call(p)}finally{if(o)throw o.error}}if(e&&u.length>0){var E=s.callData.callId||"",S={withConversation:!s.callData.conversation,awaitImages:!1};(0,A.loadCallParticipantsAccumulate)(s,G,e,E,u,S)}if(G({type:r.UPDATE_PARTICIPANTS_BATCH,data:d}),f.callStatDataStorage.set({connectionStep:c}),Number(null==t?void 0:t[0].id)===s.peer){var T=function(e,t){var n={call_event_type:e,session_id:s.callData.callId,peer_id:s.peer,is_group_call:!1};t&&(n.reason=t),g.callStats.logEvent(n)};if(c===C.ParticipantStatus.CONNECTED){if(T(r.CallActionEventType.CALL_CONNECTED),!s.participants[s.peer].wasConnected&&(0,h.isCreator)(s.participants[s.me])){var I=f.callStatDataStorage.get().startType;T(r.CallActionEventType.OUTGOING_CALL_ACCEPTED_REMOTELY,null==I?void 0:I.toString())}}else c===C.ParticipantStatus.WAITING&&T(r.CallActionEventType.OUTGOING_CALL_REMOTE_RINGING)}},onPermissionsError:function(n){if(e.debug&&console.warn("onPermissionsError",n),y.getState().mode===r.Mode.CALL){switch(n){case r.MediaError.CAMERA_PERMISSION:case r.MediaError.CAMERA_ACCESS:t.toggleLocalVideo(!1);break;case r.MediaError.MIC_ACCESS:case r.MediaError.MIC_NOT_FOUND:t.toggleLocalAudio(!1);break;case r.MediaError.SCREEN_PERMISSION:case r.MediaError.SCREEN_ACCESS:t.captureScreen(!1)}G({type:r.ERROR,text:(0,v.getMediaErrorMessage)(n,w)})}},onPermissionsRequested:function(){e.debug&&console.warn("onPermissionsRequested")},onRemoteRemoved:function(t){e.debug&&console.warn("onRemoteRemoved",t.id),G({type:r.REMOVE_USER,participantId:+t.id})},onCallState:function(t,n,i){var o,l,s;e.debug&&console.warn("onCallState",t,n,i);var c=i.id,u=i.direction,d=i.joinLink;if(!c||!y.getState().callData.callId){if(G({type:r.CALL_STATE,callData:{callId:c},joinLink:d}),!y.getState().peer){var p=Object.keys(y.getState().participants||{}).map((function(e){return Number(e)}));p.length&&(0,A.loadCallParticipantsAccumulate)(V,G,e,c,(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(p)),[y.getState().me]),{withConversation:!0,withChatMembers:!0,withCallParticipants:!0,awaitImages:!1})}!(0,_.isGroupCallByPeer)(y.getState().peer||0)||"JOINING"!==u&&"OUTGOING"!==u||g.callStats.logEvent({call_event_type:r.CallActionEventType.CALL_CONNECTED,session_id:c,peer_id:y.getState().peer||0,is_group_call:!0}),(null===(o=y.getState())||void 0===o?void 0:o.startOptions)&&(null===(s=null===(l=y.getState())||void 0===l?void 0:l.startOptions)||void 0===s?void 0:s.createLink)&&(0,A.loadAndCopyJoinLink)(G,c,y.getState().groupId)}},onRateNeeded:function(){e.debug&&console.warn("onRateNeeded")},onSpeakerChanged:function(t){var n=t.id;e.debug&&console.warn("onSpeakerChanged",n),G({type:r.SET_ORATOR,orator:+n})},onJoinStatus:function(t,n){e.debug&&console.warn("onJoinStatus",t,n)},onHangup:function(n,a){var i=n.hangup;e.debug&&console.warn("onHangup",i,a);var l=i&&![r.HANGUP_TYPE_CANCELED,r.HANGUP_TYPE_MISSED,r.HANGUP_TYPE_HUNGUP,r.HANGUP_TYPE_REMOVED].includes(i),s=y.getState(),c=i&&i===r.HANGUP_TYPE_HUNGUP,u=(0,_.isGroupCallByPeer)(s.peer);if(s.mode===r.Mode.CALL&&l||s.localStatus===C.ParticipantStatus.WAITING_HALL&&i===r.HANGUP_TYPE_REMOVED)G({type:r.HANGUP,data:i}),(0,d.pause)(r.HANGUP_DELAY,null).finally((function(){G({type:r.CHANGE_MODE,mode:r.Mode.READY});var e=r.CALL_HANGUP_MODAP_MAP[i];e&&G({type:r.TOGGLE_POPUP,data:e})}));else if(V.config.showFeedbackScreen&&c){var p=s.callData.ts,A=(p?Math.floor((Date.now()-p)/1e3):0)>10&&0===Math.floor(3*Math.random()),v=0===Math.floor(5*Math.random());u&&A||v?(G({type:r.MANAGEMENT,isOpen:!1}),G({type:r.CHANGE_MODE,mode:r.Mode.FEEDBACK})):s.mode!==r.Mode.ERROR&&G({type:r.CHANGE_MODE,mode:r.Mode.READY})}else s.mode!==r.Mode.ERROR&&G({type:r.CHANGE_MODE,mode:r.Mode.READY});e.isInActiveCall=!1;var h=(0,o.isInReconnect)(s);if(a=a||"",(0,m.addCallStatEvent)(i,a,h,e.debug),!h&&!u){var E="none";i===C.HangupType.MISSED?E="timeout":i===C.HangupType.BUSY&&(E="busy");var S=s.callData.conversation,T={call_event_type:r.CallActionEventType.CALL_DECLINED_OR_HANGED_REMOTELY,session_id:a,peer_id:(null==S?void 0:S.peerId)||0,is_group_call:!1,reason:E};g.callStats.logEvent(T)}e.authorizedGroupId&&function(e,t,n,a){M(e,t,n,0,a)}(t,e,y,G),f.callStatDataStorage.reset(),(0,b.sendVirtualBackgroundDisabled)(s)},onCallAccepted:function(){e.debug&&console.warn("onCallAccepted"),(0,_.isGroupCallByPeer)(y.getState().peer)&&g.callStats.logEvent({call_event_type:r.CallActionEventType.CALL_CONNECTED,session_id:y.getState().callData.callId,peer_id:y.getState().peer,is_group_call:(0,_.isGroupCallByPeer)(y.getState().peer)})},onTokenExpired:function(){e.debug&&console.warn("onTokenExpired"),(e.tokenAttempts||0)<3&&(P(t,e,y),e.tokenAttempts=(e.tokenAttempts||0)+1)},onDeviceChange:function(){e.debug&&console.warn("onDeviceChange")},onMultipartyChatCreated:function(){e.debug&&console.warn("onMultipartyChatCreated")},onFingerprintChange:function(t){e.debug&&console.warn("onFingerprintChange",t)},onVolumesDetected:(0,s.volumesDetectorGenerator)({onUpdate:function(e){G({type:r.SET_SPEAKERS,data:e})},volumeLevelDetection:r.VOLUME_LEVEL_DETECTION,debugCallback:function(){e.debug}}),onLocalVolume:(0,s.localVolumeDetectorGenerator)({onVolumeLevelReached:function(){var e=y.getState();G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.SPEAKING_ON_MUTE}}),g.callStats.logEvent({call_event_type:r.CallActionEventType.MIC_OFF_WHILE_TALKING_ALERT,session_id:e.callData.callId,peer_id:e.peer,is_group_call:(0,_.isGroupCallByPeer)(e.peer)})},onVolumeLevelUpdated:function(e){var t,n=null===(t=y.getState().participants[F].mediaSettings)||void 0===t?void 0:t.isAudioEnabled,a=y.getState().speakers,i=Object.assign({},a);e&&n?i[F]=!0:e||delete i[F],i[F]!==a[F]&&G({type:r.SET_SPEAKERS,data:{speakers:i}})},needCheckMicEnabled:!0,volumeLevelDetection:r.VOLUME_LEVEL_DETECTION,vectorLength:5,callbackFactorStep:0,sensitivityCoefficient:.45,debugCallback:function(){e.debug}}),onChatMessage:function(t,n,a){e.debug&&console.warn("onChatMessage",t,n,a)},onCustomData:function(t,n){e.debug&&console.warn("onCustomData",t,n)},onNetworkStatusChanged:function(t){var n,r;if(e.debug&&console.warn("onNetworkStatusChanged",t),(0,_.isGroupCallByPeer)(V.peer)&&V.config.badNetwork||!(0,_.isGroupCallByPeer)(V.peer)&&V.config.badNetworkP2P)try{for(var i=(0,a.__values)(t),o=i.next();!o.done;o=i.next()){var l=o.value;(0,E.throttleAccumulateDispatchParticipant)(G,+l.uid.id,{networkStatus:l.rating})}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},onLocalNetworkStatusChanged:function(t){e.debug&&console.warn("onLocalNetworkStatusChanged",t),((0,_.isGroupCallByPeer)(V.peer)&&V.config.badNetwork||!(0,_.isGroupCallByPeer)(V.peer)&&V.config.badNetworkP2P)&&(0,E.throttleAccumulateDispatchParticipant)(G,V.me,{networkStatus:t})},onDebugMessage:function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];e.debug&&console.warn.apply(console,(0,a.__spreadArray)(["onDebugMessage",t],(0,a.__read)(n)))},onRemoteParticipantState:function(t,n){var a,i,o,l,s,c;n=H(n);var u=t.id,d=!!(null===(o=null===(i=null===(a=y.getState().participants[u])||void 0===a?void 0:a.statusData)||void 0===i?void 0:i.hand)||void 0===o?void 0:o.state);if(d!==!!(null===(l=null==n?void 0:n.hand)||void 0===l?void 0:l.state)){e.debug&&console.warn("onRemoteParticipantState",t,n);var p=!!(null===(s=y.getState().participants[u])||void 0===s?void 0:s.name);(0,E.throttleAccumulateDispatchParticipant)(G,u,{statusData:n}),(null===(c=null==n?void 0:n.hand)||void 0===c?void 0:c.state)&&!d&&p&&G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.RAISED_HAND,data:u}})}},onRolesChanged:function(t,n){e.debug&&console.warn("onRolesChanged",t,n);var a=y.getState().participants[t.id];n.includes(C.UserRole.ADMIN)&&a&&G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.USER_GRANTED_WITH_ADMIN_ROLE,data:t.id}}),(0,E.throttleAccumulateDispatchParticipant)(G,t.id,{roles:n})},onLocalRolesChanged:function(t){e.debug&&console.warn("onLocalRolesChanged",t),(t.includes(C.UserRole.ADMIN)||t.includes(C.UserRole.CREATOR))&&(0,E.throttleAccumulateDispatchParticipant)(G,F,{permissions:{audio:r.MediaPermissionType.ALLOW,video:r.MediaPermissionType.ALLOW,screenSharing:r.MediaPermissionType.ALLOW}}),t.includes(C.UserRole.ADMIN)&&G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.ADMIN_ROLE_GRANTED}}),t.includes(C.UserRole.ADMIN)||t.includes(C.UserRole.CREATOR)?V.config.allowWaitingHall&&(0,_.isWaitingHallEnabled)(y.getState())&&(0,T.loadAdditionalWaitingHall)(y.getState(),G,!0):y.getState().waitingHall&&(0,T.clearWaitingList)(G),G({type:r.CHANGE_PARTICIPANT_ROLES,participantId:F,data:t})},onDeviceSwitched:function(t,n){e.debug&&console.warn("onDeviceSwitched",t,n)},onMuteStates:function(n,i,o,l,s,c){var u,d;e.debug&&console.warn("onMuteStates",n,i,o,l,s,c);var p=y.getState(),_=p.participants[p.me],m=_.permissions,f=m.audio,g=m.video,A=m.screenSharing,v=!!(null===(d=null===(u=_.statusData)||void 0===u?void 0:u.hand)||void 0===d?void 0:d.state);if(!s||Number(null==c?void 0:c.id)!==p.me&&null!==c){null===c&&G({type:r.SET_CALL_PERMISSIONS,data:n}),p.popup!==r.POPUP_UNMUTE_REQUEST&&p.popup!==r.POPUP_UNMUTE_AUDIO_REQUEST||G({type:r.TOGGLE_POPUP});var S=(0,h.isAdmin)(_)||(0,h.isCreator)(_),T=r.NotificationType.ADMIN_MUTE,I=n[C.MediaOption.AUDIO]===C.MuteState.MUTE?r.MediaPermissionType.ALLOW:n[C.MediaOption.AUDIO]===C.MuteState.MUTE_PERMANENT?r.MediaPermissionType.DENY:f,b=n[C.MediaOption.VIDEO]===C.MuteState.MUTE?r.MediaPermissionType.ALLOW:n[C.MediaOption.VIDEO]===C.MuteState.MUTE_PERMANENT?r.MediaPermissionType.DENY:g,N=n[C.MediaOption.SCREEN_SHARING]===C.MuteState.MUTE?r.MediaPermissionType.ALLOW:n[C.MediaOption.SCREEN_SHARING]===C.MuteState.MUTE_PERMANENT?r.MediaPermissionType.DENY:A;if(f!==I&&I===r.MediaPermissionType.DENY&&g!==b&&b===r.MediaPermissionType.DENY?T=S?r.NotificationType.ADMIN_MUTE:r.NotificationType.ADMIN_MUTE_PERMANENT:f!==I&&I===r.MediaPermissionType.DENY&&g===b?T=S?r.NotificationType.ADMIN_MUTE_AUDIO:r.NotificationType.ADMIN_MUTE_PERMANENT_AUDIO:f===I&&g!==b&&b===r.MediaPermissionType.DENY?T=S?r.NotificationType.ADMIN_MUTE_VIDEO:r.NotificationType.ADMIN_MUTE_PERMANENT_VIDEO:f!==I&&I===r.MediaPermissionType.ALLOW&&g!==b&&b===r.MediaPermissionType.ALLOW?T=S?null:r.NotificationType.ADMIN_UNMUTE_PERMANENT:f!==I&&I===r.MediaPermissionType.ALLOW&&g===b?T=S?null:r.NotificationType.ADMIN_UNMUTE_PERMANENT_AUDIO:f===I&&g!==b&&b===r.MediaPermissionType.ALLOW?T=S?null:r.NotificationType.ADMIN_UNMUTE_PERMANENT_VIDEO:o.includes(C.MediaOption.AUDIO)&&f===I&&I===r.MediaPermissionType.ALLOW&&o.includes(C.MediaOption.VIDEO)&&g===b&&b===r.MediaPermissionType.ALLOW?T=r.NotificationType.ADMIN_MUTE:o.includes(C.MediaOption.AUDIO)&&f===I&&I===r.MediaPermissionType.ALLOW&&g===b?T=r.NotificationType.ADMIN_MUTE_AUDIO:f===I&&o.includes(C.MediaOption.VIDEO)&&g===b&&b===r.MediaPermissionType.ALLOW&&(T=r.NotificationType.ADMIN_MUTE_VIDEO),null===T||Number(null==c?void 0:c.id)!==p.me&&null!==c||G({type:r.CALL_NOTIFICATION,notification:{type:T}}),(0,h.isAdmin)(_)||(0,h.isCreator)(_))return;(0,E.throttleAccumulateDispatchParticipant)(G,F,{permissions:{audio:I,video:b,screenSharing:N}})}else{if(v&&t.changeParticipantState({hand:r.SdkHandType.LOWERED}).catch(console.log),G({type:r.TOGGLE_POPUP,data:o.includes(C.MediaOption.VIDEO)?r.POPUP_UNMUTE_REQUEST:r.POPUP_UNMUTE_AUDIO_REQUEST}),(0,h.isAdmin)(_)||(0,h.isCreator)(_))return;var w=!l;(0,E.throttleAccumulateDispatchParticipant)(G,F,(0,a.__assign)({permissions:{audio:o.includes(C.MediaOption.AUDIO)?w?r.MediaPermissionType.ONCE:r.MediaPermissionType.ALLOW:f,video:o.includes(C.MediaOption.VIDEO)?w?r.MediaPermissionType.ONCE:r.MediaPermissionType.ALLOW:g,screenSharing:o.includes(C.MediaOption.SCREEN_SHARING)?w?r.MediaPermissionType.ONCE:r.MediaPermissionType.ALLOW:A}},v&&{statusData:(0,a.__assign)((0,a.__assign)({},_.statusData),{hand:{ts:Date.now(),state:!1}})}))}},onRecordStarted:function(t,n,a,i,o,l){e.debug&&console.warn("onRecordStarted",t,n,a,i);var s={isOn:!0,videoId:parseInt(o),ownerId:parseInt(l),host:t,startTime:a,link:"https://"+window.location.host+(0,S.getShortVideoUrl)(l,o),startStreamParams:void 0};G({type:r.SET_TRANSLATION,data:s})},onRecordStopped:function(){e.debug&&console.warn("onRecordStopped"),G({type:r.SET_TRANSLATION,data:{isOn:!1,hasPermission:!1}})},onLocalPin:function(t){var n;e.debug&&console.warn("onLocalPin",{unpin:t});var a=y.getState(),i=a.participants[F];t||G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.PINNED_BY_ADMIN}}),!t&&(0,h.isMutedPermanently)(i)&&(0,E.throttleAccumulateDispatchParticipant)(G,F,{permissions:{audio:r.MediaPermissionType.ONCE,video:r.MediaPermissionType.ONCE,screenSharing:r.MediaPermissionType.ONCE}}),t||(null===(n=i.mediaSettings)||void 0===n?void 0:n.isAudioEnabled)||G({type:r.TOGGLE_POPUP,data:r.POPUP_ADMIN_PIN_UNMUTE_REQUEST}),t||a.isOratorMode||G({type:r.TOGGLE_ORATOR_MODE,isOratorMode:!0}),G({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:t?null:F})},onPinnedParticipant:function(t,n){e.debug&&console.warn("onPinnedParticipant",t,n);var a=y.getState(),i=a.participants[t.id];!n&&i&&((null==i?void 0:i.shortName)||(null==i?void 0:i.name))&&G({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.USER_PINNED_BY_ADMIN,data:t.id}}),a.isOratorMode||G({type:r.TOGGLE_ORATOR_MODE,isOratorMode:!0}),G({type:r.SET_ADMIN_PINNED_PARTICIPANT,data:n?null:Number(t.id)})},onOptionsChanged:function(t){e.debug&&console.warn("onOptionsChanged",t),G({type:r.SET_CONVERSATION_OPTIONS,data:t})},onLocalStatus:function(t){e.debug&&console.warn("onLocalStatus",t);var n=y.getState(),o=n.callData,s=n.me;n.participants[s].status!==C.ParticipantStatus.WAITING_HALL||t!==C.ParticipantStatus.WAITING||(0,h.isParticipantAnonym)(s)||(null==o?void 0:o.callId)&&(0,i.getConversationsByCall)([o.callId]).then((function(e){var t=e.items,n=(0,a.__read)(t,1)[0].peer.id;return D(y,n,void 0).then((function(e){return(0,l.preloadImagesFromResponse)(e)})).then((function(){return n}))})).catch((function(e){var t;8===(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.error_code)&&Promise.resolve(0)})),G({type:r.SET_LOCAL_STATUS,data:t}),(0,E.throttleAccumulateDispatchParticipant)(G,n.me,{status:t,wasConnected:!0})},onChatRoomUpdated:function(t,n,a){e.debug&&console.warn("onChatRoomUpdated",t,n,a),t===C.ChatRoomEventType.ATTENDEE&&(0,T.loadWaitingHall)(n,a,y.getState(),G)}};e.authorized=!1,e.authorizedGroupId=0,e.debugMessage=C.debugMessage,e.call=function(e,t,n,a,i){var o=a.dispatch;return function(s,u,d,p,m){void 0===m&&(m=0);var A=(0,_.getMediaOptions)({video:u,audio:!0});return e.isInActiveCall?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(L):(e.isInActiveCall=!0,Promise.resolve().then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return k(e)})).then((function(){return M(t,e,a,m,o)})).then((function(){return(0,c.checkPermissions)(t,A)})).then((function(){return D(a,s,d)})).then((function(n){return Promise.all([(0,l.preloadImagesFromResponse)(n),i(e,t,a,A,s)])})).then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!1}),o({type:r.CHANGE_MODE,mode:r.Mode.CALL,peerId:s}),f.callStatDataStorage.set({timeStart:Date.now(),isOutgoingCall:!0,entryPoint:p,startType:u?r.CallType.VIDEO:r.CallType.AUDIO}),g.callStats.logEvent({call_event_type:u?r.CallActionEventType.OUTGOING_CALL_STARTED_VIDEO:r.CallActionEventType.OUTGOING_CALL_STARTED_AUDIO,session_id:a.getState().callData.callId,peer_id:s,is_group_call:!1,source:p,group_call_users_count:2}),R(a,s,d)})).catch((function(a){e.isInActiveCall=!1,o({type:r.SHOW_LOADER,isLoaderVisible:!1}),x(a,t,e,(0,_.isGroupCallByPeer)(s),n,o)})))}}(e,t,w,y,W),e.startGroupCall=function(e,t,n,a,i){var o=a.dispatch;return function(l,s,u,d,m,v,h){void 0===v&&(v=!0),void 0===h&&(h=null);var E=(0,_.getMediaOptions)({video:d,audio:!0}),C=u?u.filter(p.isUserPeer):[];return e.debug&&u&&u.length!==C.length&&console.warn("Some ids cannot get into the call.",u.filter((function(e){return!(0,p.isUserPeer)(e)}))),e.isInActiveCall?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(L):(e.isInActiveCall=!0,Promise.resolve().then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return k(e)})).then((function(){return M(t,e,a,0,o)})).then((function(){return(0,c.checkPermissions)(t,E)})).then((function(){return D(a,l,s)})).then((function(e){return(0,A.loadChatMembersAction)(a.getState(),o,l,e[0])})).then((function(){return i(e,t,a,E,l)})).then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!1}),o({type:r.CHANGE_MODE,mode:r.Mode.CALL,peerId:l}),v&&(C&&C.length?o({type:r.GROUP_CALL_SETUP,open:!0,peerId:l,preselectedIds:C}):o({type:r.MANAGEMENT,isOpen:!0})),h&&o({type:r.SET_TRANSLATION,data:{deferredId:h}}),R(a,l,s),f.callStatDataStorage.set({timeStart:Date.now(),isOutgoingCall:!0,startType:d?r.CallType.VIDEO:r.CallType.AUDIO,entryPoint:m,isGroupCall:!0}),g.callStats.logEvent({call_event_type:d?r.CallActionEventType.OUTGOING_CALL_STARTED_VIDEO:r.CallActionEventType.OUTGOING_CALL_STARTED_AUDIO,session_id:a.getState().callData.callId,peer_id:l,is_group_call:!0,source:m,group_call_users_count:1})})).catch((function(a){e.isInActiveCall=!1,o({type:r.SHOW_LOADER,isLoaderVisible:!1}),x(a,t,e,(0,_.isGroupCallByPeer)(l),n,o)})))}}(e,t,w,y,W),e.startCall=function(e,t,n,a,i){var o=a.dispatch;return function(s,u,d,p,m){void 0===d&&(d=!0),void 0===p&&(p=0),void 0===m&&(m={});var v=(0,_.getMediaOptions)({video:s,audio:!0});if(e.isInActiveCall)return Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(L);e.isInActiveCall=!0;var h=(0,_.getDefaultConversation)(n);return Promise.resolve().then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return k(e)})).then((function(){return M(t,e,a,p,o)})).then((function(){return(0,c.checkPermissions)(t,v)})).then((function(){return Promise.all([i(e,t,a,v),(0,l.preloadImagesFromResponse)([h])])})).then((function(){m&&m.conversationOptions&&Object.keys(m.conversationOptions).length>0&&t.changeConversationOptions(m.conversationOptions)})).then((function(){o({type:r.SHOW_LOADER,isLoaderVisible:!1}),o({type:r.LOAD_PEERS,conversation:h,members:[],peerId:0}),o({type:r.CHANGE_MODE,mode:r.Mode.CALL}),d&&o({type:r.MANAGEMENT,isOpen:!0});var e=a.getState().callData.callId;(null==m?void 0:m.createLink)&&(e?(0,A.loadAndCopyJoinLink)(o,e,p):o({type:r.SET_START_OPTIONS,data:m})),f.callStatDataStorage.set({timeStart:Date.now(),isOutgoingCall:!0,entryPoint:u,startType:s?r.CallType.VIDEO:r.CallType.AUDIO,isGroupCall:!0}),g.callStats.logEvent({call_event_type:s?r.CallActionEventType.OUTGOING_CALL_STARTED_VIDEO:r.CallActionEventType.OUTGOING_CALL_STARTED_AUDIO,session_id:e,peer_id:0,is_group_call:!0,source:u,group_call_users_count:1})})).catch((function(a){e.isInActiveCall=!1,o({type:r.SHOW_LOADER,isLoaderVisible:!1}),x(a,t,e,!0,n,o)}))}}(e,t,w,y,W),e.joinCallByLink=function(e,t,n,o,s){var u=o.dispatch;return function(d,p,m,f,A,v){void 0===m&&(m=!1),void 0===A&&(A=0),void 0===v&&(v=void 0);var E=(0,_.getMediaOptions)({video:m,audio:!0});return e.isInActiveCall?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(L):(e.isInActiveCall=!0,(0,h.isParticipantAnonym)(o.getState().me)?Promise.resolve().then((function(){u({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return k(e)})).then((function(){return(0,c.checkPermissions)(t,E)})).then((function(){return s(d,E).then((function(){u({type:r.SHOW_LOADER,isLoaderVisible:!1}),u({type:r.CHANGE_MODE,mode:r.Mode.CALL,joinLink:d})}))})).catch((function(a){e.isInActiveCall=!1,u({type:r.SHOW_LOADER,isLoaderVisible:!1}),x(a,t,e,!0,n,u)})):Promise.resolve().then((function(){u({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){return k(e)})).then((function(){return M(t,e,o,A,u)})).then((function(){return(0,c.checkPermissions)(t,E)})).then((function(){return s(d,E)})).then((function(e){var t=e.id;return(0,i.getConversationsByCall)([t])})).then((function(e){var t=e.items;if(!t||0===t.length)return 0;var n=(0,a.__read)(t,1)[0].peer.id;return D(o,n,p).then((function(e){return(0,l.preloadImagesFromResponse)(e)})),n})).catch((function(e){var t,n;if(8===(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.error_code))return 0;if(951===(null===(n=null==e?void 0:e.error)||void 0===n?void 0:n.error_code))return 0;throw e})).then((function(e){u({type:r.SHOW_LOADER,isLoaderVisible:!1}),u({type:r.CHANGE_MODE,mode:r.Mode.CALL,peerId:e,joinLink:d}),v&&u({type:r.SET_TRANSLATION,data:{deferredId:v}}),e&&R(o,e,p),g.callStats.logEvent({call_event_type:r.CallActionEventType.GROUP_CALL_JOINED,session_id:o.getState().callData.callId,peer_id:null!=e?e:0,is_group_call:!0,source:f,group_call_users_count:(0,h.getActiveParticipantsCount)(o.getState())})})).catch((function(a){e.isInActiveCall=!1,u({type:r.SHOW_LOADER,isLoaderVisible:!1}),x(a,t,e,!0,n,u)})))}}(e,t,w,y,z),e.showJoinPopup=function(e,t,n){var l=n.dispatch;return function(s,c){var u=n.getState().mode;return u===r.Mode.CALL||u===r.Mode.INCOMING?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch((function(){l({type:r.ERROR,text:t("calls_already_in_call_error")})})):(l({type:r.SHOW_LOADER,isLoaderVisible:!0}),(0,i.getJoinLinkDetails)(s).then(o.normalizePreviewData.bind(null,t)).then((function(e){l({type:r.SHOW_LOADER,isLoaderVisible:!1}),l({type:r.JOIN,data:(0,a.__assign)((0,a.__assign)({},e),{entryPoint:c})})})).catch((function(n){var a;e.eventHandlers.onError&&n&&e.eventHandlers.onError(n),e.debug&&console.warn("getJoinLinkDetails",n);var i=(0,o.getTextForApiErrorByCode)(null===(a=null==n?void 0:n.error)||void 0===a?void 0:a.error_code,!0,t);console.error(i),l({type:r.SHOW_LOADER,isLoaderVisible:!1}),l({type:r.ERROR,text:i,handleType:r.ErrorHandleType.FATAL})})))}}(e,w,y),e.acceptCall=function(e,t,n,a){var i=a.dispatch;return function(o,l){var s=a.getState(),u=s.peer,d=s.callData,p=(0,_.getMediaOptions)({video:o,audio:l});return(0,c.checkPermissions)(t,p).then((function(){return t.acceptCall(p)})).then((function(t){var n=t.acceptTime;i({type:r.CHANGE_MODE,mode:r.Mode.CALL,ts:n}),e.isInActiveCall=!0,g.callStats.logEvent({call_event_type:r.CallActionEventType.INCOMING_CALL_ACCEPTED,session_id:d.callId,peer_id:u,is_group_call:(0,_.isGroupCallByPeer)(u),reason:o?r.CallType.VIDEO:r.CallType.AUDIO})})).catch((function(t){i({type:r.ERROR,text:(0,v.getPermissionsErrorMessage)(o,!0,n),handleType:r.ErrorHandleType.DECLINE}),e.eventHandlers.onError&&t&&e.eventHandlers.onError(t),(0,C.debugMessage)(C.DebugMessageType.ERROR,t),console.error(t)}))}}(e,t,w,y),e.showCallByNamePopup=function(e,t,n,a){var i=a.dispatch;return function(e,t,o){var l=a.getState().mode;return l===r.Mode.CALL||l===r.Mode.INCOMING?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch((function(){i({type:r.ERROR,text:n("calls_already_in_call_error")})})):Promise.resolve().then((function(){i({type:r.SHOW_LOADER,isLoaderVisible:!0})})).then((function(){i({type:r.SHOW_LOADER,isLoaderVisible:!1}),i({type:r.CALL_BY_NAME,data:{peerId:e,joinLink:o,entryPoint:t}})})).catch((function(){i({type:r.SHOW_LOADER,isLoaderVisible:!1})}))}}(0,0,w,y),e.showCreateCallByLinkPopup=function(e,t,n,a){var i=a.dispatch;return function(e){var t=a.getState().mode;return t===r.Mode.CALL||t===r.Mode.INCOMING?Promise.reject(r.CallErrorType.ALREADY_IN_CALL).catch(L):Promise.resolve().then((function(){i({type:r.CHANGE_MODE,mode:r.Mode.CREATE_CALL,entryPoint:e})}))}}(0,0,0,y),e.store=y;var Q=(0,N.getWarningBrowserInfo)(V.config.browserWarnings);if(null==Q?void 0:Q.block){var Z=function(){return y.dispatch({type:r.CHANGE_MODE,mode:r.Mode.START})};e.call=Z,e.startGroupCall=Z,e.startCall=Z,e.acceptCall=Z,e.joinCallByLink=function(e){return y.dispatch({type:r.CHANGE_MODE,mode:r.Mode.START,joinLink:e})},e.showJoinPopup=Z,e.showCallByNamePopup=Z,e.showCreateCallByLinkPopup=Z}var J=n.token?Promise.resolve(n.token):(0,u.fetchToken)(n.is_dev);return J.then((function(n){return t.init(Y).then((function(){V.config.debugLog&&e.setDebug(!0)})).then((function(){return function(n){return Promise.resolve().then((function(){return(0,h.isParticipantAnonym)(y.getState().me)?Promise.resolve():t.authorize(n).then((function(){return(0,u.saveLocalToken)(n)})).then((function(){return e.authorized=!0})).catch((function(e){throw(0,u.removeLocalToken)(),e}))}))}(n)}))}))}function L(e){switch(e){case r.CallErrorType.ALREADY_IN_CALL:console.log("Already in call");break;default:console.log(e)}}function P(e,t,n){return function(e,t,n){return(0,i.getCallAuthToken)(n.getState().isDev).then((function(n){var a=n.token;return e.authorize(a).then((function(){return(0,u.saveLocalToken)(a)})).then((function(){return t.authorized=!0}))}))}(e,t,n).catch((function(e){t.eventHandlers.onError&&e&&t.eventHandlers.onError(e),console.error("Could not authorize with token request",e)}))}function k(e){return new Promise((function(t){e.initializing.finally((function(){t()}))}))}function M(e,t,n,a,o,l){return void 0===l&&(l=!1),new Promise((function(s,c){a||t.authorizedGroupId||s(),a&&t.authorizedGroupId===a&&s(),l||(g.callStats.setEventCommonData(),o({type:r.SET_GROUP_MEMBERS,groupMembersCount:0,groupMembers:[],unableToCallGroupMembersIds:[]})),(0,i.getCallAuthToken)(n.getState().isDev,a).then((function(n){var u=n.token;e.authorize(u).then((function(){t.authorizedGroupId=a,l?s():a?(0,i.getGroupById)(-a).then((function(e){if(e.groups){var t=e.groups[0];o({type:r.SET_GROUP,groupId:a,meGroup:(0,y.normalizeGroup)(t)}),g.callStats.setEventCommonData({group_id:a}),s()}})).catch((function(e){c(e)})):s()}))}))}))}function O(e,t,n,a,r,i){void 0===r&&(r=0),void 0===i&&(i=[]);var l=(0,o.createPayload)(r,a);if(!r)return t.callTo(void 0,a,l,!0);if(!(0,_.isGroupCallByPeer)(r))return G(e,n,r).then((function(e){return t.forceRelayPolicy(e),t.callTo(r.toString(),a,l)}));var s=i.filter((function(e){return e=Number(e),(0,p.isUserPeer)(e)&&e!==n.getState().me}));return t.callTo(s,a,l,!0)}function D(e,t,n){var l=e.dispatch;return!!n||t?(n?Promise.resolve((0,o.convertClientData)(n)):(0,i.retryLoadCallPeers)(t).then(o.convertServerData)).then((function(e){var n=(0,a.__read)(e,3),i=n[0],o=n[1],s=n[2];return(0,A.setActiveCallData)(l,s||i),l({type:r.LOAD_PEERS,conversation:i,members:o,peerId:t}),e})):Promise.reject("Cannot load data")}function R(e,t,n){var s=e.dispatch;return!!n&&t?(0,i.retryLoadCallPeers)(t).then((function(e){var t=(0,a.__read)((0,o.convertServerData)(e),2),n=t[0],r=t[1];return(0,A.setActiveCallData)(s,e.items[0]),(0,l.preloadImagesFromResponse)([n,r])})).then((function(e){var t=(0,a.__read)(e,2),n=t[0],i=t[1];s({type:r.LOAD_PEERS,conversation:n,members:i})})):Promise.resolve()}function B(e,t,n){switch(!0){case function(e){var t=e||{},n=t.hangup,a=t.message;return!(!n||!a)}(e):case function(e){var t=e||{},n=t.hangup;return t.message&&void 0===n}(e):return(0,o.getTextForServerError)(e.message,t,n);case function(e){var t;return["TypeError","SyntaxError","RangeError","EvalError","URIError"].includes(null===(t=null==e?void 0:e.__proto__)||void 0===t?void 0:t.name)}(e):return n("calls_error");case function(e){return!!e.error_msg}(e):return(0,o.getTextForServerError)(e.error_msg,t,n);case function(e){return"number"==typeof e}(e):return(0,o.getTextForClientError)(e,t,n);case function(e){return!!e}(e):default:return n("calls_sorry_error")}}function x(e,t,n,a,i,o){var l,s;try{var c=B(e,a,i);t.hangup(),n.eventHandlers.onError&&e&&n.eventHandlers.onError(e),(0,C.debugMessage)(C.DebugMessageType.ERROR,e),console.error(e),o({type:r.ERROR,text:c,handleType:r.ErrorHandleType.FATAL}),(null===(l=n.eventHandlers)||void 0===l?void 0:l.onErrorStartCall)&&(null===(s=n.eventHandlers)||void 0===s||s.onErrorStartCall())}catch(n){throw(0,C.debugMessage)(C.DebugMessageType.ERROR,n),console.error(n),t.hangup(),e}}function U(e,t,n,a,i){var o,l,s=Object.keys(e.screenSharers).filter((function(t){return e.screenSharers[t]})).length,c=function(n,a){var i=function(e){t({type:r.TOGGLE_ORATOR_MODE,isOratorMode:e})},o=function(e){t({type:r.SET_PINNED_PARTICIPANT,pinnedParticipant:e})};n&&!e.isOratorMode&&i(!0),!n&&e.screenSharingNeedDisableOratorModeAfterStop&&i(!1),t({type:r.SET_SCREEN_SHARING_PINNED_PARTICIPANT,screenSharingPinnedParticipant:a,screenSharingNeedDisableOratorModeAfterStop:!e.isOratorMode,screenSharingOldPinnedParticipant:e.pinnedParticipant}),a&&e.pinnedParticipant&&o(null),a||e.pinnedParticipant||!e.screenSharingOldPinnedParticipant||o(e.screenSharingOldPinnedParticipant)};0===s&&n?c(!0,a):1!==s||n||c(!(!e.adminPinnedParticipant&&!e.pinnedParticipant),null),!!(null===(l=null===(o=e.participants[a])||void 0===o?void 0:o.mediaSettings)||void 0===l?void 0:l.isScreenSharingEnabled)!==n&&t({type:r.SET_SCREEN_SHARER,participantId:a,isScreenSharingEnabled:n}),n&&i&&t({type:r.CALL_NOTIFICATION,notification:{type:r.NotificationType.SCREEN_SHARING_STARTED,data:a}})}function H(e){var t,n;return e.hand?(0,a.__assign)((0,a.__assign)({},e),{hand:{state:(null===(t=null==e?void 0:e.hand)||void 0===t?void 0:t.state)===r.SdkHandType.RAISED,ts:null===(n=null==e?void 0:e.hand)||void 0===n?void 0:n.ts}}):e}function G(e,t,n){var a=t.getState();return a.ipSettingEnabled&&"all"!==a.privacySettings.callsIp?(0,p.isChatPeer)(n)?Promise.resolve(!0):e.isFriend?Promise.resolve(!e.isFriend(n)):Object.keys(a.friendsCache).length>0?Promise.resolve(!a.friendsCache[n]):(0,o.exponentialRetry)(A.loadFriendsAction)(e,a,t.dispatch).then((function(){return G(e,t,n)})):Promise.resolve(!1)}},662727:(e,t,n)=>{"use strict";n.d(t,{getCallTimer:()=>p,getHangupStatus:()=>_,getCallStatus:()=>m});var a=n(121255),r=n(52777),i=n(298811),o=n(667294),l=n(464380),s=n(670778),c=n(580248),u=n(745284),d=n(697483);function p(e){return e?o.createElement(r.CallTimer,{duration:(0,i.calculateCallDuration)(e)}):null}function _(e,t){if(e.hangupType)switch(e.hangupType){case a.HANGUP_TYPE_BUSY:return t("calls_busy");case a.HANGUP_TYPE_CALLEE_IS_OFFLINE:return t("calls_callee_is_offline");case a.HANGUP_TYPE_REJECTED:return t("calls_rejected_status");case a.HANGUP_TYPE_CANCELED:case a.HANGUP_TYPE_MISSED:case a.HANGUP_TYPE_HUNGUP:case a.HANGUP_TYPE_REMOVED:return null;case a.HANGUP_TYPE_CALLER_IS_BLOCKED:case a.HANGUP_TYPE_EXTERNAL_API_ERROR:case a.HANGUP_TYPE_FAILED:case a.HANGUP_TYPE_NOT_FRIENDS:case a.HANGUP_TYPE_OLD_VERSION:case a.HANGUP_TYPE_SERVICE_DISABLED:case a.HANGUP_TYPE_UNKNOWN_ERROR:case a.HANGUP_TYPE_UNSUPPORTED:return t("calls_error")}return null}var m=function(e,t){return e?_(e,t)||function(e,t){var n,a=e.participants[t];return a&&a.status===l.ParticipantStatus.CONNECTED||a&&a.status===l.ParticipantStatus.WAITING_HALL||(0,d.getActiveParticipantsCount)(e)<2?null:o.createElement(s.ParticipantStatusContainer,{status:null!==(n=null==a?void 0:a.status)&&void 0!==n?n:l.ParticipantStatus.WAITING})}(e,(0,u.isGroupCallByPeer)(e.peer)?e.me:e.peer)||function(e,t){return void 0===((0,u.isGroupCallByPeer)(e.peer)?e.callData.ts:e.callData.localTimeStamp)?o.createElement(c.default,null,t("calls_status_waiting")):null}(e,t):""}},387691:(e,t,n)=>{"use strict";n.d(t,{localVolumeDetectorGenerator:()=>r,volumesDetectorGenerator:()=>i});var a=n(570655);function r(e){var t=e.onVolumeLevelReached,n=e.needCheckMicEnabled,r=e.vectorLength,i=e.volumeLevelDetection,o=e.callbackFactorStep,l=e.sensitivityCoefficient,s=e.onVolumeLevelUpdated,c=e.debugCallback,u=function(e){var t=[],n=0;return function(a){if(t.push(a),n+=a,t.length>e){var r=t.shift();n-=r||0}return n/t.length}}(r),d=0,p=!1;return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];c&&c(e);var _=(0,a.__read)(e,2),m=_[0],f=_[1],g=m>i;p!==g&&s&&s(g),p=g,0!==d&&f&&(d=0);var A=u(m);n&&f||m/A>(1+d)/l&&m>i&&(d+=o,t())}}function i(e){var t=e.onUpdate,n=e.volumeLevelDetection,r=e.debugCallback,i={},s=[],c={},u=[];return function(){for(var e=[],d=0;d<arguments.length;d++)e[d]=arguments[d];r&&r(e);var p=(0,a.__read)(e,1),_=p[0];c=Object.keys(c).reduce((function(e,t){return c[t]-1>0&&(e[t]=c[t]-1),e}),{});var m=_.reduce((function(e,t){var a=t.uid.id;return t.volume>n&&(e[a]=!0,c[a]=3),e}),{});u=Object.keys(c);var f=!1,g={speakers:null,speakersInHeader:null};o(i,m)||(g.speakers=m,i=m,f=!0),l(s,u)||(g.speakersInHeader=u,s=u,f=!0),f&&t(g)}}function o(e,t){var n=Object.keys(e),a=Object.keys(t);return n.length===a.length&&n.every((function(e){return t[e]}))}function l(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}},485525:(e,t,n)=>{"use strict";n.d(t,{wakeLockRequest:()=>c,wakeLockRelease:()=>u});var a,r="wakeLock"in navigator&&!0,i=null,o=!1,l=function(){null!==i&&"visible"===document.visibilityState&&c()},s=function(){var e,t,n,r;a||((a=document.createElement("video")).setAttribute("title","Wake lock"),a.setAttribute("playsinline",""),e=a,t="mp4",n="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA=",(r=document.createElement("source")).src=n,r.type="video/"+t,e.appendChild(r),a.addEventListener("loadedmetadata",(function(){a&&a.addEventListener("timeupdate",(function(){a&&a.currentTime>.5&&(a.currentTime=Math.random())}))}))),a.play().catch((function(){}))};function c(){if(!r)return s();o||(o=!0,document.addEventListener("visibilitychange",l));try{navigator.wakeLock.request("screen").then((function(e){(i=e).addEventListener("release",(function(){}))}))}catch(e){console.error(e.name+", "+e.message)}}function u(){r?i&&i.release().then((function(){i=null})):a&&a.pause()}},862191:(e,t,n)=>{"use strict";n.d(t,{callStatDataStorage:()=>l});var a=n(570655),r=n(464380),i={timeStart:null,entryPoint:null,startType:null,isGroupCall:!1,hadVideoEnabled:!1,isOutgoingCall:!1,connectionStep:null};function o(e){switch(e){case r.ParticipantStatus.WAITING:return 1;case r.ParticipantStatus.CONNECTING:return 2;case r.ParticipantStatus.CONNECTED:return 3;default:return 0}}var l={get:function(){return i},set:function(e){var t,n;i=(0,a.__assign)((0,a.__assign)((0,a.__assign)({},i),e),{connectionStep:(t=e.connectionStep,n=i.connectionStep,t&&o(t)&&o(t)>o(n)?t:n)})},reset:function(){i={timeStart:null,entryPoint:null,startType:null,isGroupCall:!1,hadVideoEnabled:!1,isOutgoingCall:!1,connectionStep:null}}}},614914:(e,t,n)=>{"use strict";n.d(t,{callStats:()=>o});var a=n(570655),r=n(697483),i="type_voip_call_item",o=new(function(){function e(){this.eventCommonData={}}return e.prototype.setActionStatCollector=function(e){this.actionStatCollector=e},e.prototype.setEventCommonData=function(e){void 0===e&&(e={}),this.eventCommonData=e},e.prototype.logEvent=function(e){var t,n=e.peer_id,o=(0,r.isParticipantGroup)(n)?n:0,l=(0,a.__assign)((0,a.__assign)((0,a.__assign)({},e),{peer_id:e.peer_id.toString(),session_id:e.session_id||"",lib_version:"calls_v2",group_id:o}),this.eventCommonData);this.actionStatCollector&&this.actionStatCollector.logEvent(((t={type:i}).type_voip_call_item=l,t))},e}())},170794:(e,t,n)=>{"use strict";n.d(t,{setStatlogEventsHandler:()=>l,addCallStatEvent:()=>s});var a,r=n(121255),i=n(862191),o=n(464380);function l(e){a=e}function s(e,t,n,o){var l,s,u,d=i.callStatDataStorage.get(),p=d.startType,_=d.entryPoint,m=d.timeStart,f=d.isGroupCall,g=d.hadVideoEnabled,A=d.isOutgoingCall,v=!e||e===r.HANGUP_TYPE_HUNGUP&&!n,h={type:p&&function(e,t,n){var a;a=e===r.CallType.VIDEO?t?r.CallStatReachedType.GROUP_VIDEO:r.CallStatReachedType.VIDEO:n?t?r.CallStatReachedType.GROUP_AUDIO_TO_VIDEO:r.CallStatReachedType.AUDIO_TO_VIDEO:t?r.CallStatReachedType.GROUP_AUDIO:r.CallStatReachedType.AUDIO;return a}(p,f,g),result:v?r.CallStatResult.SUCCESS:r.CallStatResult.FAIL,failReason:v?null:c(e,n),callSource:_,totalDuration:m?Date.now()-m:0};A&&(o&&console.log(h),l=t,u=[(s=h).type||"",s.result,s.failReason||"",s.callSource||"",s.totalDuration],a&&a({name:"call_stats",value:l,keys:u}))}function c(e,t){var n=i.callStatDataStorage.get().isOutgoingCall,a=i.callStatDataStorage.get().connectionStep;switch(!0){case t:return r.CallStatFailReason.CONNECTION_LOST;case e===r.HANGUP_TYPE_CANCELED:return r.CallStatFailReason.LOCAL_DECLINE;case e===r.HANGUP_TYPE_REJECTED:return r.CallStatFailReason.REMOTE_DECLINE;case e===r.HANGUP_TYPE_BUSY:return r.CallStatFailReason.REMOTE_BUSY;case e===r.HANGUP_TYPE_MISSED:return n?r.CallStatFailReason.REMOTE_TIMEOUT:null;case a===o.ParticipantStatus.CONNECTING:return r.CallStatFailReason.REMOTE_FAILED_ACCEPT;case!a:return r.CallStatFailReason.REMOTE_NO_CONNECT;default:return null}}},525046:(e,t,n)=>{"use strict";n.d(t,{saveLocalToken:()=>o,removeLocalToken:()=>l,fetchToken:()=>s});var a=n(659397),r=n(329538),i="calls_token";function o(e){a.localStorage.setItem(i,e)}function l(){a.localStorage.removeItem(i)}function s(e){var t=a.localStorage.getItem(i);return t?Promise.resolve(t):(0,r.getCallAuthToken)(e).then((function(e){return e.token}))}},580248:(e,t,n)=>{"use strict";n.d(t,{default:()=>c});var a=n(570655),r=n(667294),i=n(45697),o=n.n(i),l=n(659397),s=function(e){var t=e.children,n=e.className,i=(0,a.__rest)(e,["children","className"]),o=(0,l.classNames)("ActivityIndicator",n);return r.createElement("span",(0,a.__assign)({},i,{className:o}),t)};s.propTypes={className:o().string,children:o().node};const c=s},685537:(e,t,n)=>{"use strict";n.d(t,{AvatarsStack:()=>o});var a=n(667294),r=n(211941),i=n(906942),o=function(e){var t=e.items;return a.createElement("figure",{className:"AvatarsStack"},a.createElement(r.default,null,a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg"},a.createElement("defs",null,a.createElement("clipPath",{id:"users-mask"},a.createElement("path",{d:"M43.56 8.25a25 25 0 100 33.5A27.88 27.88 0 0138 25c0-6.28 2.07-12.08 5.56-16.75z"}))))),t.map((function(e,t){return"src"in e?a.createElement("img",{src:e.src,className:"AvatarsStack__item",alt:e.alt,key:e.key||t}):a.createElement(i.ConversationNoPhoto,{text:e.text,id:e.id,size:"50",className:"AvatarsStack__item",key:e.key||t})})))}},622206:(e,t,n)=>{"use strict";n.d(t,{AvatarsStackNoSvgSizes:()=>a,AvatarsStackNoSvg:()=>l});var a,r=n(667294),i=n(906942),o=n(659397);!function(e){e.SIZE_50="50",e.SIZE_34="34",e.SIZE_24="24"}(a||(a={}));var l=function(e){var t=e.items,n=e.size,l=void 0===n?a.SIZE_50:n;return r.createElement("div",{className:"AvatarsStackNoSvg"},t.map((function(e,t){var n=(0,o.classNames)("AvatarsStackNoSvg__item","AvatarsStackNoSvg__item--"+l);return"src"in e?r.createElement("img",{src:e.src,className:n,alt:e.alt,key:e.key||t}):r.createElement(i.ConversationNoPhoto,{text:e.text,id:e.id,size:l,className:n,key:e.key||t})})))}},20845:(e,t,n)=>{"use strict";n.d(t,{DivBlockSkeleton:()=>i});var a=n(667294),r=n(911099),i=function(e){var t=e.height,n=e.classNames,i=void 0===n?"":n,o=(0,a.useMemo)((function(){return{height:t}}),[t]);return a.createElement("div",{className:(0,r.classNames)("DivBlockSkeleton",i),style:o})}},607691:(e,t,n)=>{"use strict";n.d(t,{ListCopyControl:()=>c});var a=n(570655),r=n(667294),i=n(58600),o=n(326542),l=n(629142),s=n(659397),c=function(e){var t=e.value,n=e.copyText,c=e.doneText,u=e.className,d=(0,a.__read)((0,r.useState)(!1),2),p=d[0],_=d[1],m=(0,r.useCallback)((function(){_(!0)}),[]),f=(0,r.useCallback)((function(){_(!1)}),[]),g=(0,s.classNames)("ListCopyControl",u,{"ListCopyControl--copied":p});return r.createElement("div",{className:g},r.createElement(i.CopyText,{text:t,onCopyDone:m},r.createElement(o.default,{className:"ListCopyControl__copyButton"},n)),r.createElement(l.default,{shown:p,callback:f,className:"ListCopyControl__copyDone"},c))}},295886:(e,t,n)=>{"use strict";n.d(t,{ListHeader:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.headingElement,n=void 0===t?"h3":t,i=e.extra,o=e.right,l=e.className,s=e.children,c=n;return a.createElement("header",{className:(0,r.classNames)("ListHeader",l)},a.createElement(c,{className:"ListHeader__text"},s),a.createElement("span",{className:"ListHeader__extra"},i),o&&a.createElement("span",{className:"ListHeader__right"},o))}},489685:(e,t,n)=>{"use strict";n.d(t,{LinkIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"14",height:"14",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},t,{"aria-hidden":"true"}),r.createElement("path",{d:"M6.022 9.184a.837.837 0 01-1.187-.001 3.861 3.861 0 010-5.419l2.618-2.643a3.772 3.772 0 015.366 0c1.261 1.274 1.557 3.033.67 4.508-.296.49-.947.47-1.325.09-.275-.276-.254-.707-.077-1.019.465-.817.24-1.683-.456-2.379a2.094 2.094 0 00-2.997 0L6.023 4.956a2.143 2.143 0 00-.001 3.025.83.83 0 010 1.202zm1.95-3.166c.833.835.832 2.19-.001 3.025L5.36 11.68a2.094 2.094 0 01-2.998 0c-.695-.696-.91-1.555-.446-2.371.178-.313.199-.744-.076-1.019-.379-.38-1.03-.4-1.325.09-.888 1.474-.602 3.226.659 4.5a3.772 3.772 0 005.367 0l2.617-2.643a3.861 3.861 0 000-5.419.837.837 0 00-1.187 0 .83.83 0 000 1.2z"}))}},823694:(e,t,n)=>{"use strict";n.d(t,{PrivacyIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"20",height:"20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{d:"M4 9.6c0-.56 0-.84.109-1.054a1 1 0 01.437-.437C4.76 8 5.04 8 5.6 8h8.8c.56 0 .84 0 1.054.109a1 1 0 01.437.437C16 8.76 16 9.04 16 9.6v4.8c0 .56 0 .84-.109 1.054a1 1 0 01-.437.437C15.24 16 14.96 16 14.4 16H5.6c-.56 0-.84 0-1.054-.109a1 1 0 01-.437-.437C4 15.24 4 14.96 4 14.4V9.6z",fill:"#fff"}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.2 6a2.2 2.2 0 00-4.4 0v4a2.2 2.2 0 104.4-.001V6zM10 2a4 4 0 00-4 4v4a4 4 0 108-.001V6A4 4 0 0010 2z",fill:"#fff"}))}},449608:(e,t,n)=>{"use strict";n.d(t,{TimeIcon:()=>i});var a=n(570655),r=n(667294),i=function(e){var t=(0,a.__rest)(e,[]);return r.createElement("svg",(0,a.__assign)({width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.8 8a6.2 6.2 0 1112.4 0A6.2 6.2 0 011.8 8zM0 8a8 8 0 1116 0A8 8 0 010 8zm8.9-3a.9.9 0 00-1.8 0v4a.9.9 0 00.498.805l2 1a.9.9 0 10.804-1.61L8.9 8.444V5z",fill:"#fff"}))}},605329:(e,t,n)=>{"use strict";n.d(t,{PageColumns:()=>r});var a=n(667294),r=function(e){var t=e.narrow,n=e.children;return a.createElement("div",{className:"wide_column_left"},a.createElement("div",{className:"narrow_column_wrap"},a.createElement("div",{className:"narrow_column",id:"narrow_column"},t)),a.createElement("div",{className:"wide_column_wrap"},a.createElement("div",{className:"wide_column",id:"wide_column"},n)))}},575003:(e,t,n)=>{"use strict";n.d(t,{RightMenu:()=>i});var a=n(667294),r=n(659397),i=function(e){var t=e.tabs,n=e.activeTab,i=e.onTabClick,o=e.loading,l=void 0!==o&&o,s=window.uiRightMenu,c=(0,a.useCallback)((function(e,a){e.preventDefault();var r=t.find((function(e){return e.id===a}));if(r){if(r.id===n)return;var o=r.ref.current;s.switchMenu(o),i(a,r.href)}}),[n]);return(0,a.useEffect)((function(){var e=t.find((function(e){return e.id===n}));if(e){var a=e.ref.current;s.switchMenu(a)}}),[n]),(0,a.useEffect)((function(){var e=t.find((function(e){return e.id===n}));if(e){var a=e.ref.current;l?s.showProgress(a):s.hideProgress(a)}}),[l,n]),a.createElement("div",{className:"page_block ui_rmenu ui_rmenu_pr",role:"list"},t.map((function(e){if(e.separator)return a.createElement("div",{key:e.id,className:"ui_rmenu_sep"});var t=e,n=t.id,i=t.ref,o=t.href,l=t.label,s=t.parentTab;return a.createElement("a",{key:n,className:(0,r.classNames)("ui_rmenu_item",{ui_rmenu_subitem:!!s}),ref:i,href:o,onClick:function(e){return c(e,n)}},a.createElement("span",null,l))})),a.createElement("div",{className:"ui_rmenu_slider _ui_rmenu_slider"}))}},641221:(e,t,n)=>{"use strict";n.d(t,{TooltipNew:()=>s});var a,r=n(570655),i=n(667294),o=n(617841),l=n(659397);function s(e){var t=e.children,n=e.content,s=e.position,c=void 0===s?"auto":s,u=e.align,d=void 0===u?"auto":u,p=e.appearance,_=void 0===p?"dark":p,m=e.open,f=void 0!==m&&m,g=e.onOpen,A=e.onClose,v=e.delay,h=void 0===v?50:v,E=(0,r.__rest)(e,["children","content","position","align","appearance","open","onOpen","onClose","delay"]),C=(0,r.__read)((0,i.useState)(f?a.OPENED:a.CLOSED),2),S=C[0],y=C[1],T=(0,i.useRef)(null);(0,i.useEffect)((function(){var e=null,t=null,n=function(){e&&(clearTimeout(e),e=null)},r=function(){n(),e=window.setTimeout((function(){y(a.OPENED),g&&g()}),h)},i=function(){n(),t=window.setTimeout((function(){S===a.OPENED?y(a.IS_CLOSING):(y(a.CLOSED),A&&A())}),0)};return T&&T.current&&(T.current.addEventListener("mouseenter",r),T.current.addEventListener("mouseleave",i)),function(){T&&T.current&&(T.current.removeEventListener("mouseenter",r),T.current.removeEventListener("mouseleave",i)),n(),t&&(window.clearTimeout(t),t=null)}}),[T,S]),(0,i.useEffect)((function(){var e=f?a.OPENED:a.CLOSED;S!==e&&y(e)}),[f]);var I=(0,i.useCallback)((function(){S===a.IS_CLOSING&&(y(a.CLOSED),A&&A())}),[S]),b=(0,l.classNames)("TooltipNew",{"TooltipNew--removed":"isClosing"===S,"TooltipNew--dark":"dark"===_,"TooltipNew--light":"light"===_}),N=i.createElement("div",{className:b,onTransitionEnd:I},n);return i.createElement(o.Popper,(0,r.__assign)({open:S!==a.CLOSED,position:c,align:d,content:N,ref:T},E),t)}!function(e){e.OPENED="opened",e.IS_CLOSING="isClosing",e.CLOSED="closed"}(a||(a={}))}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={id:e,loaded:!1,exports:{}};return a[e].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=a,e=[],i.O=(t,n,a,r)=>{if(!n){var o=1/0;for(u=0;u<e.length;u++){for(var[n,a,r]=e[u],l=!0,s=0;s<n.length;s++)(!1&r||o>=r)&&Object.keys(i.O).every((e=>i.O[e](n[s])))?n.splice(s--,1):(l=!1,r<o&&(o=r));if(l){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,a,r]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var r=Object.create(null);i.r(r);var o={};t=t||[null,n({}),n([]),n(n)];for(var l=2&a&&e;"object"==typeof l&&!~t.indexOf(l);l=n(l))Object.getOwnPropertyNames(l).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(r,o),r},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.e=()=>Promise.resolve(),i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={94387:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var a,r,[o,l,s]=n,c=0;for(a in l)i.o(l,a)&&(i.m[a]=l[a]);if(s)var u=s(i);for(t&&t(n);c<o.length;c++)r=o[c],i.o(e,r)&&e[r]&&e[r][0](),e[o[c]]=0;return i.O(u)},n=self.webpackChunkvk=self.webpackChunkvk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=i.O(void 0,[68592,24509,3833,22070,89429],(()=>i(366206)));o=i.O(o)})();